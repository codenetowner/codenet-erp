var KL=Object.defineProperty;var l3=e=>{throw TypeError(e)};var GL=(e,t,r)=>t in e?KL(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var qv=(e,t,r)=>GL(e,typeof t!="symbol"?t+"":t,r),Kv=(e,t,r)=>t.has(e)||l3("Cannot "+r);var ce=(e,t,r)=>(Kv(e,t,"read from private field"),r?r.call(e):t.get(e)),Ft=(e,t,r)=>t.has(e)?l3("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),bt=(e,t,r,s)=>(Kv(e,t,"write to private field"),s?s.call(e,r):t.set(e,r),r),lr=(e,t,r)=>(Kv(e,t,"access private method"),r);var Wx=(e,t,r,s)=>({set _(n){bt(e,t,n,r)},get _(){return ce(e,t,s)}});function QL(e,t){for(var r=0;r<t.length;r++){const s=t[r];if(typeof s!="string"&&!Array.isArray(s)){for(const n in s)if(n!=="default"&&!(n in e)){const i=Object.getOwnPropertyDescriptor(s,n);i&&Object.defineProperty(e,n,i.get?i:{enumerable:!0,get:()=>s[n]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function r(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(n){if(n.ep)return;n.ep=!0;const i=r(n);fetch(n.href,i)}})();function xo(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var M_={exports:{}},Yg={},L_={exports:{}},mr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xf=Symbol.for("react.element"),XL=Symbol.for("react.portal"),YL=Symbol.for("react.fragment"),JL=Symbol.for("react.strict_mode"),ZL=Symbol.for("react.profiler"),e$=Symbol.for("react.provider"),t$=Symbol.for("react.context"),r$=Symbol.for("react.forward_ref"),a$=Symbol.for("react.suspense"),s$=Symbol.for("react.memo"),n$=Symbol.for("react.lazy"),o3=Symbol.iterator;function i$(e){return e===null||typeof e!="object"?null:(e=o3&&e[o3]||e["@@iterator"],typeof e=="function"?e:null)}var $_={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},B_=Object.assign,z_={};function k0(e,t,r){this.props=e,this.context=t,this.refs=z_,this.updater=r||$_}k0.prototype.isReactComponent={};k0.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};k0.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function U_(){}U_.prototype=k0.prototype;function eN(e,t,r){this.props=e,this.context=t,this.refs=z_,this.updater=r||$_}var tN=eN.prototype=new U_;tN.constructor=eN;B_(tN,k0.prototype);tN.isPureReactComponent=!0;var c3=Array.isArray,W_=Object.prototype.hasOwnProperty,rN={current:null},V_={key:!0,ref:!0,__self:!0,__source:!0};function H_(e,t,r){var s,n={},i=null,l=null;if(t!=null)for(s in t.ref!==void 0&&(l=t.ref),t.key!==void 0&&(i=""+t.key),t)W_.call(t,s)&&!V_.hasOwnProperty(s)&&(n[s]=t[s]);var o=arguments.length-2;if(o===1)n.children=r;else if(1<o){for(var c=Array(o),u=0;u<o;u++)c[u]=arguments[u+2];n.children=c}if(e&&e.defaultProps)for(s in o=e.defaultProps,o)n[s]===void 0&&(n[s]=o[s]);return{$$typeof:Xf,type:e,key:i,ref:l,props:n,_owner:rN.current}}function l$(e,t){return{$$typeof:Xf,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function aN(e){return typeof e=="object"&&e!==null&&e.$$typeof===Xf}function o$(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var d3=/\/+/g;function Gv(e,t){return typeof e=="object"&&e!==null&&e.key!=null?o$(""+e.key):t.toString(36)}function zm(e,t,r,s,n){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var l=!1;if(e===null)l=!0;else switch(i){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case Xf:case XL:l=!0}}if(l)return l=e,n=n(l),e=s===""?"."+Gv(l,0):s,c3(n)?(r="",e!=null&&(r=e.replace(d3,"$&/")+"/"),zm(n,t,r,"",function(u){return u})):n!=null&&(aN(n)&&(n=l$(n,r+(!n.key||l&&l.key===n.key?"":(""+n.key).replace(d3,"$&/")+"/")+e)),t.push(n)),1;if(l=0,s=s===""?".":s+":",c3(e))for(var o=0;o<e.length;o++){i=e[o];var c=s+Gv(i,o);l+=zm(i,t,r,c,n)}else if(c=i$(e),typeof c=="function")for(e=c.call(e),o=0;!(i=e.next()).done;)i=i.value,c=s+Gv(i,o++),l+=zm(i,t,r,c,n);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function Vx(e,t,r){if(e==null)return e;var s=[],n=0;return zm(e,s,"","",function(i){return t.call(r,i,n++)}),s}function c$(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var mn={current:null},Um={transition:null},d$={ReactCurrentDispatcher:mn,ReactCurrentBatchConfig:Um,ReactCurrentOwner:rN};function q_(){throw Error("act(...) is not supported in production builds of React.")}mr.Children={map:Vx,forEach:function(e,t,r){Vx(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Vx(e,function(){t++}),t},toArray:function(e){return Vx(e,function(t){return t})||[]},only:function(e){if(!aN(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};mr.Component=k0;mr.Fragment=YL;mr.Profiler=ZL;mr.PureComponent=eN;mr.StrictMode=JL;mr.Suspense=a$;mr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=d$;mr.act=q_;mr.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var s=B_({},e.props),n=e.key,i=e.ref,l=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,l=rN.current),t.key!==void 0&&(n=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(c in t)W_.call(t,c)&&!V_.hasOwnProperty(c)&&(s[c]=t[c]===void 0&&o!==void 0?o[c]:t[c])}var c=arguments.length-2;if(c===1)s.children=r;else if(1<c){o=Array(c);for(var u=0;u<c;u++)o[u]=arguments[u+2];s.children=o}return{$$typeof:Xf,type:e.type,key:n,ref:i,props:s,_owner:l}};mr.createContext=function(e){return e={$$typeof:t$,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:e$,_context:e},e.Consumer=e};mr.createElement=H_;mr.createFactory=function(e){var t=H_.bind(null,e);return t.type=e,t};mr.createRef=function(){return{current:null}};mr.forwardRef=function(e){return{$$typeof:r$,render:e}};mr.isValidElement=aN;mr.lazy=function(e){return{$$typeof:n$,_payload:{_status:-1,_result:e},_init:c$}};mr.memo=function(e,t){return{$$typeof:s$,type:e,compare:t===void 0?null:t}};mr.startTransition=function(e){var t=Um.transition;Um.transition={};try{e()}finally{Um.transition=t}};mr.unstable_act=q_;mr.useCallback=function(e,t){return mn.current.useCallback(e,t)};mr.useContext=function(e){return mn.current.useContext(e)};mr.useDebugValue=function(){};mr.useDeferredValue=function(e){return mn.current.useDeferredValue(e)};mr.useEffect=function(e,t){return mn.current.useEffect(e,t)};mr.useId=function(){return mn.current.useId()};mr.useImperativeHandle=function(e,t,r){return mn.current.useImperativeHandle(e,t,r)};mr.useInsertionEffect=function(e,t){return mn.current.useInsertionEffect(e,t)};mr.useLayoutEffect=function(e,t){return mn.current.useLayoutEffect(e,t)};mr.useMemo=function(e,t){return mn.current.useMemo(e,t)};mr.useReducer=function(e,t,r){return mn.current.useReducer(e,t,r)};mr.useRef=function(e){return mn.current.useRef(e)};mr.useState=function(e){return mn.current.useState(e)};mr.useSyncExternalStore=function(e,t,r){return mn.current.useSyncExternalStore(e,t,r)};mr.useTransition=function(){return mn.current.useTransition()};mr.version="18.3.1";L_.exports=mr;var m=L_.exports;const K_=xo(m),G_=QL({__proto__:null,default:K_},[m]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var u$=m,h$=Symbol.for("react.element"),f$=Symbol.for("react.fragment"),x$=Object.prototype.hasOwnProperty,m$=u$.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p$={key:!0,ref:!0,__self:!0,__source:!0};function Q_(e,t,r){var s,n={},i=null,l=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(l=t.ref);for(s in t)x$.call(t,s)&&!p$.hasOwnProperty(s)&&(n[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps,t)n[s]===void 0&&(n[s]=t[s]);return{$$typeof:h$,type:e,key:i,ref:l,props:n,_owner:m$.current}}Yg.Fragment=f$;Yg.jsx=Q_;Yg.jsxs=Q_;M_.exports=Yg;var a=M_.exports,y1={},X_={exports:{}},Jn={},Y_={exports:{}},J_={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(K,q){var ge=K.length;K.push(q);e:for(;0<ge;){var G=ge-1>>>1,B=K[G];if(0<n(B,q))K[G]=q,K[ge]=B,ge=G;else break e}}function r(K){return K.length===0?null:K[0]}function s(K){if(K.length===0)return null;var q=K[0],ge=K.pop();if(ge!==q){K[0]=ge;e:for(var G=0,B=K.length,se=B>>>1;G<se;){var L=2*(G+1)-1,Z=K[L],F=L+1,he=K[F];if(0>n(Z,ge))F<B&&0>n(he,Z)?(K[G]=he,K[F]=ge,G=F):(K[G]=Z,K[L]=ge,G=L);else if(F<B&&0>n(he,ge))K[G]=he,K[F]=ge,G=F;else break e}}return q}function n(K,q){var ge=K.sortIndex-q.sortIndex;return ge!==0?ge:K.id-q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var l=Date,o=l.now();e.unstable_now=function(){return l.now()-o}}var c=[],u=[],d=1,h=null,f=3,x=!1,p=!1,g=!1,y=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,j=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(K){for(var q=r(u);q!==null;){if(q.callback===null)s(u);else if(q.startTime<=K)s(u),q.sortIndex=q.expirationTime,t(c,q);else break;q=r(u)}}function w(K){if(g=!1,b(K),!p)if(r(c)!==null)p=!0,Q(k);else{var q=r(u);q!==null&&H(w,q.startTime-K)}}function k(K,q){p=!1,g&&(g=!1,v(_),_=-1),x=!0;var ge=f;try{for(b(q),h=r(c);h!==null&&(!(h.expirationTime>q)||K&&!R());){var G=h.callback;if(typeof G=="function"){h.callback=null,f=h.priorityLevel;var B=G(h.expirationTime<=q);q=e.unstable_now(),typeof B=="function"?h.callback=B:h===r(c)&&s(c),b(q)}else s(c);h=r(c)}if(h!==null)var se=!0;else{var L=r(u);L!==null&&H(w,L.startTime-q),se=!1}return se}finally{h=null,f=ge,x=!1}}var N=!1,S=null,_=-1,O=5,E=-1;function R(){return!(e.unstable_now()-E<O)}function C(){if(S!==null){var K=e.unstable_now();E=K;var q=!0;try{q=S(!0,K)}finally{q?I():(N=!1,S=null)}}else N=!1}var I;if(typeof j=="function")I=function(){j(C)};else if(typeof MessageChannel<"u"){var ne=new MessageChannel,W=ne.port2;ne.port1.onmessage=C,I=function(){W.postMessage(null)}}else I=function(){y(C,0)};function Q(K){S=K,N||(N=!0,I())}function H(K,q){_=y(function(){K(e.unstable_now())},q)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(K){K.callback=null},e.unstable_continueExecution=function(){p||x||(p=!0,Q(k))},e.unstable_forceFrameRate=function(K){0>K||125<K?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<K?Math.floor(1e3/K):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(K){switch(f){case 1:case 2:case 3:var q=3;break;default:q=f}var ge=f;f=q;try{return K()}finally{f=ge}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(K,q){switch(K){case 1:case 2:case 3:case 4:case 5:break;default:K=3}var ge=f;f=K;try{return q()}finally{f=ge}},e.unstable_scheduleCallback=function(K,q,ge){var G=e.unstable_now();switch(typeof ge=="object"&&ge!==null?(ge=ge.delay,ge=typeof ge=="number"&&0<ge?G+ge:G):ge=G,K){case 1:var B=-1;break;case 2:B=250;break;case 5:B=1073741823;break;case 4:B=1e4;break;default:B=5e3}return B=ge+B,K={id:d++,callback:q,priorityLevel:K,startTime:ge,expirationTime:B,sortIndex:-1},ge>G?(K.sortIndex=ge,t(u,K),r(c)===null&&K===r(u)&&(g?(v(_),_=-1):g=!0,H(w,ge-G))):(K.sortIndex=B,t(c,K),p||x||(p=!0,Q(k))),K},e.unstable_shouldYield=R,e.unstable_wrapCallback=function(K){var q=f;return function(){var ge=f;f=q;try{return K.apply(this,arguments)}finally{f=ge}}}})(J_);Y_.exports=J_;var g$=Y_.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var y$=m,Gn=g$;function ot(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Z_=new Set,qh={};function Ud(e,t){Zu(e,t),Zu(e+"Capture",t)}function Zu(e,t){for(qh[e]=t,e=0;e<t.length;e++)Z_.add(t[e])}var Jl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),v1=Object.prototype.hasOwnProperty,v$=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,u3={},h3={};function b$(e){return v1.call(h3,e)?!0:v1.call(u3,e)?!1:v$.test(e)?h3[e]=!0:(u3[e]=!0,!1)}function j$(e,t,r,s){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return s?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function w$(e,t,r,s){if(t===null||typeof t>"u"||j$(e,t,r,s))return!0;if(s)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function pn(e,t,r,s,n,i,l){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=s,this.attributeNamespace=n,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=l}var Ts={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Ts[e]=new pn(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Ts[t]=new pn(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Ts[e]=new pn(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Ts[e]=new pn(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Ts[e]=new pn(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Ts[e]=new pn(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Ts[e]=new pn(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Ts[e]=new pn(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Ts[e]=new pn(e,5,!1,e.toLowerCase(),null,!1,!1)});var sN=/[\-:]([a-z])/g;function nN(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(sN,nN);Ts[t]=new pn(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(sN,nN);Ts[t]=new pn(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(sN,nN);Ts[t]=new pn(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Ts[e]=new pn(e,1,!1,e.toLowerCase(),null,!1,!1)});Ts.xlinkHref=new pn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Ts[e]=new pn(e,1,!1,e.toLowerCase(),null,!0,!0)});function iN(e,t,r,s){var n=Ts.hasOwnProperty(t)?Ts[t]:null;(n!==null?n.type!==0:s||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(w$(t,r,n,s)&&(r=null),s||n===null?b$(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):n.mustUseProperty?e[n.propertyName]=r===null?n.type===3?!1:"":r:(t=n.attributeName,s=n.attributeNamespace,r===null?e.removeAttribute(t):(n=n.type,r=n===3||n===4&&r===!0?"":""+r,s?e.setAttributeNS(s,t,r):e.setAttribute(t,r))))}var mo=y$.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Hx=Symbol.for("react.element"),fu=Symbol.for("react.portal"),xu=Symbol.for("react.fragment"),lN=Symbol.for("react.strict_mode"),b1=Symbol.for("react.profiler"),eT=Symbol.for("react.provider"),tT=Symbol.for("react.context"),oN=Symbol.for("react.forward_ref"),j1=Symbol.for("react.suspense"),w1=Symbol.for("react.suspense_list"),cN=Symbol.for("react.memo"),To=Symbol.for("react.lazy"),rT=Symbol.for("react.offscreen"),f3=Symbol.iterator;function G0(e){return e===null||typeof e!="object"?null:(e=f3&&e[f3]||e["@@iterator"],typeof e=="function"?e:null)}var Sa=Object.assign,Qv;function xh(e){if(Qv===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Qv=t&&t[1]||""}return`
`+Qv+e}var Xv=!1;function Yv(e,t){if(!e||Xv)return"";Xv=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var s=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){s=u}e.call(t.prototype)}else{try{throw Error()}catch(u){s=u}e()}}catch(u){if(u&&s&&typeof u.stack=="string"){for(var n=u.stack.split(`
`),i=s.stack.split(`
`),l=n.length-1,o=i.length-1;1<=l&&0<=o&&n[l]!==i[o];)o--;for(;1<=l&&0<=o;l--,o--)if(n[l]!==i[o]){if(l!==1||o!==1)do if(l--,o--,0>o||n[l]!==i[o]){var c=`
`+n[l].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=l&&0<=o);break}}}finally{Xv=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?xh(e):""}function N$(e){switch(e.tag){case 5:return xh(e.type);case 16:return xh("Lazy");case 13:return xh("Suspense");case 19:return xh("SuspenseList");case 0:case 2:case 15:return e=Yv(e.type,!1),e;case 11:return e=Yv(e.type.render,!1),e;case 1:return e=Yv(e.type,!0),e;default:return""}}function N1(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case xu:return"Fragment";case fu:return"Portal";case b1:return"Profiler";case lN:return"StrictMode";case j1:return"Suspense";case w1:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case tT:return(e.displayName||"Context")+".Consumer";case eT:return(e._context.displayName||"Context")+".Provider";case oN:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case cN:return t=e.displayName||null,t!==null?t:N1(e.type)||"Memo";case To:t=e._payload,e=e._init;try{return N1(e(t))}catch{}}return null}function S$(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return N1(t);case 8:return t===lN?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function hc(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function aT(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function k$(e){var t=aT(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),s=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var n=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return n.call(this)},set:function(l){s=""+l,i.call(this,l)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return s},setValue:function(l){s=""+l},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function qx(e){e._valueTracker||(e._valueTracker=k$(e))}function sT(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),s="";return e&&(s=aT(e)?e.checked?"true":"false":e.value),e=s,e!==r?(t.setValue(e),!0):!1}function dp(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function S1(e,t){var r=t.checked;return Sa({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function x3(e,t){var r=t.defaultValue==null?"":t.defaultValue,s=t.checked!=null?t.checked:t.defaultChecked;r=hc(t.value!=null?t.value:r),e._wrapperState={initialChecked:s,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function nT(e,t){t=t.checked,t!=null&&iN(e,"checked",t,!1)}function k1(e,t){nT(e,t);var r=hc(t.value),s=t.type;if(r!=null)s==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(s==="submit"||s==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?C1(e,t.type,r):t.hasOwnProperty("defaultValue")&&C1(e,t.type,hc(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function m3(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var s=t.type;if(!(s!=="submit"&&s!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function C1(e,t,r){(t!=="number"||dp(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var mh=Array.isArray;function Au(e,t,r,s){if(e=e.options,t){t={};for(var n=0;n<r.length;n++)t["$"+r[n]]=!0;for(r=0;r<e.length;r++)n=t.hasOwnProperty("$"+e[r].value),e[r].selected!==n&&(e[r].selected=n),n&&s&&(e[r].defaultSelected=!0)}else{for(r=""+hc(r),t=null,n=0;n<e.length;n++){if(e[n].value===r){e[n].selected=!0,s&&(e[n].defaultSelected=!0);return}t!==null||e[n].disabled||(t=e[n])}t!==null&&(t.selected=!0)}}function E1(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ot(91));return Sa({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function p3(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(ot(92));if(mh(r)){if(1<r.length)throw Error(ot(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:hc(r)}}function iT(e,t){var r=hc(t.value),s=hc(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),s!=null&&(e.defaultValue=""+s)}function g3(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function lT(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function P1(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?lT(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Kx,oT=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,s,n){MSApp.execUnsafeLocalFunction(function(){return e(t,r,s,n)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Kx=Kx||document.createElement("div"),Kx.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Kx.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Kh(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var kh={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},C$=["Webkit","ms","Moz","O"];Object.keys(kh).forEach(function(e){C$.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),kh[t]=kh[e]})});function cT(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||kh.hasOwnProperty(e)&&kh[e]?(""+t).trim():t+"px"}function dT(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var s=r.indexOf("--")===0,n=cT(r,t[r],s);r==="float"&&(r="cssFloat"),s?e.setProperty(r,n):e[r]=n}}var E$=Sa({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function A1(e,t){if(t){if(E$[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ot(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ot(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ot(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ot(62))}}function _1(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var T1=null;function dN(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var I1=null,_u=null,Tu=null;function y3(e){if(e=Zf(e)){if(typeof I1!="function")throw Error(ot(280));var t=e.stateNode;t&&(t=ry(t),I1(e.stateNode,e.type,t))}}function uT(e){_u?Tu?Tu.push(e):Tu=[e]:_u=e}function hT(){if(_u){var e=_u,t=Tu;if(Tu=_u=null,y3(e),t)for(e=0;e<t.length;e++)y3(t[e])}}function fT(e,t){return e(t)}function xT(){}var Jv=!1;function mT(e,t,r){if(Jv)return e(t,r);Jv=!0;try{return fT(e,t,r)}finally{Jv=!1,(_u!==null||Tu!==null)&&(xT(),hT())}}function Gh(e,t){var r=e.stateNode;if(r===null)return null;var s=ry(r);if(s===null)return null;r=s[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(e=e.type,s=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!s;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(ot(231,t,typeof r));return r}var O1=!1;if(Jl)try{var Q0={};Object.defineProperty(Q0,"passive",{get:function(){O1=!0}}),window.addEventListener("test",Q0,Q0),window.removeEventListener("test",Q0,Q0)}catch{O1=!1}function P$(e,t,r,s,n,i,l,o,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(d){this.onError(d)}}var Ch=!1,up=null,hp=!1,D1=null,A$={onError:function(e){Ch=!0,up=e}};function _$(e,t,r,s,n,i,l,o,c){Ch=!1,up=null,P$.apply(A$,arguments)}function T$(e,t,r,s,n,i,l,o,c){if(_$.apply(this,arguments),Ch){if(Ch){var u=up;Ch=!1,up=null}else throw Error(ot(198));hp||(hp=!0,D1=u)}}function Wd(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function pT(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function v3(e){if(Wd(e)!==e)throw Error(ot(188))}function I$(e){var t=e.alternate;if(!t){if(t=Wd(e),t===null)throw Error(ot(188));return t!==e?null:e}for(var r=e,s=t;;){var n=r.return;if(n===null)break;var i=n.alternate;if(i===null){if(s=n.return,s!==null){r=s;continue}break}if(n.child===i.child){for(i=n.child;i;){if(i===r)return v3(n),e;if(i===s)return v3(n),t;i=i.sibling}throw Error(ot(188))}if(r.return!==s.return)r=n,s=i;else{for(var l=!1,o=n.child;o;){if(o===r){l=!0,r=n,s=i;break}if(o===s){l=!0,s=n,r=i;break}o=o.sibling}if(!l){for(o=i.child;o;){if(o===r){l=!0,r=i,s=n;break}if(o===s){l=!0,s=i,r=n;break}o=o.sibling}if(!l)throw Error(ot(189))}}if(r.alternate!==s)throw Error(ot(190))}if(r.tag!==3)throw Error(ot(188));return r.stateNode.current===r?e:t}function gT(e){return e=I$(e),e!==null?yT(e):null}function yT(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=yT(e);if(t!==null)return t;e=e.sibling}return null}var vT=Gn.unstable_scheduleCallback,b3=Gn.unstable_cancelCallback,O$=Gn.unstable_shouldYield,D$=Gn.unstable_requestPaint,Ra=Gn.unstable_now,F$=Gn.unstable_getCurrentPriorityLevel,uN=Gn.unstable_ImmediatePriority,bT=Gn.unstable_UserBlockingPriority,fp=Gn.unstable_NormalPriority,R$=Gn.unstable_LowPriority,jT=Gn.unstable_IdlePriority,Jg=null,ml=null;function M$(e){if(ml&&typeof ml.onCommitFiberRoot=="function")try{ml.onCommitFiberRoot(Jg,e,void 0,(e.current.flags&128)===128)}catch{}}var Bi=Math.clz32?Math.clz32:B$,L$=Math.log,$$=Math.LN2;function B$(e){return e>>>=0,e===0?32:31-(L$(e)/$$|0)|0}var Gx=64,Qx=4194304;function ph(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function xp(e,t){var r=e.pendingLanes;if(r===0)return 0;var s=0,n=e.suspendedLanes,i=e.pingedLanes,l=r&268435455;if(l!==0){var o=l&~n;o!==0?s=ph(o):(i&=l,i!==0&&(s=ph(i)))}else l=r&~n,l!==0?s=ph(l):i!==0&&(s=ph(i));if(s===0)return 0;if(t!==0&&t!==s&&!(t&n)&&(n=s&-s,i=t&-t,n>=i||n===16&&(i&4194240)!==0))return t;if(s&4&&(s|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=s;0<t;)r=31-Bi(t),n=1<<r,s|=e[r],t&=~n;return s}function z$(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function U$(e,t){for(var r=e.suspendedLanes,s=e.pingedLanes,n=e.expirationTimes,i=e.pendingLanes;0<i;){var l=31-Bi(i),o=1<<l,c=n[l];c===-1?(!(o&r)||o&s)&&(n[l]=z$(o,t)):c<=t&&(e.expiredLanes|=o),i&=~o}}function F1(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function wT(){var e=Gx;return Gx<<=1,!(Gx&4194240)&&(Gx=64),e}function Zv(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Yf(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Bi(t),e[t]=r}function W$(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var s=e.eventTimes;for(e=e.expirationTimes;0<r;){var n=31-Bi(r),i=1<<n;t[n]=0,s[n]=-1,e[n]=-1,r&=~i}}function hN(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var s=31-Bi(r),n=1<<s;n&t|e[s]&t&&(e[s]|=t),r&=~n}}var Ur=0;function NT(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var ST,fN,kT,CT,ET,R1=!1,Xx=[],ec=null,tc=null,rc=null,Qh=new Map,Xh=new Map,Ro=[],V$="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function j3(e,t){switch(e){case"focusin":case"focusout":ec=null;break;case"dragenter":case"dragleave":tc=null;break;case"mouseover":case"mouseout":rc=null;break;case"pointerover":case"pointerout":Qh.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Xh.delete(t.pointerId)}}function X0(e,t,r,s,n,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:s,nativeEvent:i,targetContainers:[n]},t!==null&&(t=Zf(t),t!==null&&fN(t)),e):(e.eventSystemFlags|=s,t=e.targetContainers,n!==null&&t.indexOf(n)===-1&&t.push(n),e)}function H$(e,t,r,s,n){switch(t){case"focusin":return ec=X0(ec,e,t,r,s,n),!0;case"dragenter":return tc=X0(tc,e,t,r,s,n),!0;case"mouseover":return rc=X0(rc,e,t,r,s,n),!0;case"pointerover":var i=n.pointerId;return Qh.set(i,X0(Qh.get(i)||null,e,t,r,s,n)),!0;case"gotpointercapture":return i=n.pointerId,Xh.set(i,X0(Xh.get(i)||null,e,t,r,s,n)),!0}return!1}function PT(e){var t=zc(e.target);if(t!==null){var r=Wd(t);if(r!==null){if(t=r.tag,t===13){if(t=pT(r),t!==null){e.blockedOn=t,ET(e.priority,function(){kT(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Wm(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=M1(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var s=new r.constructor(r.type,r);T1=s,r.target.dispatchEvent(s),T1=null}else return t=Zf(r),t!==null&&fN(t),e.blockedOn=r,!1;t.shift()}return!0}function w3(e,t,r){Wm(e)&&r.delete(t)}function q$(){R1=!1,ec!==null&&Wm(ec)&&(ec=null),tc!==null&&Wm(tc)&&(tc=null),rc!==null&&Wm(rc)&&(rc=null),Qh.forEach(w3),Xh.forEach(w3)}function Y0(e,t){e.blockedOn===t&&(e.blockedOn=null,R1||(R1=!0,Gn.unstable_scheduleCallback(Gn.unstable_NormalPriority,q$)))}function Yh(e){function t(n){return Y0(n,e)}if(0<Xx.length){Y0(Xx[0],e);for(var r=1;r<Xx.length;r++){var s=Xx[r];s.blockedOn===e&&(s.blockedOn=null)}}for(ec!==null&&Y0(ec,e),tc!==null&&Y0(tc,e),rc!==null&&Y0(rc,e),Qh.forEach(t),Xh.forEach(t),r=0;r<Ro.length;r++)s=Ro[r],s.blockedOn===e&&(s.blockedOn=null);for(;0<Ro.length&&(r=Ro[0],r.blockedOn===null);)PT(r),r.blockedOn===null&&Ro.shift()}var Iu=mo.ReactCurrentBatchConfig,mp=!0;function K$(e,t,r,s){var n=Ur,i=Iu.transition;Iu.transition=null;try{Ur=1,xN(e,t,r,s)}finally{Ur=n,Iu.transition=i}}function G$(e,t,r,s){var n=Ur,i=Iu.transition;Iu.transition=null;try{Ur=4,xN(e,t,r,s)}finally{Ur=n,Iu.transition=i}}function xN(e,t,r,s){if(mp){var n=M1(e,t,r,s);if(n===null)cb(e,t,s,pp,r),j3(e,s);else if(H$(n,e,t,r,s))s.stopPropagation();else if(j3(e,s),t&4&&-1<V$.indexOf(e)){for(;n!==null;){var i=Zf(n);if(i!==null&&ST(i),i=M1(e,t,r,s),i===null&&cb(e,t,s,pp,r),i===n)break;n=i}n!==null&&s.stopPropagation()}else cb(e,t,s,null,r)}}var pp=null;function M1(e,t,r,s){if(pp=null,e=dN(s),e=zc(e),e!==null)if(t=Wd(e),t===null)e=null;else if(r=t.tag,r===13){if(e=pT(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return pp=e,null}function AT(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(F$()){case uN:return 1;case bT:return 4;case fp:case R$:return 16;case jT:return 536870912;default:return 16}default:return 16}}var Go=null,mN=null,Vm=null;function _T(){if(Vm)return Vm;var e,t=mN,r=t.length,s,n="value"in Go?Go.value:Go.textContent,i=n.length;for(e=0;e<r&&t[e]===n[e];e++);var l=r-e;for(s=1;s<=l&&t[r-s]===n[i-s];s++);return Vm=n.slice(e,1<s?1-s:void 0)}function Hm(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Yx(){return!0}function N3(){return!1}function Zn(e){function t(r,s,n,i,l){this._reactName=r,this._targetInst=n,this.type=s,this.nativeEvent=i,this.target=l,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(i):i[o]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Yx:N3,this.isPropagationStopped=N3,this}return Sa(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Yx)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Yx)},persist:function(){},isPersistent:Yx}),t}var C0={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},pN=Zn(C0),Jf=Sa({},C0,{view:0,detail:0}),Q$=Zn(Jf),eb,tb,J0,Zg=Sa({},Jf,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:gN,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==J0&&(J0&&e.type==="mousemove"?(eb=e.screenX-J0.screenX,tb=e.screenY-J0.screenY):tb=eb=0,J0=e),eb)},movementY:function(e){return"movementY"in e?e.movementY:tb}}),S3=Zn(Zg),X$=Sa({},Zg,{dataTransfer:0}),Y$=Zn(X$),J$=Sa({},Jf,{relatedTarget:0}),rb=Zn(J$),Z$=Sa({},C0,{animationName:0,elapsedTime:0,pseudoElement:0}),e7=Zn(Z$),t7=Sa({},C0,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),r7=Zn(t7),a7=Sa({},C0,{data:0}),k3=Zn(a7),s7={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},n7={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},i7={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function l7(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=i7[e])?!!t[e]:!1}function gN(){return l7}var o7=Sa({},Jf,{key:function(e){if(e.key){var t=s7[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Hm(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?n7[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:gN,charCode:function(e){return e.type==="keypress"?Hm(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Hm(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),c7=Zn(o7),d7=Sa({},Zg,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),C3=Zn(d7),u7=Sa({},Jf,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:gN}),h7=Zn(u7),f7=Sa({},C0,{propertyName:0,elapsedTime:0,pseudoElement:0}),x7=Zn(f7),m7=Sa({},Zg,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),p7=Zn(m7),g7=[9,13,27,32],yN=Jl&&"CompositionEvent"in window,Eh=null;Jl&&"documentMode"in document&&(Eh=document.documentMode);var y7=Jl&&"TextEvent"in window&&!Eh,TT=Jl&&(!yN||Eh&&8<Eh&&11>=Eh),E3=" ",P3=!1;function IT(e,t){switch(e){case"keyup":return g7.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function OT(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var mu=!1;function v7(e,t){switch(e){case"compositionend":return OT(t);case"keypress":return t.which!==32?null:(P3=!0,E3);case"textInput":return e=t.data,e===E3&&P3?null:e;default:return null}}function b7(e,t){if(mu)return e==="compositionend"||!yN&&IT(e,t)?(e=_T(),Vm=mN=Go=null,mu=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return TT&&t.locale!=="ko"?null:t.data;default:return null}}var j7={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function A3(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!j7[e.type]:t==="textarea"}function DT(e,t,r,s){uT(s),t=gp(t,"onChange"),0<t.length&&(r=new pN("onChange","change",null,r,s),e.push({event:r,listeners:t}))}var Ph=null,Jh=null;function w7(e){HT(e,0)}function ey(e){var t=yu(e);if(sT(t))return e}function N7(e,t){if(e==="change")return t}var FT=!1;if(Jl){var ab;if(Jl){var sb="oninput"in document;if(!sb){var _3=document.createElement("div");_3.setAttribute("oninput","return;"),sb=typeof _3.oninput=="function"}ab=sb}else ab=!1;FT=ab&&(!document.documentMode||9<document.documentMode)}function T3(){Ph&&(Ph.detachEvent("onpropertychange",RT),Jh=Ph=null)}function RT(e){if(e.propertyName==="value"&&ey(Jh)){var t=[];DT(t,Jh,e,dN(e)),mT(w7,t)}}function S7(e,t,r){e==="focusin"?(T3(),Ph=t,Jh=r,Ph.attachEvent("onpropertychange",RT)):e==="focusout"&&T3()}function k7(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return ey(Jh)}function C7(e,t){if(e==="click")return ey(t)}function E7(e,t){if(e==="input"||e==="change")return ey(t)}function P7(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Hi=typeof Object.is=="function"?Object.is:P7;function Zh(e,t){if(Hi(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),s=Object.keys(t);if(r.length!==s.length)return!1;for(s=0;s<r.length;s++){var n=r[s];if(!v1.call(t,n)||!Hi(e[n],t[n]))return!1}return!0}function I3(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function O3(e,t){var r=I3(e);e=0;for(var s;r;){if(r.nodeType===3){if(s=e+r.textContent.length,e<=t&&s>=t)return{node:r,offset:t-e};e=s}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=I3(r)}}function MT(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?MT(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function LT(){for(var e=window,t=dp();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=dp(e.document)}return t}function vN(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function A7(e){var t=LT(),r=e.focusedElem,s=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&MT(r.ownerDocument.documentElement,r)){if(s!==null&&vN(r)){if(t=s.start,e=s.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var n=r.textContent.length,i=Math.min(s.start,n);s=s.end===void 0?i:Math.min(s.end,n),!e.extend&&i>s&&(n=s,s=i,i=n),n=O3(r,i);var l=O3(r,s);n&&l&&(e.rangeCount!==1||e.anchorNode!==n.node||e.anchorOffset!==n.offset||e.focusNode!==l.node||e.focusOffset!==l.offset)&&(t=t.createRange(),t.setStart(n.node,n.offset),e.removeAllRanges(),i>s?(e.addRange(t),e.extend(l.node,l.offset)):(t.setEnd(l.node,l.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var _7=Jl&&"documentMode"in document&&11>=document.documentMode,pu=null,L1=null,Ah=null,$1=!1;function D3(e,t,r){var s=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;$1||pu==null||pu!==dp(s)||(s=pu,"selectionStart"in s&&vN(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),Ah&&Zh(Ah,s)||(Ah=s,s=gp(L1,"onSelect"),0<s.length&&(t=new pN("onSelect","select",null,t,r),e.push({event:t,listeners:s}),t.target=pu)))}function Jx(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var gu={animationend:Jx("Animation","AnimationEnd"),animationiteration:Jx("Animation","AnimationIteration"),animationstart:Jx("Animation","AnimationStart"),transitionend:Jx("Transition","TransitionEnd")},nb={},$T={};Jl&&($T=document.createElement("div").style,"AnimationEvent"in window||(delete gu.animationend.animation,delete gu.animationiteration.animation,delete gu.animationstart.animation),"TransitionEvent"in window||delete gu.transitionend.transition);function ty(e){if(nb[e])return nb[e];if(!gu[e])return e;var t=gu[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in $T)return nb[e]=t[r];return e}var BT=ty("animationend"),zT=ty("animationiteration"),UT=ty("animationstart"),WT=ty("transitionend"),VT=new Map,F3="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Nc(e,t){VT.set(e,t),Ud(t,[e])}for(var ib=0;ib<F3.length;ib++){var lb=F3[ib],T7=lb.toLowerCase(),I7=lb[0].toUpperCase()+lb.slice(1);Nc(T7,"on"+I7)}Nc(BT,"onAnimationEnd");Nc(zT,"onAnimationIteration");Nc(UT,"onAnimationStart");Nc("dblclick","onDoubleClick");Nc("focusin","onFocus");Nc("focusout","onBlur");Nc(WT,"onTransitionEnd");Zu("onMouseEnter",["mouseout","mouseover"]);Zu("onMouseLeave",["mouseout","mouseover"]);Zu("onPointerEnter",["pointerout","pointerover"]);Zu("onPointerLeave",["pointerout","pointerover"]);Ud("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ud("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ud("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ud("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ud("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ud("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var gh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),O7=new Set("cancel close invalid load scroll toggle".split(" ").concat(gh));function R3(e,t,r){var s=e.type||"unknown-event";e.currentTarget=r,T$(s,t,void 0,e),e.currentTarget=null}function HT(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var s=e[r],n=s.event;s=s.listeners;e:{var i=void 0;if(t)for(var l=s.length-1;0<=l;l--){var o=s[l],c=o.instance,u=o.currentTarget;if(o=o.listener,c!==i&&n.isPropagationStopped())break e;R3(n,o,u),i=c}else for(l=0;l<s.length;l++){if(o=s[l],c=o.instance,u=o.currentTarget,o=o.listener,c!==i&&n.isPropagationStopped())break e;R3(n,o,u),i=c}}}if(hp)throw e=D1,hp=!1,D1=null,e}function Zr(e,t){var r=t[V1];r===void 0&&(r=t[V1]=new Set);var s=e+"__bubble";r.has(s)||(qT(t,e,2,!1),r.add(s))}function ob(e,t,r){var s=0;t&&(s|=4),qT(r,e,s,t)}var Zx="_reactListening"+Math.random().toString(36).slice(2);function ef(e){if(!e[Zx]){e[Zx]=!0,Z_.forEach(function(r){r!=="selectionchange"&&(O7.has(r)||ob(r,!1,e),ob(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Zx]||(t[Zx]=!0,ob("selectionchange",!1,t))}}function qT(e,t,r,s){switch(AT(t)){case 1:var n=K$;break;case 4:n=G$;break;default:n=xN}r=n.bind(null,t,r,e),n=void 0,!O1||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(n=!0),s?n!==void 0?e.addEventListener(t,r,{capture:!0,passive:n}):e.addEventListener(t,r,!0):n!==void 0?e.addEventListener(t,r,{passive:n}):e.addEventListener(t,r,!1)}function cb(e,t,r,s,n){var i=s;if(!(t&1)&&!(t&2)&&s!==null)e:for(;;){if(s===null)return;var l=s.tag;if(l===3||l===4){var o=s.stateNode.containerInfo;if(o===n||o.nodeType===8&&o.parentNode===n)break;if(l===4)for(l=s.return;l!==null;){var c=l.tag;if((c===3||c===4)&&(c=l.stateNode.containerInfo,c===n||c.nodeType===8&&c.parentNode===n))return;l=l.return}for(;o!==null;){if(l=zc(o),l===null)return;if(c=l.tag,c===5||c===6){s=i=l;continue e}o=o.parentNode}}s=s.return}mT(function(){var u=i,d=dN(r),h=[];e:{var f=VT.get(e);if(f!==void 0){var x=pN,p=e;switch(e){case"keypress":if(Hm(r)===0)break e;case"keydown":case"keyup":x=c7;break;case"focusin":p="focus",x=rb;break;case"focusout":p="blur",x=rb;break;case"beforeblur":case"afterblur":x=rb;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":x=S3;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":x=Y$;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":x=h7;break;case BT:case zT:case UT:x=e7;break;case WT:x=x7;break;case"scroll":x=Q$;break;case"wheel":x=p7;break;case"copy":case"cut":case"paste":x=r7;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":x=C3}var g=(t&4)!==0,y=!g&&e==="scroll",v=g?f!==null?f+"Capture":null:f;g=[];for(var j=u,b;j!==null;){b=j;var w=b.stateNode;if(b.tag===5&&w!==null&&(b=w,v!==null&&(w=Gh(j,v),w!=null&&g.push(tf(j,w,b)))),y)break;j=j.return}0<g.length&&(f=new x(f,p,null,r,d),h.push({event:f,listeners:g}))}}if(!(t&7)){e:{if(f=e==="mouseover"||e==="pointerover",x=e==="mouseout"||e==="pointerout",f&&r!==T1&&(p=r.relatedTarget||r.fromElement)&&(zc(p)||p[Zl]))break e;if((x||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,x?(p=r.relatedTarget||r.toElement,x=u,p=p?zc(p):null,p!==null&&(y=Wd(p),p!==y||p.tag!==5&&p.tag!==6)&&(p=null)):(x=null,p=u),x!==p)){if(g=S3,w="onMouseLeave",v="onMouseEnter",j="mouse",(e==="pointerout"||e==="pointerover")&&(g=C3,w="onPointerLeave",v="onPointerEnter",j="pointer"),y=x==null?f:yu(x),b=p==null?f:yu(p),f=new g(w,j+"leave",x,r,d),f.target=y,f.relatedTarget=b,w=null,zc(d)===u&&(g=new g(v,j+"enter",p,r,d),g.target=b,g.relatedTarget=y,w=g),y=w,x&&p)t:{for(g=x,v=p,j=0,b=g;b;b=su(b))j++;for(b=0,w=v;w;w=su(w))b++;for(;0<j-b;)g=su(g),j--;for(;0<b-j;)v=su(v),b--;for(;j--;){if(g===v||v!==null&&g===v.alternate)break t;g=su(g),v=su(v)}g=null}else g=null;x!==null&&M3(h,f,x,g,!1),p!==null&&y!==null&&M3(h,y,p,g,!0)}}e:{if(f=u?yu(u):window,x=f.nodeName&&f.nodeName.toLowerCase(),x==="select"||x==="input"&&f.type==="file")var k=N7;else if(A3(f))if(FT)k=E7;else{k=k7;var N=S7}else(x=f.nodeName)&&x.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(k=C7);if(k&&(k=k(e,u))){DT(h,k,r,d);break e}N&&N(e,f,u),e==="focusout"&&(N=f._wrapperState)&&N.controlled&&f.type==="number"&&C1(f,"number",f.value)}switch(N=u?yu(u):window,e){case"focusin":(A3(N)||N.contentEditable==="true")&&(pu=N,L1=u,Ah=null);break;case"focusout":Ah=L1=pu=null;break;case"mousedown":$1=!0;break;case"contextmenu":case"mouseup":case"dragend":$1=!1,D3(h,r,d);break;case"selectionchange":if(_7)break;case"keydown":case"keyup":D3(h,r,d)}var S;if(yN)e:{switch(e){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else mu?IT(e,r)&&(_="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(_="onCompositionStart");_&&(TT&&r.locale!=="ko"&&(mu||_!=="onCompositionStart"?_==="onCompositionEnd"&&mu&&(S=_T()):(Go=d,mN="value"in Go?Go.value:Go.textContent,mu=!0)),N=gp(u,_),0<N.length&&(_=new k3(_,e,null,r,d),h.push({event:_,listeners:N}),S?_.data=S:(S=OT(r),S!==null&&(_.data=S)))),(S=y7?v7(e,r):b7(e,r))&&(u=gp(u,"onBeforeInput"),0<u.length&&(d=new k3("onBeforeInput","beforeinput",null,r,d),h.push({event:d,listeners:u}),d.data=S))}HT(h,t)})}function tf(e,t,r){return{instance:e,listener:t,currentTarget:r}}function gp(e,t){for(var r=t+"Capture",s=[];e!==null;){var n=e,i=n.stateNode;n.tag===5&&i!==null&&(n=i,i=Gh(e,r),i!=null&&s.unshift(tf(e,i,n)),i=Gh(e,t),i!=null&&s.push(tf(e,i,n))),e=e.return}return s}function su(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function M3(e,t,r,s,n){for(var i=t._reactName,l=[];r!==null&&r!==s;){var o=r,c=o.alternate,u=o.stateNode;if(c!==null&&c===s)break;o.tag===5&&u!==null&&(o=u,n?(c=Gh(r,i),c!=null&&l.unshift(tf(r,c,o))):n||(c=Gh(r,i),c!=null&&l.push(tf(r,c,o)))),r=r.return}l.length!==0&&e.push({event:t,listeners:l})}var D7=/\r\n?/g,F7=/\u0000|\uFFFD/g;function L3(e){return(typeof e=="string"?e:""+e).replace(D7,`
`).replace(F7,"")}function em(e,t,r){if(t=L3(t),L3(e)!==t&&r)throw Error(ot(425))}function yp(){}var B1=null,z1=null;function U1(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var W1=typeof setTimeout=="function"?setTimeout:void 0,R7=typeof clearTimeout=="function"?clearTimeout:void 0,$3=typeof Promise=="function"?Promise:void 0,M7=typeof queueMicrotask=="function"?queueMicrotask:typeof $3<"u"?function(e){return $3.resolve(null).then(e).catch(L7)}:W1;function L7(e){setTimeout(function(){throw e})}function db(e,t){var r=t,s=0;do{var n=r.nextSibling;if(e.removeChild(r),n&&n.nodeType===8)if(r=n.data,r==="/$"){if(s===0){e.removeChild(n),Yh(t);return}s--}else r!=="$"&&r!=="$?"&&r!=="$!"||s++;r=n}while(r);Yh(t)}function ac(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function B3(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var E0=Math.random().toString(36).slice(2),hl="__reactFiber$"+E0,rf="__reactProps$"+E0,Zl="__reactContainer$"+E0,V1="__reactEvents$"+E0,$7="__reactListeners$"+E0,B7="__reactHandles$"+E0;function zc(e){var t=e[hl];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Zl]||r[hl]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=B3(e);e!==null;){if(r=e[hl])return r;e=B3(e)}return t}e=r,r=e.parentNode}return null}function Zf(e){return e=e[hl]||e[Zl],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function yu(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ot(33))}function ry(e){return e[rf]||null}var H1=[],vu=-1;function Sc(e){return{current:e}}function ra(e){0>vu||(e.current=H1[vu],H1[vu]=null,vu--)}function Yr(e,t){vu++,H1[vu]=e.current,e.current=t}var fc={},Xs=Sc(fc),En=Sc(!1),vd=fc;function e0(e,t){var r=e.type.contextTypes;if(!r)return fc;var s=e.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===t)return s.__reactInternalMemoizedMaskedChildContext;var n={},i;for(i in r)n[i]=t[i];return s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=n),n}function Pn(e){return e=e.childContextTypes,e!=null}function vp(){ra(En),ra(Xs)}function z3(e,t,r){if(Xs.current!==fc)throw Error(ot(168));Yr(Xs,t),Yr(En,r)}function KT(e,t,r){var s=e.stateNode;if(t=t.childContextTypes,typeof s.getChildContext!="function")return r;s=s.getChildContext();for(var n in s)if(!(n in t))throw Error(ot(108,S$(e)||"Unknown",n));return Sa({},r,s)}function bp(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||fc,vd=Xs.current,Yr(Xs,e),Yr(En,En.current),!0}function U3(e,t,r){var s=e.stateNode;if(!s)throw Error(ot(169));r?(e=KT(e,t,vd),s.__reactInternalMemoizedMergedChildContext=e,ra(En),ra(Xs),Yr(Xs,e)):ra(En),Yr(En,r)}var Il=null,ay=!1,ub=!1;function GT(e){Il===null?Il=[e]:Il.push(e)}function z7(e){ay=!0,GT(e)}function kc(){if(!ub&&Il!==null){ub=!0;var e=0,t=Ur;try{var r=Il;for(Ur=1;e<r.length;e++){var s=r[e];do s=s(!0);while(s!==null)}Il=null,ay=!1}catch(n){throw Il!==null&&(Il=Il.slice(e+1)),vT(uN,kc),n}finally{Ur=t,ub=!1}}return null}var bu=[],ju=0,jp=null,wp=0,ui=[],hi=0,bd=null,Bl=1,zl="";function Dc(e,t){bu[ju++]=wp,bu[ju++]=jp,jp=e,wp=t}function QT(e,t,r){ui[hi++]=Bl,ui[hi++]=zl,ui[hi++]=bd,bd=e;var s=Bl;e=zl;var n=32-Bi(s)-1;s&=~(1<<n),r+=1;var i=32-Bi(t)+n;if(30<i){var l=n-n%5;i=(s&(1<<l)-1).toString(32),s>>=l,n-=l,Bl=1<<32-Bi(t)+n|r<<n|s,zl=i+e}else Bl=1<<i|r<<n|s,zl=e}function bN(e){e.return!==null&&(Dc(e,1),QT(e,1,0))}function jN(e){for(;e===jp;)jp=bu[--ju],bu[ju]=null,wp=bu[--ju],bu[ju]=null;for(;e===bd;)bd=ui[--hi],ui[hi]=null,zl=ui[--hi],ui[hi]=null,Bl=ui[--hi],ui[hi]=null}var qn=null,Vn=null,oa=!1,Di=null;function XT(e,t){var r=fi(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function W3(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,qn=e,Vn=ac(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,qn=e,Vn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=bd!==null?{id:Bl,overflow:zl}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=fi(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,qn=e,Vn=null,!0):!1;default:return!1}}function q1(e){return(e.mode&1)!==0&&(e.flags&128)===0}function K1(e){if(oa){var t=Vn;if(t){var r=t;if(!W3(e,t)){if(q1(e))throw Error(ot(418));t=ac(r.nextSibling);var s=qn;t&&W3(e,t)?XT(s,r):(e.flags=e.flags&-4097|2,oa=!1,qn=e)}}else{if(q1(e))throw Error(ot(418));e.flags=e.flags&-4097|2,oa=!1,qn=e}}}function V3(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;qn=e}function tm(e){if(e!==qn)return!1;if(!oa)return V3(e),oa=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!U1(e.type,e.memoizedProps)),t&&(t=Vn)){if(q1(e))throw YT(),Error(ot(418));for(;t;)XT(e,t),t=ac(t.nextSibling)}if(V3(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ot(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Vn=ac(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Vn=null}}else Vn=qn?ac(e.stateNode.nextSibling):null;return!0}function YT(){for(var e=Vn;e;)e=ac(e.nextSibling)}function t0(){Vn=qn=null,oa=!1}function wN(e){Di===null?Di=[e]:Di.push(e)}var U7=mo.ReactCurrentBatchConfig;function Z0(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(ot(309));var s=r.stateNode}if(!s)throw Error(ot(147,e));var n=s,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(l){var o=n.refs;l===null?delete o[i]:o[i]=l},t._stringRef=i,t)}if(typeof e!="string")throw Error(ot(284));if(!r._owner)throw Error(ot(290,e))}return e}function rm(e,t){throw e=Object.prototype.toString.call(t),Error(ot(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function H3(e){var t=e._init;return t(e._payload)}function JT(e){function t(v,j){if(e){var b=v.deletions;b===null?(v.deletions=[j],v.flags|=16):b.push(j)}}function r(v,j){if(!e)return null;for(;j!==null;)t(v,j),j=j.sibling;return null}function s(v,j){for(v=new Map;j!==null;)j.key!==null?v.set(j.key,j):v.set(j.index,j),j=j.sibling;return v}function n(v,j){return v=lc(v,j),v.index=0,v.sibling=null,v}function i(v,j,b){return v.index=b,e?(b=v.alternate,b!==null?(b=b.index,b<j?(v.flags|=2,j):b):(v.flags|=2,j)):(v.flags|=1048576,j)}function l(v){return e&&v.alternate===null&&(v.flags|=2),v}function o(v,j,b,w){return j===null||j.tag!==6?(j=yb(b,v.mode,w),j.return=v,j):(j=n(j,b),j.return=v,j)}function c(v,j,b,w){var k=b.type;return k===xu?d(v,j,b.props.children,w,b.key):j!==null&&(j.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===To&&H3(k)===j.type)?(w=n(j,b.props),w.ref=Z0(v,j,b),w.return=v,w):(w=Jm(b.type,b.key,b.props,null,v.mode,w),w.ref=Z0(v,j,b),w.return=v,w)}function u(v,j,b,w){return j===null||j.tag!==4||j.stateNode.containerInfo!==b.containerInfo||j.stateNode.implementation!==b.implementation?(j=vb(b,v.mode,w),j.return=v,j):(j=n(j,b.children||[]),j.return=v,j)}function d(v,j,b,w,k){return j===null||j.tag!==7?(j=od(b,v.mode,w,k),j.return=v,j):(j=n(j,b),j.return=v,j)}function h(v,j,b){if(typeof j=="string"&&j!==""||typeof j=="number")return j=yb(""+j,v.mode,b),j.return=v,j;if(typeof j=="object"&&j!==null){switch(j.$$typeof){case Hx:return b=Jm(j.type,j.key,j.props,null,v.mode,b),b.ref=Z0(v,null,j),b.return=v,b;case fu:return j=vb(j,v.mode,b),j.return=v,j;case To:var w=j._init;return h(v,w(j._payload),b)}if(mh(j)||G0(j))return j=od(j,v.mode,b,null),j.return=v,j;rm(v,j)}return null}function f(v,j,b,w){var k=j!==null?j.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return k!==null?null:o(v,j,""+b,w);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Hx:return b.key===k?c(v,j,b,w):null;case fu:return b.key===k?u(v,j,b,w):null;case To:return k=b._init,f(v,j,k(b._payload),w)}if(mh(b)||G0(b))return k!==null?null:d(v,j,b,w,null);rm(v,b)}return null}function x(v,j,b,w,k){if(typeof w=="string"&&w!==""||typeof w=="number")return v=v.get(b)||null,o(j,v,""+w,k);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Hx:return v=v.get(w.key===null?b:w.key)||null,c(j,v,w,k);case fu:return v=v.get(w.key===null?b:w.key)||null,u(j,v,w,k);case To:var N=w._init;return x(v,j,b,N(w._payload),k)}if(mh(w)||G0(w))return v=v.get(b)||null,d(j,v,w,k,null);rm(j,w)}return null}function p(v,j,b,w){for(var k=null,N=null,S=j,_=j=0,O=null;S!==null&&_<b.length;_++){S.index>_?(O=S,S=null):O=S.sibling;var E=f(v,S,b[_],w);if(E===null){S===null&&(S=O);break}e&&S&&E.alternate===null&&t(v,S),j=i(E,j,_),N===null?k=E:N.sibling=E,N=E,S=O}if(_===b.length)return r(v,S),oa&&Dc(v,_),k;if(S===null){for(;_<b.length;_++)S=h(v,b[_],w),S!==null&&(j=i(S,j,_),N===null?k=S:N.sibling=S,N=S);return oa&&Dc(v,_),k}for(S=s(v,S);_<b.length;_++)O=x(S,v,_,b[_],w),O!==null&&(e&&O.alternate!==null&&S.delete(O.key===null?_:O.key),j=i(O,j,_),N===null?k=O:N.sibling=O,N=O);return e&&S.forEach(function(R){return t(v,R)}),oa&&Dc(v,_),k}function g(v,j,b,w){var k=G0(b);if(typeof k!="function")throw Error(ot(150));if(b=k.call(b),b==null)throw Error(ot(151));for(var N=k=null,S=j,_=j=0,O=null,E=b.next();S!==null&&!E.done;_++,E=b.next()){S.index>_?(O=S,S=null):O=S.sibling;var R=f(v,S,E.value,w);if(R===null){S===null&&(S=O);break}e&&S&&R.alternate===null&&t(v,S),j=i(R,j,_),N===null?k=R:N.sibling=R,N=R,S=O}if(E.done)return r(v,S),oa&&Dc(v,_),k;if(S===null){for(;!E.done;_++,E=b.next())E=h(v,E.value,w),E!==null&&(j=i(E,j,_),N===null?k=E:N.sibling=E,N=E);return oa&&Dc(v,_),k}for(S=s(v,S);!E.done;_++,E=b.next())E=x(S,v,_,E.value,w),E!==null&&(e&&E.alternate!==null&&S.delete(E.key===null?_:E.key),j=i(E,j,_),N===null?k=E:N.sibling=E,N=E);return e&&S.forEach(function(C){return t(v,C)}),oa&&Dc(v,_),k}function y(v,j,b,w){if(typeof b=="object"&&b!==null&&b.type===xu&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case Hx:e:{for(var k=b.key,N=j;N!==null;){if(N.key===k){if(k=b.type,k===xu){if(N.tag===7){r(v,N.sibling),j=n(N,b.props.children),j.return=v,v=j;break e}}else if(N.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===To&&H3(k)===N.type){r(v,N.sibling),j=n(N,b.props),j.ref=Z0(v,N,b),j.return=v,v=j;break e}r(v,N);break}else t(v,N);N=N.sibling}b.type===xu?(j=od(b.props.children,v.mode,w,b.key),j.return=v,v=j):(w=Jm(b.type,b.key,b.props,null,v.mode,w),w.ref=Z0(v,j,b),w.return=v,v=w)}return l(v);case fu:e:{for(N=b.key;j!==null;){if(j.key===N)if(j.tag===4&&j.stateNode.containerInfo===b.containerInfo&&j.stateNode.implementation===b.implementation){r(v,j.sibling),j=n(j,b.children||[]),j.return=v,v=j;break e}else{r(v,j);break}else t(v,j);j=j.sibling}j=vb(b,v.mode,w),j.return=v,v=j}return l(v);case To:return N=b._init,y(v,j,N(b._payload),w)}if(mh(b))return p(v,j,b,w);if(G0(b))return g(v,j,b,w);rm(v,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,j!==null&&j.tag===6?(r(v,j.sibling),j=n(j,b),j.return=v,v=j):(r(v,j),j=yb(b,v.mode,w),j.return=v,v=j),l(v)):r(v,j)}return y}var r0=JT(!0),ZT=JT(!1),Np=Sc(null),Sp=null,wu=null,NN=null;function SN(){NN=wu=Sp=null}function kN(e){var t=Np.current;ra(Np),e._currentValue=t}function G1(e,t,r){for(;e!==null;){var s=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,s!==null&&(s.childLanes|=t)):s!==null&&(s.childLanes&t)!==t&&(s.childLanes|=t),e===r)break;e=e.return}}function Ou(e,t){Sp=e,NN=wu=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(kn=!0),e.firstContext=null)}function gi(e){var t=e._currentValue;if(NN!==e)if(e={context:e,memoizedValue:t,next:null},wu===null){if(Sp===null)throw Error(ot(308));wu=e,Sp.dependencies={lanes:0,firstContext:e}}else wu=wu.next=e;return t}var Uc=null;function CN(e){Uc===null?Uc=[e]:Uc.push(e)}function e5(e,t,r,s){var n=t.interleaved;return n===null?(r.next=r,CN(t)):(r.next=n.next,n.next=r),t.interleaved=r,eo(e,s)}function eo(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Io=!1;function EN(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function t5(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Hl(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function sc(e,t,r){var s=e.updateQueue;if(s===null)return null;if(s=s.shared,jr&2){var n=s.pending;return n===null?t.next=t:(t.next=n.next,n.next=t),s.pending=t,eo(e,r)}return n=s.interleaved,n===null?(t.next=t,CN(s)):(t.next=n.next,n.next=t),s.interleaved=t,eo(e,r)}function qm(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var s=t.lanes;s&=e.pendingLanes,r|=s,t.lanes=r,hN(e,r)}}function q3(e,t){var r=e.updateQueue,s=e.alternate;if(s!==null&&(s=s.updateQueue,r===s)){var n=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var l={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?n=i=l:i=i.next=l,r=r.next}while(r!==null);i===null?n=i=t:i=i.next=t}else n=i=t;r={baseState:s.baseState,firstBaseUpdate:n,lastBaseUpdate:i,shared:s.shared,effects:s.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function kp(e,t,r,s){var n=e.updateQueue;Io=!1;var i=n.firstBaseUpdate,l=n.lastBaseUpdate,o=n.shared.pending;if(o!==null){n.shared.pending=null;var c=o,u=c.next;c.next=null,l===null?i=u:l.next=u,l=c;var d=e.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==l&&(o===null?d.firstBaseUpdate=u:o.next=u,d.lastBaseUpdate=c))}if(i!==null){var h=n.baseState;l=0,d=u=c=null,o=i;do{var f=o.lane,x=o.eventTime;if((s&f)===f){d!==null&&(d=d.next={eventTime:x,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var p=e,g=o;switch(f=t,x=r,g.tag){case 1:if(p=g.payload,typeof p=="function"){h=p.call(x,h,f);break e}h=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=g.payload,f=typeof p=="function"?p.call(x,h,f):p,f==null)break e;h=Sa({},h,f);break e;case 2:Io=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,f=n.effects,f===null?n.effects=[o]:f.push(o))}else x={eventTime:x,lane:f,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(u=d=x,c=h):d=d.next=x,l|=f;if(o=o.next,o===null){if(o=n.shared.pending,o===null)break;f=o,o=f.next,f.next=null,n.lastBaseUpdate=f,n.shared.pending=null}}while(!0);if(d===null&&(c=h),n.baseState=c,n.firstBaseUpdate=u,n.lastBaseUpdate=d,t=n.shared.interleaved,t!==null){n=t;do l|=n.lane,n=n.next;while(n!==t)}else i===null&&(n.shared.lanes=0);wd|=l,e.lanes=l,e.memoizedState=h}}function K3(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var s=e[t],n=s.callback;if(n!==null){if(s.callback=null,s=r,typeof n!="function")throw Error(ot(191,n));n.call(s)}}}var ex={},pl=Sc(ex),af=Sc(ex),sf=Sc(ex);function Wc(e){if(e===ex)throw Error(ot(174));return e}function PN(e,t){switch(Yr(sf,t),Yr(af,e),Yr(pl,ex),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:P1(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=P1(t,e)}ra(pl),Yr(pl,t)}function a0(){ra(pl),ra(af),ra(sf)}function r5(e){Wc(sf.current);var t=Wc(pl.current),r=P1(t,e.type);t!==r&&(Yr(af,e),Yr(pl,r))}function AN(e){af.current===e&&(ra(pl),ra(af))}var ya=Sc(0);function Cp(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var hb=[];function _N(){for(var e=0;e<hb.length;e++)hb[e]._workInProgressVersionPrimary=null;hb.length=0}var Km=mo.ReactCurrentDispatcher,fb=mo.ReactCurrentBatchConfig,jd=0,ja=null,Ya=null,ms=null,Ep=!1,_h=!1,nf=0,W7=0;function Rs(){throw Error(ot(321))}function TN(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Hi(e[r],t[r]))return!1;return!0}function IN(e,t,r,s,n,i){if(jd=i,ja=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Km.current=e===null||e.memoizedState===null?K7:G7,e=r(s,n),_h){i=0;do{if(_h=!1,nf=0,25<=i)throw Error(ot(301));i+=1,ms=Ya=null,t.updateQueue=null,Km.current=Q7,e=r(s,n)}while(_h)}if(Km.current=Pp,t=Ya!==null&&Ya.next!==null,jd=0,ms=Ya=ja=null,Ep=!1,t)throw Error(ot(300));return e}function ON(){var e=nf!==0;return nf=0,e}function nl(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ms===null?ja.memoizedState=ms=e:ms=ms.next=e,ms}function yi(){if(Ya===null){var e=ja.alternate;e=e!==null?e.memoizedState:null}else e=Ya.next;var t=ms===null?ja.memoizedState:ms.next;if(t!==null)ms=t,Ya=e;else{if(e===null)throw Error(ot(310));Ya=e,e={memoizedState:Ya.memoizedState,baseState:Ya.baseState,baseQueue:Ya.baseQueue,queue:Ya.queue,next:null},ms===null?ja.memoizedState=ms=e:ms=ms.next=e}return ms}function lf(e,t){return typeof t=="function"?t(e):t}function xb(e){var t=yi(),r=t.queue;if(r===null)throw Error(ot(311));r.lastRenderedReducer=e;var s=Ya,n=s.baseQueue,i=r.pending;if(i!==null){if(n!==null){var l=n.next;n.next=i.next,i.next=l}s.baseQueue=n=i,r.pending=null}if(n!==null){i=n.next,s=s.baseState;var o=l=null,c=null,u=i;do{var d=u.lane;if((jd&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),s=u.hasEagerState?u.eagerState:e(s,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(o=c=h,l=s):c=c.next=h,ja.lanes|=d,wd|=d}u=u.next}while(u!==null&&u!==i);c===null?l=s:c.next=o,Hi(s,t.memoizedState)||(kn=!0),t.memoizedState=s,t.baseState=l,t.baseQueue=c,r.lastRenderedState=s}if(e=r.interleaved,e!==null){n=e;do i=n.lane,ja.lanes|=i,wd|=i,n=n.next;while(n!==e)}else n===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function mb(e){var t=yi(),r=t.queue;if(r===null)throw Error(ot(311));r.lastRenderedReducer=e;var s=r.dispatch,n=r.pending,i=t.memoizedState;if(n!==null){r.pending=null;var l=n=n.next;do i=e(i,l.action),l=l.next;while(l!==n);Hi(i,t.memoizedState)||(kn=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,s]}function a5(){}function s5(e,t){var r=ja,s=yi(),n=t(),i=!Hi(s.memoizedState,n);if(i&&(s.memoizedState=n,kn=!0),s=s.queue,DN(l5.bind(null,r,s,e),[e]),s.getSnapshot!==t||i||ms!==null&&ms.memoizedState.tag&1){if(r.flags|=2048,of(9,i5.bind(null,r,s,n,t),void 0,null),bs===null)throw Error(ot(349));jd&30||n5(r,t,n)}return n}function n5(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=ja.updateQueue,t===null?(t={lastEffect:null,stores:null},ja.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function i5(e,t,r,s){t.value=r,t.getSnapshot=s,o5(t)&&c5(e)}function l5(e,t,r){return r(function(){o5(t)&&c5(e)})}function o5(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Hi(e,r)}catch{return!0}}function c5(e){var t=eo(e,1);t!==null&&zi(t,e,1,-1)}function G3(e){var t=nl();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:lf,lastRenderedState:e},t.queue=e,e=e.dispatch=q7.bind(null,ja,e),[t.memoizedState,e]}function of(e,t,r,s){return e={tag:e,create:t,destroy:r,deps:s,next:null},t=ja.updateQueue,t===null?(t={lastEffect:null,stores:null},ja.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(s=r.next,r.next=e,e.next=s,t.lastEffect=e)),e}function d5(){return yi().memoizedState}function Gm(e,t,r,s){var n=nl();ja.flags|=e,n.memoizedState=of(1|t,r,void 0,s===void 0?null:s)}function sy(e,t,r,s){var n=yi();s=s===void 0?null:s;var i=void 0;if(Ya!==null){var l=Ya.memoizedState;if(i=l.destroy,s!==null&&TN(s,l.deps)){n.memoizedState=of(t,r,i,s);return}}ja.flags|=e,n.memoizedState=of(1|t,r,i,s)}function Q3(e,t){return Gm(8390656,8,e,t)}function DN(e,t){return sy(2048,8,e,t)}function u5(e,t){return sy(4,2,e,t)}function h5(e,t){return sy(4,4,e,t)}function f5(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function x5(e,t,r){return r=r!=null?r.concat([e]):null,sy(4,4,f5.bind(null,t,e),r)}function FN(){}function m5(e,t){var r=yi();t=t===void 0?null:t;var s=r.memoizedState;return s!==null&&t!==null&&TN(t,s[1])?s[0]:(r.memoizedState=[e,t],e)}function p5(e,t){var r=yi();t=t===void 0?null:t;var s=r.memoizedState;return s!==null&&t!==null&&TN(t,s[1])?s[0]:(e=e(),r.memoizedState=[e,t],e)}function g5(e,t,r){return jd&21?(Hi(r,t)||(r=wT(),ja.lanes|=r,wd|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,kn=!0),e.memoizedState=r)}function V7(e,t){var r=Ur;Ur=r!==0&&4>r?r:4,e(!0);var s=fb.transition;fb.transition={};try{e(!1),t()}finally{Ur=r,fb.transition=s}}function y5(){return yi().memoizedState}function H7(e,t,r){var s=ic(e);if(r={lane:s,action:r,hasEagerState:!1,eagerState:null,next:null},v5(e))b5(t,r);else if(r=e5(e,t,r,s),r!==null){var n=dn();zi(r,e,s,n),j5(r,t,s)}}function q7(e,t,r){var s=ic(e),n={lane:s,action:r,hasEagerState:!1,eagerState:null,next:null};if(v5(e))b5(t,n);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var l=t.lastRenderedState,o=i(l,r);if(n.hasEagerState=!0,n.eagerState=o,Hi(o,l)){var c=t.interleaved;c===null?(n.next=n,CN(t)):(n.next=c.next,c.next=n),t.interleaved=n;return}}catch{}finally{}r=e5(e,t,n,s),r!==null&&(n=dn(),zi(r,e,s,n),j5(r,t,s))}}function v5(e){var t=e.alternate;return e===ja||t!==null&&t===ja}function b5(e,t){_h=Ep=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function j5(e,t,r){if(r&4194240){var s=t.lanes;s&=e.pendingLanes,r|=s,t.lanes=r,hN(e,r)}}var Pp={readContext:gi,useCallback:Rs,useContext:Rs,useEffect:Rs,useImperativeHandle:Rs,useInsertionEffect:Rs,useLayoutEffect:Rs,useMemo:Rs,useReducer:Rs,useRef:Rs,useState:Rs,useDebugValue:Rs,useDeferredValue:Rs,useTransition:Rs,useMutableSource:Rs,useSyncExternalStore:Rs,useId:Rs,unstable_isNewReconciler:!1},K7={readContext:gi,useCallback:function(e,t){return nl().memoizedState=[e,t===void 0?null:t],e},useContext:gi,useEffect:Q3,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Gm(4194308,4,f5.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Gm(4194308,4,e,t)},useInsertionEffect:function(e,t){return Gm(4,2,e,t)},useMemo:function(e,t){var r=nl();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var s=nl();return t=r!==void 0?r(t):t,s.memoizedState=s.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},s.queue=e,e=e.dispatch=H7.bind(null,ja,e),[s.memoizedState,e]},useRef:function(e){var t=nl();return e={current:e},t.memoizedState=e},useState:G3,useDebugValue:FN,useDeferredValue:function(e){return nl().memoizedState=e},useTransition:function(){var e=G3(!1),t=e[0];return e=V7.bind(null,e[1]),nl().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var s=ja,n=nl();if(oa){if(r===void 0)throw Error(ot(407));r=r()}else{if(r=t(),bs===null)throw Error(ot(349));jd&30||n5(s,t,r)}n.memoizedState=r;var i={value:r,getSnapshot:t};return n.queue=i,Q3(l5.bind(null,s,i,e),[e]),s.flags|=2048,of(9,i5.bind(null,s,i,r,t),void 0,null),r},useId:function(){var e=nl(),t=bs.identifierPrefix;if(oa){var r=zl,s=Bl;r=(s&~(1<<32-Bi(s)-1)).toString(32)+r,t=":"+t+"R"+r,r=nf++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=W7++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},G7={readContext:gi,useCallback:m5,useContext:gi,useEffect:DN,useImperativeHandle:x5,useInsertionEffect:u5,useLayoutEffect:h5,useMemo:p5,useReducer:xb,useRef:d5,useState:function(){return xb(lf)},useDebugValue:FN,useDeferredValue:function(e){var t=yi();return g5(t,Ya.memoizedState,e)},useTransition:function(){var e=xb(lf)[0],t=yi().memoizedState;return[e,t]},useMutableSource:a5,useSyncExternalStore:s5,useId:y5,unstable_isNewReconciler:!1},Q7={readContext:gi,useCallback:m5,useContext:gi,useEffect:DN,useImperativeHandle:x5,useInsertionEffect:u5,useLayoutEffect:h5,useMemo:p5,useReducer:mb,useRef:d5,useState:function(){return mb(lf)},useDebugValue:FN,useDeferredValue:function(e){var t=yi();return Ya===null?t.memoizedState=e:g5(t,Ya.memoizedState,e)},useTransition:function(){var e=mb(lf)[0],t=yi().memoizedState;return[e,t]},useMutableSource:a5,useSyncExternalStore:s5,useId:y5,unstable_isNewReconciler:!1};function Ai(e,t){if(e&&e.defaultProps){t=Sa({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Q1(e,t,r,s){t=e.memoizedState,r=r(s,t),r=r==null?t:Sa({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var ny={isMounted:function(e){return(e=e._reactInternals)?Wd(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var s=dn(),n=ic(e),i=Hl(s,n);i.payload=t,r!=null&&(i.callback=r),t=sc(e,i,n),t!==null&&(zi(t,e,n,s),qm(t,e,n))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var s=dn(),n=ic(e),i=Hl(s,n);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=sc(e,i,n),t!==null&&(zi(t,e,n,s),qm(t,e,n))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=dn(),s=ic(e),n=Hl(r,s);n.tag=2,t!=null&&(n.callback=t),t=sc(e,n,s),t!==null&&(zi(t,e,s,r),qm(t,e,s))}};function X3(e,t,r,s,n,i,l){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(s,i,l):t.prototype&&t.prototype.isPureReactComponent?!Zh(r,s)||!Zh(n,i):!0}function w5(e,t,r){var s=!1,n=fc,i=t.contextType;return typeof i=="object"&&i!==null?i=gi(i):(n=Pn(t)?vd:Xs.current,s=t.contextTypes,i=(s=s!=null)?e0(e,n):fc),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=ny,e.stateNode=t,t._reactInternals=e,s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=n,e.__reactInternalMemoizedMaskedChildContext=i),t}function Y3(e,t,r,s){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,s),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,s),t.state!==e&&ny.enqueueReplaceState(t,t.state,null)}function X1(e,t,r,s){var n=e.stateNode;n.props=r,n.state=e.memoizedState,n.refs={},EN(e);var i=t.contextType;typeof i=="object"&&i!==null?n.context=gi(i):(i=Pn(t)?vd:Xs.current,n.context=e0(e,i)),n.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(Q1(e,t,i,r),n.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof n.getSnapshotBeforeUpdate=="function"||typeof n.UNSAFE_componentWillMount!="function"&&typeof n.componentWillMount!="function"||(t=n.state,typeof n.componentWillMount=="function"&&n.componentWillMount(),typeof n.UNSAFE_componentWillMount=="function"&&n.UNSAFE_componentWillMount(),t!==n.state&&ny.enqueueReplaceState(n,n.state,null),kp(e,r,n,s),n.state=e.memoizedState),typeof n.componentDidMount=="function"&&(e.flags|=4194308)}function s0(e,t){try{var r="",s=t;do r+=N$(s),s=s.return;while(s);var n=r}catch(i){n=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:n,digest:null}}function pb(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Y1(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var X7=typeof WeakMap=="function"?WeakMap:Map;function N5(e,t,r){r=Hl(-1,r),r.tag=3,r.payload={element:null};var s=t.value;return r.callback=function(){_p||(_p=!0,lj=s),Y1(e,t)},r}function S5(e,t,r){r=Hl(-1,r),r.tag=3;var s=e.type.getDerivedStateFromError;if(typeof s=="function"){var n=t.value;r.payload=function(){return s(n)},r.callback=function(){Y1(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){Y1(e,t),typeof s!="function"&&(nc===null?nc=new Set([this]):nc.add(this));var l=t.stack;this.componentDidCatch(t.value,{componentStack:l!==null?l:""})}),r}function J3(e,t,r){var s=e.pingCache;if(s===null){s=e.pingCache=new X7;var n=new Set;s.set(t,n)}else n=s.get(t),n===void 0&&(n=new Set,s.set(t,n));n.has(r)||(n.add(r),e=dB.bind(null,e,t,r),t.then(e,e))}function Z3(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function eC(e,t,r,s,n){return e.mode&1?(e.flags|=65536,e.lanes=n,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Hl(-1,1),t.tag=2,sc(r,t,1))),r.lanes|=1),e)}var Y7=mo.ReactCurrentOwner,kn=!1;function an(e,t,r,s){t.child=e===null?ZT(t,null,r,s):r0(t,e.child,r,s)}function tC(e,t,r,s,n){r=r.render;var i=t.ref;return Ou(t,n),s=IN(e,t,r,s,i,n),r=ON(),e!==null&&!kn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n,to(e,t,n)):(oa&&r&&bN(t),t.flags|=1,an(e,t,s,n),t.child)}function rC(e,t,r,s,n){if(e===null){var i=r.type;return typeof i=="function"&&!WN(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,k5(e,t,i,s,n)):(e=Jm(r.type,null,s,t,t.mode,n),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&n)){var l=i.memoizedProps;if(r=r.compare,r=r!==null?r:Zh,r(l,s)&&e.ref===t.ref)return to(e,t,n)}return t.flags|=1,e=lc(i,s),e.ref=t.ref,e.return=t,t.child=e}function k5(e,t,r,s,n){if(e!==null){var i=e.memoizedProps;if(Zh(i,s)&&e.ref===t.ref)if(kn=!1,t.pendingProps=s=i,(e.lanes&n)!==0)e.flags&131072&&(kn=!0);else return t.lanes=e.lanes,to(e,t,n)}return J1(e,t,r,s,n)}function C5(e,t,r){var s=t.pendingProps,n=s.children,i=e!==null?e.memoizedState:null;if(s.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Yr(Su,Mn),Mn|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Yr(Su,Mn),Mn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=i!==null?i.baseLanes:r,Yr(Su,Mn),Mn|=s}else i!==null?(s=i.baseLanes|r,t.memoizedState=null):s=r,Yr(Su,Mn),Mn|=s;return an(e,t,n,r),t.child}function E5(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function J1(e,t,r,s,n){var i=Pn(r)?vd:Xs.current;return i=e0(t,i),Ou(t,n),r=IN(e,t,r,s,i,n),s=ON(),e!==null&&!kn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n,to(e,t,n)):(oa&&s&&bN(t),t.flags|=1,an(e,t,r,n),t.child)}function aC(e,t,r,s,n){if(Pn(r)){var i=!0;bp(t)}else i=!1;if(Ou(t,n),t.stateNode===null)Qm(e,t),w5(t,r,s),X1(t,r,s,n),s=!0;else if(e===null){var l=t.stateNode,o=t.memoizedProps;l.props=o;var c=l.context,u=r.contextType;typeof u=="object"&&u!==null?u=gi(u):(u=Pn(r)?vd:Xs.current,u=e0(t,u));var d=r.getDerivedStateFromProps,h=typeof d=="function"||typeof l.getSnapshotBeforeUpdate=="function";h||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==s||c!==u)&&Y3(t,l,s,u),Io=!1;var f=t.memoizedState;l.state=f,kp(t,s,l,n),c=t.memoizedState,o!==s||f!==c||En.current||Io?(typeof d=="function"&&(Q1(t,r,d,s),c=t.memoizedState),(o=Io||X3(t,r,o,s,f,c,u))?(h||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(t.flags|=4194308)):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=s,t.memoizedState=c),l.props=s,l.state=c,l.context=u,s=o):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),s=!1)}else{l=t.stateNode,t5(e,t),o=t.memoizedProps,u=t.type===t.elementType?o:Ai(t.type,o),l.props=u,h=t.pendingProps,f=l.context,c=r.contextType,typeof c=="object"&&c!==null?c=gi(c):(c=Pn(r)?vd:Xs.current,c=e0(t,c));var x=r.getDerivedStateFromProps;(d=typeof x=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==h||f!==c)&&Y3(t,l,s,c),Io=!1,f=t.memoizedState,l.state=f,kp(t,s,l,n);var p=t.memoizedState;o!==h||f!==p||En.current||Io?(typeof x=="function"&&(Q1(t,r,x,s),p=t.memoizedState),(u=Io||X3(t,r,u,s,f,p,c)||!1)?(d||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(s,p,c),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(s,p,c)),typeof l.componentDidUpdate=="function"&&(t.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof l.componentDidUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=s,t.memoizedState=p),l.props=s,l.state=p,l.context=c,s=u):(typeof l.componentDidUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),s=!1)}return Z1(e,t,r,s,i,n)}function Z1(e,t,r,s,n,i){E5(e,t);var l=(t.flags&128)!==0;if(!s&&!l)return n&&U3(t,r,!1),to(e,t,i);s=t.stateNode,Y7.current=t;var o=l&&typeof r.getDerivedStateFromError!="function"?null:s.render();return t.flags|=1,e!==null&&l?(t.child=r0(t,e.child,null,i),t.child=r0(t,null,o,i)):an(e,t,o,i),t.memoizedState=s.state,n&&U3(t,r,!0),t.child}function P5(e){var t=e.stateNode;t.pendingContext?z3(e,t.pendingContext,t.pendingContext!==t.context):t.context&&z3(e,t.context,!1),PN(e,t.containerInfo)}function sC(e,t,r,s,n){return t0(),wN(n),t.flags|=256,an(e,t,r,s),t.child}var ej={dehydrated:null,treeContext:null,retryLane:0};function tj(e){return{baseLanes:e,cachePool:null,transitions:null}}function A5(e,t,r){var s=t.pendingProps,n=ya.current,i=!1,l=(t.flags&128)!==0,o;if((o=l)||(o=e!==null&&e.memoizedState===null?!1:(n&2)!==0),o?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(n|=1),Yr(ya,n&1),e===null)return K1(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(l=s.children,e=s.fallback,i?(s=t.mode,i=t.child,l={mode:"hidden",children:l},!(s&1)&&i!==null?(i.childLanes=0,i.pendingProps=l):i=oy(l,s,0,null),e=od(e,s,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=tj(r),t.memoizedState=ej,e):RN(t,l));if(n=e.memoizedState,n!==null&&(o=n.dehydrated,o!==null))return J7(e,t,l,s,o,n,r);if(i){i=s.fallback,l=t.mode,n=e.child,o=n.sibling;var c={mode:"hidden",children:s.children};return!(l&1)&&t.child!==n?(s=t.child,s.childLanes=0,s.pendingProps=c,t.deletions=null):(s=lc(n,c),s.subtreeFlags=n.subtreeFlags&14680064),o!==null?i=lc(o,i):(i=od(i,l,r,null),i.flags|=2),i.return=t,s.return=t,s.sibling=i,t.child=s,s=i,i=t.child,l=e.child.memoizedState,l=l===null?tj(r):{baseLanes:l.baseLanes|r,cachePool:null,transitions:l.transitions},i.memoizedState=l,i.childLanes=e.childLanes&~r,t.memoizedState=ej,s}return i=e.child,e=i.sibling,s=lc(i,{mode:"visible",children:s.children}),!(t.mode&1)&&(s.lanes=r),s.return=t,s.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=s,t.memoizedState=null,s}function RN(e,t){return t=oy({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function am(e,t,r,s){return s!==null&&wN(s),r0(t,e.child,null,r),e=RN(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function J7(e,t,r,s,n,i,l){if(r)return t.flags&256?(t.flags&=-257,s=pb(Error(ot(422))),am(e,t,l,s)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=s.fallback,n=t.mode,s=oy({mode:"visible",children:s.children},n,0,null),i=od(i,n,l,null),i.flags|=2,s.return=t,i.return=t,s.sibling=i,t.child=s,t.mode&1&&r0(t,e.child,null,l),t.child.memoizedState=tj(l),t.memoizedState=ej,i);if(!(t.mode&1))return am(e,t,l,null);if(n.data==="$!"){if(s=n.nextSibling&&n.nextSibling.dataset,s)var o=s.dgst;return s=o,i=Error(ot(419)),s=pb(i,s,void 0),am(e,t,l,s)}if(o=(l&e.childLanes)!==0,kn||o){if(s=bs,s!==null){switch(l&-l){case 4:n=2;break;case 16:n=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:n=32;break;case 536870912:n=268435456;break;default:n=0}n=n&(s.suspendedLanes|l)?0:n,n!==0&&n!==i.retryLane&&(i.retryLane=n,eo(e,n),zi(s,e,n,-1))}return UN(),s=pb(Error(ot(421))),am(e,t,l,s)}return n.data==="$?"?(t.flags|=128,t.child=e.child,t=uB.bind(null,e),n._reactRetry=t,null):(e=i.treeContext,Vn=ac(n.nextSibling),qn=t,oa=!0,Di=null,e!==null&&(ui[hi++]=Bl,ui[hi++]=zl,ui[hi++]=bd,Bl=e.id,zl=e.overflow,bd=t),t=RN(t,s.children),t.flags|=4096,t)}function nC(e,t,r){e.lanes|=t;var s=e.alternate;s!==null&&(s.lanes|=t),G1(e.return,t,r)}function gb(e,t,r,s,n){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:s,tail:r,tailMode:n}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=s,i.tail=r,i.tailMode=n)}function _5(e,t,r){var s=t.pendingProps,n=s.revealOrder,i=s.tail;if(an(e,t,s.children,r),s=ya.current,s&2)s=s&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&nC(e,r,t);else if(e.tag===19)nC(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}s&=1}if(Yr(ya,s),!(t.mode&1))t.memoizedState=null;else switch(n){case"forwards":for(r=t.child,n=null;r!==null;)e=r.alternate,e!==null&&Cp(e)===null&&(n=r),r=r.sibling;r=n,r===null?(n=t.child,t.child=null):(n=r.sibling,r.sibling=null),gb(t,!1,n,r,i);break;case"backwards":for(r=null,n=t.child,t.child=null;n!==null;){if(e=n.alternate,e!==null&&Cp(e)===null){t.child=n;break}e=n.sibling,n.sibling=r,r=n,n=e}gb(t,!0,r,null,i);break;case"together":gb(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Qm(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function to(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),wd|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ot(153));if(t.child!==null){for(e=t.child,r=lc(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=lc(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function Z7(e,t,r){switch(t.tag){case 3:P5(t),t0();break;case 5:r5(t);break;case 1:Pn(t.type)&&bp(t);break;case 4:PN(t,t.stateNode.containerInfo);break;case 10:var s=t.type._context,n=t.memoizedProps.value;Yr(Np,s._currentValue),s._currentValue=n;break;case 13:if(s=t.memoizedState,s!==null)return s.dehydrated!==null?(Yr(ya,ya.current&1),t.flags|=128,null):r&t.child.childLanes?A5(e,t,r):(Yr(ya,ya.current&1),e=to(e,t,r),e!==null?e.sibling:null);Yr(ya,ya.current&1);break;case 19:if(s=(r&t.childLanes)!==0,e.flags&128){if(s)return _5(e,t,r);t.flags|=128}if(n=t.memoizedState,n!==null&&(n.rendering=null,n.tail=null,n.lastEffect=null),Yr(ya,ya.current),s)break;return null;case 22:case 23:return t.lanes=0,C5(e,t,r)}return to(e,t,r)}var T5,rj,I5,O5;T5=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};rj=function(){};I5=function(e,t,r,s){var n=e.memoizedProps;if(n!==s){e=t.stateNode,Wc(pl.current);var i=null;switch(r){case"input":n=S1(e,n),s=S1(e,s),i=[];break;case"select":n=Sa({},n,{value:void 0}),s=Sa({},s,{value:void 0}),i=[];break;case"textarea":n=E1(e,n),s=E1(e,s),i=[];break;default:typeof n.onClick!="function"&&typeof s.onClick=="function"&&(e.onclick=yp)}A1(r,s);var l;r=null;for(u in n)if(!s.hasOwnProperty(u)&&n.hasOwnProperty(u)&&n[u]!=null)if(u==="style"){var o=n[u];for(l in o)o.hasOwnProperty(l)&&(r||(r={}),r[l]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(qh.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in s){var c=s[u];if(o=n!=null?n[u]:void 0,s.hasOwnProperty(u)&&c!==o&&(c!=null||o!=null))if(u==="style")if(o){for(l in o)!o.hasOwnProperty(l)||c&&c.hasOwnProperty(l)||(r||(r={}),r[l]="");for(l in c)c.hasOwnProperty(l)&&o[l]!==c[l]&&(r||(r={}),r[l]=c[l])}else r||(i||(i=[]),i.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,o=o?o.__html:void 0,c!=null&&o!==c&&(i=i||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(qh.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Zr("scroll",e),i||o===c||(i=[])):(i=i||[]).push(u,c))}r&&(i=i||[]).push("style",r);var u=i;(t.updateQueue=u)&&(t.flags|=4)}};O5=function(e,t,r,s){r!==s&&(t.flags|=4)};function eh(e,t){if(!oa)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var s=null;r!==null;)r.alternate!==null&&(s=r),r=r.sibling;s===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:s.sibling=null}}function Ms(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,s=0;if(t)for(var n=e.child;n!==null;)r|=n.lanes|n.childLanes,s|=n.subtreeFlags&14680064,s|=n.flags&14680064,n.return=e,n=n.sibling;else for(n=e.child;n!==null;)r|=n.lanes|n.childLanes,s|=n.subtreeFlags,s|=n.flags,n.return=e,n=n.sibling;return e.subtreeFlags|=s,e.childLanes=r,t}function eB(e,t,r){var s=t.pendingProps;switch(jN(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ms(t),null;case 1:return Pn(t.type)&&vp(),Ms(t),null;case 3:return s=t.stateNode,a0(),ra(En),ra(Xs),_N(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(e===null||e.child===null)&&(tm(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Di!==null&&(dj(Di),Di=null))),rj(e,t),Ms(t),null;case 5:AN(t);var n=Wc(sf.current);if(r=t.type,e!==null&&t.stateNode!=null)I5(e,t,r,s,n),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!s){if(t.stateNode===null)throw Error(ot(166));return Ms(t),null}if(e=Wc(pl.current),tm(t)){s=t.stateNode,r=t.type;var i=t.memoizedProps;switch(s[hl]=t,s[rf]=i,e=(t.mode&1)!==0,r){case"dialog":Zr("cancel",s),Zr("close",s);break;case"iframe":case"object":case"embed":Zr("load",s);break;case"video":case"audio":for(n=0;n<gh.length;n++)Zr(gh[n],s);break;case"source":Zr("error",s);break;case"img":case"image":case"link":Zr("error",s),Zr("load",s);break;case"details":Zr("toggle",s);break;case"input":x3(s,i),Zr("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!i.multiple},Zr("invalid",s);break;case"textarea":p3(s,i),Zr("invalid",s)}A1(r,i),n=null;for(var l in i)if(i.hasOwnProperty(l)){var o=i[l];l==="children"?typeof o=="string"?s.textContent!==o&&(i.suppressHydrationWarning!==!0&&em(s.textContent,o,e),n=["children",o]):typeof o=="number"&&s.textContent!==""+o&&(i.suppressHydrationWarning!==!0&&em(s.textContent,o,e),n=["children",""+o]):qh.hasOwnProperty(l)&&o!=null&&l==="onScroll"&&Zr("scroll",s)}switch(r){case"input":qx(s),m3(s,i,!0);break;case"textarea":qx(s),g3(s);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(s.onclick=yp)}s=n,t.updateQueue=s,s!==null&&(t.flags|=4)}else{l=n.nodeType===9?n:n.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=lT(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=l.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof s.is=="string"?e=l.createElement(r,{is:s.is}):(e=l.createElement(r),r==="select"&&(l=e,s.multiple?l.multiple=!0:s.size&&(l.size=s.size))):e=l.createElementNS(e,r),e[hl]=t,e[rf]=s,T5(e,t,!1,!1),t.stateNode=e;e:{switch(l=_1(r,s),r){case"dialog":Zr("cancel",e),Zr("close",e),n=s;break;case"iframe":case"object":case"embed":Zr("load",e),n=s;break;case"video":case"audio":for(n=0;n<gh.length;n++)Zr(gh[n],e);n=s;break;case"source":Zr("error",e),n=s;break;case"img":case"image":case"link":Zr("error",e),Zr("load",e),n=s;break;case"details":Zr("toggle",e),n=s;break;case"input":x3(e,s),n=S1(e,s),Zr("invalid",e);break;case"option":n=s;break;case"select":e._wrapperState={wasMultiple:!!s.multiple},n=Sa({},s,{value:void 0}),Zr("invalid",e);break;case"textarea":p3(e,s),n=E1(e,s),Zr("invalid",e);break;default:n=s}A1(r,n),o=n;for(i in o)if(o.hasOwnProperty(i)){var c=o[i];i==="style"?dT(e,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&oT(e,c)):i==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&Kh(e,c):typeof c=="number"&&Kh(e,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(qh.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Zr("scroll",e):c!=null&&iN(e,i,c,l))}switch(r){case"input":qx(e),m3(e,s,!1);break;case"textarea":qx(e),g3(e);break;case"option":s.value!=null&&e.setAttribute("value",""+hc(s.value));break;case"select":e.multiple=!!s.multiple,i=s.value,i!=null?Au(e,!!s.multiple,i,!1):s.defaultValue!=null&&Au(e,!!s.multiple,s.defaultValue,!0);break;default:typeof n.onClick=="function"&&(e.onclick=yp)}switch(r){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Ms(t),null;case 6:if(e&&t.stateNode!=null)O5(e,t,e.memoizedProps,s);else{if(typeof s!="string"&&t.stateNode===null)throw Error(ot(166));if(r=Wc(sf.current),Wc(pl.current),tm(t)){if(s=t.stateNode,r=t.memoizedProps,s[hl]=t,(i=s.nodeValue!==r)&&(e=qn,e!==null))switch(e.tag){case 3:em(s.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&em(s.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else s=(r.nodeType===9?r:r.ownerDocument).createTextNode(s),s[hl]=t,t.stateNode=s}return Ms(t),null;case 13:if(ra(ya),s=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(oa&&Vn!==null&&t.mode&1&&!(t.flags&128))YT(),t0(),t.flags|=98560,i=!1;else if(i=tm(t),s!==null&&s.dehydrated!==null){if(e===null){if(!i)throw Error(ot(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(ot(317));i[hl]=t}else t0(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Ms(t),i=!1}else Di!==null&&(dj(Di),Di=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(s=s!==null,s!==(e!==null&&e.memoizedState!==null)&&s&&(t.child.flags|=8192,t.mode&1&&(e===null||ya.current&1?ts===0&&(ts=3):UN())),t.updateQueue!==null&&(t.flags|=4),Ms(t),null);case 4:return a0(),rj(e,t),e===null&&ef(t.stateNode.containerInfo),Ms(t),null;case 10:return kN(t.type._context),Ms(t),null;case 17:return Pn(t.type)&&vp(),Ms(t),null;case 19:if(ra(ya),i=t.memoizedState,i===null)return Ms(t),null;if(s=(t.flags&128)!==0,l=i.rendering,l===null)if(s)eh(i,!1);else{if(ts!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(l=Cp(e),l!==null){for(t.flags|=128,eh(i,!1),s=l.updateQueue,s!==null&&(t.updateQueue=s,t.flags|=4),t.subtreeFlags=0,s=r,r=t.child;r!==null;)i=r,e=s,i.flags&=14680066,l=i.alternate,l===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=l.childLanes,i.lanes=l.lanes,i.child=l.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=l.memoizedProps,i.memoizedState=l.memoizedState,i.updateQueue=l.updateQueue,i.type=l.type,e=l.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Yr(ya,ya.current&1|2),t.child}e=e.sibling}i.tail!==null&&Ra()>n0&&(t.flags|=128,s=!0,eh(i,!1),t.lanes=4194304)}else{if(!s)if(e=Cp(l),e!==null){if(t.flags|=128,s=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),eh(i,!0),i.tail===null&&i.tailMode==="hidden"&&!l.alternate&&!oa)return Ms(t),null}else 2*Ra()-i.renderingStartTime>n0&&r!==1073741824&&(t.flags|=128,s=!0,eh(i,!1),t.lanes=4194304);i.isBackwards?(l.sibling=t.child,t.child=l):(r=i.last,r!==null?r.sibling=l:t.child=l,i.last=l)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Ra(),t.sibling=null,r=ya.current,Yr(ya,s?r&1|2:r&1),t):(Ms(t),null);case 22:case 23:return zN(),s=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==s&&(t.flags|=8192),s&&t.mode&1?Mn&1073741824&&(Ms(t),t.subtreeFlags&6&&(t.flags|=8192)):Ms(t),null;case 24:return null;case 25:return null}throw Error(ot(156,t.tag))}function tB(e,t){switch(jN(t),t.tag){case 1:return Pn(t.type)&&vp(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return a0(),ra(En),ra(Xs),_N(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return AN(t),null;case 13:if(ra(ya),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ot(340));t0()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ra(ya),null;case 4:return a0(),null;case 10:return kN(t.type._context),null;case 22:case 23:return zN(),null;case 24:return null;default:return null}}var sm=!1,Us=!1,rB=typeof WeakSet=="function"?WeakSet:Set,jt=null;function Nu(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(s){Aa(e,t,s)}else r.current=null}function aj(e,t,r){try{r()}catch(s){Aa(e,t,s)}}var iC=!1;function aB(e,t){if(B1=mp,e=LT(),vN(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var s=r.getSelection&&r.getSelection();if(s&&s.rangeCount!==0){r=s.anchorNode;var n=s.anchorOffset,i=s.focusNode;s=s.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var l=0,o=-1,c=-1,u=0,d=0,h=e,f=null;t:for(;;){for(var x;h!==r||n!==0&&h.nodeType!==3||(o=l+n),h!==i||s!==0&&h.nodeType!==3||(c=l+s),h.nodeType===3&&(l+=h.nodeValue.length),(x=h.firstChild)!==null;)f=h,h=x;for(;;){if(h===e)break t;if(f===r&&++u===n&&(o=l),f===i&&++d===s&&(c=l),(x=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=x}r=o===-1||c===-1?null:{start:o,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(z1={focusedElem:e,selectionRange:r},mp=!1,jt=t;jt!==null;)if(t=jt,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,jt=e;else for(;jt!==null;){t=jt;try{var p=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var g=p.memoizedProps,y=p.memoizedState,v=t.stateNode,j=v.getSnapshotBeforeUpdate(t.elementType===t.type?g:Ai(t.type,g),y);v.__reactInternalSnapshotBeforeUpdate=j}break;case 3:var b=t.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ot(163))}}catch(w){Aa(t,t.return,w)}if(e=t.sibling,e!==null){e.return=t.return,jt=e;break}jt=t.return}return p=iC,iC=!1,p}function Th(e,t,r){var s=t.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var n=s=s.next;do{if((n.tag&e)===e){var i=n.destroy;n.destroy=void 0,i!==void 0&&aj(t,r,i)}n=n.next}while(n!==s)}}function iy(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var s=r.create;r.destroy=s()}r=r.next}while(r!==t)}}function sj(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function D5(e){var t=e.alternate;t!==null&&(e.alternate=null,D5(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[hl],delete t[rf],delete t[V1],delete t[$7],delete t[B7])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function F5(e){return e.tag===5||e.tag===3||e.tag===4}function lC(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||F5(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function nj(e,t,r){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=yp));else if(s!==4&&(e=e.child,e!==null))for(nj(e,t,r),e=e.sibling;e!==null;)nj(e,t,r),e=e.sibling}function ij(e,t,r){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(s!==4&&(e=e.child,e!==null))for(ij(e,t,r),e=e.sibling;e!==null;)ij(e,t,r),e=e.sibling}var Es=null,Oi=!1;function Eo(e,t,r){for(r=r.child;r!==null;)R5(e,t,r),r=r.sibling}function R5(e,t,r){if(ml&&typeof ml.onCommitFiberUnmount=="function")try{ml.onCommitFiberUnmount(Jg,r)}catch{}switch(r.tag){case 5:Us||Nu(r,t);case 6:var s=Es,n=Oi;Es=null,Eo(e,t,r),Es=s,Oi=n,Es!==null&&(Oi?(e=Es,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Es.removeChild(r.stateNode));break;case 18:Es!==null&&(Oi?(e=Es,r=r.stateNode,e.nodeType===8?db(e.parentNode,r):e.nodeType===1&&db(e,r),Yh(e)):db(Es,r.stateNode));break;case 4:s=Es,n=Oi,Es=r.stateNode.containerInfo,Oi=!0,Eo(e,t,r),Es=s,Oi=n;break;case 0:case 11:case 14:case 15:if(!Us&&(s=r.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){n=s=s.next;do{var i=n,l=i.destroy;i=i.tag,l!==void 0&&(i&2||i&4)&&aj(r,t,l),n=n.next}while(n!==s)}Eo(e,t,r);break;case 1:if(!Us&&(Nu(r,t),s=r.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=r.memoizedProps,s.state=r.memoizedState,s.componentWillUnmount()}catch(o){Aa(r,t,o)}Eo(e,t,r);break;case 21:Eo(e,t,r);break;case 22:r.mode&1?(Us=(s=Us)||r.memoizedState!==null,Eo(e,t,r),Us=s):Eo(e,t,r);break;default:Eo(e,t,r)}}function oC(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new rB),t.forEach(function(s){var n=hB.bind(null,e,s);r.has(s)||(r.add(s),s.then(n,n))})}}function Ci(e,t){var r=t.deletions;if(r!==null)for(var s=0;s<r.length;s++){var n=r[s];try{var i=e,l=t,o=l;e:for(;o!==null;){switch(o.tag){case 5:Es=o.stateNode,Oi=!1;break e;case 3:Es=o.stateNode.containerInfo,Oi=!0;break e;case 4:Es=o.stateNode.containerInfo,Oi=!0;break e}o=o.return}if(Es===null)throw Error(ot(160));R5(i,l,n),Es=null,Oi=!1;var c=n.alternate;c!==null&&(c.return=null),n.return=null}catch(u){Aa(n,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)M5(t,e),t=t.sibling}function M5(e,t){var r=e.alternate,s=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Ci(t,e),Ji(e),s&4){try{Th(3,e,e.return),iy(3,e)}catch(g){Aa(e,e.return,g)}try{Th(5,e,e.return)}catch(g){Aa(e,e.return,g)}}break;case 1:Ci(t,e),Ji(e),s&512&&r!==null&&Nu(r,r.return);break;case 5:if(Ci(t,e),Ji(e),s&512&&r!==null&&Nu(r,r.return),e.flags&32){var n=e.stateNode;try{Kh(n,"")}catch(g){Aa(e,e.return,g)}}if(s&4&&(n=e.stateNode,n!=null)){var i=e.memoizedProps,l=r!==null?r.memoizedProps:i,o=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{o==="input"&&i.type==="radio"&&i.name!=null&&nT(n,i),_1(o,l);var u=_1(o,i);for(l=0;l<c.length;l+=2){var d=c[l],h=c[l+1];d==="style"?dT(n,h):d==="dangerouslySetInnerHTML"?oT(n,h):d==="children"?Kh(n,h):iN(n,d,h,u)}switch(o){case"input":k1(n,i);break;case"textarea":iT(n,i);break;case"select":var f=n._wrapperState.wasMultiple;n._wrapperState.wasMultiple=!!i.multiple;var x=i.value;x!=null?Au(n,!!i.multiple,x,!1):f!==!!i.multiple&&(i.defaultValue!=null?Au(n,!!i.multiple,i.defaultValue,!0):Au(n,!!i.multiple,i.multiple?[]:"",!1))}n[rf]=i}catch(g){Aa(e,e.return,g)}}break;case 6:if(Ci(t,e),Ji(e),s&4){if(e.stateNode===null)throw Error(ot(162));n=e.stateNode,i=e.memoizedProps;try{n.nodeValue=i}catch(g){Aa(e,e.return,g)}}break;case 3:if(Ci(t,e),Ji(e),s&4&&r!==null&&r.memoizedState.isDehydrated)try{Yh(t.containerInfo)}catch(g){Aa(e,e.return,g)}break;case 4:Ci(t,e),Ji(e);break;case 13:Ci(t,e),Ji(e),n=e.child,n.flags&8192&&(i=n.memoizedState!==null,n.stateNode.isHidden=i,!i||n.alternate!==null&&n.alternate.memoizedState!==null||($N=Ra())),s&4&&oC(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(Us=(u=Us)||d,Ci(t,e),Us=u):Ci(t,e),Ji(e),s&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(jt=e,d=e.child;d!==null;){for(h=jt=d;jt!==null;){switch(f=jt,x=f.child,f.tag){case 0:case 11:case 14:case 15:Th(4,f,f.return);break;case 1:Nu(f,f.return);var p=f.stateNode;if(typeof p.componentWillUnmount=="function"){s=f,r=f.return;try{t=s,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch(g){Aa(s,r,g)}}break;case 5:Nu(f,f.return);break;case 22:if(f.memoizedState!==null){dC(h);continue}}x!==null?(x.return=f,jt=x):dC(h)}d=d.sibling}e:for(d=null,h=e;;){if(h.tag===5){if(d===null){d=h;try{n=h.stateNode,u?(i=n.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(o=h.stateNode,c=h.memoizedProps.style,l=c!=null&&c.hasOwnProperty("display")?c.display:null,o.style.display=cT("display",l))}catch(g){Aa(e,e.return,g)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(g){Aa(e,e.return,g)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Ci(t,e),Ji(e),s&4&&oC(e);break;case 21:break;default:Ci(t,e),Ji(e)}}function Ji(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(F5(r)){var s=r;break e}r=r.return}throw Error(ot(160))}switch(s.tag){case 5:var n=s.stateNode;s.flags&32&&(Kh(n,""),s.flags&=-33);var i=lC(e);ij(e,i,n);break;case 3:case 4:var l=s.stateNode.containerInfo,o=lC(e);nj(e,o,l);break;default:throw Error(ot(161))}}catch(c){Aa(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function sB(e,t,r){jt=e,L5(e)}function L5(e,t,r){for(var s=(e.mode&1)!==0;jt!==null;){var n=jt,i=n.child;if(n.tag===22&&s){var l=n.memoizedState!==null||sm;if(!l){var o=n.alternate,c=o!==null&&o.memoizedState!==null||Us;o=sm;var u=Us;if(sm=l,(Us=c)&&!u)for(jt=n;jt!==null;)l=jt,c=l.child,l.tag===22&&l.memoizedState!==null?uC(n):c!==null?(c.return=l,jt=c):uC(n);for(;i!==null;)jt=i,L5(i),i=i.sibling;jt=n,sm=o,Us=u}cC(e)}else n.subtreeFlags&8772&&i!==null?(i.return=n,jt=i):cC(e)}}function cC(e){for(;jt!==null;){var t=jt;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Us||iy(5,t);break;case 1:var s=t.stateNode;if(t.flags&4&&!Us)if(r===null)s.componentDidMount();else{var n=t.elementType===t.type?r.memoizedProps:Ai(t.type,r.memoizedProps);s.componentDidUpdate(n,r.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&K3(t,i,s);break;case 3:var l=t.updateQueue;if(l!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}K3(t,l,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&Yh(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ot(163))}Us||t.flags&512&&sj(t)}catch(f){Aa(t,t.return,f)}}if(t===e){jt=null;break}if(r=t.sibling,r!==null){r.return=t.return,jt=r;break}jt=t.return}}function dC(e){for(;jt!==null;){var t=jt;if(t===e){jt=null;break}var r=t.sibling;if(r!==null){r.return=t.return,jt=r;break}jt=t.return}}function uC(e){for(;jt!==null;){var t=jt;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{iy(4,t)}catch(c){Aa(t,r,c)}break;case 1:var s=t.stateNode;if(typeof s.componentDidMount=="function"){var n=t.return;try{s.componentDidMount()}catch(c){Aa(t,n,c)}}var i=t.return;try{sj(t)}catch(c){Aa(t,i,c)}break;case 5:var l=t.return;try{sj(t)}catch(c){Aa(t,l,c)}}}catch(c){Aa(t,t.return,c)}if(t===e){jt=null;break}var o=t.sibling;if(o!==null){o.return=t.return,jt=o;break}jt=t.return}}var nB=Math.ceil,Ap=mo.ReactCurrentDispatcher,MN=mo.ReactCurrentOwner,mi=mo.ReactCurrentBatchConfig,jr=0,bs=null,Ka=null,_s=0,Mn=0,Su=Sc(0),ts=0,cf=null,wd=0,ly=0,LN=0,Ih=null,Nn=null,$N=0,n0=1/0,_l=null,_p=!1,lj=null,nc=null,nm=!1,Qo=null,Tp=0,Oh=0,oj=null,Xm=-1,Ym=0;function dn(){return jr&6?Ra():Xm!==-1?Xm:Xm=Ra()}function ic(e){return e.mode&1?jr&2&&_s!==0?_s&-_s:U7.transition!==null?(Ym===0&&(Ym=wT()),Ym):(e=Ur,e!==0||(e=window.event,e=e===void 0?16:AT(e.type)),e):1}function zi(e,t,r,s){if(50<Oh)throw Oh=0,oj=null,Error(ot(185));Yf(e,r,s),(!(jr&2)||e!==bs)&&(e===bs&&(!(jr&2)&&(ly|=r),ts===4&&Mo(e,_s)),An(e,s),r===1&&jr===0&&!(t.mode&1)&&(n0=Ra()+500,ay&&kc()))}function An(e,t){var r=e.callbackNode;U$(e,t);var s=xp(e,e===bs?_s:0);if(s===0)r!==null&&b3(r),e.callbackNode=null,e.callbackPriority=0;else if(t=s&-s,e.callbackPriority!==t){if(r!=null&&b3(r),t===1)e.tag===0?z7(hC.bind(null,e)):GT(hC.bind(null,e)),M7(function(){!(jr&6)&&kc()}),r=null;else{switch(NT(s)){case 1:r=uN;break;case 4:r=bT;break;case 16:r=fp;break;case 536870912:r=jT;break;default:r=fp}r=q5(r,$5.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function $5(e,t){if(Xm=-1,Ym=0,jr&6)throw Error(ot(327));var r=e.callbackNode;if(Du()&&e.callbackNode!==r)return null;var s=xp(e,e===bs?_s:0);if(s===0)return null;if(s&30||s&e.expiredLanes||t)t=Ip(e,s);else{t=s;var n=jr;jr|=2;var i=z5();(bs!==e||_s!==t)&&(_l=null,n0=Ra()+500,ld(e,t));do try{oB();break}catch(o){B5(e,o)}while(!0);SN(),Ap.current=i,jr=n,Ka!==null?t=0:(bs=null,_s=0,t=ts)}if(t!==0){if(t===2&&(n=F1(e),n!==0&&(s=n,t=cj(e,n))),t===1)throw r=cf,ld(e,0),Mo(e,s),An(e,Ra()),r;if(t===6)Mo(e,s);else{if(n=e.current.alternate,!(s&30)&&!iB(n)&&(t=Ip(e,s),t===2&&(i=F1(e),i!==0&&(s=i,t=cj(e,i))),t===1))throw r=cf,ld(e,0),Mo(e,s),An(e,Ra()),r;switch(e.finishedWork=n,e.finishedLanes=s,t){case 0:case 1:throw Error(ot(345));case 2:Fc(e,Nn,_l);break;case 3:if(Mo(e,s),(s&130023424)===s&&(t=$N+500-Ra(),10<t)){if(xp(e,0)!==0)break;if(n=e.suspendedLanes,(n&s)!==s){dn(),e.pingedLanes|=e.suspendedLanes&n;break}e.timeoutHandle=W1(Fc.bind(null,e,Nn,_l),t);break}Fc(e,Nn,_l);break;case 4:if(Mo(e,s),(s&4194240)===s)break;for(t=e.eventTimes,n=-1;0<s;){var l=31-Bi(s);i=1<<l,l=t[l],l>n&&(n=l),s&=~i}if(s=n,s=Ra()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*nB(s/1960))-s,10<s){e.timeoutHandle=W1(Fc.bind(null,e,Nn,_l),s);break}Fc(e,Nn,_l);break;case 5:Fc(e,Nn,_l);break;default:throw Error(ot(329))}}}return An(e,Ra()),e.callbackNode===r?$5.bind(null,e):null}function cj(e,t){var r=Ih;return e.current.memoizedState.isDehydrated&&(ld(e,t).flags|=256),e=Ip(e,t),e!==2&&(t=Nn,Nn=r,t!==null&&dj(t)),e}function dj(e){Nn===null?Nn=e:Nn.push.apply(Nn,e)}function iB(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var s=0;s<r.length;s++){var n=r[s],i=n.getSnapshot;n=n.value;try{if(!Hi(i(),n))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Mo(e,t){for(t&=~LN,t&=~ly,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Bi(t),s=1<<r;e[r]=-1,t&=~s}}function hC(e){if(jr&6)throw Error(ot(327));Du();var t=xp(e,0);if(!(t&1))return An(e,Ra()),null;var r=Ip(e,t);if(e.tag!==0&&r===2){var s=F1(e);s!==0&&(t=s,r=cj(e,s))}if(r===1)throw r=cf,ld(e,0),Mo(e,t),An(e,Ra()),r;if(r===6)throw Error(ot(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Fc(e,Nn,_l),An(e,Ra()),null}function BN(e,t){var r=jr;jr|=1;try{return e(t)}finally{jr=r,jr===0&&(n0=Ra()+500,ay&&kc())}}function Nd(e){Qo!==null&&Qo.tag===0&&!(jr&6)&&Du();var t=jr;jr|=1;var r=mi.transition,s=Ur;try{if(mi.transition=null,Ur=1,e)return e()}finally{Ur=s,mi.transition=r,jr=t,!(jr&6)&&kc()}}function zN(){Mn=Su.current,ra(Su)}function ld(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,R7(r)),Ka!==null)for(r=Ka.return;r!==null;){var s=r;switch(jN(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&vp();break;case 3:a0(),ra(En),ra(Xs),_N();break;case 5:AN(s);break;case 4:a0();break;case 13:ra(ya);break;case 19:ra(ya);break;case 10:kN(s.type._context);break;case 22:case 23:zN()}r=r.return}if(bs=e,Ka=e=lc(e.current,null),_s=Mn=t,ts=0,cf=null,LN=ly=wd=0,Nn=Ih=null,Uc!==null){for(t=0;t<Uc.length;t++)if(r=Uc[t],s=r.interleaved,s!==null){r.interleaved=null;var n=s.next,i=r.pending;if(i!==null){var l=i.next;i.next=n,s.next=l}r.pending=s}Uc=null}return e}function B5(e,t){do{var r=Ka;try{if(SN(),Km.current=Pp,Ep){for(var s=ja.memoizedState;s!==null;){var n=s.queue;n!==null&&(n.pending=null),s=s.next}Ep=!1}if(jd=0,ms=Ya=ja=null,_h=!1,nf=0,MN.current=null,r===null||r.return===null){ts=1,cf=t,Ka=null;break}e:{var i=e,l=r.return,o=r,c=t;if(t=_s,o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=o,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var x=Z3(l);if(x!==null){x.flags&=-257,eC(x,l,o,i,t),x.mode&1&&J3(i,u,t),t=x,c=u;var p=t.updateQueue;if(p===null){var g=new Set;g.add(c),t.updateQueue=g}else p.add(c);break e}else{if(!(t&1)){J3(i,u,t),UN();break e}c=Error(ot(426))}}else if(oa&&o.mode&1){var y=Z3(l);if(y!==null){!(y.flags&65536)&&(y.flags|=256),eC(y,l,o,i,t),wN(s0(c,o));break e}}i=c=s0(c,o),ts!==4&&(ts=2),Ih===null?Ih=[i]:Ih.push(i),i=l;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var v=N5(i,c,t);q3(i,v);break e;case 1:o=c;var j=i.type,b=i.stateNode;if(!(i.flags&128)&&(typeof j.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(nc===null||!nc.has(b)))){i.flags|=65536,t&=-t,i.lanes|=t;var w=S5(i,o,t);q3(i,w);break e}}i=i.return}while(i!==null)}W5(r)}catch(k){t=k,Ka===r&&r!==null&&(Ka=r=r.return);continue}break}while(!0)}function z5(){var e=Ap.current;return Ap.current=Pp,e===null?Pp:e}function UN(){(ts===0||ts===3||ts===2)&&(ts=4),bs===null||!(wd&268435455)&&!(ly&268435455)||Mo(bs,_s)}function Ip(e,t){var r=jr;jr|=2;var s=z5();(bs!==e||_s!==t)&&(_l=null,ld(e,t));do try{lB();break}catch(n){B5(e,n)}while(!0);if(SN(),jr=r,Ap.current=s,Ka!==null)throw Error(ot(261));return bs=null,_s=0,ts}function lB(){for(;Ka!==null;)U5(Ka)}function oB(){for(;Ka!==null&&!O$();)U5(Ka)}function U5(e){var t=H5(e.alternate,e,Mn);e.memoizedProps=e.pendingProps,t===null?W5(e):Ka=t,MN.current=null}function W5(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=tB(r,t),r!==null){r.flags&=32767,Ka=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ts=6,Ka=null;return}}else if(r=eB(r,t,Mn),r!==null){Ka=r;return}if(t=t.sibling,t!==null){Ka=t;return}Ka=t=e}while(t!==null);ts===0&&(ts=5)}function Fc(e,t,r){var s=Ur,n=mi.transition;try{mi.transition=null,Ur=1,cB(e,t,r,s)}finally{mi.transition=n,Ur=s}return null}function cB(e,t,r,s){do Du();while(Qo!==null);if(jr&6)throw Error(ot(327));r=e.finishedWork;var n=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(ot(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(W$(e,i),e===bs&&(Ka=bs=null,_s=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||nm||(nm=!0,q5(fp,function(){return Du(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=mi.transition,mi.transition=null;var l=Ur;Ur=1;var o=jr;jr|=4,MN.current=null,aB(e,r),M5(r,e),A7(z1),mp=!!B1,z1=B1=null,e.current=r,sB(r),D$(),jr=o,Ur=l,mi.transition=i}else e.current=r;if(nm&&(nm=!1,Qo=e,Tp=n),i=e.pendingLanes,i===0&&(nc=null),M$(r.stateNode),An(e,Ra()),t!==null)for(s=e.onRecoverableError,r=0;r<t.length;r++)n=t[r],s(n.value,{componentStack:n.stack,digest:n.digest});if(_p)throw _p=!1,e=lj,lj=null,e;return Tp&1&&e.tag!==0&&Du(),i=e.pendingLanes,i&1?e===oj?Oh++:(Oh=0,oj=e):Oh=0,kc(),null}function Du(){if(Qo!==null){var e=NT(Tp),t=mi.transition,r=Ur;try{if(mi.transition=null,Ur=16>e?16:e,Qo===null)var s=!1;else{if(e=Qo,Qo=null,Tp=0,jr&6)throw Error(ot(331));var n=jr;for(jr|=4,jt=e.current;jt!==null;){var i=jt,l=i.child;if(jt.flags&16){var o=i.deletions;if(o!==null){for(var c=0;c<o.length;c++){var u=o[c];for(jt=u;jt!==null;){var d=jt;switch(d.tag){case 0:case 11:case 15:Th(8,d,i)}var h=d.child;if(h!==null)h.return=d,jt=h;else for(;jt!==null;){d=jt;var f=d.sibling,x=d.return;if(D5(d),d===u){jt=null;break}if(f!==null){f.return=x,jt=f;break}jt=x}}}var p=i.alternate;if(p!==null){var g=p.child;if(g!==null){p.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(g!==null)}}jt=i}}if(i.subtreeFlags&2064&&l!==null)l.return=i,jt=l;else e:for(;jt!==null;){if(i=jt,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Th(9,i,i.return)}var v=i.sibling;if(v!==null){v.return=i.return,jt=v;break e}jt=i.return}}var j=e.current;for(jt=j;jt!==null;){l=jt;var b=l.child;if(l.subtreeFlags&2064&&b!==null)b.return=l,jt=b;else e:for(l=j;jt!==null;){if(o=jt,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:iy(9,o)}}catch(k){Aa(o,o.return,k)}if(o===l){jt=null;break e}var w=o.sibling;if(w!==null){w.return=o.return,jt=w;break e}jt=o.return}}if(jr=n,kc(),ml&&typeof ml.onPostCommitFiberRoot=="function")try{ml.onPostCommitFiberRoot(Jg,e)}catch{}s=!0}return s}finally{Ur=r,mi.transition=t}}return!1}function fC(e,t,r){t=s0(r,t),t=N5(e,t,1),e=sc(e,t,1),t=dn(),e!==null&&(Yf(e,1,t),An(e,t))}function Aa(e,t,r){if(e.tag===3)fC(e,e,r);else for(;t!==null;){if(t.tag===3){fC(t,e,r);break}else if(t.tag===1){var s=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(nc===null||!nc.has(s))){e=s0(r,e),e=S5(t,e,1),t=sc(t,e,1),e=dn(),t!==null&&(Yf(t,1,e),An(t,e));break}}t=t.return}}function dB(e,t,r){var s=e.pingCache;s!==null&&s.delete(t),t=dn(),e.pingedLanes|=e.suspendedLanes&r,bs===e&&(_s&r)===r&&(ts===4||ts===3&&(_s&130023424)===_s&&500>Ra()-$N?ld(e,0):LN|=r),An(e,t)}function V5(e,t){t===0&&(e.mode&1?(t=Qx,Qx<<=1,!(Qx&130023424)&&(Qx=4194304)):t=1);var r=dn();e=eo(e,t),e!==null&&(Yf(e,t,r),An(e,r))}function uB(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),V5(e,r)}function hB(e,t){var r=0;switch(e.tag){case 13:var s=e.stateNode,n=e.memoizedState;n!==null&&(r=n.retryLane);break;case 19:s=e.stateNode;break;default:throw Error(ot(314))}s!==null&&s.delete(t),V5(e,r)}var H5;H5=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||En.current)kn=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return kn=!1,Z7(e,t,r);kn=!!(e.flags&131072)}else kn=!1,oa&&t.flags&1048576&&QT(t,wp,t.index);switch(t.lanes=0,t.tag){case 2:var s=t.type;Qm(e,t),e=t.pendingProps;var n=e0(t,Xs.current);Ou(t,r),n=IN(null,t,s,e,n,r);var i=ON();return t.flags|=1,typeof n=="object"&&n!==null&&typeof n.render=="function"&&n.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Pn(s)?(i=!0,bp(t)):i=!1,t.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,EN(t),n.updater=ny,t.stateNode=n,n._reactInternals=t,X1(t,s,e,r),t=Z1(null,t,s,!0,i,r)):(t.tag=0,oa&&i&&bN(t),an(null,t,n,r),t=t.child),t;case 16:s=t.elementType;e:{switch(Qm(e,t),e=t.pendingProps,n=s._init,s=n(s._payload),t.type=s,n=t.tag=xB(s),e=Ai(s,e),n){case 0:t=J1(null,t,s,e,r);break e;case 1:t=aC(null,t,s,e,r);break e;case 11:t=tC(null,t,s,e,r);break e;case 14:t=rC(null,t,s,Ai(s.type,e),r);break e}throw Error(ot(306,s,""))}return t;case 0:return s=t.type,n=t.pendingProps,n=t.elementType===s?n:Ai(s,n),J1(e,t,s,n,r);case 1:return s=t.type,n=t.pendingProps,n=t.elementType===s?n:Ai(s,n),aC(e,t,s,n,r);case 3:e:{if(P5(t),e===null)throw Error(ot(387));s=t.pendingProps,i=t.memoizedState,n=i.element,t5(e,t),kp(t,s,null,r);var l=t.memoizedState;if(s=l.element,i.isDehydrated)if(i={element:s,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){n=s0(Error(ot(423)),t),t=sC(e,t,s,r,n);break e}else if(s!==n){n=s0(Error(ot(424)),t),t=sC(e,t,s,r,n);break e}else for(Vn=ac(t.stateNode.containerInfo.firstChild),qn=t,oa=!0,Di=null,r=ZT(t,null,s,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(t0(),s===n){t=to(e,t,r);break e}an(e,t,s,r)}t=t.child}return t;case 5:return r5(t),e===null&&K1(t),s=t.type,n=t.pendingProps,i=e!==null?e.memoizedProps:null,l=n.children,U1(s,n)?l=null:i!==null&&U1(s,i)&&(t.flags|=32),E5(e,t),an(e,t,l,r),t.child;case 6:return e===null&&K1(t),null;case 13:return A5(e,t,r);case 4:return PN(t,t.stateNode.containerInfo),s=t.pendingProps,e===null?t.child=r0(t,null,s,r):an(e,t,s,r),t.child;case 11:return s=t.type,n=t.pendingProps,n=t.elementType===s?n:Ai(s,n),tC(e,t,s,n,r);case 7:return an(e,t,t.pendingProps,r),t.child;case 8:return an(e,t,t.pendingProps.children,r),t.child;case 12:return an(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(s=t.type._context,n=t.pendingProps,i=t.memoizedProps,l=n.value,Yr(Np,s._currentValue),s._currentValue=l,i!==null)if(Hi(i.value,l)){if(i.children===n.children&&!En.current){t=to(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var o=i.dependencies;if(o!==null){l=i.child;for(var c=o.firstContext;c!==null;){if(c.context===s){if(i.tag===1){c=Hl(-1,r&-r),c.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}i.lanes|=r,c=i.alternate,c!==null&&(c.lanes|=r),G1(i.return,r,t),o.lanes|=r;break}c=c.next}}else if(i.tag===10)l=i.type===t.type?null:i.child;else if(i.tag===18){if(l=i.return,l===null)throw Error(ot(341));l.lanes|=r,o=l.alternate,o!==null&&(o.lanes|=r),G1(l,r,t),l=i.sibling}else l=i.child;if(l!==null)l.return=i;else for(l=i;l!==null;){if(l===t){l=null;break}if(i=l.sibling,i!==null){i.return=l.return,l=i;break}l=l.return}i=l}an(e,t,n.children,r),t=t.child}return t;case 9:return n=t.type,s=t.pendingProps.children,Ou(t,r),n=gi(n),s=s(n),t.flags|=1,an(e,t,s,r),t.child;case 14:return s=t.type,n=Ai(s,t.pendingProps),n=Ai(s.type,n),rC(e,t,s,n,r);case 15:return k5(e,t,t.type,t.pendingProps,r);case 17:return s=t.type,n=t.pendingProps,n=t.elementType===s?n:Ai(s,n),Qm(e,t),t.tag=1,Pn(s)?(e=!0,bp(t)):e=!1,Ou(t,r),w5(t,s,n),X1(t,s,n,r),Z1(null,t,s,!0,e,r);case 19:return _5(e,t,r);case 22:return C5(e,t,r)}throw Error(ot(156,t.tag))};function q5(e,t){return vT(e,t)}function fB(e,t,r,s){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function fi(e,t,r,s){return new fB(e,t,r,s)}function WN(e){return e=e.prototype,!(!e||!e.isReactComponent)}function xB(e){if(typeof e=="function")return WN(e)?1:0;if(e!=null){if(e=e.$$typeof,e===oN)return 11;if(e===cN)return 14}return 2}function lc(e,t){var r=e.alternate;return r===null?(r=fi(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Jm(e,t,r,s,n,i){var l=2;if(s=e,typeof e=="function")WN(e)&&(l=1);else if(typeof e=="string")l=5;else e:switch(e){case xu:return od(r.children,n,i,t);case lN:l=8,n|=8;break;case b1:return e=fi(12,r,t,n|2),e.elementType=b1,e.lanes=i,e;case j1:return e=fi(13,r,t,n),e.elementType=j1,e.lanes=i,e;case w1:return e=fi(19,r,t,n),e.elementType=w1,e.lanes=i,e;case rT:return oy(r,n,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case eT:l=10;break e;case tT:l=9;break e;case oN:l=11;break e;case cN:l=14;break e;case To:l=16,s=null;break e}throw Error(ot(130,e==null?e:typeof e,""))}return t=fi(l,r,t,n),t.elementType=e,t.type=s,t.lanes=i,t}function od(e,t,r,s){return e=fi(7,e,s,t),e.lanes=r,e}function oy(e,t,r,s){return e=fi(22,e,s,t),e.elementType=rT,e.lanes=r,e.stateNode={isHidden:!1},e}function yb(e,t,r){return e=fi(6,e,null,t),e.lanes=r,e}function vb(e,t,r){return t=fi(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function mB(e,t,r,s,n){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Zv(0),this.expirationTimes=Zv(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Zv(0),this.identifierPrefix=s,this.onRecoverableError=n,this.mutableSourceEagerHydrationData=null}function VN(e,t,r,s,n,i,l,o,c){return e=new mB(e,t,r,o,c),t===1?(t=1,i===!0&&(t|=8)):t=0,i=fi(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:s,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},EN(i),e}function pB(e,t,r){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:fu,key:s==null?null:""+s,children:e,containerInfo:t,implementation:r}}function K5(e){if(!e)return fc;e=e._reactInternals;e:{if(Wd(e)!==e||e.tag!==1)throw Error(ot(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Pn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ot(171))}if(e.tag===1){var r=e.type;if(Pn(r))return KT(e,r,t)}return t}function G5(e,t,r,s,n,i,l,o,c){return e=VN(r,s,!0,e,n,i,l,o,c),e.context=K5(null),r=e.current,s=dn(),n=ic(r),i=Hl(s,n),i.callback=t??null,sc(r,i,n),e.current.lanes=n,Yf(e,n,s),An(e,s),e}function cy(e,t,r,s){var n=t.current,i=dn(),l=ic(n);return r=K5(r),t.context===null?t.context=r:t.pendingContext=r,t=Hl(i,l),t.payload={element:e},s=s===void 0?null:s,s!==null&&(t.callback=s),e=sc(n,t,l),e!==null&&(zi(e,n,l,i),qm(e,n,l)),l}function Op(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function xC(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function HN(e,t){xC(e,t),(e=e.alternate)&&xC(e,t)}function gB(){return null}var Q5=typeof reportError=="function"?reportError:function(e){console.error(e)};function qN(e){this._internalRoot=e}dy.prototype.render=qN.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ot(409));cy(e,t,null,null)};dy.prototype.unmount=qN.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Nd(function(){cy(null,e,null,null)}),t[Zl]=null}};function dy(e){this._internalRoot=e}dy.prototype.unstable_scheduleHydration=function(e){if(e){var t=CT();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Ro.length&&t!==0&&t<Ro[r].priority;r++);Ro.splice(r,0,e),r===0&&PT(e)}};function KN(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function uy(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function mC(){}function yB(e,t,r,s,n){if(n){if(typeof s=="function"){var i=s;s=function(){var u=Op(l);i.call(u)}}var l=G5(t,s,e,0,null,!1,!1,"",mC);return e._reactRootContainer=l,e[Zl]=l.current,ef(e.nodeType===8?e.parentNode:e),Nd(),l}for(;n=e.lastChild;)e.removeChild(n);if(typeof s=="function"){var o=s;s=function(){var u=Op(c);o.call(u)}}var c=VN(e,0,!1,null,null,!1,!1,"",mC);return e._reactRootContainer=c,e[Zl]=c.current,ef(e.nodeType===8?e.parentNode:e),Nd(function(){cy(t,c,r,s)}),c}function hy(e,t,r,s,n){var i=r._reactRootContainer;if(i){var l=i;if(typeof n=="function"){var o=n;n=function(){var c=Op(l);o.call(c)}}cy(t,l,e,n)}else l=yB(r,t,e,n,s);return Op(l)}ST=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=ph(t.pendingLanes);r!==0&&(hN(t,r|1),An(t,Ra()),!(jr&6)&&(n0=Ra()+500,kc()))}break;case 13:Nd(function(){var s=eo(e,1);if(s!==null){var n=dn();zi(s,e,1,n)}}),HN(e,1)}};fN=function(e){if(e.tag===13){var t=eo(e,134217728);if(t!==null){var r=dn();zi(t,e,134217728,r)}HN(e,134217728)}};kT=function(e){if(e.tag===13){var t=ic(e),r=eo(e,t);if(r!==null){var s=dn();zi(r,e,t,s)}HN(e,t)}};CT=function(){return Ur};ET=function(e,t){var r=Ur;try{return Ur=e,t()}finally{Ur=r}};I1=function(e,t,r){switch(t){case"input":if(k1(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var s=r[t];if(s!==e&&s.form===e.form){var n=ry(s);if(!n)throw Error(ot(90));sT(s),k1(s,n)}}}break;case"textarea":iT(e,r);break;case"select":t=r.value,t!=null&&Au(e,!!r.multiple,t,!1)}};fT=BN;xT=Nd;var vB={usingClientEntryPoint:!1,Events:[Zf,yu,ry,uT,hT,BN]},th={findFiberByHostInstance:zc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},bB={bundleType:th.bundleType,version:th.version,rendererPackageName:th.rendererPackageName,rendererConfig:th.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:mo.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=gT(e),e===null?null:e.stateNode},findFiberByHostInstance:th.findFiberByHostInstance||gB,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var im=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!im.isDisabled&&im.supportsFiber)try{Jg=im.inject(bB),ml=im}catch{}}Jn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=vB;Jn.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!KN(t))throw Error(ot(200));return pB(e,t,null,r)};Jn.createRoot=function(e,t){if(!KN(e))throw Error(ot(299));var r=!1,s="",n=Q5;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(n=t.onRecoverableError)),t=VN(e,1,!1,null,null,r,!1,s,n),e[Zl]=t.current,ef(e.nodeType===8?e.parentNode:e),new qN(t)};Jn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ot(188)):(e=Object.keys(e).join(","),Error(ot(268,e)));return e=gT(t),e=e===null?null:e.stateNode,e};Jn.flushSync=function(e){return Nd(e)};Jn.hydrate=function(e,t,r){if(!uy(t))throw Error(ot(200));return hy(null,e,t,!0,r)};Jn.hydrateRoot=function(e,t,r){if(!KN(e))throw Error(ot(405));var s=r!=null&&r.hydratedSources||null,n=!1,i="",l=Q5;if(r!=null&&(r.unstable_strictMode===!0&&(n=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(l=r.onRecoverableError)),t=G5(t,null,e,1,r??null,n,!1,i,l),e[Zl]=t.current,ef(e),s)for(e=0;e<s.length;e++)r=s[e],n=r._getVersion,n=n(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,n]:t.mutableSourceEagerHydrationData.push(r,n);return new dy(t)};Jn.render=function(e,t,r){if(!uy(t))throw Error(ot(200));return hy(null,e,t,!1,r)};Jn.unmountComponentAtNode=function(e){if(!uy(e))throw Error(ot(40));return e._reactRootContainer?(Nd(function(){hy(null,null,e,!1,function(){e._reactRootContainer=null,e[Zl]=null})}),!0):!1};Jn.unstable_batchedUpdates=BN;Jn.unstable_renderSubtreeIntoContainer=function(e,t,r,s){if(!uy(r))throw Error(ot(200));if(e==null||e._reactInternals===void 0)throw Error(ot(38));return hy(e,t,r,!1,s)};Jn.version="18.3.1-next-f1338f8080-20240426";function X5(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(X5)}catch(e){console.error(e)}}X5(),X_.exports=Jn;var GN=X_.exports,pC=GN;y1.createRoot=pC.createRoot,y1.hydrateRoot=pC.hydrateRoot;/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function df(){return df=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},df.apply(this,arguments)}var Xo;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Xo||(Xo={}));const gC="popstate";function jB(e){e===void 0&&(e={});function t(s,n){let{pathname:i,search:l,hash:o}=s.location;return uj("",{pathname:i,search:l,hash:o},n.state&&n.state.usr||null,n.state&&n.state.key||"default")}function r(s,n){return typeof n=="string"?n:Dp(n)}return NB(t,r,null,e)}function wa(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function QN(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function wB(){return Math.random().toString(36).substr(2,8)}function yC(e,t){return{usr:e.state,key:e.key,idx:t}}function uj(e,t,r,s){return r===void 0&&(r=null),df({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?P0(t):t,{state:r,key:t&&t.key||s||wB()})}function Dp(e){let{pathname:t="/",search:r="",hash:s=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),s&&s!=="#"&&(t+=s.charAt(0)==="#"?s:"#"+s),t}function P0(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let s=e.indexOf("?");s>=0&&(t.search=e.substr(s),e=e.substr(0,s)),e&&(t.pathname=e)}return t}function NB(e,t,r,s){s===void 0&&(s={});let{window:n=document.defaultView,v5Compat:i=!1}=s,l=n.history,o=Xo.Pop,c=null,u=d();u==null&&(u=0,l.replaceState(df({},l.state,{idx:u}),""));function d(){return(l.state||{idx:null}).idx}function h(){o=Xo.Pop;let y=d(),v=y==null?null:y-u;u=y,c&&c({action:o,location:g.location,delta:v})}function f(y,v){o=Xo.Push;let j=uj(g.location,y,v);u=d()+1;let b=yC(j,u),w=g.createHref(j);try{l.pushState(b,"",w)}catch(k){if(k instanceof DOMException&&k.name==="DataCloneError")throw k;n.location.assign(w)}i&&c&&c({action:o,location:g.location,delta:1})}function x(y,v){o=Xo.Replace;let j=uj(g.location,y,v);u=d();let b=yC(j,u),w=g.createHref(j);l.replaceState(b,"",w),i&&c&&c({action:o,location:g.location,delta:0})}function p(y){let v=n.location.origin!=="null"?n.location.origin:n.location.href,j=typeof y=="string"?y:Dp(y);return j=j.replace(/ $/,"%20"),wa(v,"No window.location.(origin|href) available to create URL for href: "+j),new URL(j,v)}let g={get action(){return o},get location(){return e(n,l)},listen(y){if(c)throw new Error("A history only accepts one active listener");return n.addEventListener(gC,h),c=y,()=>{n.removeEventListener(gC,h),c=null}},createHref(y){return t(n,y)},createURL:p,encodeLocation(y){let v=p(y);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:f,replace:x,go(y){return l.go(y)}};return g}var vC;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(vC||(vC={}));function SB(e,t,r){return r===void 0&&(r="/"),kB(e,t,r)}function kB(e,t,r,s){let n=typeof t=="string"?P0(t):t,i=i0(n.pathname||"/",r);if(i==null)return null;let l=Y5(e);CB(l);let o=null;for(let c=0;o==null&&c<l.length;++c){let u=MB(i);o=FB(l[c],u)}return o}function Y5(e,t,r,s){t===void 0&&(t=[]),r===void 0&&(r=[]),s===void 0&&(s="");let n=(i,l,o)=>{let c={relativePath:o===void 0?i.path||"":o,caseSensitive:i.caseSensitive===!0,childrenIndex:l,route:i};c.relativePath.startsWith("/")&&(wa(c.relativePath.startsWith(s),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(s.length));let u=oc([s,c.relativePath]),d=r.concat(c);i.children&&i.children.length>0&&(wa(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),Y5(i.children,t,d,u)),!(i.path==null&&!i.index)&&t.push({path:u,score:OB(u,i.index),routesMeta:d})};return e.forEach((i,l)=>{var o;if(i.path===""||!((o=i.path)!=null&&o.includes("?")))n(i,l);else for(let c of J5(i.path))n(i,l,c)}),t}function J5(e){let t=e.split("/");if(t.length===0)return[];let[r,...s]=t,n=r.endsWith("?"),i=r.replace(/\?$/,"");if(s.length===0)return n?[i,""]:[i];let l=J5(s.join("/")),o=[];return o.push(...l.map(c=>c===""?i:[i,c].join("/"))),n&&o.push(...l),o.map(c=>e.startsWith("/")&&c===""?"/":c)}function CB(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:DB(t.routesMeta.map(s=>s.childrenIndex),r.routesMeta.map(s=>s.childrenIndex)))}const EB=/^:[\w-]+$/,PB=3,AB=2,_B=1,TB=10,IB=-2,bC=e=>e==="*";function OB(e,t){let r=e.split("/"),s=r.length;return r.some(bC)&&(s+=IB),t&&(s+=AB),r.filter(n=>!bC(n)).reduce((n,i)=>n+(EB.test(i)?PB:i===""?_B:TB),s)}function DB(e,t){return e.length===t.length&&e.slice(0,-1).every((s,n)=>s===t[n])?e[e.length-1]-t[t.length-1]:0}function FB(e,t,r){let{routesMeta:s}=e,n={},i="/",l=[];for(let o=0;o<s.length;++o){let c=s[o],u=o===s.length-1,d=i==="/"?t:t.slice(i.length)||"/",h=hj({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),f=c.route;if(!h)return null;Object.assign(n,h.params),l.push({params:n,pathname:oc([i,h.pathname]),pathnameBase:UB(oc([i,h.pathnameBase])),route:f}),h.pathnameBase!=="/"&&(i=oc([i,h.pathnameBase]))}return l}function hj(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,s]=RB(e.path,e.caseSensitive,e.end),n=t.match(r);if(!n)return null;let i=n[0],l=i.replace(/(.)\/+$/,"$1"),o=n.slice(1);return{params:s.reduce((u,d,h)=>{let{paramName:f,isOptional:x}=d;if(f==="*"){let g=o[h]||"";l=i.slice(0,i.length-g.length).replace(/(.)\/+$/,"$1")}const p=o[h];return x&&!p?u[f]=void 0:u[f]=(p||"").replace(/%2F/g,"/"),u},{}),pathname:i,pathnameBase:l,pattern:e}}function RB(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),QN(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let s=[],n="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,o,c)=>(s.push({paramName:o,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(s.push({paramName:"*"}),n+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?n+="\\/*$":e!==""&&e!=="/"&&(n+="(?:(?=\\/|$))"),[new RegExp(n,t?void 0:"i"),s]}function MB(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return QN(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function i0(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,s=e.charAt(r);return s&&s!=="/"?null:e.slice(r)||"/"}const LB=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,$B=e=>LB.test(e);function BB(e,t){t===void 0&&(t="/");let{pathname:r,search:s="",hash:n=""}=typeof e=="string"?P0(e):e,i;if(r)if($B(r))i=r;else{if(r.includes("//")){let l=r;r=r.replace(/\/\/+/g,"/"),QN(!1,"Pathnames cannot have embedded double slashes - normalizing "+(l+" -> "+r))}r.startsWith("/")?i=jC(r.substring(1),"/"):i=jC(r,t)}else i=t;return{pathname:i,search:WB(s),hash:VB(n)}}function jC(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(n=>{n===".."?r.length>1&&r.pop():n!=="."&&r.push(n)}),r.length>1?r.join("/"):"/"}function bb(e,t,r,s){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function zB(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function XN(e,t){let r=zB(e);return t?r.map((s,n)=>n===r.length-1?s.pathname:s.pathnameBase):r.map(s=>s.pathnameBase)}function YN(e,t,r,s){s===void 0&&(s=!1);let n;typeof e=="string"?n=P0(e):(n=df({},e),wa(!n.pathname||!n.pathname.includes("?"),bb("?","pathname","search",n)),wa(!n.pathname||!n.pathname.includes("#"),bb("#","pathname","hash",n)),wa(!n.search||!n.search.includes("#"),bb("#","search","hash",n)));let i=e===""||n.pathname==="",l=i?"/":n.pathname,o;if(l==null)o=r;else{let h=t.length-1;if(!s&&l.startsWith("..")){let f=l.split("/");for(;f[0]==="..";)f.shift(),h-=1;n.pathname=f.join("/")}o=h>=0?t[h]:"/"}let c=BB(n,o),u=l&&l!=="/"&&l.endsWith("/"),d=(i||l===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}const oc=e=>e.join("/").replace(/\/\/+/g,"/"),UB=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),WB=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,VB=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function HB(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const Z5=["post","put","patch","delete"];new Set(Z5);const qB=["get",...Z5];new Set(qB);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function uf(){return uf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},uf.apply(this,arguments)}const fy=m.createContext(null),e6=m.createContext(null),po=m.createContext(null),xy=m.createContext(null),wl=m.createContext({outlet:null,matches:[],isDataRoute:!1}),t6=m.createContext(null);function KB(e,t){let{relative:r}=t===void 0?{}:t;A0()||wa(!1);let{basename:s,navigator:n}=m.useContext(po),{hash:i,pathname:l,search:o}=my(e,{relative:r}),c=l;return s!=="/"&&(c=l==="/"?s:oc([s,l])),n.createHref({pathname:c,search:o,hash:i})}function A0(){return m.useContext(xy)!=null}function Vd(){return A0()||wa(!1),m.useContext(xy).location}function r6(e){m.useContext(po).static||m.useLayoutEffect(e)}function Hd(){let{isDataRoute:e}=m.useContext(wl);return e?oz():GB()}function GB(){A0()||wa(!1);let e=m.useContext(fy),{basename:t,future:r,navigator:s}=m.useContext(po),{matches:n}=m.useContext(wl),{pathname:i}=Vd(),l=JSON.stringify(XN(n,r.v7_relativeSplatPath)),o=m.useRef(!1);return r6(()=>{o.current=!0}),m.useCallback(function(u,d){if(d===void 0&&(d={}),!o.current)return;if(typeof u=="number"){s.go(u);return}let h=YN(u,JSON.parse(l),i,d.relative==="path");e==null&&t!=="/"&&(h.pathname=h.pathname==="/"?t:oc([t,h.pathname])),(d.replace?s.replace:s.push)(h,d.state,d)},[t,s,l,i,e])}const QB=m.createContext(null);function XB(e){let t=m.useContext(wl).outlet;return t&&m.createElement(QB.Provider,{value:e},t)}function a6(){let{matches:e}=m.useContext(wl),t=e[e.length-1];return t?t.params:{}}function my(e,t){let{relative:r}=t===void 0?{}:t,{future:s}=m.useContext(po),{matches:n}=m.useContext(wl),{pathname:i}=Vd(),l=JSON.stringify(XN(n,s.v7_relativeSplatPath));return m.useMemo(()=>YN(e,JSON.parse(l),i,r==="path"),[e,l,i,r])}function YB(e,t){return JB(e,t)}function JB(e,t,r,s){A0()||wa(!1);let{navigator:n}=m.useContext(po),{matches:i}=m.useContext(wl),l=i[i.length-1],o=l?l.params:{};l&&l.pathname;let c=l?l.pathnameBase:"/";l&&l.route;let u=Vd(),d;if(t){var h;let y=typeof t=="string"?P0(t):t;c==="/"||(h=y.pathname)!=null&&h.startsWith(c)||wa(!1),d=y}else d=u;let f=d.pathname||"/",x=f;if(c!=="/"){let y=c.replace(/^\//,"").split("/");x="/"+f.replace(/^\//,"").split("/").slice(y.length).join("/")}let p=SB(e,{pathname:x}),g=az(p&&p.map(y=>Object.assign({},y,{params:Object.assign({},o,y.params),pathname:oc([c,n.encodeLocation?n.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?c:oc([c,n.encodeLocation?n.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),i,r,s);return t&&g?m.createElement(xy.Provider,{value:{location:uf({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:Xo.Pop}},g):g}function ZB(){let e=lz(),t=HB(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,n={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return m.createElement(m.Fragment,null,m.createElement("h2",null,"Unexpected Application Error!"),m.createElement("h3",{style:{fontStyle:"italic"}},t),r?m.createElement("pre",{style:n},r):null,null)}const ez=m.createElement(ZB,null);class tz extends m.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?m.createElement(wl.Provider,{value:this.props.routeContext},m.createElement(t6.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function rz(e){let{routeContext:t,match:r,children:s}=e,n=m.useContext(fy);return n&&n.static&&n.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=r.route.id),m.createElement(wl.Provider,{value:t},s)}function az(e,t,r,s){var n;if(t===void 0&&(t=[]),r===void 0&&(r=null),s===void 0&&(s=null),e==null){var i;if(!r)return null;if(r.errors)e=r.matches;else if((i=s)!=null&&i.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let l=e,o=(n=r)==null?void 0:n.errors;if(o!=null){let d=l.findIndex(h=>h.route.id&&(o==null?void 0:o[h.route.id])!==void 0);d>=0||wa(!1),l=l.slice(0,Math.min(l.length,d+1))}let c=!1,u=-1;if(r&&s&&s.v7_partialHydration)for(let d=0;d<l.length;d++){let h=l[d];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(u=d),h.route.id){let{loaderData:f,errors:x}=r,p=h.route.loader&&f[h.route.id]===void 0&&(!x||x[h.route.id]===void 0);if(h.route.lazy||p){c=!0,u>=0?l=l.slice(0,u+1):l=[l[0]];break}}}return l.reduceRight((d,h,f)=>{let x,p=!1,g=null,y=null;r&&(x=o&&h.route.id?o[h.route.id]:void 0,g=h.route.errorElement||ez,c&&(u<0&&f===0?(cz("route-fallback"),p=!0,y=null):u===f&&(p=!0,y=h.route.hydrateFallbackElement||null)));let v=t.concat(l.slice(0,f+1)),j=()=>{let b;return x?b=g:p?b=y:h.route.Component?b=m.createElement(h.route.Component,null):h.route.element?b=h.route.element:b=d,m.createElement(rz,{match:h,routeContext:{outlet:d,matches:v,isDataRoute:r!=null},children:b})};return r&&(h.route.ErrorBoundary||h.route.errorElement||f===0)?m.createElement(tz,{location:r.location,revalidation:r.revalidation,component:g,error:x,children:j(),routeContext:{outlet:null,matches:v,isDataRoute:!0}}):j()},null)}var s6=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(s6||{}),n6=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(n6||{});function sz(e){let t=m.useContext(fy);return t||wa(!1),t}function nz(e){let t=m.useContext(e6);return t||wa(!1),t}function iz(e){let t=m.useContext(wl);return t||wa(!1),t}function i6(e){let t=iz(),r=t.matches[t.matches.length-1];return r.route.id||wa(!1),r.route.id}function lz(){var e;let t=m.useContext(t6),r=nz(),s=i6();return t!==void 0?t:(e=r.errors)==null?void 0:e[s]}function oz(){let{router:e}=sz(s6.UseNavigateStable),t=i6(n6.UseNavigateStable),r=m.useRef(!1);return r6(()=>{r.current=!0}),m.useCallback(function(n,i){i===void 0&&(i={}),r.current&&(typeof n=="number"?e.navigate(n):e.navigate(n,uf({fromRouteId:t},i)))},[e,t])}const wC={};function cz(e,t,r){wC[e]||(wC[e]=!0)}function dz(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function Fp(e){let{to:t,replace:r,state:s,relative:n}=e;A0()||wa(!1);let{future:i,static:l}=m.useContext(po),{matches:o}=m.useContext(wl),{pathname:c}=Vd(),u=Hd(),d=YN(t,XN(o,i.v7_relativeSplatPath),c,n==="path"),h=JSON.stringify(d);return m.useEffect(()=>u(JSON.parse(h),{replace:r,state:s,relative:n}),[u,h,n,r,s]),null}function uz(e){return XB(e.context)}function rr(e){wa(!1)}function hz(e){let{basename:t="/",children:r=null,location:s,navigationType:n=Xo.Pop,navigator:i,static:l=!1,future:o}=e;A0()&&wa(!1);let c=t.replace(/^\/*/,"/"),u=m.useMemo(()=>({basename:c,navigator:i,static:l,future:uf({v7_relativeSplatPath:!1},o)}),[c,o,i,l]);typeof s=="string"&&(s=P0(s));let{pathname:d="/",search:h="",hash:f="",state:x=null,key:p="default"}=s,g=m.useMemo(()=>{let y=i0(d,c);return y==null?null:{location:{pathname:y,search:h,hash:f,state:x,key:p},navigationType:n}},[c,d,h,f,x,p,n]);return g==null?null:m.createElement(po.Provider,{value:u},m.createElement(xy.Provider,{children:r,value:g}))}function fz(e){let{children:t,location:r}=e;return YB(fj(t),r)}new Promise(()=>{});function fj(e,t){t===void 0&&(t=[]);let r=[];return m.Children.forEach(e,(s,n)=>{if(!m.isValidElement(s))return;let i=[...t,n];if(s.type===m.Fragment){r.push.apply(r,fj(s.props.children,i));return}s.type!==rr&&wa(!1),!s.props.index||!s.props.children||wa(!1);let l={id:s.props.id||i.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(l.children=fj(s.props.children,i)),r.push(l)}),r}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Rp(){return Rp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Rp.apply(this,arguments)}function l6(e,t){if(e==null)return{};var r={},s=Object.keys(e),n,i;for(i=0;i<s.length;i++)n=s[i],!(t.indexOf(n)>=0)&&(r[n]=e[n]);return r}function xz(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function mz(e,t){return e.button===0&&(!t||t==="_self")&&!xz(e)}function xj(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,r)=>{let s=e[r];return t.concat(Array.isArray(s)?s.map(n=>[r,n]):[[r,s]])},[]))}function pz(e,t){let r=xj(e);return t&&t.forEach((s,n)=>{r.has(n)||t.getAll(n).forEach(i=>{r.append(n,i)})}),r}const gz=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],yz=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],vz="6";try{window.__reactRouterVersion=vz}catch{}const bz=m.createContext({isTransitioning:!1}),jz="startTransition",NC=G_[jz];function wz(e){let{basename:t,children:r,future:s,window:n}=e,i=m.useRef();i.current==null&&(i.current=jB({window:n,v5Compat:!0}));let l=i.current,[o,c]=m.useState({action:l.action,location:l.location}),{v7_startTransition:u}=s||{},d=m.useCallback(h=>{u&&NC?NC(()=>c(h)):c(h)},[c,u]);return m.useLayoutEffect(()=>l.listen(d),[l,d]),m.useEffect(()=>dz(s),[s]),m.createElement(hz,{basename:t,children:r,location:o.location,navigationType:o.action,navigator:l,future:s})}const Nz=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Sz=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,kz=m.forwardRef(function(t,r){let{onClick:s,relative:n,reloadDocument:i,replace:l,state:o,target:c,to:u,preventScrollReset:d,viewTransition:h}=t,f=l6(t,gz),{basename:x}=m.useContext(po),p,g=!1;if(typeof u=="string"&&Sz.test(u)&&(p=u,Nz))try{let b=new URL(window.location.href),w=u.startsWith("//")?new URL(b.protocol+u):new URL(u),k=i0(w.pathname,x);w.origin===b.origin&&k!=null?u=k+w.search+w.hash:g=!0}catch{}let y=KB(u,{relative:n}),v=Pz(u,{replace:l,state:o,target:c,preventScrollReset:d,relative:n,viewTransition:h});function j(b){s&&s(b),b.defaultPrevented||v(b)}return m.createElement("a",Rp({},f,{href:p||y,onClick:g||i?s:j,ref:r,target:c}))}),Cz=m.forwardRef(function(t,r){let{"aria-current":s="page",caseSensitive:n=!1,className:i="",end:l=!1,style:o,to:c,viewTransition:u,children:d}=t,h=l6(t,yz),f=my(c,{relative:h.relative}),x=Vd(),p=m.useContext(e6),{navigator:g,basename:y}=m.useContext(po),v=p!=null&&_z(f)&&u===!0,j=g.encodeLocation?g.encodeLocation(f).pathname:f.pathname,b=x.pathname,w=p&&p.navigation&&p.navigation.location?p.navigation.location.pathname:null;n||(b=b.toLowerCase(),w=w?w.toLowerCase():null,j=j.toLowerCase()),w&&y&&(w=i0(w,y)||w);const k=j!=="/"&&j.endsWith("/")?j.length-1:j.length;let N=b===j||!l&&b.startsWith(j)&&b.charAt(k)==="/",S=w!=null&&(w===j||!l&&w.startsWith(j)&&w.charAt(j.length)==="/"),_={isActive:N,isPending:S,isTransitioning:v},O=N?s:void 0,E;typeof i=="function"?E=i(_):E=[i,N?"active":null,S?"pending":null,v?"transitioning":null].filter(Boolean).join(" ");let R=typeof o=="function"?o(_):o;return m.createElement(kz,Rp({},h,{"aria-current":O,className:E,ref:r,style:R,to:c,viewTransition:u}),typeof d=="function"?d(_):d)});var mj;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(mj||(mj={}));var SC;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(SC||(SC={}));function Ez(e){let t=m.useContext(fy);return t||wa(!1),t}function Pz(e,t){let{target:r,replace:s,state:n,preventScrollReset:i,relative:l,viewTransition:o}=t===void 0?{}:t,c=Hd(),u=Vd(),d=my(e,{relative:l});return m.useCallback(h=>{if(mz(h,r)){h.preventDefault();let f=s!==void 0?s:Dp(u)===Dp(d);c(e,{replace:f,state:n,preventScrollReset:i,relative:l,viewTransition:o})}},[u,c,d,s,n,r,e,i,l,o])}function Az(e){let t=m.useRef(xj(e)),r=m.useRef(!1),s=Vd(),n=m.useMemo(()=>pz(s.search,r.current?null:t.current),[s.search]),i=Hd(),l=m.useCallback((o,c)=>{const u=xj(typeof o=="function"?o(n):o);r.current=!0,i("?"+u,c)},[i,n]);return[n,l]}function _z(e,t){t===void 0&&(t={});let r=m.useContext(bz);r==null&&wa(!1);let{basename:s}=Ez(mj.useViewTransitionState),n=my(e,{relative:t.relative});if(!r.isTransitioning)return!1;let i=i0(r.currentLocation.pathname,s)||r.currentLocation.pathname,l=i0(r.nextLocation.pathname,s)||r.nextLocation.pathname;return hj(n.pathname,l)!=null||hj(n.pathname,i)!=null}var _0=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Tz={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e),setInterval:(e,t)=>setInterval(e,t),clearInterval:e=>clearInterval(e)},$o,Zw,C_,Iz=(C_=class{constructor(){Ft(this,$o,Tz);Ft(this,Zw,!1)}setTimeoutProvider(e){bt(this,$o,e)}setTimeout(e,t){return ce(this,$o).setTimeout(e,t)}clearTimeout(e){ce(this,$o).clearTimeout(e)}setInterval(e,t){return ce(this,$o).setInterval(e,t)}clearInterval(e){ce(this,$o).clearInterval(e)}},$o=new WeakMap,Zw=new WeakMap,C_),Vc=new Iz;function Oz(e){setTimeout(e,0)}var Sd=typeof window>"u"||"Deno"in globalThis;function sn(){}function Dz(e,t){return typeof e=="function"?e(t):e}function pj(e){return typeof e=="number"&&e>=0&&e!==1/0}function o6(e,t){return Math.max(e+(t||0)-Date.now(),0)}function cc(e,t){return typeof e=="function"?e(t):e}function di(e,t){return typeof e=="function"?e(t):e}function kC(e,t){const{type:r="all",exact:s,fetchStatus:n,predicate:i,queryKey:l,stale:o}=e;if(l){if(s){if(t.queryHash!==JN(l,t.options))return!1}else if(!hf(t.queryKey,l))return!1}if(r!=="all"){const c=t.isActive();if(r==="active"&&!c||r==="inactive"&&c)return!1}return!(typeof o=="boolean"&&t.isStale()!==o||n&&n!==t.state.fetchStatus||i&&!i(t))}function CC(e,t){const{exact:r,status:s,predicate:n,mutationKey:i}=e;if(i){if(!t.options.mutationKey)return!1;if(r){if(kd(t.options.mutationKey)!==kd(i))return!1}else if(!hf(t.options.mutationKey,i))return!1}return!(s&&t.state.status!==s||n&&!n(t))}function JN(e,t){return((t==null?void 0:t.queryKeyHashFn)||kd)(e)}function kd(e){return JSON.stringify(e,(t,r)=>gj(r)?Object.keys(r).sort().reduce((s,n)=>(s[n]=r[n],s),{}):r)}function hf(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(r=>hf(e[r],t[r])):!1}var Fz=Object.prototype.hasOwnProperty;function c6(e,t){if(e===t)return e;const r=EC(e)&&EC(t);if(!r&&!(gj(e)&&gj(t)))return t;const n=(r?e:Object.keys(e)).length,i=r?t:Object.keys(t),l=i.length,o=r?new Array(l):{};let c=0;for(let u=0;u<l;u++){const d=r?u:i[u],h=e[d],f=t[d];if(h===f){o[d]=h,(r?u<n:Fz.call(e,d))&&c++;continue}if(h===null||f===null||typeof h!="object"||typeof f!="object"){o[d]=f;continue}const x=c6(h,f);o[d]=x,x===h&&c++}return n===l&&c===n?e:o}function Mp(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}function EC(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function gj(e){if(!PC(e))return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!PC(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function PC(e){return Object.prototype.toString.call(e)==="[object Object]"}function Rz(e){return new Promise(t=>{Vc.setTimeout(t,e)})}function yj(e,t,r){return typeof r.structuralSharing=="function"?r.structuralSharing(e,t):r.structuralSharing!==!1?c6(e,t):t}function Mz(e,t,r=0){const s=[...e,t];return r&&s.length>r?s.slice(1):s}function Lz(e,t,r=0){const s=[t,...e];return r&&s.length>r?s.slice(0,-1):s}var ZN=Symbol();function d6(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===ZN?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}function u6(e,t){return typeof e=="function"?e(...t):!!e}var Jc,Bo,zu,E_,$z=(E_=class extends _0{constructor(){super();Ft(this,Jc);Ft(this,Bo);Ft(this,zu);bt(this,zu,t=>{if(!Sd&&window.addEventListener){const r=()=>t();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){ce(this,Bo)||this.setEventListener(ce(this,zu))}onUnsubscribe(){var t;this.hasListeners()||((t=ce(this,Bo))==null||t.call(this),bt(this,Bo,void 0))}setEventListener(t){var r;bt(this,zu,t),(r=ce(this,Bo))==null||r.call(this),bt(this,Bo,t(s=>{typeof s=="boolean"?this.setFocused(s):this.onFocus()}))}setFocused(t){ce(this,Jc)!==t&&(bt(this,Jc,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(r=>{r(t)})}isFocused(){var t;return typeof ce(this,Jc)=="boolean"?ce(this,Jc):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},Jc=new WeakMap,Bo=new WeakMap,zu=new WeakMap,E_),e2=new $z;function vj(){let e,t;const r=new Promise((n,i)=>{e=n,t=i});r.status="pending",r.catch(()=>{});function s(n){Object.assign(r,n),delete r.resolve,delete r.reject}return r.resolve=n=>{s({status:"fulfilled",value:n}),e(n)},r.reject=n=>{s({status:"rejected",reason:n}),t(n)},r}var Bz=Oz;function zz(){let e=[],t=0,r=o=>{o()},s=o=>{o()},n=Bz;const i=o=>{t?e.push(o):n(()=>{r(o)})},l=()=>{const o=e;e=[],o.length&&n(()=>{s(()=>{o.forEach(c=>{r(c)})})})};return{batch:o=>{let c;t++;try{c=o()}finally{t--,t||l()}return c},batchCalls:o=>(...c)=>{i(()=>{o(...c)})},schedule:i,setNotifyFunction:o=>{r=o},setBatchNotifyFunction:o=>{s=o},setScheduler:o=>{n=o}}}var Za=zz(),Uu,zo,Wu,P_,Uz=(P_=class extends _0{constructor(){super();Ft(this,Uu,!0);Ft(this,zo);Ft(this,Wu);bt(this,Wu,t=>{if(!Sd&&window.addEventListener){const r=()=>t(!0),s=()=>t(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",s,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",s)}}})}onSubscribe(){ce(this,zo)||this.setEventListener(ce(this,Wu))}onUnsubscribe(){var t;this.hasListeners()||((t=ce(this,zo))==null||t.call(this),bt(this,zo,void 0))}setEventListener(t){var r;bt(this,Wu,t),(r=ce(this,zo))==null||r.call(this),bt(this,zo,t(this.setOnline.bind(this)))}setOnline(t){ce(this,Uu)!==t&&(bt(this,Uu,t),this.listeners.forEach(s=>{s(t)}))}isOnline(){return ce(this,Uu)}},Uu=new WeakMap,zo=new WeakMap,Wu=new WeakMap,P_),Lp=new Uz;function Wz(e){return Math.min(1e3*2**e,3e4)}function h6(e){return(e??"online")==="online"?Lp.isOnline():!0}var bj=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function f6(e){let t=!1,r=0,s;const n=vj(),i=()=>n.status!=="pending",l=g=>{var y;if(!i()){const v=new bj(g);f(v),(y=e.onCancel)==null||y.call(e,v)}},o=()=>{t=!0},c=()=>{t=!1},u=()=>e2.isFocused()&&(e.networkMode==="always"||Lp.isOnline())&&e.canRun(),d=()=>h6(e.networkMode)&&e.canRun(),h=g=>{i()||(s==null||s(),n.resolve(g))},f=g=>{i()||(s==null||s(),n.reject(g))},x=()=>new Promise(g=>{var y;s=v=>{(i()||u())&&g(v)},(y=e.onPause)==null||y.call(e)}).then(()=>{var g;s=void 0,i()||(g=e.onContinue)==null||g.call(e)}),p=()=>{if(i())return;let g;const y=r===0?e.initialPromise:void 0;try{g=y??e.fn()}catch(v){g=Promise.reject(v)}Promise.resolve(g).then(h).catch(v=>{var N;if(i())return;const j=e.retry??(Sd?0:3),b=e.retryDelay??Wz,w=typeof b=="function"?b(r,v):b,k=j===!0||typeof j=="number"&&r<j||typeof j=="function"&&j(r,v);if(t||!k){f(v);return}r++,(N=e.onFail)==null||N.call(e,r,v),Rz(w).then(()=>u()?void 0:x()).then(()=>{t?f(v):p()})})};return{promise:n,status:()=>n.status,cancel:l,continue:()=>(s==null||s(),n),cancelRetry:o,continueRetry:c,canStart:d,start:()=>(d()?p():x().then(p),n)}}var Zc,A_,x6=(A_=class{constructor(){Ft(this,Zc)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),pj(this.gcTime)&&bt(this,Zc,Vc.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(Sd?1/0:5*60*1e3))}clearGcTimeout(){ce(this,Zc)&&(Vc.clearTimeout(ce(this,Zc)),bt(this,Zc,void 0))}},Zc=new WeakMap,A_),ed,Vu,oi,td,us,Hf,rd,Ti,Al,__,Vz=(__=class extends x6{constructor(t){super();Ft(this,Ti);Ft(this,ed);Ft(this,Vu);Ft(this,oi);Ft(this,td);Ft(this,us);Ft(this,Hf);Ft(this,rd);bt(this,rd,!1),bt(this,Hf,t.defaultOptions),this.setOptions(t.options),this.observers=[],bt(this,td,t.client),bt(this,oi,ce(this,td).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,bt(this,ed,_C(this.options)),this.state=t.state??ce(this,ed),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=ce(this,us))==null?void 0:t.promise}setOptions(t){if(this.options={...ce(this,Hf),...t},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const r=_C(this.options);r.data!==void 0&&(this.setState(AC(r.data,r.dataUpdatedAt)),bt(this,ed,r))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&ce(this,oi).remove(this)}setData(t,r){const s=yj(this.state.data,t,this.options);return lr(this,Ti,Al).call(this,{data:s,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),s}setState(t,r){lr(this,Ti,Al).call(this,{type:"setState",state:t,setStateOptions:r})}cancel(t){var s,n;const r=(s=ce(this,us))==null?void 0:s.promise;return(n=ce(this,us))==null||n.cancel(t),r?r.then(sn).catch(sn):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(ce(this,ed))}isActive(){return this.observers.some(t=>di(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===ZN||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>cc(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!o6(this.state.dataUpdatedAt,t)}onFocus(){var r;const t=this.observers.find(s=>s.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(r=ce(this,us))==null||r.continue()}onOnline(){var r;const t=this.observers.find(s=>s.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(r=ce(this,us))==null||r.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),ce(this,oi).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(r=>r!==t),this.observers.length||(ce(this,us)&&(ce(this,rd)?ce(this,us).cancel({revert:!0}):ce(this,us).cancelRetry()),this.scheduleGc()),ce(this,oi).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||lr(this,Ti,Al).call(this,{type:"invalidate"})}async fetch(t,r){var c,u,d,h,f,x,p,g,y,v,j,b;if(this.state.fetchStatus!=="idle"&&((c=ce(this,us))==null?void 0:c.status())!=="rejected"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(ce(this,us))return ce(this,us).continueRetry(),ce(this,us).promise}if(t&&this.setOptions(t),!this.options.queryFn){const w=this.observers.find(k=>k.options.queryFn);w&&this.setOptions(w.options)}const s=new AbortController,n=w=>{Object.defineProperty(w,"signal",{enumerable:!0,get:()=>(bt(this,rd,!0),s.signal)})},i=()=>{const w=d6(this.options,r),N=(()=>{const S={client:ce(this,td),queryKey:this.queryKey,meta:this.meta};return n(S),S})();return bt(this,rd,!1),this.options.persister?this.options.persister(w,N,this):w(N)},o=(()=>{const w={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:ce(this,td),state:this.state,fetchFn:i};return n(w),w})();(u=this.options.behavior)==null||u.onFetch(o,this),bt(this,Vu,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((d=o.fetchOptions)==null?void 0:d.meta))&&lr(this,Ti,Al).call(this,{type:"fetch",meta:(h=o.fetchOptions)==null?void 0:h.meta}),bt(this,us,f6({initialPromise:r==null?void 0:r.initialPromise,fn:o.fetchFn,onCancel:w=>{w instanceof bj&&w.revert&&this.setState({...ce(this,Vu),fetchStatus:"idle"}),s.abort()},onFail:(w,k)=>{lr(this,Ti,Al).call(this,{type:"failed",failureCount:w,error:k})},onPause:()=>{lr(this,Ti,Al).call(this,{type:"pause"})},onContinue:()=>{lr(this,Ti,Al).call(this,{type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0}));try{const w=await ce(this,us).start();if(w===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(w),(x=(f=ce(this,oi).config).onSuccess)==null||x.call(f,w,this),(g=(p=ce(this,oi).config).onSettled)==null||g.call(p,w,this.state.error,this),w}catch(w){if(w instanceof bj){if(w.silent)return ce(this,us).promise;if(w.revert){if(this.state.data===void 0)throw w;return this.state.data}}throw lr(this,Ti,Al).call(this,{type:"error",error:w}),(v=(y=ce(this,oi).config).onError)==null||v.call(y,w,this),(b=(j=ce(this,oi).config).onSettled)==null||b.call(j,this.state.data,w,this),w}finally{this.scheduleGc()}}},ed=new WeakMap,Vu=new WeakMap,oi=new WeakMap,td=new WeakMap,us=new WeakMap,Hf=new WeakMap,rd=new WeakMap,Ti=new WeakSet,Al=function(t){const r=s=>{switch(t.type){case"failed":return{...s,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...s,fetchStatus:"paused"};case"continue":return{...s,fetchStatus:"fetching"};case"fetch":return{...s,...m6(s.data,this.options),fetchMeta:t.meta??null};case"success":const n={...s,...AC(t.data,t.dataUpdatedAt),dataUpdateCount:s.dataUpdateCount+1,...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return bt(this,Vu,t.manual?n:void 0),n;case"error":const i=t.error;return{...s,error:i,errorUpdateCount:s.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:s.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error"};case"invalidate":return{...s,isInvalidated:!0};case"setState":return{...s,...t.state}}};this.state=r(this.state),Za.batch(()=>{this.observers.forEach(s=>{s.onQueryUpdate()}),ce(this,oi).notify({query:this,type:"updated",action:t})})},__);function m6(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:h6(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function AC(e,t){return{data:e,dataUpdatedAt:t??Date.now(),error:null,isInvalidated:!1,status:"success"}}function _C(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,r=t!==void 0,s=r?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?s??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var vn,yr,qf,en,ad,Hu,Dl,Uo,Kf,qu,Ku,sd,nd,Wo,Gu,Ir,yh,jj,wj,Nj,Sj,kj,Cj,Ej,p6,T_,Hz=(T_=class extends _0{constructor(t,r){super();Ft(this,Ir);Ft(this,vn);Ft(this,yr);Ft(this,qf);Ft(this,en);Ft(this,ad);Ft(this,Hu);Ft(this,Dl);Ft(this,Uo);Ft(this,Kf);Ft(this,qu);Ft(this,Ku);Ft(this,sd);Ft(this,nd);Ft(this,Wo);Ft(this,Gu,new Set);this.options=r,bt(this,vn,t),bt(this,Uo,null),bt(this,Dl,vj()),this.bindMethods(),this.setOptions(r)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(ce(this,yr).addObserver(this),TC(ce(this,yr),this.options)?lr(this,Ir,yh).call(this):this.updateResult(),lr(this,Ir,Sj).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Pj(ce(this,yr),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Pj(ce(this,yr),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,lr(this,Ir,kj).call(this),lr(this,Ir,Cj).call(this),ce(this,yr).removeObserver(this)}setOptions(t){const r=this.options,s=ce(this,yr);if(this.options=ce(this,vn).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof di(this.options.enabled,ce(this,yr))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");lr(this,Ir,Ej).call(this),ce(this,yr).setOptions(this.options),r._defaulted&&!Mp(this.options,r)&&ce(this,vn).getQueryCache().notify({type:"observerOptionsUpdated",query:ce(this,yr),observer:this});const n=this.hasListeners();n&&IC(ce(this,yr),s,this.options,r)&&lr(this,Ir,yh).call(this),this.updateResult(),n&&(ce(this,yr)!==s||di(this.options.enabled,ce(this,yr))!==di(r.enabled,ce(this,yr))||cc(this.options.staleTime,ce(this,yr))!==cc(r.staleTime,ce(this,yr)))&&lr(this,Ir,jj).call(this);const i=lr(this,Ir,wj).call(this);n&&(ce(this,yr)!==s||di(this.options.enabled,ce(this,yr))!==di(r.enabled,ce(this,yr))||i!==ce(this,Wo))&&lr(this,Ir,Nj).call(this,i)}getOptimisticResult(t){const r=ce(this,vn).getQueryCache().build(ce(this,vn),t),s=this.createResult(r,t);return Kz(this,s)&&(bt(this,en,s),bt(this,Hu,this.options),bt(this,ad,ce(this,yr).state)),s}getCurrentResult(){return ce(this,en)}trackResult(t,r){return new Proxy(t,{get:(s,n)=>(this.trackProp(n),r==null||r(n),n==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&ce(this,Dl).status==="pending"&&ce(this,Dl).reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(s,n))})}trackProp(t){ce(this,Gu).add(t)}getCurrentQuery(){return ce(this,yr)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const r=ce(this,vn).defaultQueryOptions(t),s=ce(this,vn).getQueryCache().build(ce(this,vn),r);return s.fetch().then(()=>this.createResult(s,r))}fetch(t){return lr(this,Ir,yh).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),ce(this,en)))}createResult(t,r){var O;const s=ce(this,yr),n=this.options,i=ce(this,en),l=ce(this,ad),o=ce(this,Hu),u=t!==s?t.state:ce(this,qf),{state:d}=t;let h={...d},f=!1,x;if(r._optimisticResults){const E=this.hasListeners(),R=!E&&TC(t,r),C=E&&IC(t,s,r,n);(R||C)&&(h={...h,...m6(d.data,t.options)}),r._optimisticResults==="isRestoring"&&(h.fetchStatus="idle")}let{error:p,errorUpdatedAt:g,status:y}=h;x=h.data;let v=!1;if(r.placeholderData!==void 0&&x===void 0&&y==="pending"){let E;i!=null&&i.isPlaceholderData&&r.placeholderData===(o==null?void 0:o.placeholderData)?(E=i.data,v=!0):E=typeof r.placeholderData=="function"?r.placeholderData((O=ce(this,Ku))==null?void 0:O.state.data,ce(this,Ku)):r.placeholderData,E!==void 0&&(y="success",x=yj(i==null?void 0:i.data,E,r),f=!0)}if(r.select&&x!==void 0&&!v)if(i&&x===(l==null?void 0:l.data)&&r.select===ce(this,Kf))x=ce(this,qu);else try{bt(this,Kf,r.select),x=r.select(x),x=yj(i==null?void 0:i.data,x,r),bt(this,qu,x),bt(this,Uo,null)}catch(E){bt(this,Uo,E)}ce(this,Uo)&&(p=ce(this,Uo),x=ce(this,qu),g=Date.now(),y="error");const j=h.fetchStatus==="fetching",b=y==="pending",w=y==="error",k=b&&j,N=x!==void 0,_={status:y,fetchStatus:h.fetchStatus,isPending:b,isSuccess:y==="success",isError:w,isInitialLoading:k,isLoading:k,data:x,dataUpdatedAt:h.dataUpdatedAt,error:p,errorUpdatedAt:g,failureCount:h.fetchFailureCount,failureReason:h.fetchFailureReason,errorUpdateCount:h.errorUpdateCount,isFetched:h.dataUpdateCount>0||h.errorUpdateCount>0,isFetchedAfterMount:h.dataUpdateCount>u.dataUpdateCount||h.errorUpdateCount>u.errorUpdateCount,isFetching:j,isRefetching:j&&!b,isLoadingError:w&&!N,isPaused:h.fetchStatus==="paused",isPlaceholderData:f,isRefetchError:w&&N,isStale:t2(t,r),refetch:this.refetch,promise:ce(this,Dl),isEnabled:di(r.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const E=I=>{_.status==="error"?I.reject(_.error):_.data!==void 0&&I.resolve(_.data)},R=()=>{const I=bt(this,Dl,_.promise=vj());E(I)},C=ce(this,Dl);switch(C.status){case"pending":t.queryHash===s.queryHash&&E(C);break;case"fulfilled":(_.status==="error"||_.data!==C.value)&&R();break;case"rejected":(_.status!=="error"||_.error!==C.reason)&&R();break}}return _}updateResult(){const t=ce(this,en),r=this.createResult(ce(this,yr),this.options);if(bt(this,ad,ce(this,yr).state),bt(this,Hu,this.options),ce(this,ad).data!==void 0&&bt(this,Ku,ce(this,yr)),Mp(r,t))return;bt(this,en,r);const s=()=>{if(!t)return!0;const{notifyOnChangeProps:n}=this.options,i=typeof n=="function"?n():n;if(i==="all"||!i&&!ce(this,Gu).size)return!0;const l=new Set(i??ce(this,Gu));return this.options.throwOnError&&l.add("error"),Object.keys(ce(this,en)).some(o=>{const c=o;return ce(this,en)[c]!==t[c]&&l.has(c)})};lr(this,Ir,p6).call(this,{listeners:s()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&lr(this,Ir,Sj).call(this)}},vn=new WeakMap,yr=new WeakMap,qf=new WeakMap,en=new WeakMap,ad=new WeakMap,Hu=new WeakMap,Dl=new WeakMap,Uo=new WeakMap,Kf=new WeakMap,qu=new WeakMap,Ku=new WeakMap,sd=new WeakMap,nd=new WeakMap,Wo=new WeakMap,Gu=new WeakMap,Ir=new WeakSet,yh=function(t){lr(this,Ir,Ej).call(this);let r=ce(this,yr).fetch(this.options,t);return t!=null&&t.throwOnError||(r=r.catch(sn)),r},jj=function(){lr(this,Ir,kj).call(this);const t=cc(this.options.staleTime,ce(this,yr));if(Sd||ce(this,en).isStale||!pj(t))return;const s=o6(ce(this,en).dataUpdatedAt,t)+1;bt(this,sd,Vc.setTimeout(()=>{ce(this,en).isStale||this.updateResult()},s))},wj=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(ce(this,yr)):this.options.refetchInterval)??!1},Nj=function(t){lr(this,Ir,Cj).call(this),bt(this,Wo,t),!(Sd||di(this.options.enabled,ce(this,yr))===!1||!pj(ce(this,Wo))||ce(this,Wo)===0)&&bt(this,nd,Vc.setInterval(()=>{(this.options.refetchIntervalInBackground||e2.isFocused())&&lr(this,Ir,yh).call(this)},ce(this,Wo)))},Sj=function(){lr(this,Ir,jj).call(this),lr(this,Ir,Nj).call(this,lr(this,Ir,wj).call(this))},kj=function(){ce(this,sd)&&(Vc.clearTimeout(ce(this,sd)),bt(this,sd,void 0))},Cj=function(){ce(this,nd)&&(Vc.clearInterval(ce(this,nd)),bt(this,nd,void 0))},Ej=function(){const t=ce(this,vn).getQueryCache().build(ce(this,vn),this.options);if(t===ce(this,yr))return;const r=ce(this,yr);bt(this,yr,t),bt(this,qf,t.state),this.hasListeners()&&(r==null||r.removeObserver(this),t.addObserver(this))},p6=function(t){Za.batch(()=>{t.listeners&&this.listeners.forEach(r=>{r(ce(this,en))}),ce(this,vn).getQueryCache().notify({query:ce(this,yr),type:"observerResultsUpdated"})})},T_);function qz(e,t){return di(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function TC(e,t){return qz(e,t)||e.state.data!==void 0&&Pj(e,t,t.refetchOnMount)}function Pj(e,t,r){if(di(t.enabled,e)!==!1&&cc(t.staleTime,e)!=="static"){const s=typeof r=="function"?r(e):r;return s==="always"||s!==!1&&t2(e,t)}return!1}function IC(e,t,r,s){return(e!==t||di(s.enabled,e)===!1)&&(!r.suspense||e.state.status!=="error")&&t2(e,r)}function t2(e,t){return di(t.enabled,e)!==!1&&e.isStaleByTime(cc(t.staleTime,e))}function Kz(e,t){return!Mp(e.getCurrentResult(),t)}function OC(e){return{onFetch:(t,r)=>{var d,h,f,x,p;const s=t.options,n=(f=(h=(d=t.fetchOptions)==null?void 0:d.meta)==null?void 0:h.fetchMore)==null?void 0:f.direction,i=((x=t.state.data)==null?void 0:x.pages)||[],l=((p=t.state.data)==null?void 0:p.pageParams)||[];let o={pages:[],pageParams:[]},c=0;const u=async()=>{let g=!1;const y=b=>{Object.defineProperty(b,"signal",{enumerable:!0,get:()=>(t.signal.aborted?g=!0:t.signal.addEventListener("abort",()=>{g=!0}),t.signal)})},v=d6(t.options,t.fetchOptions),j=async(b,w,k)=>{if(g)return Promise.reject();if(w==null&&b.pages.length)return Promise.resolve(b);const S=(()=>{const R={client:t.client,queryKey:t.queryKey,pageParam:w,direction:k?"backward":"forward",meta:t.options.meta};return y(R),R})(),_=await v(S),{maxPages:O}=t.options,E=k?Lz:Mz;return{pages:E(b.pages,_,O),pageParams:E(b.pageParams,w,O)}};if(n&&i.length){const b=n==="backward",w=b?Gz:DC,k={pages:i,pageParams:l},N=w(s,k);o=await j(k,N,b)}else{const b=e??i.length;do{const w=c===0?l[0]??s.initialPageParam:DC(s,o);if(c>0&&w==null)break;o=await j(o,w),c++}while(c<b)}return o};t.options.persister?t.fetchFn=()=>{var g,y;return(y=(g=t.options).persister)==null?void 0:y.call(g,u,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r)}:t.fetchFn=u}}}function DC(e,{pages:t,pageParams:r}){const s=t.length-1;return t.length>0?e.getNextPageParam(t[s],t,r[s],r):void 0}function Gz(e,{pages:t,pageParams:r}){var s;return t.length>0?(s=e.getPreviousPageParam)==null?void 0:s.call(e,t[0],t,r[0],r):void 0}var Gf,ll,tn,id,ol,Ao,I_,Qz=(I_=class extends x6{constructor(t){super();Ft(this,ol);Ft(this,Gf);Ft(this,ll);Ft(this,tn);Ft(this,id);bt(this,Gf,t.client),this.mutationId=t.mutationId,bt(this,tn,t.mutationCache),bt(this,ll,[]),this.state=t.state||g6(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){ce(this,ll).includes(t)||(ce(this,ll).push(t),this.clearGcTimeout(),ce(this,tn).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){bt(this,ll,ce(this,ll).filter(r=>r!==t)),this.scheduleGc(),ce(this,tn).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){ce(this,ll).length||(this.state.status==="pending"?this.scheduleGc():ce(this,tn).remove(this))}continue(){var t;return((t=ce(this,id))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var l,o,c,u,d,h,f,x,p,g,y,v,j,b,w,k,N,S,_,O;const r=()=>{lr(this,ol,Ao).call(this,{type:"continue"})},s={client:ce(this,Gf),meta:this.options.meta,mutationKey:this.options.mutationKey};bt(this,id,f6({fn:()=>this.options.mutationFn?this.options.mutationFn(t,s):Promise.reject(new Error("No mutationFn found")),onFail:(E,R)=>{lr(this,ol,Ao).call(this,{type:"failed",failureCount:E,error:R})},onPause:()=>{lr(this,ol,Ao).call(this,{type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>ce(this,tn).canRun(this)}));const n=this.state.status==="pending",i=!ce(this,id).canStart();try{if(n)r();else{lr(this,ol,Ao).call(this,{type:"pending",variables:t,isPaused:i}),await((o=(l=ce(this,tn).config).onMutate)==null?void 0:o.call(l,t,this,s));const R=await((u=(c=this.options).onMutate)==null?void 0:u.call(c,t,s));R!==this.state.context&&lr(this,ol,Ao).call(this,{type:"pending",context:R,variables:t,isPaused:i})}const E=await ce(this,id).start();return await((h=(d=ce(this,tn).config).onSuccess)==null?void 0:h.call(d,E,t,this.state.context,this,s)),await((x=(f=this.options).onSuccess)==null?void 0:x.call(f,E,t,this.state.context,s)),await((g=(p=ce(this,tn).config).onSettled)==null?void 0:g.call(p,E,null,this.state.variables,this.state.context,this,s)),await((v=(y=this.options).onSettled)==null?void 0:v.call(y,E,null,t,this.state.context,s)),lr(this,ol,Ao).call(this,{type:"success",data:E}),E}catch(E){try{throw await((b=(j=ce(this,tn).config).onError)==null?void 0:b.call(j,E,t,this.state.context,this,s)),await((k=(w=this.options).onError)==null?void 0:k.call(w,E,t,this.state.context,s)),await((S=(N=ce(this,tn).config).onSettled)==null?void 0:S.call(N,void 0,E,this.state.variables,this.state.context,this,s)),await((O=(_=this.options).onSettled)==null?void 0:O.call(_,void 0,E,t,this.state.context,s)),E}finally{lr(this,ol,Ao).call(this,{type:"error",error:E})}}finally{ce(this,tn).runNext(this)}}},Gf=new WeakMap,ll=new WeakMap,tn=new WeakMap,id=new WeakMap,ol=new WeakSet,Ao=function(t){const r=s=>{switch(t.type){case"failed":return{...s,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...s,isPaused:!0};case"continue":return{...s,isPaused:!1};case"pending":return{...s,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...s,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...s,data:void 0,error:t.error,failureCount:s.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=r(this.state),Za.batch(()=>{ce(this,ll).forEach(s=>{s.onMutationUpdate(t)}),ce(this,tn).notify({mutation:this,type:"updated",action:t})})},I_);function g6(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Fl,Ii,Qf,O_,Xz=(O_=class extends _0{constructor(t={}){super();Ft(this,Fl);Ft(this,Ii);Ft(this,Qf);this.config=t,bt(this,Fl,new Set),bt(this,Ii,new Map),bt(this,Qf,0)}build(t,r,s){const n=new Qz({client:t,mutationCache:this,mutationId:++Wx(this,Qf)._,options:t.defaultMutationOptions(r),state:s});return this.add(n),n}add(t){ce(this,Fl).add(t);const r=lm(t);if(typeof r=="string"){const s=ce(this,Ii).get(r);s?s.push(t):ce(this,Ii).set(r,[t])}this.notify({type:"added",mutation:t})}remove(t){if(ce(this,Fl).delete(t)){const r=lm(t);if(typeof r=="string"){const s=ce(this,Ii).get(r);if(s)if(s.length>1){const n=s.indexOf(t);n!==-1&&s.splice(n,1)}else s[0]===t&&ce(this,Ii).delete(r)}}this.notify({type:"removed",mutation:t})}canRun(t){const r=lm(t);if(typeof r=="string"){const s=ce(this,Ii).get(r),n=s==null?void 0:s.find(i=>i.state.status==="pending");return!n||n===t}else return!0}runNext(t){var s;const r=lm(t);if(typeof r=="string"){const n=(s=ce(this,Ii).get(r))==null?void 0:s.find(i=>i!==t&&i.state.isPaused);return(n==null?void 0:n.continue())??Promise.resolve()}else return Promise.resolve()}clear(){Za.batch(()=>{ce(this,Fl).forEach(t=>{this.notify({type:"removed",mutation:t})}),ce(this,Fl).clear(),ce(this,Ii).clear()})}getAll(){return Array.from(ce(this,Fl))}find(t){const r={exact:!0,...t};return this.getAll().find(s=>CC(r,s))}findAll(t={}){return this.getAll().filter(r=>CC(t,r))}notify(t){Za.batch(()=>{this.listeners.forEach(r=>{r(t)})})}resumePausedMutations(){const t=this.getAll().filter(r=>r.state.isPaused);return Za.batch(()=>Promise.all(t.map(r=>r.continue().catch(sn))))}},Fl=new WeakMap,Ii=new WeakMap,Qf=new WeakMap,O_);function lm(e){var t;return(t=e.options.scope)==null?void 0:t.id}var Rl,Vo,bn,Ml,Yl,Zm,Aj,D_,Yz=(D_=class extends _0{constructor(r,s){super();Ft(this,Yl);Ft(this,Rl);Ft(this,Vo);Ft(this,bn);Ft(this,Ml);bt(this,Rl,r),this.setOptions(s),this.bindMethods(),lr(this,Yl,Zm).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(r){var n;const s=this.options;this.options=ce(this,Rl).defaultMutationOptions(r),Mp(this.options,s)||ce(this,Rl).getMutationCache().notify({type:"observerOptionsUpdated",mutation:ce(this,bn),observer:this}),s!=null&&s.mutationKey&&this.options.mutationKey&&kd(s.mutationKey)!==kd(this.options.mutationKey)?this.reset():((n=ce(this,bn))==null?void 0:n.state.status)==="pending"&&ce(this,bn).setOptions(this.options)}onUnsubscribe(){var r;this.hasListeners()||(r=ce(this,bn))==null||r.removeObserver(this)}onMutationUpdate(r){lr(this,Yl,Zm).call(this),lr(this,Yl,Aj).call(this,r)}getCurrentResult(){return ce(this,Vo)}reset(){var r;(r=ce(this,bn))==null||r.removeObserver(this),bt(this,bn,void 0),lr(this,Yl,Zm).call(this),lr(this,Yl,Aj).call(this)}mutate(r,s){var n;return bt(this,Ml,s),(n=ce(this,bn))==null||n.removeObserver(this),bt(this,bn,ce(this,Rl).getMutationCache().build(ce(this,Rl),this.options)),ce(this,bn).addObserver(this),ce(this,bn).execute(r)}},Rl=new WeakMap,Vo=new WeakMap,bn=new WeakMap,Ml=new WeakMap,Yl=new WeakSet,Zm=function(){var s;const r=((s=ce(this,bn))==null?void 0:s.state)??g6();bt(this,Vo,{...r,isPending:r.status==="pending",isSuccess:r.status==="success",isError:r.status==="error",isIdle:r.status==="idle",mutate:this.mutate,reset:this.reset})},Aj=function(r){Za.batch(()=>{var s,n,i,l,o,c,u,d;if(ce(this,Ml)&&this.hasListeners()){const h=ce(this,Vo).variables,f=ce(this,Vo).context,x={client:ce(this,Rl),meta:this.options.meta,mutationKey:this.options.mutationKey};(r==null?void 0:r.type)==="success"?((n=(s=ce(this,Ml)).onSuccess)==null||n.call(s,r.data,h,f,x),(l=(i=ce(this,Ml)).onSettled)==null||l.call(i,r.data,null,h,f,x)):(r==null?void 0:r.type)==="error"&&((c=(o=ce(this,Ml)).onError)==null||c.call(o,r.error,h,f,x),(d=(u=ce(this,Ml)).onSettled)==null||d.call(u,void 0,r.error,h,f,x))}this.listeners.forEach(h=>{h(ce(this,Vo))})})},D_),cl,F_,Jz=(F_=class extends _0{constructor(t={}){super();Ft(this,cl);this.config=t,bt(this,cl,new Map)}build(t,r,s){const n=r.queryKey,i=r.queryHash??JN(n,r);let l=this.get(i);return l||(l=new Vz({client:t,queryKey:n,queryHash:i,options:t.defaultQueryOptions(r),state:s,defaultOptions:t.getQueryDefaults(n)}),this.add(l)),l}add(t){ce(this,cl).has(t.queryHash)||(ce(this,cl).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const r=ce(this,cl).get(t.queryHash);r&&(t.destroy(),r===t&&ce(this,cl).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){Za.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return ce(this,cl).get(t)}getAll(){return[...ce(this,cl).values()]}find(t){const r={exact:!0,...t};return this.getAll().find(s=>kC(r,s))}findAll(t={}){const r=this.getAll();return Object.keys(t).length>0?r.filter(s=>kC(t,s)):r}notify(t){Za.batch(()=>{this.listeners.forEach(r=>{r(t)})})}onFocus(){Za.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){Za.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},cl=new WeakMap,F_),Pa,Ho,qo,Qu,Xu,Ko,Yu,Ju,R_,Zz=(R_=class{constructor(e={}){Ft(this,Pa);Ft(this,Ho);Ft(this,qo);Ft(this,Qu);Ft(this,Xu);Ft(this,Ko);Ft(this,Yu);Ft(this,Ju);bt(this,Pa,e.queryCache||new Jz),bt(this,Ho,e.mutationCache||new Xz),bt(this,qo,e.defaultOptions||{}),bt(this,Qu,new Map),bt(this,Xu,new Map),bt(this,Ko,0)}mount(){Wx(this,Ko)._++,ce(this,Ko)===1&&(bt(this,Yu,e2.subscribe(async e=>{e&&(await this.resumePausedMutations(),ce(this,Pa).onFocus())})),bt(this,Ju,Lp.subscribe(async e=>{e&&(await this.resumePausedMutations(),ce(this,Pa).onOnline())})))}unmount(){var e,t;Wx(this,Ko)._--,ce(this,Ko)===0&&((e=ce(this,Yu))==null||e.call(this),bt(this,Yu,void 0),(t=ce(this,Ju))==null||t.call(this),bt(this,Ju,void 0))}isFetching(e){return ce(this,Pa).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return ce(this,Ho).findAll({...e,status:"pending"}).length}getQueryData(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=ce(this,Pa).get(t.queryHash))==null?void 0:r.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),r=ce(this,Pa).build(this,t),s=r.state.data;return s===void 0?this.fetchQuery(e):(e.revalidateIfStale&&r.isStaleByTime(cc(t.staleTime,r))&&this.prefetchQuery(t),Promise.resolve(s))}getQueriesData(e){return ce(this,Pa).findAll(e).map(({queryKey:t,state:r})=>{const s=r.data;return[t,s]})}setQueryData(e,t,r){const s=this.defaultQueryOptions({queryKey:e}),n=ce(this,Pa).get(s.queryHash),i=n==null?void 0:n.state.data,l=Dz(t,i);if(l!==void 0)return ce(this,Pa).build(this,s).setData(l,{...r,manual:!0})}setQueriesData(e,t,r){return Za.batch(()=>ce(this,Pa).findAll(e).map(({queryKey:s})=>[s,this.setQueryData(s,t,r)]))}getQueryState(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=ce(this,Pa).get(t.queryHash))==null?void 0:r.state}removeQueries(e){const t=ce(this,Pa);Za.batch(()=>{t.findAll(e).forEach(r=>{t.remove(r)})})}resetQueries(e,t){const r=ce(this,Pa);return Za.batch(()=>(r.findAll(e).forEach(s=>{s.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const r={revert:!0,...t},s=Za.batch(()=>ce(this,Pa).findAll(e).map(n=>n.cancel(r)));return Promise.all(s).then(sn).catch(sn)}invalidateQueries(e,t={}){return Za.batch(()=>(ce(this,Pa).findAll(e).forEach(r=>{r.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const r={...t,cancelRefetch:t.cancelRefetch??!0},s=Za.batch(()=>ce(this,Pa).findAll(e).filter(n=>!n.isDisabled()&&!n.isStatic()).map(n=>{let i=n.fetch(void 0,r);return r.throwOnError||(i=i.catch(sn)),n.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(s).then(sn)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const r=ce(this,Pa).build(this,t);return r.isStaleByTime(cc(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(sn).catch(sn)}fetchInfiniteQuery(e){return e.behavior=OC(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(sn).catch(sn)}ensureInfiniteQueryData(e){return e.behavior=OC(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return Lp.isOnline()?ce(this,Ho).resumePausedMutations():Promise.resolve()}getQueryCache(){return ce(this,Pa)}getMutationCache(){return ce(this,Ho)}getDefaultOptions(){return ce(this,qo)}setDefaultOptions(e){bt(this,qo,e)}setQueryDefaults(e,t){ce(this,Qu).set(kd(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...ce(this,Qu).values()],r={};return t.forEach(s=>{hf(e,s.queryKey)&&Object.assign(r,s.defaultOptions)}),r}setMutationDefaults(e,t){ce(this,Xu).set(kd(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...ce(this,Xu).values()],r={};return t.forEach(s=>{hf(e,s.mutationKey)&&Object.assign(r,s.defaultOptions)}),r}defaultQueryOptions(e){if(e._defaulted)return e;const t={...ce(this,qo).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=JN(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===ZN&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...ce(this,qo).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){ce(this,Pa).clear(),ce(this,Ho).clear()}},Pa=new WeakMap,Ho=new WeakMap,qo=new WeakMap,Qu=new WeakMap,Xu=new WeakMap,Ko=new WeakMap,Yu=new WeakMap,Ju=new WeakMap,R_),y6=m.createContext(void 0),py=e=>{const t=m.useContext(y6);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},e9=({client:e,children:t})=>(m.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),a.jsx(y6.Provider,{value:e,children:t})),v6=m.createContext(!1),t9=()=>m.useContext(v6);v6.Provider;function r9(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var a9=m.createContext(r9()),s9=()=>m.useContext(a9),n9=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},i9=e=>{m.useEffect(()=>{e.clearReset()},[e])},l9=({result:e,errorResetBoundary:t,throwOnError:r,query:s,suspense:n})=>e.isError&&!t.isReset()&&!e.isFetching&&s&&(n&&e.data===void 0||u6(r,[e.error,s])),o9=e=>{if(e.suspense){const r=n=>n==="static"?n:Math.max(n??1e3,1e3),s=e.staleTime;e.staleTime=typeof s=="function"?(...n)=>r(s(...n)):r(s),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},c9=(e,t)=>e.isLoading&&e.isFetching&&!t,d9=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,FC=(e,t,r)=>t.fetchOptimistic(e).catch(()=>{r.clearReset()});function u9(e,t,r){var h,f,x,p,g;const s=t9(),n=s9(),i=py(),l=i.defaultQueryOptions(e);(f=(h=i.getDefaultOptions().queries)==null?void 0:h._experimental_beforeQuery)==null||f.call(h,l),l._optimisticResults=s?"isRestoring":"optimistic",o9(l),n9(l,n),i9(n);const o=!i.getQueryCache().get(l.queryHash),[c]=m.useState(()=>new t(i,l)),u=c.getOptimisticResult(l),d=!s&&e.subscribed!==!1;if(m.useSyncExternalStore(m.useCallback(y=>{const v=d?c.subscribe(Za.batchCalls(y)):sn;return c.updateResult(),v},[c,d]),()=>c.getCurrentResult(),()=>c.getCurrentResult()),m.useEffect(()=>{c.setOptions(l)},[l,c]),d9(l,u))throw FC(l,c,n);if(l9({result:u,errorResetBoundary:n,throwOnError:l.throwOnError,query:i.getQueryCache().get(l.queryHash),suspense:l.suspense}))throw u.error;if((p=(x=i.getDefaultOptions().queries)==null?void 0:x._experimental_afterQuery)==null||p.call(x,l,u),l.experimental_prefetchInRender&&!Sd&&c9(u,s)){const y=o?FC(l,c,n):(g=i.getQueryCache().get(l.queryHash))==null?void 0:g.promise;y==null||y.catch(sn).finally(()=>{c.updateResult()})}return l.notifyOnChangeProps?u:c.trackResult(u)}function Dh(e,t){return u9(e,Hz)}function ep(e,t){const r=py(),[s]=m.useState(()=>new Yz(r,e));m.useEffect(()=>{s.setOptions(e)},[s,e]);const n=m.useSyncExternalStore(m.useCallback(l=>s.subscribe(Za.batchCalls(l)),[s]),()=>s.getCurrentResult(),()=>s.getCurrentResult()),i=m.useCallback((l,o)=>{s.mutate(l,o).catch(sn)},[s]);if(n.error&&u6(s.options.throwOnError,[n.error]))throw n.error;return{...n,mutate:i,mutateAsync:n.mutate}}function b6(e,t){return function(){return e.apply(t,arguments)}}const{toString:h9}=Object.prototype,{getPrototypeOf:r2}=Object,{iterator:gy,toStringTag:j6}=Symbol,yy=(e=>t=>{const r=h9.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),Qi=e=>(e=e.toLowerCase(),t=>yy(t)===e),vy=e=>t=>typeof t===e,{isArray:T0}=Array,l0=vy("undefined");function tx(e){return e!==null&&!l0(e)&&e.constructor!==null&&!l0(e.constructor)&&_n(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const w6=Qi("ArrayBuffer");function f9(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&w6(e.buffer),t}const x9=vy("string"),_n=vy("function"),N6=vy("number"),rx=e=>e!==null&&typeof e=="object",m9=e=>e===!0||e===!1,tp=e=>{if(yy(e)!=="object")return!1;const t=r2(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(j6 in e)&&!(gy in e)},p9=e=>{if(!rx(e)||tx(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},g9=Qi("Date"),y9=Qi("File"),v9=Qi("Blob"),b9=Qi("FileList"),j9=e=>rx(e)&&_n(e.pipe),w9=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||_n(e.append)&&((t=yy(e))==="formdata"||t==="object"&&_n(e.toString)&&e.toString()==="[object FormData]"))},N9=Qi("URLSearchParams"),[S9,k9,C9,E9]=["ReadableStream","Request","Response","Headers"].map(Qi),P9=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function ax(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let s,n;if(typeof e!="object"&&(e=[e]),T0(e))for(s=0,n=e.length;s<n;s++)t.call(null,e[s],s,e);else{if(tx(e))return;const i=r?Object.getOwnPropertyNames(e):Object.keys(e),l=i.length;let o;for(s=0;s<l;s++)o=i[s],t.call(null,e[o],o,e)}}function S6(e,t){if(tx(e))return null;t=t.toLowerCase();const r=Object.keys(e);let s=r.length,n;for(;s-- >0;)if(n=r[s],t===n.toLowerCase())return n;return null}const Hc=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,k6=e=>!l0(e)&&e!==Hc;function _j(){const{caseless:e,skipUndefined:t}=k6(this)&&this||{},r={},s=(n,i)=>{const l=e&&S6(r,i)||i;tp(r[l])&&tp(n)?r[l]=_j(r[l],n):tp(n)?r[l]=_j({},n):T0(n)?r[l]=n.slice():(!t||!l0(n))&&(r[l]=n)};for(let n=0,i=arguments.length;n<i;n++)arguments[n]&&ax(arguments[n],s);return r}const A9=(e,t,r,{allOwnKeys:s}={})=>(ax(t,(n,i)=>{r&&_n(n)?e[i]=b6(n,r):e[i]=n},{allOwnKeys:s}),e),_9=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),T9=(e,t,r,s)=>{e.prototype=Object.create(t.prototype,s),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},I9=(e,t,r,s)=>{let n,i,l;const o={};if(t=t||{},e==null)return t;do{for(n=Object.getOwnPropertyNames(e),i=n.length;i-- >0;)l=n[i],(!s||s(l,e,t))&&!o[l]&&(t[l]=e[l],o[l]=!0);e=r!==!1&&r2(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},O9=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const s=e.indexOf(t,r);return s!==-1&&s===r},D9=e=>{if(!e)return null;if(T0(e))return e;let t=e.length;if(!N6(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},F9=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&r2(Uint8Array)),R9=(e,t)=>{const s=(e&&e[gy]).call(e);let n;for(;(n=s.next())&&!n.done;){const i=n.value;t.call(e,i[0],i[1])}},M9=(e,t)=>{let r;const s=[];for(;(r=e.exec(t))!==null;)s.push(r);return s},L9=Qi("HTMLFormElement"),$9=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,s,n){return s.toUpperCase()+n}),RC=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),B9=Qi("RegExp"),C6=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),s={};ax(r,(n,i)=>{let l;(l=t(n,i,e))!==!1&&(s[i]=l||n)}),Object.defineProperties(e,s)},z9=e=>{C6(e,(t,r)=>{if(_n(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const s=e[r];if(_n(s)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},U9=(e,t)=>{const r={},s=n=>{n.forEach(i=>{r[i]=!0})};return T0(e)?s(e):s(String(e).split(t)),r},W9=()=>{},V9=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function H9(e){return!!(e&&_n(e.append)&&e[j6]==="FormData"&&e[gy])}const q9=e=>{const t=new Array(10),r=(s,n)=>{if(rx(s)){if(t.indexOf(s)>=0)return;if(tx(s))return s;if(!("toJSON"in s)){t[n]=s;const i=T0(s)?[]:{};return ax(s,(l,o)=>{const c=r(l,n+1);!l0(c)&&(i[o]=c)}),t[n]=void 0,i}}return s};return r(e,0)},K9=Qi("AsyncFunction"),G9=e=>e&&(rx(e)||_n(e))&&_n(e.then)&&_n(e.catch),E6=((e,t)=>e?setImmediate:t?((r,s)=>(Hc.addEventListener("message",({source:n,data:i})=>{n===Hc&&i===r&&s.length&&s.shift()()},!1),n=>{s.push(n),Hc.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",_n(Hc.postMessage)),Q9=typeof queueMicrotask<"u"?queueMicrotask.bind(Hc):typeof process<"u"&&process.nextTick||E6,X9=e=>e!=null&&_n(e[gy]),Oe={isArray:T0,isArrayBuffer:w6,isBuffer:tx,isFormData:w9,isArrayBufferView:f9,isString:x9,isNumber:N6,isBoolean:m9,isObject:rx,isPlainObject:tp,isEmptyObject:p9,isReadableStream:S9,isRequest:k9,isResponse:C9,isHeaders:E9,isUndefined:l0,isDate:g9,isFile:y9,isBlob:v9,isRegExp:B9,isFunction:_n,isStream:j9,isURLSearchParams:N9,isTypedArray:F9,isFileList:b9,forEach:ax,merge:_j,extend:A9,trim:P9,stripBOM:_9,inherits:T9,toFlatObject:I9,kindOf:yy,kindOfTest:Qi,endsWith:O9,toArray:D9,forEachEntry:R9,matchAll:M9,isHTMLForm:L9,hasOwnProperty:RC,hasOwnProp:RC,reduceDescriptors:C6,freezeMethods:z9,toObjectSet:U9,toCamelCase:$9,noop:W9,toFiniteNumber:V9,findKey:S6,global:Hc,isContextDefined:k6,isSpecCompliantForm:H9,toJSONObject:q9,isAsyncFn:K9,isThenable:G9,setImmediate:E6,asap:Q9,isIterable:X9};function ar(e,t,r,s,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),s&&(this.request=s),n&&(this.response=n,this.status=n.status?n.status:null)}Oe.inherits(ar,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Oe.toJSONObject(this.config),code:this.code,status:this.status}}});const P6=ar.prototype,A6={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{A6[e]={value:e}});Object.defineProperties(ar,A6);Object.defineProperty(P6,"isAxiosError",{value:!0});ar.from=(e,t,r,s,n,i)=>{const l=Object.create(P6);Oe.toFlatObject(e,l,function(d){return d!==Error.prototype},u=>u!=="isAxiosError");const o=e&&e.message?e.message:"Error",c=t==null&&e?e.code:t;return ar.call(l,o,c,r,s,n),e&&l.cause==null&&Object.defineProperty(l,"cause",{value:e,configurable:!0}),l.name=e&&e.name||"Error",i&&Object.assign(l,i),l};const Y9=null;function Tj(e){return Oe.isPlainObject(e)||Oe.isArray(e)}function _6(e){return Oe.endsWith(e,"[]")?e.slice(0,-2):e}function MC(e,t,r){return e?e.concat(t).map(function(n,i){return n=_6(n),!r&&i?"["+n+"]":n}).join(r?".":""):t}function J9(e){return Oe.isArray(e)&&!e.some(Tj)}const Z9=Oe.toFlatObject(Oe,{},null,function(t){return/^is[A-Z]/.test(t)});function by(e,t,r){if(!Oe.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=Oe.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(g,y){return!Oe.isUndefined(y[g])});const s=r.metaTokens,n=r.visitor||d,i=r.dots,l=r.indexes,c=(r.Blob||typeof Blob<"u"&&Blob)&&Oe.isSpecCompliantForm(t);if(!Oe.isFunction(n))throw new TypeError("visitor must be a function");function u(p){if(p===null)return"";if(Oe.isDate(p))return p.toISOString();if(Oe.isBoolean(p))return p.toString();if(!c&&Oe.isBlob(p))throw new ar("Blob is not supported. Use a Buffer instead.");return Oe.isArrayBuffer(p)||Oe.isTypedArray(p)?c&&typeof Blob=="function"?new Blob([p]):Buffer.from(p):p}function d(p,g,y){let v=p;if(p&&!y&&typeof p=="object"){if(Oe.endsWith(g,"{}"))g=s?g:g.slice(0,-2),p=JSON.stringify(p);else if(Oe.isArray(p)&&J9(p)||(Oe.isFileList(p)||Oe.endsWith(g,"[]"))&&(v=Oe.toArray(p)))return g=_6(g),v.forEach(function(b,w){!(Oe.isUndefined(b)||b===null)&&t.append(l===!0?MC([g],w,i):l===null?g:g+"[]",u(b))}),!1}return Tj(p)?!0:(t.append(MC(y,g,i),u(p)),!1)}const h=[],f=Object.assign(Z9,{defaultVisitor:d,convertValue:u,isVisitable:Tj});function x(p,g){if(!Oe.isUndefined(p)){if(h.indexOf(p)!==-1)throw Error("Circular reference detected in "+g.join("."));h.push(p),Oe.forEach(p,function(v,j){(!(Oe.isUndefined(v)||v===null)&&n.call(t,v,Oe.isString(j)?j.trim():j,g,f))===!0&&x(v,g?g.concat(j):[j])}),h.pop()}}if(!Oe.isObject(e))throw new TypeError("data must be an object");return x(e),t}function LC(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(s){return t[s]})}function a2(e,t){this._pairs=[],e&&by(e,this,t)}const T6=a2.prototype;T6.append=function(t,r){this._pairs.push([t,r])};T6.toString=function(t){const r=t?function(s){return t.call(this,s,LC)}:LC;return this._pairs.map(function(n){return r(n[0])+"="+r(n[1])},"").join("&")};function eU(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function I6(e,t,r){if(!t)return e;const s=r&&r.encode||eU;Oe.isFunction(r)&&(r={serialize:r});const n=r&&r.serialize;let i;if(n?i=n(t,r):i=Oe.isURLSearchParams(t)?t.toString():new a2(t,r).toString(s),i){const l=e.indexOf("#");l!==-1&&(e=e.slice(0,l)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class $C{constructor(){this.handlers=[]}use(t,r,s){return this.handlers.push({fulfilled:t,rejected:r,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){Oe.forEach(this.handlers,function(s){s!==null&&t(s)})}}const O6={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},tU=typeof URLSearchParams<"u"?URLSearchParams:a2,rU=typeof FormData<"u"?FormData:null,aU=typeof Blob<"u"?Blob:null,sU={isBrowser:!0,classes:{URLSearchParams:tU,FormData:rU,Blob:aU},protocols:["http","https","file","blob","url","data"]},s2=typeof window<"u"&&typeof document<"u",Ij=typeof navigator=="object"&&navigator||void 0,nU=s2&&(!Ij||["ReactNative","NativeScript","NS"].indexOf(Ij.product)<0),iU=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",lU=s2&&window.location.href||"http://localhost",oU=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:s2,hasStandardBrowserEnv:nU,hasStandardBrowserWebWorkerEnv:iU,navigator:Ij,origin:lU},Symbol.toStringTag,{value:"Module"})),Hs={...oU,...sU};function cU(e,t){return by(e,new Hs.classes.URLSearchParams,{visitor:function(r,s,n,i){return Hs.isNode&&Oe.isBuffer(r)?(this.append(s,r.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...t})}function dU(e){return Oe.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function uU(e){const t={},r=Object.keys(e);let s;const n=r.length;let i;for(s=0;s<n;s++)i=r[s],t[i]=e[i];return t}function D6(e){function t(r,s,n,i){let l=r[i++];if(l==="__proto__")return!0;const o=Number.isFinite(+l),c=i>=r.length;return l=!l&&Oe.isArray(n)?n.length:l,c?(Oe.hasOwnProp(n,l)?n[l]=[n[l],s]:n[l]=s,!o):((!n[l]||!Oe.isObject(n[l]))&&(n[l]=[]),t(r,s,n[l],i)&&Oe.isArray(n[l])&&(n[l]=uU(n[l])),!o)}if(Oe.isFormData(e)&&Oe.isFunction(e.entries)){const r={};return Oe.forEachEntry(e,(s,n)=>{t(dU(s),n,r,0)}),r}return null}function hU(e,t,r){if(Oe.isString(e))try{return(t||JSON.parse)(e),Oe.trim(e)}catch(s){if(s.name!=="SyntaxError")throw s}return(r||JSON.stringify)(e)}const sx={transitional:O6,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const s=r.getContentType()||"",n=s.indexOf("application/json")>-1,i=Oe.isObject(t);if(i&&Oe.isHTMLForm(t)&&(t=new FormData(t)),Oe.isFormData(t))return n?JSON.stringify(D6(t)):t;if(Oe.isArrayBuffer(t)||Oe.isBuffer(t)||Oe.isStream(t)||Oe.isFile(t)||Oe.isBlob(t)||Oe.isReadableStream(t))return t;if(Oe.isArrayBufferView(t))return t.buffer;if(Oe.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let o;if(i){if(s.indexOf("application/x-www-form-urlencoded")>-1)return cU(t,this.formSerializer).toString();if((o=Oe.isFileList(t))||s.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return by(o?{"files[]":t}:t,c&&new c,this.formSerializer)}}return i||n?(r.setContentType("application/json",!1),hU(t)):t}],transformResponse:[function(t){const r=this.transitional||sx.transitional,s=r&&r.forcedJSONParsing,n=this.responseType==="json";if(Oe.isResponse(t)||Oe.isReadableStream(t))return t;if(t&&Oe.isString(t)&&(s&&!this.responseType||n)){const l=!(r&&r.silentJSONParsing)&&n;try{return JSON.parse(t,this.parseReviver)}catch(o){if(l)throw o.name==="SyntaxError"?ar.from(o,ar.ERR_BAD_RESPONSE,this,null,this.response):o}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Hs.classes.FormData,Blob:Hs.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Oe.forEach(["delete","get","head","post","put","patch"],e=>{sx.headers[e]={}});const fU=Oe.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),xU=e=>{const t={};let r,s,n;return e&&e.split(`
`).forEach(function(l){n=l.indexOf(":"),r=l.substring(0,n).trim().toLowerCase(),s=l.substring(n+1).trim(),!(!r||t[r]&&fU[r])&&(r==="set-cookie"?t[r]?t[r].push(s):t[r]=[s]:t[r]=t[r]?t[r]+", "+s:s)}),t},BC=Symbol("internals");function rh(e){return e&&String(e).trim().toLowerCase()}function rp(e){return e===!1||e==null?e:Oe.isArray(e)?e.map(rp):String(e)}function mU(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=r.exec(e);)t[s[1]]=s[2];return t}const pU=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function jb(e,t,r,s,n){if(Oe.isFunction(s))return s.call(this,t,r);if(n&&(t=r),!!Oe.isString(t)){if(Oe.isString(s))return t.indexOf(s)!==-1;if(Oe.isRegExp(s))return s.test(t)}}function gU(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,s)=>r.toUpperCase()+s)}function yU(e,t){const r=Oe.toCamelCase(" "+t);["get","set","has"].forEach(s=>{Object.defineProperty(e,s+r,{value:function(n,i,l){return this[s].call(this,t,n,i,l)},configurable:!0})})}let Tn=class{constructor(t){t&&this.set(t)}set(t,r,s){const n=this;function i(o,c,u){const d=rh(c);if(!d)throw new Error("header name must be a non-empty string");const h=Oe.findKey(n,d);(!h||n[h]===void 0||u===!0||u===void 0&&n[h]!==!1)&&(n[h||c]=rp(o))}const l=(o,c)=>Oe.forEach(o,(u,d)=>i(u,d,c));if(Oe.isPlainObject(t)||t instanceof this.constructor)l(t,r);else if(Oe.isString(t)&&(t=t.trim())&&!pU(t))l(xU(t),r);else if(Oe.isObject(t)&&Oe.isIterable(t)){let o={},c,u;for(const d of t){if(!Oe.isArray(d))throw TypeError("Object iterator must return a key-value pair");o[u=d[0]]=(c=o[u])?Oe.isArray(c)?[...c,d[1]]:[c,d[1]]:d[1]}l(o,r)}else t!=null&&i(r,t,s);return this}get(t,r){if(t=rh(t),t){const s=Oe.findKey(this,t);if(s){const n=this[s];if(!r)return n;if(r===!0)return mU(n);if(Oe.isFunction(r))return r.call(this,n,s);if(Oe.isRegExp(r))return r.exec(n);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=rh(t),t){const s=Oe.findKey(this,t);return!!(s&&this[s]!==void 0&&(!r||jb(this,this[s],s,r)))}return!1}delete(t,r){const s=this;let n=!1;function i(l){if(l=rh(l),l){const o=Oe.findKey(s,l);o&&(!r||jb(s,s[o],o,r))&&(delete s[o],n=!0)}}return Oe.isArray(t)?t.forEach(i):i(t),n}clear(t){const r=Object.keys(this);let s=r.length,n=!1;for(;s--;){const i=r[s];(!t||jb(this,this[i],i,t,!0))&&(delete this[i],n=!0)}return n}normalize(t){const r=this,s={};return Oe.forEach(this,(n,i)=>{const l=Oe.findKey(s,i);if(l){r[l]=rp(n),delete r[i];return}const o=t?gU(i):String(i).trim();o!==i&&delete r[i],r[o]=rp(n),s[o]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return Oe.forEach(this,(s,n)=>{s!=null&&s!==!1&&(r[n]=t&&Oe.isArray(s)?s.join(", "):s)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const s=new this(t);return r.forEach(n=>s.set(n)),s}static accessor(t){const s=(this[BC]=this[BC]={accessors:{}}).accessors,n=this.prototype;function i(l){const o=rh(l);s[o]||(yU(n,l),s[o]=!0)}return Oe.isArray(t)?t.forEach(i):i(t),this}};Tn.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Oe.reduceDescriptors(Tn.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(s){this[r]=s}}});Oe.freezeMethods(Tn);function wb(e,t){const r=this||sx,s=t||r,n=Tn.from(s.headers);let i=s.data;return Oe.forEach(e,function(o){i=o.call(r,i,n.normalize(),t?t.status:void 0)}),n.normalize(),i}function F6(e){return!!(e&&e.__CANCEL__)}function I0(e,t,r){ar.call(this,e??"canceled",ar.ERR_CANCELED,t,r),this.name="CanceledError"}Oe.inherits(I0,ar,{__CANCEL__:!0});function R6(e,t,r){const s=r.config.validateStatus;!r.status||!s||s(r.status)?e(r):t(new ar("Request failed with status code "+r.status,[ar.ERR_BAD_REQUEST,ar.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function vU(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function bU(e,t){e=e||10;const r=new Array(e),s=new Array(e);let n=0,i=0,l;return t=t!==void 0?t:1e3,function(c){const u=Date.now(),d=s[i];l||(l=u),r[n]=c,s[n]=u;let h=i,f=0;for(;h!==n;)f+=r[h++],h=h%e;if(n=(n+1)%e,n===i&&(i=(i+1)%e),u-l<t)return;const x=d&&u-d;return x?Math.round(f*1e3/x):void 0}}function jU(e,t){let r=0,s=1e3/t,n,i;const l=(u,d=Date.now())=>{r=d,n=null,i&&(clearTimeout(i),i=null),e(...u)};return[(...u)=>{const d=Date.now(),h=d-r;h>=s?l(u,d):(n=u,i||(i=setTimeout(()=>{i=null,l(n)},s-h)))},()=>n&&l(n)]}const $p=(e,t,r=3)=>{let s=0;const n=bU(50,250);return jU(i=>{const l=i.loaded,o=i.lengthComputable?i.total:void 0,c=l-s,u=n(c),d=l<=o;s=l;const h={loaded:l,total:o,progress:o?l/o:void 0,bytes:c,rate:u||void 0,estimated:u&&o&&d?(o-l)/u:void 0,event:i,lengthComputable:o!=null,[t?"download":"upload"]:!0};e(h)},r)},zC=(e,t)=>{const r=e!=null;return[s=>t[0]({lengthComputable:r,total:e,loaded:s}),t[1]]},UC=e=>(...t)=>Oe.asap(()=>e(...t)),wU=Hs.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,Hs.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(Hs.origin),Hs.navigator&&/(msie|trident)/i.test(Hs.navigator.userAgent)):()=>!0,NU=Hs.hasStandardBrowserEnv?{write(e,t,r,s,n,i,l){if(typeof document>"u")return;const o=[`${e}=${encodeURIComponent(t)}`];Oe.isNumber(r)&&o.push(`expires=${new Date(r).toUTCString()}`),Oe.isString(s)&&o.push(`path=${s}`),Oe.isString(n)&&o.push(`domain=${n}`),i===!0&&o.push("secure"),Oe.isString(l)&&o.push(`SameSite=${l}`),document.cookie=o.join("; ")},read(e){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function SU(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function kU(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function M6(e,t,r){let s=!SU(t);return e&&(s||r==!1)?kU(e,t):t}const WC=e=>e instanceof Tn?{...e}:e;function Cd(e,t){t=t||{};const r={};function s(u,d,h,f){return Oe.isPlainObject(u)&&Oe.isPlainObject(d)?Oe.merge.call({caseless:f},u,d):Oe.isPlainObject(d)?Oe.merge({},d):Oe.isArray(d)?d.slice():d}function n(u,d,h,f){if(Oe.isUndefined(d)){if(!Oe.isUndefined(u))return s(void 0,u,h,f)}else return s(u,d,h,f)}function i(u,d){if(!Oe.isUndefined(d))return s(void 0,d)}function l(u,d){if(Oe.isUndefined(d)){if(!Oe.isUndefined(u))return s(void 0,u)}else return s(void 0,d)}function o(u,d,h){if(h in t)return s(u,d);if(h in e)return s(void 0,u)}const c={url:i,method:i,data:i,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:o,headers:(u,d,h)=>n(WC(u),WC(d),h,!0)};return Oe.forEach(Object.keys({...e,...t}),function(d){const h=c[d]||n,f=h(e[d],t[d],d);Oe.isUndefined(f)&&h!==o||(r[d]=f)}),r}const L6=e=>{const t=Cd({},e);let{data:r,withXSRFToken:s,xsrfHeaderName:n,xsrfCookieName:i,headers:l,auth:o}=t;if(t.headers=l=Tn.from(l),t.url=I6(M6(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),o&&l.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):""))),Oe.isFormData(r)){if(Hs.hasStandardBrowserEnv||Hs.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if(Oe.isFunction(r.getHeaders)){const c=r.getHeaders(),u=["content-type","content-length"];Object.entries(c).forEach(([d,h])=>{u.includes(d.toLowerCase())&&l.set(d,h)})}}if(Hs.hasStandardBrowserEnv&&(s&&Oe.isFunction(s)&&(s=s(t)),s||s!==!1&&wU(t.url))){const c=n&&i&&NU.read(i);c&&l.set(n,c)}return t},CU=typeof XMLHttpRequest<"u",EU=CU&&function(e){return new Promise(function(r,s){const n=L6(e);let i=n.data;const l=Tn.from(n.headers).normalize();let{responseType:o,onUploadProgress:c,onDownloadProgress:u}=n,d,h,f,x,p;function g(){x&&x(),p&&p(),n.cancelToken&&n.cancelToken.unsubscribe(d),n.signal&&n.signal.removeEventListener("abort",d)}let y=new XMLHttpRequest;y.open(n.method.toUpperCase(),n.url,!0),y.timeout=n.timeout;function v(){if(!y)return;const b=Tn.from("getAllResponseHeaders"in y&&y.getAllResponseHeaders()),k={data:!o||o==="text"||o==="json"?y.responseText:y.response,status:y.status,statusText:y.statusText,headers:b,config:e,request:y};R6(function(S){r(S),g()},function(S){s(S),g()},k),y=null}"onloadend"in y?y.onloadend=v:y.onreadystatechange=function(){!y||y.readyState!==4||y.status===0&&!(y.responseURL&&y.responseURL.indexOf("file:")===0)||setTimeout(v)},y.onabort=function(){y&&(s(new ar("Request aborted",ar.ECONNABORTED,e,y)),y=null)},y.onerror=function(w){const k=w&&w.message?w.message:"Network Error",N=new ar(k,ar.ERR_NETWORK,e,y);N.event=w||null,s(N),y=null},y.ontimeout=function(){let w=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const k=n.transitional||O6;n.timeoutErrorMessage&&(w=n.timeoutErrorMessage),s(new ar(w,k.clarifyTimeoutError?ar.ETIMEDOUT:ar.ECONNABORTED,e,y)),y=null},i===void 0&&l.setContentType(null),"setRequestHeader"in y&&Oe.forEach(l.toJSON(),function(w,k){y.setRequestHeader(k,w)}),Oe.isUndefined(n.withCredentials)||(y.withCredentials=!!n.withCredentials),o&&o!=="json"&&(y.responseType=n.responseType),u&&([f,p]=$p(u,!0),y.addEventListener("progress",f)),c&&y.upload&&([h,x]=$p(c),y.upload.addEventListener("progress",h),y.upload.addEventListener("loadend",x)),(n.cancelToken||n.signal)&&(d=b=>{y&&(s(!b||b.type?new I0(null,e,y):b),y.abort(),y=null)},n.cancelToken&&n.cancelToken.subscribe(d),n.signal&&(n.signal.aborted?d():n.signal.addEventListener("abort",d)));const j=vU(n.url);if(j&&Hs.protocols.indexOf(j)===-1){s(new ar("Unsupported protocol "+j+":",ar.ERR_BAD_REQUEST,e));return}y.send(i||null)})},PU=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let s=new AbortController,n;const i=function(u){if(!n){n=!0,o();const d=u instanceof Error?u:this.reason;s.abort(d instanceof ar?d:new I0(d instanceof Error?d.message:d))}};let l=t&&setTimeout(()=>{l=null,i(new ar(`timeout ${t} of ms exceeded`,ar.ETIMEDOUT))},t);const o=()=>{e&&(l&&clearTimeout(l),l=null,e.forEach(u=>{u.unsubscribe?u.unsubscribe(i):u.removeEventListener("abort",i)}),e=null)};e.forEach(u=>u.addEventListener("abort",i));const{signal:c}=s;return c.unsubscribe=()=>Oe.asap(o),c}},AU=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let s=0,n;for(;s<r;)n=s+t,yield e.slice(s,n),s=n},_U=async function*(e,t){for await(const r of TU(e))yield*AU(r,t)},TU=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:s}=await t.read();if(r)break;yield s}}finally{await t.cancel()}},VC=(e,t,r,s)=>{const n=_U(e,t);let i=0,l,o=c=>{l||(l=!0,s&&s(c))};return new ReadableStream({async pull(c){try{const{done:u,value:d}=await n.next();if(u){o(),c.close();return}let h=d.byteLength;if(r){let f=i+=h;r(f)}c.enqueue(new Uint8Array(d))}catch(u){throw o(u),u}},cancel(c){return o(c),n.return()}},{highWaterMark:2})},HC=64*1024,{isFunction:om}=Oe,IU=(({Request:e,Response:t})=>({Request:e,Response:t}))(Oe.global),{ReadableStream:qC,TextEncoder:KC}=Oe.global,GC=(e,...t)=>{try{return!!e(...t)}catch{return!1}},OU=e=>{e=Oe.merge.call({skipUndefined:!0},IU,e);const{fetch:t,Request:r,Response:s}=e,n=t?om(t):typeof fetch=="function",i=om(r),l=om(s);if(!n)return!1;const o=n&&om(qC),c=n&&(typeof KC=="function"?(p=>g=>p.encode(g))(new KC):async p=>new Uint8Array(await new r(p).arrayBuffer())),u=i&&o&&GC(()=>{let p=!1;const g=new r(Hs.origin,{body:new qC,method:"POST",get duplex(){return p=!0,"half"}}).headers.has("Content-Type");return p&&!g}),d=l&&o&&GC(()=>Oe.isReadableStream(new s("").body)),h={stream:d&&(p=>p.body)};n&&["text","arrayBuffer","blob","formData","stream"].forEach(p=>{!h[p]&&(h[p]=(g,y)=>{let v=g&&g[p];if(v)return v.call(g);throw new ar(`Response type '${p}' is not supported`,ar.ERR_NOT_SUPPORT,y)})});const f=async p=>{if(p==null)return 0;if(Oe.isBlob(p))return p.size;if(Oe.isSpecCompliantForm(p))return(await new r(Hs.origin,{method:"POST",body:p}).arrayBuffer()).byteLength;if(Oe.isArrayBufferView(p)||Oe.isArrayBuffer(p))return p.byteLength;if(Oe.isURLSearchParams(p)&&(p=p+""),Oe.isString(p))return(await c(p)).byteLength},x=async(p,g)=>{const y=Oe.toFiniteNumber(p.getContentLength());return y??f(g)};return async p=>{let{url:g,method:y,data:v,signal:j,cancelToken:b,timeout:w,onDownloadProgress:k,onUploadProgress:N,responseType:S,headers:_,withCredentials:O="same-origin",fetchOptions:E}=L6(p),R=t||fetch;S=S?(S+"").toLowerCase():"text";let C=PU([j,b&&b.toAbortSignal()],w),I=null;const ne=C&&C.unsubscribe&&(()=>{C.unsubscribe()});let W;try{if(N&&u&&y!=="get"&&y!=="head"&&(W=await x(_,v))!==0){let G=new r(g,{method:"POST",body:v,duplex:"half"}),B;if(Oe.isFormData(v)&&(B=G.headers.get("content-type"))&&_.setContentType(B),G.body){const[se,L]=zC(W,$p(UC(N)));v=VC(G.body,HC,se,L)}}Oe.isString(O)||(O=O?"include":"omit");const Q=i&&"credentials"in r.prototype,H={...E,signal:C,method:y.toUpperCase(),headers:_.normalize().toJSON(),body:v,duplex:"half",credentials:Q?O:void 0};I=i&&new r(g,H);let K=await(i?R(I,E):R(g,H));const q=d&&(S==="stream"||S==="response");if(d&&(k||q&&ne)){const G={};["status","statusText","headers"].forEach(Z=>{G[Z]=K[Z]});const B=Oe.toFiniteNumber(K.headers.get("content-length")),[se,L]=k&&zC(B,$p(UC(k),!0))||[];K=new s(VC(K.body,HC,se,()=>{L&&L(),ne&&ne()}),G)}S=S||"text";let ge=await h[Oe.findKey(h,S)||"text"](K,p);return!q&&ne&&ne(),await new Promise((G,B)=>{R6(G,B,{data:ge,headers:Tn.from(K.headers),status:K.status,statusText:K.statusText,config:p,request:I})})}catch(Q){throw ne&&ne(),Q&&Q.name==="TypeError"&&/Load failed|fetch/i.test(Q.message)?Object.assign(new ar("Network Error",ar.ERR_NETWORK,p,I),{cause:Q.cause||Q}):ar.from(Q,Q&&Q.code,p,I)}}},DU=new Map,$6=e=>{let t=e&&e.env||{};const{fetch:r,Request:s,Response:n}=t,i=[s,n,r];let l=i.length,o=l,c,u,d=DU;for(;o--;)c=i[o],u=d.get(c),u===void 0&&d.set(c,u=o?new Map:OU(t)),d=u;return u};$6();const n2={http:Y9,xhr:EU,fetch:{get:$6}};Oe.forEach(n2,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const QC=e=>`- ${e}`,FU=e=>Oe.isFunction(e)||e===null||e===!1;function RU(e,t){e=Oe.isArray(e)?e:[e];const{length:r}=e;let s,n;const i={};for(let l=0;l<r;l++){s=e[l];let o;if(n=s,!FU(s)&&(n=n2[(o=String(s)).toLowerCase()],n===void 0))throw new ar(`Unknown adapter '${o}'`);if(n&&(Oe.isFunction(n)||(n=n.get(t))))break;i[o||"#"+l]=n}if(!n){const l=Object.entries(i).map(([c,u])=>`adapter ${c} `+(u===!1?"is not supported by the environment":"is not available in the build"));let o=r?l.length>1?`since :
`+l.map(QC).join(`
`):" "+QC(l[0]):"as no adapter specified";throw new ar("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return n}const B6={getAdapter:RU,adapters:n2};function Nb(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new I0(null,e)}function XC(e){return Nb(e),e.headers=Tn.from(e.headers),e.data=wb.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),B6.getAdapter(e.adapter||sx.adapter,e)(e).then(function(s){return Nb(e),s.data=wb.call(e,e.transformResponse,s),s.headers=Tn.from(s.headers),s},function(s){return F6(s)||(Nb(e),s&&s.response&&(s.response.data=wb.call(e,e.transformResponse,s.response),s.response.headers=Tn.from(s.response.headers))),Promise.reject(s)})}const z6="1.13.2",jy={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{jy[e]=function(s){return typeof s===e||"a"+(t<1?"n ":" ")+e}});const YC={};jy.transitional=function(t,r,s){function n(i,l){return"[Axios v"+z6+"] Transitional option '"+i+"'"+l+(s?". "+s:"")}return(i,l,o)=>{if(t===!1)throw new ar(n(l," has been removed"+(r?" in "+r:"")),ar.ERR_DEPRECATED);return r&&!YC[l]&&(YC[l]=!0,console.warn(n(l," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(i,l,o):!0}};jy.spelling=function(t){return(r,s)=>(console.warn(`${s} is likely a misspelling of ${t}`),!0)};function MU(e,t,r){if(typeof e!="object")throw new ar("options must be an object",ar.ERR_BAD_OPTION_VALUE);const s=Object.keys(e);let n=s.length;for(;n-- >0;){const i=s[n],l=t[i];if(l){const o=e[i],c=o===void 0||l(o,i,e);if(c!==!0)throw new ar("option "+i+" must be "+c,ar.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new ar("Unknown option "+i,ar.ERR_BAD_OPTION)}}const ap={assertOptions:MU,validators:jy},Zi=ap.validators;let cd=class{constructor(t){this.defaults=t||{},this.interceptors={request:new $C,response:new $C}}async request(t,r){try{return await this._request(t,r)}catch(s){if(s instanceof Error){let n={};Error.captureStackTrace?Error.captureStackTrace(n):n=new Error;const i=n.stack?n.stack.replace(/^.+\n/,""):"";try{s.stack?i&&!String(s.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+i):s.stack=i}catch{}}throw s}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=Cd(this.defaults,r);const{transitional:s,paramsSerializer:n,headers:i}=r;s!==void 0&&ap.assertOptions(s,{silentJSONParsing:Zi.transitional(Zi.boolean),forcedJSONParsing:Zi.transitional(Zi.boolean),clarifyTimeoutError:Zi.transitional(Zi.boolean)},!1),n!=null&&(Oe.isFunction(n)?r.paramsSerializer={serialize:n}:ap.assertOptions(n,{encode:Zi.function,serialize:Zi.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),ap.assertOptions(r,{baseUrl:Zi.spelling("baseURL"),withXsrfToken:Zi.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let l=i&&Oe.merge(i.common,i[r.method]);i&&Oe.forEach(["delete","get","head","post","put","patch","common"],p=>{delete i[p]}),r.headers=Tn.concat(l,i);const o=[];let c=!0;this.interceptors.request.forEach(function(g){typeof g.runWhen=="function"&&g.runWhen(r)===!1||(c=c&&g.synchronous,o.unshift(g.fulfilled,g.rejected))});const u=[];this.interceptors.response.forEach(function(g){u.push(g.fulfilled,g.rejected)});let d,h=0,f;if(!c){const p=[XC.bind(this),void 0];for(p.unshift(...o),p.push(...u),f=p.length,d=Promise.resolve(r);h<f;)d=d.then(p[h++],p[h++]);return d}f=o.length;let x=r;for(;h<f;){const p=o[h++],g=o[h++];try{x=p(x)}catch(y){g.call(this,y);break}}try{d=XC.call(this,x)}catch(p){return Promise.reject(p)}for(h=0,f=u.length;h<f;)d=d.then(u[h++],u[h++]);return d}getUri(t){t=Cd(this.defaults,t);const r=M6(t.baseURL,t.url,t.allowAbsoluteUrls);return I6(r,t.params,t.paramsSerializer)}};Oe.forEach(["delete","get","head","options"],function(t){cd.prototype[t]=function(r,s){return this.request(Cd(s||{},{method:t,url:r,data:(s||{}).data}))}});Oe.forEach(["post","put","patch"],function(t){function r(s){return function(i,l,o){return this.request(Cd(o||{},{method:t,headers:s?{"Content-Type":"multipart/form-data"}:{},url:i,data:l}))}}cd.prototype[t]=r(),cd.prototype[t+"Form"]=r(!0)});let LU=class U6{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(i){r=i});const s=this;this.promise.then(n=>{if(!s._listeners)return;let i=s._listeners.length;for(;i-- >0;)s._listeners[i](n);s._listeners=null}),this.promise.then=n=>{let i;const l=new Promise(o=>{s.subscribe(o),i=o}).then(n);return l.cancel=function(){s.unsubscribe(i)},l},t(function(i,l,o){s.reason||(s.reason=new I0(i,l,o),r(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=s=>{t.abort(s)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new U6(function(n){t=n}),cancel:t}}};function $U(e){return function(r){return e.apply(null,r)}}function BU(e){return Oe.isObject(e)&&e.isAxiosError===!0}const Oj={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(Oj).forEach(([e,t])=>{Oj[t]=e});function W6(e){const t=new cd(e),r=b6(cd.prototype.request,t);return Oe.extend(r,cd.prototype,t,{allOwnKeys:!0}),Oe.extend(r,t,null,{allOwnKeys:!0}),r.create=function(n){return W6(Cd(e,n))},r}const La=W6(sx);La.Axios=cd;La.CanceledError=I0;La.CancelToken=LU;La.isCancel=F6;La.VERSION=z6;La.toFormData=by;La.AxiosError=ar;La.Cancel=La.CanceledError;La.all=function(t){return Promise.all(t)};La.spread=$U;La.isAxiosError=BU;La.mergeConfig=Cd;La.AxiosHeaders=Tn;La.formToJSON=e=>D6(Oe.isHTMLForm(e)?new FormData(e):e);La.getAdapter=B6.getAdapter;La.HttpStatusCode=Oj;La.default=La;const{Axios:Xve,AxiosError:Yve,CanceledError:Jve,isCancel:Zve,CancelToken:ebe,VERSION:tbe,all:rbe,Cancel:abe,isAxiosError:sbe,spread:nbe,toFormData:ibe,AxiosHeaders:lbe,HttpStatusCode:obe,formToJSON:cbe,getAdapter:dbe,mergeConfig:ube}=La,zU="http://localhost:5227/api",ie=La.create({baseURL:zU,headers:{"Content-Type":"application/json"}});ie.interceptors.request.use(e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization=`Bearer ${t}`),e});ie.interceptors.response.use(e=>e,e=>{var r,s,n;const t=(s=(r=e.config)==null?void 0:r.url)==null?void 0:s.includes("/auth/");return((n=e.response)==null?void 0:n.status)===401&&!t&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"),Promise.reject(e)});const UU={login:async(e,t)=>{var r;try{return await ie.post("/auth/company/login",{username:e,password:t})}catch(s){if(((r=s.response)==null?void 0:r.status)===401){const i=(await ie.post("/auth/employee/lookup",{username:e})).data.companyId;if(i)return await ie.post("/auth/employee/login",{username:e,password:t},{headers:{"X-Company-Id":i.toString()}});throw s}throw s}},getMe:()=>ie.get("/auth/me")},br={getAll:e=>ie.get("/products",{params:e}),getById:e=>ie.get(`/products/${e}`),create:e=>ie.post("/products",e),update:(e,t)=>ie.put(`/products/${e}`,t),delete:e=>ie.delete(`/products/${e}`),getCostHistory:e=>ie.get(`/products/${e}/cost-history`),addCostHistory:(e,t)=>ie.post(`/products/${e}/cost-history`,t),getInventory:e=>ie.get(`/products/${e}/inventory`),getValuation:e=>ie.get("/products/valuation",{params:e}),bulkImport:e=>ie.post("/products/bulk-import",e),bulkAssign:e=>ie.post("/products/bulk-assign",e),bulkOnlineShop:e=>ie.post("/products/bulk-online-shop",e),adjustStock:e=>ie.post("/products/stock-adjustment",e),getStockAdjustments:e=>ie.get("/products/stock-adjustments",{params:e}),getVariants:e=>ie.get(`/products/${e}/variants`),createVariant:(e,t)=>ie.post(`/products/${e}/variants`,t),updateVariant:(e,t,r)=>ie.put(`/products/${e}/variants/${t}`,r),deleteVariant:(e,t)=>ie.delete(`/products/${e}/variants/${t}`)},Ha={getAll:e=>ie.get("/customers",{params:e}),getById:e=>ie.get(`/customers/${e}`),create:e=>ie.post("/customers",e),update:(e,t)=>ie.put(`/customers/${e}`,t),delete:e=>ie.delete(`/customers/${e}`),getSpecialPrices:e=>ie.get(`/customers/${e}/special-prices`),addSpecialPrice:(e,t)=>ie.post(`/customers/${e}/special-prices`,t),updateSpecialPrice:(e,t,r)=>ie.put(`/customers/${e}/special-prices/${t}`,r),deleteSpecialPrice:(e,t)=>ie.delete(`/customers/${e}/special-prices/${t}`),resolveMapsLink:e=>ie.post("/customers/resolve-maps-link",{url:e})},hs={getAll:e=>ie.get("/employees",{params:e}),getById:e=>ie.get(`/employees/${e}`),create:e=>ie.post("/employees",e),update:(e,t)=>ie.put(`/employees/${e}`,t),updateRating:(e,t)=>ie.patch(`/employees/${e}/rating`,{rating:t}),toggleStatus:e=>ie.patch(`/employees/${e}/status`),delete:e=>ie.delete(`/employees/${e}`),getWarehouses:()=>ie.get("/employees/warehouses"),getVans:()=>ie.get("/employees/vans"),getVisibility:e=>ie.get(`/employees/${e}/visibility`),updateVisibilitySettings:(e,t)=>ie.put(`/employees/${e}/visibility/settings`,t),assignCustomers:(e,t)=>ie.put(`/employees/${e}/visibility/customers`,{itemIds:t}),assignProducts:(e,t)=>ie.put(`/employees/${e}/visibility/products`,{itemIds:t}),getVisitAnalysis:(e,t,r)=>ie.get(`/employees/${e}/visit-analysis`,{params:{startDate:t,endDate:r}})},JC={getAll:()=>ie.get("/employees/salesmen"),getPerformance:(e,t)=>ie.get(`/employees/salesmen/${e}/performance`,{params:{date:t}})},Ks={getAll:e=>ie.get("/warehouses",{params:e}),getById:e=>ie.get(`/warehouses/${e}`),create:e=>ie.post("/warehouses",e),update:(e,t)=>ie.put(`/warehouses/${e}`,t),delete:e=>ie.delete(`/warehouses/${e}`)},rn={getAll:e=>ie.get("/vans",{params:e}),getById:e=>ie.get(`/vans/${e}`),create:e=>ie.post("/vans",e),update:(e,t)=>ie.put(`/vans/${e}`,t),delete:e=>ie.delete(`/vans/${e}`),getDrivers:()=>ie.get("/vans/drivers"),getStock:e=>ie.get(`/vans/${e}/stock`),getMovements:(e,t)=>ie.get(`/vans/${e}/movements`,{params:{limit:t}}),loadStock:(e,t)=>ie.post(`/vans/${e}/load-stock`,t),unloadStock:(e,t)=>ie.post(`/vans/${e}/unload-stock`,t)},qc={getAll:e=>ie.get("/tasks",{params:e}),getById:e=>ie.get(`/tasks/${e}`),create:e=>ie.post("/tasks",e),update:(e,t)=>ie.put(`/tasks/${e}`,t),updateStatus:(e,t)=>ie.put(`/tasks/${e}/status`,{status:t}),delete:e=>ie.delete(`/tasks/${e}`)},Vr={getAll:e=>ie.get("/suppliers",{params:e}),getById:e=>ie.get(`/suppliers/${e}`),create:e=>ie.post("/suppliers",e),update:(e,t)=>ie.put(`/suppliers/${e}`,t),delete:e=>ie.delete(`/suppliers/${e}`),getPurchaseOrders:e=>ie.get("/suppliers/purchase-orders",{params:e}),getPurchaseOrder:e=>ie.get(`/suppliers/purchase-orders/${e}`),createPurchaseOrder:e=>ie.post("/suppliers/purchase-orders",e),updatePurchaseOrderStatus:(e,t)=>ie.put(`/suppliers/purchase-orders/${e}/status`,{status:t}),deletePurchaseOrder:e=>ie.delete(`/suppliers/purchase-orders/${e}`),getInvoices:e=>ie.get("/suppliers/invoices",{params:e}),getInvoice:e=>ie.get(`/suppliers/invoices/${e}`),createInvoice:e=>ie.post("/suppliers/invoices",e),getPayments:e=>ie.get("/suppliers/payments",{params:e}),createPayment:e=>ie.post("/suppliers/payments",e),updatePayment:(e,t)=>ie.put(`/suppliers/payments/${e}`,t),deletePayment:e=>ie.delete(`/suppliers/payments/${e}`)},Pi={getAll:e=>ie.get("/expenses",{params:e}),getById:e=>ie.get(`/expenses/${e}`),create:e=>ie.post("/expenses",e),update:(e,t)=>ie.put(`/expenses/${e}`,t),delete:e=>ie.delete(`/expenses/${e}`),getCategories:()=>ie.get("/expenses/categories"),createCategory:e=>ie.post("/expenses/categories",e),updateCategory:(e,t)=>ie.put(`/expenses/categories/${e}`,t),deleteCategory:e=>ie.delete(`/expenses/categories/${e}`)},cm={getCollections:e=>ie.get("/cash/collections",{params:e}),createCollection:e=>ie.post("/cash/collections",e),getDeposits:e=>ie.get("/cash/deposits",{params:e}),createDeposit:e=>ie.post("/cash/deposits",e),updateDepositStatus:(e,t)=>ie.put(`/cash/deposits/${e}/status`,t),getVanCash:()=>ie.get("/cash/van-cash"),getOverview:()=>ie.get("/cash/overview")},il={getAll:e=>ie.get("/categories",{params:e}),getById:e=>ie.get(`/categories/${e}`),getSubcategories:e=>ie.get(`/categories/${e}/subcategories`),create:e=>ie.post("/categories",e),update:(e,t)=>ie.put(`/categories/${e}`,t),delete:e=>ie.delete(`/categories/${e}`)},Kc={getAll:()=>ie.get("/currencies"),create:e=>ie.post("/currencies",e),update:(e,t)=>ie.put(`/currencies/${e}`,t),delete:e=>ie.delete(`/currencies/${e}`)},ku={getAll:e=>ie.get("/units",{params:e}),getById:e=>ie.get(`/units/${e}`),create:e=>ie.post("/units",e),update:(e,t)=>ie.put(`/units/${e}`,t),delete:e=>ie.delete(`/units/${e}`)},Bp={get:()=>ie.get("/settings"),update:e=>ie.put("/settings",e)},vh={getAll:()=>ie.get("/roles"),getById:e=>ie.get(`/roles/${e}`),create:e=>ie.post("/roles",e),update:(e,t)=>ie.put(`/roles/${e}`,t),delete:e=>ie.delete(`/roles/${e}`)},dm={getAll:e=>ie.get("/leads",{params:e}).then(t=>t.data),getById:e=>ie.get(`/leads/${e}`).then(t=>t.data),create:e=>ie.post("/leads",e).then(t=>t.data),update:(e,t)=>ie.put(`/leads/${e}`,t),convert:(e,t)=>ie.post(`/leads/${e}/convert`,t).then(r=>r.data),reject:(e,t)=>ie.post(`/leads/${e}/reject`,{reason:t}),delete:e=>ie.delete(`/leads/${e}`),getSummary:()=>ie.get("/leads/summary").then(e=>e.data)},ah={getAll:e=>ie.get("/returns",{params:e}).then(t=>t.data),getById:e=>ie.get(`/returns/${e}`).then(t=>t.data),create:e=>ie.post("/returns",e).then(t=>t.data),approve:e=>ie.post(`/returns/${e}/approve`),reject:(e,t)=>ie.post(`/returns/${e}/reject`,{reason:t}),process:(e,t)=>ie.post(`/returns/${e}/process`,t),delete:e=>ie.delete(`/returns/${e}`)},zp={getInventory:e=>ie.get("/direct-sales/inventory",{params:{warehouseId:e}}).then(t=>t.data),getCustomerPrices:e=>ie.get(`/direct-sales/customer-prices/${e}`).then(t=>t.data),createSale:e=>ie.post("/direct-sales",e).then(t=>t.data),getSales:e=>ie.get("/direct-sales",{params:e}).then(t=>t.data),getOrderByNumber:e=>ie.get(`/direct-sales/order/${encodeURIComponent(e)}`).then(t=>t.data),processReturnExchange:e=>ie.post("/direct-sales/return-exchange",e).then(t=>t.data),getReturnExchanges:e=>ie.get("/direct-sales/return-exchanges",{params:e}).then(t=>t.data)},_i={getAll:e=>ie.get("/quotes",{params:e}).then(t=>t.data),getById:e=>ie.get(`/quotes/${e}`).then(t=>t.data),getByNumber:e=>ie.get(`/quotes/by-number/${e}`).then(t=>t.data),getSummary:()=>ie.get("/quotes/summary").then(e=>e.data),create:e=>ie.post("/quotes",e).then(t=>t.data),update:(e,t)=>ie.put(`/quotes/${e}`,t).then(r=>r.data),updateStatus:(e,t)=>ie.put(`/quotes/${e}/status`,{status:t}),convert:(e,t)=>ie.post(`/quotes/${e}/convert`,{orderId:t}),delete:e=>ie.delete(`/quotes/${e}`)},Rc={getAll:e=>ie.get("/employee-payments",{params:e}).then(t=>t.data),getById:e=>ie.get(`/employee-payments/${e}`).then(t=>t.data),getByEmployee:e=>ie.get(`/employee-payments/employee/${e}`).then(t=>t.data),create:e=>ie.post("/employee-payments",e).then(t=>t.data),update:(e,t)=>ie.put(`/employee-payments/${e}`,t),delete:e=>ie.delete(`/employee-payments/${e}`),getSummary:e=>ie.get("/employee-payments/summary",{params:e}).then(t=>t.data)},_o={getDashboard:()=>ie.get("/reports/dashboard").then(e=>e.data),getSales:(e,t,r)=>ie.get("/reports/sales",{params:{startDate:e,endDate:t,driverId:r}}).then(s=>s.data),getCollections:(e,t,r)=>ie.get("/reports/collections",{params:{startDate:e,endDate:t,driverId:r}}).then(s=>s.data),getStock:e=>ie.get("/reports/stock",{params:{warehouseId:e}}).then(t=>t.data),getExpenses:(e,t,r)=>ie.get("/reports/expenses",{params:{startDate:e,endDate:t,categoryId:r}}).then(s=>s.data),getDriverPerformance:(e,t,r)=>ie.get("/reports/driver-performance",{params:{startDate:e,endDate:t,driverId:r}}).then(s=>s.data),getCustomerStatement:(e,t,r)=>ie.get(`/reports/customer-statement/${e}`,{params:{startDate:t,endDate:r}}).then(s=>s.data),getVanPerformance:(e,t,r)=>ie.get("/reports/van-performance",{params:{startDate:e,endDate:t,vanId:r}}).then(s=>s.data)},Oc={getAll:e=>ie.get("/attendance",{params:e}),getById:e=>ie.get(`/attendance/${e}`),getByEmployee:(e,t)=>ie.get(`/attendance/employee/${e}`,{params:t}),getSummary:e=>ie.get("/attendance/summary",{params:e}),getEmployees:()=>ie.get("/attendance/employees"),create:e=>ie.post("/attendance",e),createBulk:e=>ie.post("/attendance/bulk",e),update:(e,t)=>ie.put(`/attendance/${e}`,t),delete:e=>ie.delete(`/attendance/${e}`)},Tl={getAll:e=>ie.get("/rawmaterials",{params:e}).then(t=>t.data),getById:e=>ie.get(`/rawmaterials/${e}`).then(t=>t.data),create:e=>ie.post("/rawmaterials",e).then(t=>t.data),update:(e,t)=>ie.put(`/rawmaterials/${e}`,t),delete:e=>ie.delete(`/rawmaterials/${e}`),getInventory:e=>ie.get(`/rawmaterials/${e}/inventory`).then(t=>t.data),getAllInventory:e=>ie.get("/rawmaterials/inventory/all",{params:e}).then(t=>t.data),adjustInventory:(e,t)=>ie.post(`/rawmaterials/${e}/inventory/adjust`,t)},dl={getAll:e=>ie.get("/rawmaterialpurchases",{params:e}).then(t=>t.data),getById:e=>ie.get(`/rawmaterialpurchases/${e}`).then(t=>t.data),create:e=>ie.post("/rawmaterialpurchases",e).then(t=>t.data),recordPayment:(e,t)=>ie.put(`/rawmaterialpurchases/${e}/payment`,t),delete:e=>ie.delete(`/rawmaterialpurchases/${e}`)},Sb={get:()=>ie.get("/online-store-settings").then(e=>e.data),update:e=>ie.put("/online-store-settings",e),getAvailableCategories:()=>ie.get("/online-store-settings/available-categories").then(e=>e.data)},sh={getAll:e=>ie.get("/onlineorders",{params:e}).then(t=>t.data),getById:e=>ie.get(`/onlineorders/${e}`).then(t=>t.data),updateStatus:(e,t)=>ie.put(`/onlineorders/${e}/status`,t),assignDriver:(e,t)=>ie.put(`/onlineorders/${e}/assign-driver`,t),requestDriver:e=>ie.put(`/onlineorders/${e}/request-driver`),getStats:()=>ie.get("/onlineorders/stats").then(e=>e.data)},Sn={getAccounts:e=>ie.get("/accounting/accounts",{params:e}).then(t=>t.data),getAccount:e=>ie.get(`/accounting/accounts/${e}`).then(t=>t.data),createAccount:e=>ie.post("/accounting/accounts",e).then(t=>t.data),updateAccount:(e,t)=>ie.put(`/accounting/accounts/${e}`,t),deleteAccount:e=>ie.delete(`/accounting/accounts/${e}`),getJournalEntries:e=>ie.get("/accounting/journal-entries",{params:e}).then(t=>t.data),getJournalEntry:e=>ie.get(`/accounting/journal-entries/${e}`).then(t=>t.data),createJournalEntry:e=>ie.post("/accounting/journal-entries",e).then(t=>t.data),reverseJournalEntry:e=>ie.post(`/accounting/journal-entries/${e}/reverse`).then(t=>t.data),getLedger:(e,t)=>ie.get(`/accounting/ledger/${e}`,{params:t}).then(r=>r.data),getTrialBalance:e=>ie.get("/accounting/reports/trial-balance",{params:e}).then(t=>t.data),getIncomeStatement:(e,t)=>ie.get("/accounting/reports/income-statement",{params:{startDate:e,endDate:t}}).then(r=>r.data),getBalanceSheet:e=>ie.get("/accounting/reports/balance-sheet",{params:e}).then(t=>t.data),resetAccounting:()=>ie.post("/accounting/reset").then(e=>e.data)},el={getAll:e=>ie.get("/productionorders",{params:e}).then(t=>t.data),getById:e=>ie.get(`/productionorders/${e}`).then(t=>t.data),create:e=>ie.post("/productionorders",e).then(t=>t.data),addCost:(e,t)=>ie.post(`/productionorders/${e}/costs`,t).then(r=>r.data),removeCost:(e,t)=>ie.delete(`/productionorders/${e}/costs/${t}`),complete:e=>ie.post(`/productionorders/${e}/complete`).then(t=>t.data),delete:e=>ie.delete(`/productionorders/${e}`)};function wy(){const[e,t]=m.useState(null),[r,s]=m.useState(!0);m.useEffect(()=>{const l=localStorage.getItem("token"),o=localStorage.getItem("user");l&&o&&t(JSON.parse(o)),s(!1)},[]);const n=m.useCallback(async(l,o)=>{const c=await UU.login(l,o),{token:u,user:d}=c.data;return localStorage.setItem("token",u),localStorage.setItem("user",JSON.stringify(d)),t(d),d},[]),i=m.useCallback(()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),t(null)},[]);return{user:e,isAuthenticated:!!e,isLoading:r,login:n,logout:i}}const V6=m.createContext(null);function WU({children:e}){const{user:t,isLoading:r}=wy(),s=(t==null?void 0:t.role)==="CompanyAdmin"||(t==null?void 0:t.isSuperAdmin)||!1,n=(t==null?void 0:t.permissions)||{},i=c=>s?!0:n[c]===!0,l=c=>s?!0:c.some(u=>n[u]===!0),o=c=>s?!0:c.every(u=>n[u]===!0);return a.jsx(V6.Provider,{value:{permissions:n,hasPermission:i,hasAnyPermission:l,hasAllPermissions:o,isCompanyAdmin:s,isLoading:r},children:e})}function Ny(){const e=m.useContext(V6);if(!e)throw new Error("usePermissions must be used within a PermissionProvider");return e}const Ve={VIEW_DASHBOARD:"View dashboard",VIEW_EMPLOYEES:"View employees",CREATE_EMPLOYEES:"Create employees",EDIT_EMPLOYEES:"Edit employees",DELETE_EMPLOYEES:"Delete employees",MANAGE_EMPLOYEE_PAYMENTS:"Manage employee payments",VIEW_ATTENDANCE:"View attendance",VIEW_ROLES:"View roles",CREATE_ROLES:"Create roles",EDIT_ROLES:"Edit roles",DELETE_ROLES:"Delete roles",VIEW_VANS:"View vans",CREATE_VANS:"Create vans",EDIT_VANS:"Edit vans",DELETE_VANS:"Delete vans",VIEW_VAN_STOCK:"View van stock",VIEW_WAREHOUSES:"View warehouses",CREATE_WAREHOUSES:"Create warehouses",EDIT_WAREHOUSES:"Edit warehouses",DELETE_WAREHOUSES:"Delete warehouses",VIEW_PRODUCTS:"View products",CREATE_PRODUCTS:"Create products",EDIT_PRODUCTS:"Edit products",DELETE_PRODUCTS:"Delete products",MANAGE_COST_HISTORY:"Manage cost history",VIEW_CATEGORIES:"View categories",VIEW_UNITS:"View units",VIEW_INVENTORY_VALUATION:"View inventory valuation",EDIT_INVENTORY_SETTINGS:"Edit inventory settings",ADJUST_STOCK_LEVELS:"Adjust stock levels",VIEW_CUSTOMERS:"View customers",CREATE_CUSTOMERS:"Create customers",EDIT_CUSTOMERS:"Edit customers",MANAGE_SPECIAL_PRICES:"Manage special prices",VIEW_LEADS:"View leads",VIEW_ORDERS:"View orders",VIEW_QUOTES:"View quotes",VIEW_DIRECT_SALES:"View direct sales",VIEW_RETURNS:"View returns",VIEW_SUPPLIERS:"View suppliers",VIEW_EXPENSES:"View expenses",VIEW_COLLECTIONS:"View collections",VIEW_CURRENCIES:"View currencies",VIEW_DEEP_REPORT:"View deep report",VIEW_SALES_REPORT:"View sales report",VIEW_SETTINGS:"View settings",VIEW_ONLINE_STORE:"View online store",VIEW_ONLINE_ORDERS:"View online orders",VIEW_ACCOUNTING:"View accounting",VIEW_FINANCIAL_REPORTS:"View financial reports"};/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VU=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),H6=(...e)=>e.filter((t,r,s)=>!!t&&t.trim()!==""&&s.indexOf(t)===r).join(" ").trim();/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var HU={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qU=m.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:s,className:n="",children:i,iconNode:l,...o},c)=>m.createElement("svg",{ref:c,...HU,width:t,height:t,stroke:e,strokeWidth:s?Number(r)*24/Number(t):r,className:H6("lucide",n),...o},[...l.map(([u,d])=>m.createElement(u,d)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tt=(e,t)=>{const r=m.forwardRef(({className:s,...n},i)=>m.createElement(qU,{ref:i,iconNode:t,className:H6(`lucide-${VU(e)}`,s),...n}));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZC=tt("ArrowDownToLine",[["path",{d:"M12 17V3",key:"1cwfxf"}],["path",{d:"m6 11 6 6 6-6",key:"12ii2o"}],["path",{d:"M19 21H5",key:"150jfl"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KU=tt("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GU=tt("ArrowLeftRight",[["path",{d:"M8 3 4 7l4 4",key:"9rb6wj"}],["path",{d:"M4 7h16",key:"6tx8e3"}],["path",{d:"m16 21 4-4-4-4",key:"siv7j2"}],["path",{d:"M20 17H4",key:"h6l3hr"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ff=tt("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QU=tt("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fh=tt("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XU=tt("ArrowUpFromLine",[["path",{d:"m18 9-6-6-6 6",key:"kcunyi"}],["path",{d:"M12 3v14",key:"7cf3v8"}],["path",{d:"M5 21h14",key:"11awu3"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YU=tt("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JU=tt("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e4=tt("Banknote",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oo=tt("Barcode",[["path",{d:"M3 5v14",key:"1nt18q"}],["path",{d:"M8 5v14",key:"1ybrkv"}],["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"M17 5v14",key:"ycjyhj"}],["path",{d:"M21 5v14",key:"nzette"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZU=tt("BookMarked",[["path",{d:"M10 2v8l3-3 3 3V2",key:"sqw3rj"}],["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eW=tt("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tW=tt("Box",[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rW=tt("Boxes",[["path",{d:"M2.97 12.92A2 2 0 0 0 2 14.63v3.24a2 2 0 0 0 .97 1.71l3 1.8a2 2 0 0 0 2.06 0L12 19v-5.5l-5-3-4.03 2.42Z",key:"lc1i9w"}],["path",{d:"m7 16.5-4.74-2.85",key:"1o9zyk"}],["path",{d:"m7 16.5 5-3",key:"va8pkn"}],["path",{d:"M7 16.5v5.17",key:"jnp8gn"}],["path",{d:"M12 13.5V19l3.97 2.38a2 2 0 0 0 2.06 0l3-1.8a2 2 0 0 0 .97-1.71v-3.24a2 2 0 0 0-.97-1.71L17 10.5l-5 3Z",key:"8zsnat"}],["path",{d:"m17 16.5-5-3",key:"8arw3v"}],["path",{d:"m17 16.5 4.74-2.85",key:"8rfmw"}],["path",{d:"M17 16.5v5.17",key:"k6z78m"}],["path",{d:"M7.97 4.42A2 2 0 0 0 7 6.13v4.37l5 3 5-3V6.13a2 2 0 0 0-.97-1.71l-3-1.8a2 2 0 0 0-2.06 0l-3 1.8Z",key:"1xygjf"}],["path",{d:"M12 8 7.26 5.15",key:"1vbdud"}],["path",{d:"m12 8 4.74-2.85",key:"3rx089"}],["path",{d:"M12 13.5V8",key:"1io7kd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aW=tt("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t4=tt("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sW=tt("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nW=tt("CalendarCheck",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ro=tt("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qi=tt("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q6=tt("ChartPie",[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jt=tt("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i2=tt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iW=tt("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K6=tt("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G6=tt("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kb=tt("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o0=tt("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dj=tt("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r4=tt("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Up=tt("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q6=tt("Coins",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rh=tt("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const da=tt("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nx=tt("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lW=tt("Equal",[["line",{x1:"5",x2:"19",y1:"9",y2:"9",key:"1nwqeh"}],["line",{x1:"5",x2:"19",y1:"15",y2:"15",key:"g8yjpy"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gs=tt("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wp=tt("Factory",[["path",{d:"M2 20a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8l-7 5V8l-7 5V4a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"159hny"}],["path",{d:"M17 18h1",key:"uldtlt"}],["path",{d:"M12 18h1",key:"s9uhes"}],["path",{d:"M7 18h1",key:"1neino"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oW=tt("FileChartColumnIncreasing",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 18v-2",key:"qcmpov"}],["path",{d:"M12 18v-4",key:"q1q25u"}],["path",{d:"M16 18v-6",key:"15y0np"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X6=tt("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Br=tt("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l2=tt("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cW=tt("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dW=tt("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fj=tt("HandCoins",[["path",{d:"M11 15h2a2 2 0 1 0 0-4h-3c-.6 0-1.1.2-1.4.6L3 17",key:"geh8rc"}],["path",{d:"m7 21 1.6-1.4c.3-.4.8-.6 1.4-.6h4c1.1 0 2.1-.4 2.8-1.2l4.6-4.4a2 2 0 0 0-2.75-2.91l-4.2 3.9",key:"1fto5m"}],["path",{d:"m2 16 6 6",key:"1pfhp9"}],["circle",{cx:"16",cy:"9",r:"2.9",key:"1n0dlu"}],["circle",{cx:"6",cy:"5",r:"3",key:"151irh"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sp=tt("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rj=tt("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uW=tt("Landmark",[["line",{x1:"3",x2:"21",y1:"22",y2:"22",key:"j8o0r"}],["line",{x1:"6",x2:"6",y1:"18",y2:"11",key:"10tf0k"}],["line",{x1:"10",x2:"10",y1:"18",y2:"11",key:"54lgf6"}],["line",{x1:"14",x2:"14",y1:"18",y2:"11",key:"380y"}],["line",{x1:"18",x2:"18",y1:"18",y2:"11",key:"1kevvc"}],["polygon",{points:"12 2 20 7 4 7",key:"jkujk7"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hW=tt("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y6=tt("ListChecks",[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vt=tt("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fW=tt("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dc=tt("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xW=tt("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cb=tt("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tr=tt("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mW=tt("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pW=tt("PanelLeftClose",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"m16 15-3-3 3-3",key:"14y99z"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gW=tt("PanelLeft",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yW=tt("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vW=tt("Percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vp=tt("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hr=tt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ua=tt("Printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yo=tt("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mj=tt("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ao=tt("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J6=tt("Ruler",[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bW=tt("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jW=tt("Scale",[["path",{d:"m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"7g6ntu"}],["path",{d:"m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"ijws7r"}],["path",{d:"M7 21h10",key:"1b0cd5"}],["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2",key:"3gwbw2"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Na=tt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lj=tt("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wW=tt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NW=tt("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SW=tt("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ix=tt("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kW=tt("SlidersHorizontal",[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const js=tt("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CW=tt("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z6=tt("Store",[["path",{d:"m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7",key:"ztvudi"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["path",{d:"M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4",key:"2ebpfo"}],["path",{d:"M2 7h20",key:"1fcdvo"}],["path",{d:"M22 7v3a2 2 0 0 1-2 2a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 16 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 12 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 8 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 4 12a2 2 0 0 1-2-2V7",key:"6c3vgh"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xf=tt("Tags",[["path",{d:"m15 5 6.3 6.3a2.4 2.4 0 0 1 0 3.4L17 19",key:"1cbfv1"}],["path",{d:"M9.586 5.586A2 2 0 0 0 8.172 5H3a1 1 0 0 0-1 1v5.172a2 2 0 0 0 .586 1.414L8.29 18.29a2.426 2.426 0 0 0 3.42 0l3.58-3.58a2.426 2.426 0 0 0 0-3.42z",key:"135mg7"}],["circle",{cx:"6.5",cy:"9.5",r:".5",fill:"currentColor",key:"5pm5xn"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a4=tt("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xr=tt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EW=tt("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hn=tt("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c0=tt("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const On=tt("Truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s4=tt("Undo2",[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5a5.5 5.5 0 0 1-5.5 5.5H11",key:"f3b9sd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d0=tt("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hp=tt("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PW=tt("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ed=tt("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AW=tt("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sy=tt("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const so=tt("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n4=tt("Wallet",[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gl=tt("Warehouse",[["path",{d:"M22 8.35V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8.35A2 2 0 0 1 3.26 6.5l8-3.2a2 2 0 0 1 1.48 0l8 3.2A2 2 0 0 1 22 8.35Z",key:"gksnxg"}],["path",{d:"M6 18h12",key:"9pbo8z"}],["path",{d:"M6 14h12",key:"4cwo0f"}],["rect",{width:"12",height:"12",x:"6",y:"10",key:"apd30q"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yt=tt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),_W=[{title:"Main",items:[{path:"/",label:"Dashboard",icon:hW,permission:Ve.VIEW_DASHBOARD}]},{title:"Team",items:[{path:"/employees",label:"Employees",icon:PW,permission:Ve.VIEW_EMPLOYEES},{path:"/attendance",label:"Attendance",icon:nW,permission:Ve.VIEW_ATTENDANCE},{path:"/roles",label:"Roles",icon:NW,permission:Ve.VIEW_ROLES}]},{title:"Operations",items:[{path:"/vans",label:"Vans",icon:On,permission:Ve.VIEW_VANS},{path:"/salesmen",label:"Salesmen",icon:aW,permission:Ve.VIEW_EMPLOYEES},{path:"/warehouses",label:"Warehouses",icon:gl,permission:Ve.VIEW_WAREHOUSES}]},{title:"Inventory",items:[{path:"/products",label:"Products",icon:Tr,permission:Ve.VIEW_PRODUCTS},{path:"/categories",label:"Categories",icon:xf,permission:Ve.VIEW_CATEGORIES},{path:"/units",label:"Units",icon:J6,permission:Ve.VIEW_UNITS},{path:"/stock-adjustment",label:"Stock Adjust",icon:Fh,permission:Ve.ADJUST_STOCK_LEVELS},{path:"/valuation",label:"Valuation",icon:jW,permission:Ve.VIEW_INVENTORY_VALUATION},{path:"/inventory-settings",label:"Inv Settings",icon:kW,permission:Ve.EDIT_INVENTORY_SETTINGS}]},{title:"Production",items:[{path:"/raw-materials",label:"Raw Materials",icon:rW,permission:Ve.VIEW_PRODUCTS},{path:"/raw-material-purchases",label:"RM Purchases",icon:Br,permission:Ve.VIEW_SUPPLIERS},{path:"/production-orders",label:"Production",icon:Wp,permission:Ve.VIEW_PRODUCTS}]},{title:"Sales",items:[{path:"/customers",label:"Customers",icon:so,permission:Ve.VIEW_CUSTOMERS},{path:"/leads",label:"Leads",icon:Ed,permission:Ve.VIEW_LEADS},{path:"/tasks",label:"Orders & Tasks",icon:Y6,permission:Ve.VIEW_ORDERS},{path:"/quotes",label:"Quotes",icon:Br,permission:Ve.VIEW_QUOTES},{path:"/direct-sales",label:"Direct Sales",icon:ix,permission:Ve.VIEW_DIRECT_SALES}]},{title:"Finance",items:[{path:"/cash",label:"Cash",icon:Fj,permission:Ve.VIEW_COLLECTIONS},{path:"/suppliers",label:"Suppliers",icon:On,permission:Ve.VIEW_SUPPLIERS},{path:"/expenses",label:"Expenses",icon:Yo,permission:Ve.VIEW_EXPENSES},{path:"/currencies",label:"Currencies",icon:Q6,permission:Ve.VIEW_CURRENCIES}]},{title:"Accounting",items:[{path:"/chart-of-accounts",label:"Chart of Accounts",icon:eW,permission:Ve.VIEW_ACCOUNTING},{path:"/journal-entries",label:"Journal Entries",icon:ZU,permission:Ve.VIEW_ACCOUNTING},{path:"/account-ledger",label:"Account Ledger",icon:uW,permission:Ve.VIEW_ACCOUNTING},{path:"/financial-reports",label:"Financial Reports",icon:oW,permission:Ve.VIEW_FINANCIAL_REPORTS}]},{title:"Reports",items:[{path:"/reports",label:"Reports",icon:qi,permission:Ve.VIEW_SALES_REPORT},{path:"/deep-report",label:"Deep Report",icon:sp,permission:Ve.VIEW_DEEP_REPORT}]},{title:"Online Store",items:[{path:"/online-store-settings",label:"Store Settings",icon:Z6,permission:Ve.VIEW_ONLINE_STORE},{path:"/online-orders",label:"Online Orders",icon:SW,permission:Ve.VIEW_ONLINE_ORDERS}]},{title:"Settings",items:[{path:"/settings",label:"Settings",icon:wW,permission:Ve.VIEW_SETTINGS}]}];function TW(){const{user:e,logout:t}=wy(),{hasPermission:r,isCompanyAdmin:s}=Ny(),[n,i]=m.useState(!0),[l,o]=m.useState(""),c=()=>{t(),window.location.href="/login"},u=_W.map(d=>({...d,items:d.items.filter(h=>h.permission&&!s&&!r(h.permission)?!1:l.trim()?h.label.toLowerCase().includes(l.toLowerCase()):!0)})).filter(d=>d.items.length>0);return a.jsxs("div",{className:"min-h-screen bg-gray-100",children:[a.jsxs("aside",{className:`fixed top-0 left-0 h-screen bg-[#003366] flex flex-col transition-all duration-300 ${n?"w-60":"w-16"}`,children:[a.jsxs("div",{className:"p-4 border-b border-[#002244] flex-shrink-0 flex items-center justify-between",children:[n&&a.jsxs("h1",{className:"text-xl font-bold text-white flex items-center gap-2",children:[a.jsx(qi,{size:24,className:"text-emerald-400"}),"Company Admin"]}),a.jsx("button",{onClick:()=>i(!n),className:"p-2 text-white hover:bg-[#002244] rounded-lg",children:n?a.jsx(pW,{size:20}):a.jsx(gW,{size:20})})]}),n&&a.jsx("div",{className:"px-3 py-2 border-b border-[#002244]",children:a.jsxs("div",{className:"relative",children:[a.jsx(Na,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Search pages...",value:l,onChange:d=>o(d.target.value),className:"w-full pl-9 pr-8 py-2 text-sm bg-[#002244] border border-[#001a33] rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-1 focus:ring-emerald-400"}),l&&a.jsx("button",{onClick:()=>o(""),className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-white",children:a.jsx(yt,{size:14})})]})}),a.jsx("nav",{className:"py-2 flex-1 overflow-y-auto",children:u.map(d=>a.jsxs("div",{className:"mb-2",children:[n&&a.jsx("div",{className:"px-4 py-2 text-xs font-semibold text-gray-400 uppercase tracking-wider",children:d.title}),d.items.map(h=>a.jsxs(Cz,{to:h.path,className:({isActive:f})=>`flex items-center gap-3 px-4 py-2.5 text-white transition-colors ${f?"bg-[#002244] text-emerald-400":"hover:bg-[#002244]"}`,title:n?void 0:h.label,children:[a.jsx(h.icon,{size:18,className:"flex-shrink-0"}),n&&a.jsx("span",{className:"text-sm",children:h.label})]},h.path))]},d.title))}),a.jsxs("div",{className:"flex-shrink-0 p-4 border-t border-[#002244] bg-[#003366]",children:[n&&a.jsxs("div",{className:"mb-3",children:[a.jsx("p",{className:"font-medium text-white text-sm",children:e==null?void 0:e.name}),a.jsx("p",{className:"text-xs text-gray-400",children:e==null?void 0:e.companyName})]}),a.jsxs("button",{onClick:c,className:`flex items-center gap-3 w-full px-4 py-2 text-red-400 hover:bg-[#002244] rounded-lg text-sm ${n?"":"justify-center px-2"}`,title:n?void 0:"Logout",children:[a.jsx(fW,{size:18}),n&&a.jsx("span",{children:"Logout"})]})]})]}),a.jsx("main",{className:`p-6 min-h-screen transition-all duration-300 ${n?"ml-60":"ml-16"}`,children:a.jsx(uz,{})})]})}const IW={"/":Ve.VIEW_DASHBOARD,"/employees":Ve.VIEW_EMPLOYEES,"/attendance":Ve.VIEW_ATTENDANCE,"/roles":Ve.VIEW_ROLES,"/vans":Ve.VIEW_VANS,"/salesmen":Ve.VIEW_EMPLOYEES,"/warehouses":Ve.VIEW_WAREHOUSES,"/products":Ve.VIEW_PRODUCTS,"/categories":Ve.VIEW_CATEGORIES,"/units":Ve.VIEW_UNITS,"/valuation":Ve.VIEW_INVENTORY_VALUATION,"/inventory-settings":Ve.EDIT_INVENTORY_SETTINGS,"/raw-materials":Ve.VIEW_PRODUCTS,"/raw-material-purchases":Ve.VIEW_SUPPLIERS,"/production-orders":Ve.VIEW_PRODUCTS,"/customers":Ve.VIEW_CUSTOMERS,"/leads":Ve.VIEW_LEADS,"/tasks":Ve.VIEW_ORDERS,"/quotes":Ve.VIEW_QUOTES,"/direct-sales":Ve.VIEW_DIRECT_SALES,"/sales-history":Ve.VIEW_DIRECT_SALES,"/returns":Ve.VIEW_RETURNS,"/cash":Ve.VIEW_COLLECTIONS,"/suppliers":Ve.VIEW_SUPPLIERS,"/expenses":Ve.VIEW_EXPENSES,"/currencies":Ve.VIEW_CURRENCIES,"/reports":Ve.VIEW_SALES_REPORT,"/deep-report":Ve.VIEW_DEEP_REPORT,"/settings":Ve.VIEW_SETTINGS},OW=["/","/direct-sales","/tasks","/products","/customers","/cash","/reports","/deep-report","/employees","/warehouses","/vans","/suppliers","/expenses","/currencies","/settings"];function dr({permission:e,children:t}){const{hasPermission:r,isCompanyAdmin:s}=Ny();return s||!e||r(e)?a.jsx(a.Fragment,{children:t}):a.jsx(eI,{})}function eI(){const{hasPermission:e,isCompanyAdmin:t}=Ny();if(t)return a.jsx(Fp,{to:"/",replace:!0});for(const r of OW){const s=IW[r];if(s&&e(s))return a.jsx(Fp,{to:r,replace:!0})}return a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:a.jsxs("div",{className:"text-center",children:[a.jsx("h2",{className:"text-xl font-bold text-gray-700",children:"No Access"}),a.jsx("p",{className:"text-gray-500 mt-2",children:"You don't have permission to access any pages. Contact your administrator."})]})})}function DW(){const[e,t]=m.useState(""),[r,s]=m.useState(""),[n,i]=m.useState(""),[l,o]=m.useState(!1),{login:c}=wy(),u=async d=>{var h,f;d.preventDefault(),i(""),o(!0);try{await c(e,r),window.location.href="/"}catch(x){i(((f=(h=x.response)==null?void 0:h.data)==null?void 0:f.message)||"Login failed"),o(!1)}};return a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-pink-500 to-pink-700",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx("h1",{className:"text-3xl font-bold text-pink-600",children:"Catalyst"}),a.jsx("p",{className:"text-gray-500 mt-2",children:"Company Admin Portal"})]}),a.jsxs("form",{onSubmit:u,className:"space-y-6",children:[n&&a.jsx("div",{className:"bg-red-50 text-red-600 p-3 rounded-lg text-sm",children:n}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Username"}),a.jsx("input",{type:"text",value:e,onChange:d=>t(d.target.value),className:"input",placeholder:"Enter your username",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),a.jsx("input",{type:"password",value:r,onChange:d=>s(d.target.value),className:"input",placeholder:"Enter your password",required:!0})]}),a.jsx("button",{type:"submit",disabled:l,className:"w-full bg-pink-600 hover:bg-pink-700 text-white rounded-lg py-3 font-medium disabled:opacity-50",children:l?"Signing in...":"Sign In"})]})]})})}function FW(){const[e,t]=m.useState(!0),[r,s]=m.useState(null),[n,i]=m.useState({customers:0,drivers:0,vans:0});m.useEffect(()=>{l()},[]);const l=async()=>{var c,u,d,h;t(!0);try{const[f,x,p,g]=await Promise.all([_o.getDashboard(),Ha.getAll(),hs.getAll(),rn.getAll()]);s(f),i({customers:((c=x.data)==null?void 0:c.length)||0,drivers:((d=(u=p.data)==null?void 0:u.filter(y=>y.role==="Driver"))==null?void 0:d.length)||0,vans:((h=g.data)==null?void 0:h.length)||0})}catch(f){console.error("Failed to load dashboard:",f)}finally{t(!1)}},o=c=>`$${(c||0).toFixed(3)}`;return e?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx(vt,{className:"animate-spin text-emerald-500",size:48})}):a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Dashboard"}),a.jsx("button",{onClick:l,className:"px-4 py-2 bg-emerald-500 text-white rounded-lg text-sm hover:bg-emerald-600",children:"Refresh"})]}),a.jsx("h2",{className:"text-lg font-semibold text-gray-700 mb-4",children:"Today's Overview"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:[a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-5",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-gray-500 text-sm",children:"Today's Sales"}),a.jsx("p",{className:"text-2xl font-bold text-emerald-600",children:o((r==null?void 0:r.todaySales)||0)})]}),a.jsx("div",{className:"p-3 bg-emerald-100 rounded-lg",children:a.jsx(da,{className:"text-emerald-600",size:24})})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-5",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-gray-500 text-sm",children:"Today's Orders"}),a.jsx("p",{className:"text-2xl font-bold text-blue-600",children:(r==null?void 0:r.todayOrders)||0})]}),a.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:a.jsx(ix,{className:"text-blue-600",size:24})})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-5",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-gray-500 text-sm",children:"Collections"}),a.jsx("p",{className:"text-2xl font-bold text-purple-600",children:o((r==null?void 0:r.todayCollections)||0)})]}),a.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:a.jsx(Fj,{className:"text-purple-600",size:24})})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-5",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-gray-500 text-sm",children:"Deposits"}),a.jsx("p",{className:"text-2xl font-bold text-orange-600",children:o((r==null?void 0:r.todayDeposits)||0)})]}),a.jsx("div",{className:"p-3 bg-orange-100 rounded-lg",children:a.jsx(Rh,{className:"text-orange-600",size:24})})]})})]}),a.jsx("h2",{className:"text-lg font-semibold text-gray-700 mb-4",children:"This Month"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-8",children:[a.jsx("div",{className:"bg-gradient-to-br from-emerald-500 to-emerald-600 rounded-xl shadow-sm p-5 text-white",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-emerald-100 text-sm",children:"Month Sales"}),a.jsx("p",{className:"text-3xl font-bold",children:o((r==null?void 0:r.monthSales)||0)})]}),a.jsx(hn,{size:32,className:"text-emerald-200"})]})}),a.jsx("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl shadow-sm p-5 text-white",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-blue-100 text-sm",children:"Month Orders"}),a.jsx("p",{className:"text-3xl font-bold",children:(r==null?void 0:r.monthOrders)||0})]}),a.jsx(Tr,{size:32,className:"text-blue-200"})]})}),a.jsx("div",{className:"bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl shadow-sm p-5 text-white",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-purple-100 text-sm",children:"Month Collections"}),a.jsx("p",{className:"text-3xl font-bold",children:o((r==null?void 0:r.monthCollections)||0)})]}),a.jsx(Fj,{size:32,className:"text-purple-200"})]})})]}),a.jsx("h2",{className:"text-lg font-semibold text-gray-700 mb-4",children:"Key Metrics"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-8",children:[a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-5 border-l-4 border-red-500",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-gray-500 text-sm",children:"Outstanding Debt"}),a.jsx("p",{className:"text-2xl font-bold text-red-600",children:o((r==null?void 0:r.totalOutstandingDebt)||0)})]}),a.jsx(Y6,{className:"text-red-400",size:28})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-5 border-l-4 border-cyan-500",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-gray-500 text-sm",children:"Cash in Vans"}),a.jsx("p",{className:"text-2xl font-bold text-cyan-600",children:o((r==null?void 0:r.cashInVans)||0)})]}),a.jsx(On,{className:"text-cyan-400",size:28})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-5 border-l-4 border-green-500",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-gray-500 text-sm",children:"Active Drivers"}),a.jsx("p",{className:"text-2xl font-bold text-green-600",children:(r==null?void 0:r.activeDrivers)||0})]}),a.jsx(Hp,{className:"text-green-400",size:28})]})})]}),a.jsx("h2",{className:"text-lg font-semibold text-gray-700 mb-4",children:"System Totals"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-5",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:a.jsx(so,{className:"text-blue-600",size:24})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-gray-500 text-sm",children:"Total Customers"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:n.customers})]})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-5",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:a.jsx(Hp,{className:"text-green-600",size:24})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-gray-500 text-sm",children:"Total Drivers"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:n.drivers})]})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-5",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"p-3 bg-cyan-100 rounded-lg",children:a.jsx(On,{className:"text-cyan-600",size:24})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-gray-500 text-sm",children:"Total Vans"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:n.vans})]})]})})]})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var qp={};qp.version="0.18.5";var tI=1252,RW=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],o2={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},c2=function(e){RW.indexOf(e)!=-1&&(tI=o2[0]=e)};function MW(){c2(1252)}var Li=function(e){c2(e)};function d2(){Li(1200),MW()}function i4(e){for(var t=[],r=0,s=e.length;r<s;++r)t[r]=e.charCodeAt(r);return t}function LW(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function rI(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var bh=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?LW(e.slice(2)):t==254&&r==255?rI(e.slice(2)):t==65279?e.slice(1):e},um=function(t){return String.fromCharCode(t)},l4=function(t){return String.fromCharCode(t)},mf,Jo="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function pf(e){for(var t="",r=0,s=0,n=0,i=0,l=0,o=0,c=0,u=0;u<e.length;)r=e.charCodeAt(u++),i=r>>2,s=e.charCodeAt(u++),l=(r&3)<<4|s>>4,n=e.charCodeAt(u++),o=(s&15)<<2|n>>6,c=n&63,isNaN(s)?o=c=64:isNaN(n)&&(c=64),t+=Jo.charAt(i)+Jo.charAt(l)+Jo.charAt(o)+Jo.charAt(c);return t}function Qn(e){var t="",r=0,s=0,n=0,i=0,l=0,o=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)i=Jo.indexOf(e.charAt(u++)),l=Jo.indexOf(e.charAt(u++)),r=i<<2|l>>4,t+=String.fromCharCode(r),o=Jo.indexOf(e.charAt(u++)),s=(l&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(s)),c=Jo.indexOf(e.charAt(u++)),n=(o&3)<<6|c,c!==64&&(t+=String.fromCharCode(n));return t}var cr=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),go=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function xc(e){return cr?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function o4(e){return cr?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var zn=function(t){return cr?go(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function ky(e){if(typeof ArrayBuffer>"u")return zn(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),s=0;s!=e.length;++s)r[s]=e.charCodeAt(s)&255;return t}function Cc(e){if(Array.isArray(e))return e.map(function(s){return String.fromCharCode(s)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function $W(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function u2(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return u2(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var ps=cr?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:go(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var s=new Uint8Array(r),n=0;for(t=0,r=0;t<e.length;r+=n,++t)if(n=e[t].length,e[t]instanceof Uint8Array)s.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";s.set(new Uint8Array(e[t]),r)}return s}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function BW(e){for(var t=[],r=0,s=e.length+250,n=xc(e.length+255),i=0;i<e.length;++i){var l=e.charCodeAt(i);if(l<128)n[r++]=l;else if(l<2048)n[r++]=192|l>>6&31,n[r++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var o=e.charCodeAt(++i)&1023;n[r++]=240|l>>8&7,n[r++]=128|l>>2&63,n[r++]=128|o>>6&15|(l&3)<<4,n[r++]=128|o&63}else n[r++]=224|l>>12&15,n[r++]=128|l>>6&63,n[r++]=128|l&63;r>s&&(t.push(n.slice(0,r)),r=0,n=xc(65535),s=65530)}return t.push(n.slice(0,r)),ps(t)}var un=/\u0000/g,jh=/[\u0001-\u0006]/g;function Fu(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function $i(e,t){var r=""+e;return r.length>=t?r:_a("0",t-r.length)+r}function h2(e,t){var r=""+e;return r.length>=t?r:_a(" ",t-r.length)+r}function Kp(e,t){var r=""+e;return r.length>=t?r:r+_a(" ",t-r.length)}function zW(e,t){var r=""+Math.round(e);return r.length>=t?r:_a("0",t-r.length)+r}function UW(e,t){var r=""+e;return r.length>=t?r:_a("0",t-r.length)+r}var c4=Math.pow(2,32);function nu(e,t){if(e>c4||e<-c4)return zW(e,t);var r=Math.round(e);return UW(r,t)}function Gp(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var d4=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Eb=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function WW(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Wt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},u4={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},VW={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Qp(e,t,r){for(var s=e<0?-1:1,n=e*s,i=0,l=1,o=0,c=1,u=0,d=0,h=Math.floor(n);u<t&&(h=Math.floor(n),o=h*l+i,d=h*u+c,!(n-h<5e-8));)n=1/(n-h),i=l,l=o,c=u,u=d;if(d>t&&(u>t?(d=c,o=i):(d=u,o=l)),!r)return[0,s*o,d];var f=Math.floor(s*o/d);return[f,s*o-f*d,d]}function Gc(e,t,r){if(e>2958465||e<0)return null;var s=e|0,n=Math.floor(86400*(e-s)),i=0,l=[],o={D:s,T:n,u:86400*(e-s)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(s+=1462),o.u>.9999&&(o.u=0,++n==86400&&(o.T=n=0,++s,++o.D)),s===60)l=r?[1317,10,29]:[1900,2,29],i=3;else if(s===0)l=r?[1317,8,29]:[1900,1,0],i=6;else{s>60&&--s;var c=new Date(1900,0,1);c.setDate(c.getDate()+s-1),l=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),s<60&&(i=(i+6)%7),r&&(i=XW(c,l))}return o.y=l[0],o.m=l[1],o.d=l[2],o.S=n%60,n=Math.floor(n/60),o.M=n%60,n=Math.floor(n/60),o.H=n,o.q=i,o}var aI=new Date(1899,11,31,0,0,0),HW=aI.getTime(),qW=new Date(1900,2,1,0,0,0);function sI(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=qW&&(r+=24*60*60*1e3),(r-(HW+(e.getTimezoneOffset()-aI.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function f2(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function KW(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function GW(e){var t=e<0?12:11,r=f2(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function QW(e){var t=f2(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function gf(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=GW(e):t===10?r=e.toFixed(10).substr(0,12):r=QW(e),f2(KW(r.toUpperCase()))}function Pd(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):gf(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return vi(14,sI(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function XW(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function YW(e,t,r,s){var n="",i=0,l=0,o=r.y,c,u=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:c=o%100,u=2;break;default:c=o%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,u=t.length;break;case 3:return Eb[r.m-1][1];case 5:return Eb[r.m-1][0];default:return Eb[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,u=t.length;break;case 3:return d4[r.q][0];default:return d4[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?$i(r.S,t.length):(s>=2?l=s===3?1e3:100:l=s===1?10:1,i=Math.round(l*(r.S+r.u)),i>=60*l&&(i=0),t==="s"?i===0?"0":""+i/l:(n=$i(i,2+s),t==="ss"?n.substr(0,2):"."+n.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:c=o,u=1;break}var d=u>0?$i(c,u):"";return d}function Zo(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,s=e.substr(0,r);r!=e.length;r+=t)s+=(s.length>0?",":"")+e.substr(r,t);return s}var nI=/%/g;function JW(e,t,r){var s=t.replace(nI,""),n=t.length-s.length;return ql(e,s,r*Math.pow(10,2*n))+_a("%",n)}function ZW(e,t,r){for(var s=t.length-1;t.charCodeAt(s-1)===44;)--s;return ql(e,t.substr(0,s),r/Math.pow(10,3*(t.length-s)))}function iI(e,t){var r,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+iI(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%n;if(i<0&&(i+=n),r=(t/Math.pow(10,i)).toPrecision(s+1+(n+i)%n),r.indexOf("e")===-1){var l=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+i):r+="E+"+(l-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,n)+"."+r.substr(2+n),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,d){return c+u+d.substr(0,(n+i)%n)+"."+d.substr(i)+"E"})}else r=t.toExponential(s);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var lI=/# (\?+)( ?)\/( ?)(\d+)/;function eV(e,t,r){var s=parseInt(e[4],10),n=Math.round(t*s),i=Math.floor(n/s),l=n-i*s,o=s;return r+(i===0?"":""+i)+" "+(l===0?_a(" ",e[1].length+1+e[4].length):h2(l,e[1].length)+e[2]+"/"+e[3]+$i(o,e[4].length))}function tV(e,t,r){return r+(t===0?"":""+t)+_a(" ",e[1].length+2+e[4].length)}var oI=/^#*0*\.([0#]+)/,cI=/\).*[0#]/,dI=/\(###\) ###\\?-####/;function nn(e){for(var t="",r,s=0;s!=e.length;++s)switch(r=e.charCodeAt(s)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function h4(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function f4(e,t){var r=e-Math.floor(e),s=Math.pow(10,t);return t<(""+Math.round(r*s)).length?0:Math.round(r*s)}function rV(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function aV(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function ai(e,t,r){if(e.charCodeAt(0)===40&&!t.match(cI)){var s=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ai("n",s,r):"("+ai("n",s,-r)+")"}if(t.charCodeAt(t.length-1)===44)return ZW(e,t,r);if(t.indexOf("%")!==-1)return JW(e,t,r);if(t.indexOf("E")!==-1)return iI(t,r);if(t.charCodeAt(0)===36)return"$"+ai(e,t.substr(t.charAt(1)==" "?2:1),r);var n,i,l,o,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+nu(c,t.length);if(t.match(/^[#?]+$/))return n=nu(r,0),n==="0"&&(n=""),n.length>t.length?n:nn(t.substr(0,t.length-n.length))+n;if(i=t.match(lI))return eV(i,c,u);if(t.match(/^#+0+$/))return u+nu(c,t.length-t.indexOf("0"));if(i=t.match(oI))return n=h4(r,i[1].length).replace(/^([^\.]+)$/,"$1."+nn(i[1])).replace(/\.$/,"."+nn(i[1])).replace(/\.(\d*)$/,function(p,g){return"."+g+_a("0",nn(i[1]).length-g.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+h4(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+Zo(nu(c,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ai(e,t,-r):Zo(""+(Math.floor(r)+rV(r,i[1].length)))+"."+$i(f4(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return ai(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Fu(ai(e,t.replace(/[\\-]/g,""),r)),l=0,Fu(Fu(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return l<n.length?n.charAt(l++):p==="0"?"0":""}));if(t.match(dI))return n=ai(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var d="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(i[4].length,7),o=Qp(c,Math.pow(10,l)-1,!1),n=""+u,d=ql("n",i[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),n+=d+i[2]+"/"+i[3],d=Kp(o[2],l),d.length<i[4].length&&(d=nn(i[4].substr(i[4].length-d.length))+d),n+=d,n;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(i[1].length,i[4].length),7),o=Qp(c,Math.pow(10,l)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?h2(o[1],l)+i[2]+"/"+i[3]+Kp(o[2],l):_a(" ",2*l+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return n=nu(r,0),t.length<=n.length?n:nn(t.substr(0,t.length-n.length))+n;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),l=n.indexOf(".");var h=t.indexOf(".")-l,f=t.length-n.length-h;return nn(t.substr(0,h)+n+t.substr(t.length-f))}if(i=t.match(/^00,000\.([#0]*0)$/))return l=f4(r,i[1].length),r<0?"-"+ai(e,t,-r):Zo(aV(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?$i(0,3-p.length):"")+p})+"."+$i(l,i[1].length);switch(t){case"###,##0.00":return ai(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var x=Zo(nu(c,0));return x!=="0"?u+x:"";case"###,###.00":return ai(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return ai(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function sV(e,t,r){for(var s=t.length-1;t.charCodeAt(s-1)===44;)--s;return ql(e,t.substr(0,s),r/Math.pow(10,3*(t.length-s)))}function nV(e,t,r){var s=t.replace(nI,""),n=t.length-s.length;return ql(e,s,r*Math.pow(10,2*n))+_a("%",n)}function uI(e,t){var r,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+uI(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%n;if(i<0&&(i+=n),r=(t/Math.pow(10,i)).toPrecision(s+1+(n+i)%n),!r.match(/[Ee]/)){var l=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+i):r+="E+"+(l-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,d){return c+u+d.substr(0,(n+i)%n)+"."+d.substr(i)+"E"})}else r=t.toExponential(s);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function al(e,t,r){if(e.charCodeAt(0)===40&&!t.match(cI)){var s=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?al("n",s,r):"("+al("n",s,-r)+")"}if(t.charCodeAt(t.length-1)===44)return sV(e,t,r);if(t.indexOf("%")!==-1)return nV(e,t,r);if(t.indexOf("E")!==-1)return uI(t,r);if(t.charCodeAt(0)===36)return"$"+al(e,t.substr(t.charAt(1)==" "?2:1),r);var n,i,l,o,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+$i(c,t.length);if(t.match(/^[#?]+$/))return n=""+r,r===0&&(n=""),n.length>t.length?n:nn(t.substr(0,t.length-n.length))+n;if(i=t.match(lI))return tV(i,c,u);if(t.match(/^#+0+$/))return u+$i(c,t.length-t.indexOf("0"));if(i=t.match(oI))return n=(""+r).replace(/^([^\.]+)$/,"$1."+nn(i[1])).replace(/\.$/,"."+nn(i[1])),n=n.replace(/\.(\d*)$/,function(p,g){return"."+g+_a("0",nn(i[1]).length-g.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+Zo(""+c);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+al(e,t,-r):Zo(""+r)+"."+_a("0",i[1].length);if(i=t.match(/^#,#*,#0/))return al(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Fu(al(e,t.replace(/[\\-]/g,""),r)),l=0,Fu(Fu(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return l<n.length?n.charAt(l++):p==="0"?"0":""}));if(t.match(dI))return n=al(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var d="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(i[4].length,7),o=Qp(c,Math.pow(10,l)-1,!1),n=""+u,d=ql("n",i[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),n+=d+i[2]+"/"+i[3],d=Kp(o[2],l),d.length<i[4].length&&(d=nn(i[4].substr(i[4].length-d.length))+d),n+=d,n;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(i[1].length,i[4].length),7),o=Qp(c,Math.pow(10,l)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?h2(o[1],l)+i[2]+"/"+i[3]+Kp(o[2],l):_a(" ",2*l+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return n=""+r,t.length<=n.length?n:nn(t.substr(0,t.length-n.length))+n;if(i=t.match(/^([#0]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),l=n.indexOf(".");var h=t.indexOf(".")-l,f=t.length-n.length-h;return nn(t.substr(0,h)+n+t.substr(t.length-f))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+al(e,t,-r):Zo(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?$i(0,3-p.length):"")+p})+"."+$i(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var x=Zo(""+c);return x!=="0"?u+x:"";default:if(t.match(/\.[0#?]*$/))return al(e,t.slice(0,t.lastIndexOf(".")),r)+nn(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function ql(e,t,r){return(r|0)===r?al(e,t,r):ai(e,t,r)}function iV(e){for(var t=[],r=!1,s=0,n=0;s<e.length;++s)switch(e.charCodeAt(s)){case 34:r=!r;break;case 95:case 42:case 92:++s;break;case 59:t[t.length]=e.substr(n,s-n),n=s+1}if(t[t.length]=e.substr(n),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var hI=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function O0(e){for(var t=0,r="",s="";t<e.length;)switch(r=e.charAt(t)){case"G":Gp(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(s=r;e.charAt(t++)!=="]"&&t<e.length;)s+=e.charAt(t);if(s.match(hI))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function lV(e,t,r,s){for(var n=[],i="",l=0,o="",c="t",u,d,h,f="H";l<e.length;)switch(o=e.charAt(l)){case"G":if(!Gp(e,l))throw new Error("unrecognized character "+o+" in "+e);n[n.length]={t:"G",v:"General"},l+=7;break;case'"':for(i="";(h=e.charCodeAt(++l))!==34&&l<e.length;)i+=String.fromCharCode(h);n[n.length]={t:"t",v:i},++l;break;case"\\":var x=e.charAt(++l),p=x==="("||x===")"?x:"t";n[n.length]={t:p,v:x},++l;break;case"_":n[n.length]={t:"t",v:" "},l+=2;break;case"@":n[n.length]={t:"T",v:t},++l;break;case"B":case"b":if(e.charAt(l+1)==="1"||e.charAt(l+1)==="2"){if(u==null&&(u=Gc(t,r,e.charAt(l+1)==="2"),u==null))return"";n[n.length]={t:"X",v:e.substr(l,2)},c=o,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=Gc(t,r),u==null))return"";for(i=o;++l<e.length&&e.charAt(l).toLowerCase()===o;)i+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=f),n[n.length]={t:o,v:i},c=o;break;case"A":case"a":case"":var g={t:o,v:o};if(u==null&&(u=Gc(t,r)),e.substr(l,3).toUpperCase()==="A/P"?(u!=null&&(g.v=u.H>=12?"P":"A"),g.t="T",f="h",l+=3):e.substr(l,5).toUpperCase()==="AM/PM"?(u!=null&&(g.v=u.H>=12?"PM":"AM"),g.t="T",l+=5,f="h"):e.substr(l,5).toUpperCase()==="/"?(u!=null&&(g.v=u.H>=12?"":""),g.t="T",l+=5,f="h"):(g.t="t",++l),u==null&&g.t==="T")return"";n[n.length]=g,c=o;break;case"[":for(i=o;e.charAt(l++)!=="]"&&l<e.length;)i+=e.charAt(l);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(hI)){if(u==null&&(u=Gc(t,r),u==null))return"";n[n.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",O0(e)||(n[n.length]={t:"t",v:i}));break;case".":if(u!=null){for(i=o;++l<e.length&&(o=e.charAt(l))==="0";)i+=o;n[n.length]={t:"s",v:i};break}case"0":case"#":for(i=o;++l<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(l))>-1;)i+=o;n[n.length]={t:"n",v:i};break;case"?":for(i=o;e.charAt(++l)===o;)i+=o;n[n.length]={t:o,v:i},c=o;break;case"*":++l,(e.charAt(l)==" "||e.charAt(l)=="*")&&++l;break;case"(":case")":n[n.length]={t:s===1?"t":o,v:o},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=o;l<e.length&&"0123456789".indexOf(e.charAt(++l))>-1;)i+=e.charAt(l);n[n.length]={t:"D",v:i};break;case" ":n[n.length]={t:o,v:o},++l;break;case"$":n[n.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);n[n.length]={t:"t",v:o},++l;break}var y=0,v=0,j;for(l=n.length-1,c="t";l>=0;--l)switch(n[l].t){case"h":case"H":n[l].t=f,c="h",y<1&&(y=1);break;case"s":(j=n[l].v.match(/\.0+$/))&&(v=Math.max(v,j[0].length-1)),y<3&&(y=3);case"d":case"y":case"M":case"e":c=n[l].t;break;case"m":c==="s"&&(n[l].t="M",y<2&&(y=2));break;case"X":break;case"Z":y<1&&n[l].v.match(/[Hh]/)&&(y=1),y<2&&n[l].v.match(/[Mm]/)&&(y=2),y<3&&n[l].v.match(/[Ss]/)&&(y=3)}switch(y){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var b="",w;for(l=0;l<n.length;++l)switch(n[l].t){case"t":case"T":case" ":case"D":break;case"X":n[l].v="",n[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[l].v=YW(n[l].t.charCodeAt(0),n[l].v,u,v),n[l].t="t";break;case"n":case"?":for(w=l+1;n[w]!=null&&((o=n[w].t)==="?"||o==="D"||(o===" "||o==="t")&&n[w+1]!=null&&(n[w+1].t==="?"||n[w+1].t==="t"&&n[w+1].v==="/")||n[l].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(n[w].v==="/"||n[w].v===" "&&n[w+1]!=null&&n[w+1].t=="?"));)n[l].v+=n[w].v,n[w]={v:"",t:";"},++w;b+=n[l].v,l=w-1;break;case"G":n[l].t="t",n[l].v=Pd(t,r);break}var k="",N,S;if(b.length>0){b.charCodeAt(0)==40?(N=t<0&&b.charCodeAt(0)===45?-t:t,S=ql("n",b,N)):(N=t<0&&s>1?-t:t,S=ql("n",b,N),N<0&&n[0]&&n[0].t=="t"&&(S=S.substr(1),n[0].v="-"+n[0].v)),w=S.length-1;var _=n.length;for(l=0;l<n.length;++l)if(n[l]!=null&&n[l].t!="t"&&n[l].v.indexOf(".")>-1){_=l;break}var O=n.length;if(_===n.length&&S.indexOf("E")===-1){for(l=n.length-1;l>=0;--l)n[l]==null||"n?".indexOf(n[l].t)===-1||(w>=n[l].v.length-1?(w-=n[l].v.length,n[l].v=S.substr(w+1,n[l].v.length)):w<0?n[l].v="":(n[l].v=S.substr(0,w+1),w=-1),n[l].t="t",O=l);w>=0&&O<n.length&&(n[O].v=S.substr(0,w+1)+n[O].v)}else if(_!==n.length&&S.indexOf("E")===-1){for(w=S.indexOf(".")-1,l=_;l>=0;--l)if(!(n[l]==null||"n?".indexOf(n[l].t)===-1)){for(d=n[l].v.indexOf(".")>-1&&l===_?n[l].v.indexOf(".")-1:n[l].v.length-1,k=n[l].v.substr(d+1);d>=0;--d)w>=0&&(n[l].v.charAt(d)==="0"||n[l].v.charAt(d)==="#")&&(k=S.charAt(w--)+k);n[l].v=k,n[l].t="t",O=l}for(w>=0&&O<n.length&&(n[O].v=S.substr(0,w+1)+n[O].v),w=S.indexOf(".")+1,l=_;l<n.length;++l)if(!(n[l]==null||"n?(".indexOf(n[l].t)===-1&&l!==_)){for(d=n[l].v.indexOf(".")>-1&&l===_?n[l].v.indexOf(".")+1:0,k=n[l].v.substr(0,d);d<n[l].v.length;++d)w<S.length&&(k+=S.charAt(w++));n[l].v=k,n[l].t="t",O=l}}}for(l=0;l<n.length;++l)n[l]!=null&&"n?".indexOf(n[l].t)>-1&&(N=s>1&&t<0&&l>0&&n[l-1].v==="-"?-t:t,n[l].v=ql(n[l].t,n[l].v,N),n[l].t="t");var E="";for(l=0;l!==n.length;++l)n[l]!=null&&(E+=n[l].v);return E}var x4=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function m4(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function oV(e,t){var r=iV(e),s=r.length,n=r[s-1].indexOf("@");if(s<4&&n>-1&&--s,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||n>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=n>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=n>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=n>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[s,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var l=r[0].match(x4),o=r[1].match(x4);return m4(t,l)?[s,r[0]]:m4(t,o)?[s,r[1]]:[s,r[l!=null&&o!=null?2:1]]}return[s,i]}function vi(e,t,r){r==null&&(r={});var s="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?s=r.dateNF:s=e;break;case"number":e==14&&r.dateNF?s=r.dateNF:s=(r.table!=null?r.table:Wt)[e],s==null&&(s=r.table&&r.table[u4[e]]||Wt[u4[e]]),s==null&&(s=VW[e]||"General");break}if(Gp(s,0))return Pd(t,r);t instanceof Date&&(t=sI(t,r.date1904));var n=oV(s,t);if(Gp(n[1]))return Pd(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return lV(n[1],t,r,n[0])}function Kl(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Wt[r]==null){t<0&&(t=r);continue}if(Wt[r]==e){t=r;break}}t<0&&(t=391)}return Wt[t]=e,t}function Cy(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Kl(e[t],t)}function D0(){Wt=WW()}var cV={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},fI=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function dV(e){var t=typeof e=="number"?Wt[e]:e;return t=t.replace(fI,"(\\d+)"),new RegExp("^"+t+"$")}function uV(e,t,r){var s=-1,n=-1,i=-1,l=-1,o=-1,c=-1;(t.match(fI)||[]).forEach(function(h,f){var x=parseInt(r[f+1],10);switch(h.toLowerCase().charAt(0)){case"y":s=x;break;case"d":i=x;break;case"h":l=x;break;case"s":c=x;break;case"m":l>=0?o=x:n=x;break}}),c>=0&&o==-1&&n>=0&&(o=n,n=-1);var u=(""+(s>=0?s:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return l==-1&&o==-1&&c==-1?u:s==-1&&n==-1&&i==-1?d:u+"T"+d}var hV=function(){var e={};e.version="1.2.0";function t(){for(var S=0,_=new Array(256),O=0;O!=256;++O)S=O,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,_[O]=S;return typeof Int32Array<"u"?new Int32Array(_):_}var r=t();function s(S){var _=0,O=0,E=0,R=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(E=0;E!=256;++E)R[E]=S[E];for(E=0;E!=256;++E)for(O=S[E],_=256+E;_<4096;_+=256)O=R[_]=O>>>8^S[O&255];var C=[];for(E=1;E!=16;++E)C[E-1]=typeof Int32Array<"u"?R.subarray(E*256,E*256+256):R.slice(E*256,E*256+256);return C}var n=s(r),i=n[0],l=n[1],o=n[2],c=n[3],u=n[4],d=n[5],h=n[6],f=n[7],x=n[8],p=n[9],g=n[10],y=n[11],v=n[12],j=n[13],b=n[14];function w(S,_){for(var O=_^-1,E=0,R=S.length;E<R;)O=O>>>8^r[(O^S.charCodeAt(E++))&255];return~O}function k(S,_){for(var O=_^-1,E=S.length-15,R=0;R<E;)O=b[S[R++]^O&255]^j[S[R++]^O>>8&255]^v[S[R++]^O>>16&255]^y[S[R++]^O>>>24]^g[S[R++]]^p[S[R++]]^x[S[R++]]^f[S[R++]]^h[S[R++]]^d[S[R++]]^u[S[R++]]^c[S[R++]]^o[S[R++]]^l[S[R++]]^i[S[R++]]^r[S[R++]];for(E+=15;R<E;)O=O>>>8^r[(O^S[R++])&255];return~O}function N(S,_){for(var O=_^-1,E=0,R=S.length,C=0,I=0;E<R;)C=S.charCodeAt(E++),C<128?O=O>>>8^r[(O^C)&255]:C<2048?(O=O>>>8^r[(O^(192|C>>6&31))&255],O=O>>>8^r[(O^(128|C&63))&255]):C>=55296&&C<57344?(C=(C&1023)+64,I=S.charCodeAt(E++)&1023,O=O>>>8^r[(O^(240|C>>8&7))&255],O=O>>>8^r[(O^(128|C>>2&63))&255],O=O>>>8^r[(O^(128|I>>6&15|(C&3)<<4))&255],O=O>>>8^r[(O^(128|I&63))&255]):(O=O>>>8^r[(O^(224|C>>12&15))&255],O=O>>>8^r[(O^(128|C>>6&63))&255],O=O>>>8^r[(O^(128|C&63))&255]);return~O}return e.table=r,e.bstr=w,e.buf=k,e.str=N,e}(),$t=function(){var t={};t.version="1.2.1";function r(V,J){for(var X=V.split("/"),te=J.split("/"),re=0,ae=0,Ne=Math.min(X.length,te.length);re<Ne;++re){if(ae=X[re].length-te[re].length)return ae;if(X[re]!=te[re])return X[re]<te[re]?-1:1}return X.length-te.length}function s(V){if(V.charAt(V.length-1)=="/")return V.slice(0,-1).indexOf("/")===-1?V:s(V.slice(0,-1));var J=V.lastIndexOf("/");return J===-1?V:V.slice(0,J+1)}function n(V){if(V.charAt(V.length-1)=="/")return n(V.slice(0,-1));var J=V.lastIndexOf("/");return J===-1?V:V.slice(J+1)}function i(V,J){typeof J=="string"&&(J=new Date(J));var X=J.getHours();X=X<<6|J.getMinutes(),X=X<<5|J.getSeconds()>>>1,V.write_shift(2,X);var te=J.getFullYear()-1980;te=te<<4|J.getMonth()+1,te=te<<5|J.getDate(),V.write_shift(2,te)}function l(V){var J=V.read_shift(2)&65535,X=V.read_shift(2)&65535,te=new Date,re=X&31;X>>>=5;var ae=X&15;X>>>=4,te.setMilliseconds(0),te.setFullYear(X+1980),te.setMonth(ae-1),te.setDate(re);var Ne=J&31;J>>>=5;var Be=J&63;return J>>>=6,te.setHours(J),te.setMinutes(Be),te.setSeconds(Ne<<1),te}function o(V){Ps(V,0);for(var J={},X=0;V.l<=V.length-4;){var te=V.read_shift(2),re=V.read_shift(2),ae=V.l+re,Ne={};switch(te){case 21589:X=V.read_shift(1),X&1&&(Ne.mtime=V.read_shift(4)),re>5&&(X&2&&(Ne.atime=V.read_shift(4)),X&4&&(Ne.ctime=V.read_shift(4))),Ne.mtime&&(Ne.mt=new Date(Ne.mtime*1e3));break}V.l=ae,J[te]=Ne}return J}var c;function u(){return c||(c={})}function d(V,J){if(V[0]==80&&V[1]==75)return Ie(V,J);if((V[0]|32)==109&&(V[1]|32)==105)return Or(V,J);if(V.length<512)throw new Error("CFB file size "+V.length+" < 512");var X=3,te=512,re=0,ae=0,Ne=0,Be=0,Se=0,Pe=[],pe=V.slice(0,512);Ps(pe,0);var qe=h(pe);switch(X=qe[0],X){case 3:te=512;break;case 4:te=4096;break;case 0:if(qe[1]==0)return Ie(V,J);default:throw new Error("Major Version: Expected 3 or 4 saw "+X)}te!==512&&(pe=V.slice(0,te),Ps(pe,28));var lt=V.slice(0,te);f(pe,X);var ft=pe.read_shift(4,"i");if(X===3&&ft!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ft);pe.l+=4,Ne=pe.read_shift(4,"i"),pe.l+=4,pe.chk("00100000","Mini Stream Cutoff Size: "),Be=pe.read_shift(4,"i"),re=pe.read_shift(4,"i"),Se=pe.read_shift(4,"i"),ae=pe.read_shift(4,"i");for(var Ze=-1,dt=0;dt<109&&(Ze=pe.read_shift(4,"i"),!(Ze<0));++dt)Pe[dt]=Ze;var Ot=x(V,te);y(Se,ae,Ot,te,Pe);var Y=j(Ot,Ne,Pe,te);Y[Ne].name="!Directory",re>0&&Be!==I&&(Y[Be].name="!MiniFAT"),Y[Pe[0]].name="!FAT",Y.fat_addrs=Pe,Y.ssz=te;var De={},at=[],st=[],Mt=[];b(Ne,Y,Ot,at,re,De,st,Be),p(st,Mt,at),at.shift();var Lt={FileIndex:st,FullPaths:Mt};return J&&J.raw&&(Lt.raw={header:lt,sectors:Ot}),Lt}function h(V){if(V[V.l]==80&&V[V.l+1]==75)return[0,0];V.chk(ne,"Header Signature: "),V.l+=16;var J=V.read_shift(2,"u");return[V.read_shift(2,"u"),J]}function f(V,J){var X=9;switch(V.l+=2,X=V.read_shift(2)){case 9:if(J!=3)throw new Error("Sector Shift: Expected 9 saw "+X);break;case 12:if(J!=4)throw new Error("Sector Shift: Expected 12 saw "+X);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+X)}V.chk("0600","Mini Sector Shift: "),V.chk("000000000000","Reserved: ")}function x(V,J){for(var X=Math.ceil(V.length/J)-1,te=[],re=1;re<X;++re)te[re-1]=V.slice(re*J,(re+1)*J);return te[X-1]=V.slice(X*J),te}function p(V,J,X){for(var te=0,re=0,ae=0,Ne=0,Be=0,Se=X.length,Pe=[],pe=[];te<Se;++te)Pe[te]=pe[te]=te,J[te]=X[te];for(;Be<pe.length;++Be)te=pe[Be],re=V[te].L,ae=V[te].R,Ne=V[te].C,Pe[te]===te&&(re!==-1&&Pe[re]!==re&&(Pe[te]=Pe[re]),ae!==-1&&Pe[ae]!==ae&&(Pe[te]=Pe[ae])),Ne!==-1&&(Pe[Ne]=te),re!==-1&&te!=Pe[te]&&(Pe[re]=Pe[te],pe.lastIndexOf(re)<Be&&pe.push(re)),ae!==-1&&te!=Pe[te]&&(Pe[ae]=Pe[te],pe.lastIndexOf(ae)<Be&&pe.push(ae));for(te=1;te<Se;++te)Pe[te]===te&&(ae!==-1&&Pe[ae]!==ae?Pe[te]=Pe[ae]:re!==-1&&Pe[re]!==re&&(Pe[te]=Pe[re]));for(te=1;te<Se;++te)if(V[te].type!==0){if(Be=te,Be!=Pe[Be])do Be=Pe[Be],J[te]=J[Be]+"/"+J[te];while(Be!==0&&Pe[Be]!==-1&&Be!=Pe[Be]);Pe[te]=-1}for(J[0]+="/",te=1;te<Se;++te)V[te].type!==2&&(J[te]+="/")}function g(V,J,X){for(var te=V.start,re=V.size,ae=[],Ne=te;X&&re>0&&Ne>=0;)ae.push(J.slice(Ne*C,Ne*C+C)),re-=C,Ne=Bc(X,Ne*4);return ae.length===0?He(0):ps(ae).slice(0,V.size)}function y(V,J,X,te,re){var ae=I;if(V===I){if(J!==0)throw new Error("DIFAT chain shorter than expected")}else if(V!==-1){var Ne=X[V],Be=(te>>>2)-1;if(!Ne)return;for(var Se=0;Se<Be&&(ae=Bc(Ne,Se*4))!==I;++Se)re.push(ae);y(Bc(Ne,te-4),J-1,X,te,re)}}function v(V,J,X,te,re){var ae=[],Ne=[];re||(re=[]);var Be=te-1,Se=0,Pe=0;for(Se=J;Se>=0;){re[Se]=!0,ae[ae.length]=Se,Ne.push(V[Se]);var pe=X[Math.floor(Se*4/te)];if(Pe=Se*4&Be,te<4+Pe)throw new Error("FAT boundary crossed: "+Se+" 4 "+te);if(!V[pe])break;Se=Bc(V[pe],Pe)}return{nodes:ae,data:E4([Ne])}}function j(V,J,X,te){var re=V.length,ae=[],Ne=[],Be=[],Se=[],Pe=te-1,pe=0,qe=0,lt=0,ft=0;for(pe=0;pe<re;++pe)if(Be=[],lt=pe+J,lt>=re&&(lt-=re),!Ne[lt]){Se=[];var Ze=[];for(qe=lt;qe>=0;){Ze[qe]=!0,Ne[qe]=!0,Be[Be.length]=qe,Se.push(V[qe]);var dt=X[Math.floor(qe*4/te)];if(ft=qe*4&Pe,te<4+ft)throw new Error("FAT boundary crossed: "+qe+" 4 "+te);if(!V[dt]||(qe=Bc(V[dt],ft),Ze[qe]))break}ae[lt]={nodes:Be,data:E4([Se])}}return ae}function b(V,J,X,te,re,ae,Ne,Be){for(var Se=0,Pe=te.length?2:0,pe=J[V].data,qe=0,lt=0,ft;qe<pe.length;qe+=128){var Ze=pe.slice(qe,qe+128);Ps(Ze,64),lt=Ze.read_shift(2),ft=b2(Ze,0,lt-Pe),te.push(ft);var dt={name:ft,type:Ze.read_shift(1),color:Ze.read_shift(1),L:Ze.read_shift(4,"i"),R:Ze.read_shift(4,"i"),C:Ze.read_shift(4,"i"),clsid:Ze.read_shift(16),state:Ze.read_shift(4,"i"),start:0,size:0},Ot=Ze.read_shift(2)+Ze.read_shift(2)+Ze.read_shift(2)+Ze.read_shift(2);Ot!==0&&(dt.ct=w(Ze,Ze.l-8));var Y=Ze.read_shift(2)+Ze.read_shift(2)+Ze.read_shift(2)+Ze.read_shift(2);Y!==0&&(dt.mt=w(Ze,Ze.l-8)),dt.start=Ze.read_shift(4,"i"),dt.size=Ze.read_shift(4,"i"),dt.size<0&&dt.start<0&&(dt.size=dt.type=0,dt.start=I,dt.name=""),dt.type===5?(Se=dt.start,re>0&&Se!==I&&(J[Se].name="!StreamData")):dt.size>=4096?(dt.storage="fat",J[dt.start]===void 0&&(J[dt.start]=v(X,dt.start,J.fat_addrs,J.ssz)),J[dt.start].name=dt.name,dt.content=J[dt.start].data.slice(0,dt.size)):(dt.storage="minifat",dt.size<0?dt.size=0:Se!==I&&dt.start!==I&&J[Se]&&(dt.content=g(dt,J[Se].data,(J[Be]||{}).data))),dt.content&&Ps(dt.content,0),ae[ft]=dt,Ne.push(dt)}}function w(V,J){return new Date((Bn(V,J+4)/1e7*Math.pow(2,32)+Bn(V,J)/1e7-11644473600)*1e3)}function k(V,J){return u(),d(c.readFileSync(V),J)}function N(V,J){var X=J&&J.type;switch(X||cr&&Buffer.isBuffer(V)&&(X="buffer"),X||"base64"){case"file":return k(V,J);case"base64":return d(zn(Qn(V)),J);case"binary":return d(zn(V),J)}return d(V,J)}function S(V,J){var X=J||{},te=X.root||"Root Entry";if(V.FullPaths||(V.FullPaths=[]),V.FileIndex||(V.FileIndex=[]),V.FullPaths.length!==V.FileIndex.length)throw new Error("inconsistent CFB structure");V.FullPaths.length===0&&(V.FullPaths[0]=te+"/",V.FileIndex[0]={name:te,type:5}),X.CLSID&&(V.FileIndex[0].clsid=X.CLSID),_(V)}function _(V){var J="Sh33tJ5";if(!$t.find(V,"/"+J)){var X=He(4);X[0]=55,X[1]=X[3]=50,X[2]=54,V.FileIndex.push({name:J,type:2,content:X,size:4,L:69,R:69,C:69}),V.FullPaths.push(V.FullPaths[0]+J),O(V)}}function O(V,J){S(V);for(var X=!1,te=!1,re=V.FullPaths.length-1;re>=0;--re){var ae=V.FileIndex[re];switch(ae.type){case 0:te?X=!0:(V.FileIndex.pop(),V.FullPaths.pop());break;case 1:case 2:case 5:te=!0,isNaN(ae.R*ae.L*ae.C)&&(X=!0),ae.R>-1&&ae.L>-1&&ae.R==ae.L&&(X=!0);break;default:X=!0;break}}if(!(!X&&!J)){var Ne=new Date(1987,1,19),Be=0,Se=Object.create?Object.create(null):{},Pe=[];for(re=0;re<V.FullPaths.length;++re)Se[V.FullPaths[re]]=!0,V.FileIndex[re].type!==0&&Pe.push([V.FullPaths[re],V.FileIndex[re]]);for(re=0;re<Pe.length;++re){var pe=s(Pe[re][0]);te=Se[pe],te||(Pe.push([pe,{name:n(pe).replace("/",""),type:1,clsid:Q,ct:Ne,mt:Ne,content:null}]),Se[pe]=!0)}for(Pe.sort(function(ft,Ze){return r(ft[0],Ze[0])}),V.FullPaths=[],V.FileIndex=[],re=0;re<Pe.length;++re)V.FullPaths[re]=Pe[re][0],V.FileIndex[re]=Pe[re][1];for(re=0;re<Pe.length;++re){var qe=V.FileIndex[re],lt=V.FullPaths[re];if(qe.name=n(lt).replace("/",""),qe.L=qe.R=qe.C=-(qe.color=1),qe.size=qe.content?qe.content.length:0,qe.start=0,qe.clsid=qe.clsid||Q,re===0)qe.C=Pe.length>1?1:-1,qe.size=0,qe.type=5;else if(lt.slice(-1)=="/"){for(Be=re+1;Be<Pe.length&&s(V.FullPaths[Be])!=lt;++Be);for(qe.C=Be>=Pe.length?-1:Be,Be=re+1;Be<Pe.length&&s(V.FullPaths[Be])!=s(lt);++Be);qe.R=Be>=Pe.length?-1:Be,qe.type=1}else s(V.FullPaths[re+1]||"")==s(lt)&&(qe.R=re+1),qe.type=2}}}function E(V,J){var X=J||{};if(X.fileType=="mad")return _r(V,X);switch(O(V),X.fileType){case"zip":return ht(V,X)}var te=function(ft){for(var Ze=0,dt=0,Ot=0;Ot<ft.FileIndex.length;++Ot){var Y=ft.FileIndex[Ot];if(Y.content){var De=Y.content.length;De>0&&(De<4096?Ze+=De+63>>6:dt+=De+511>>9)}}for(var at=ft.FullPaths.length+3>>2,st=Ze+7>>3,Mt=Ze+127>>7,Lt=st+dt+at+Mt,pt=Lt+127>>7,Ut=pt<=109?0:Math.ceil((pt-109)/127);Lt+pt+Ut+127>>7>pt;)Ut=++pt<=109?0:Math.ceil((pt-109)/127);var qt=[1,Ut,pt,Mt,at,dt,Ze,0];return ft.FileIndex[0].size=Ze<<6,qt[7]=(ft.FileIndex[0].start=qt[0]+qt[1]+qt[2]+qt[3]+qt[4]+qt[5])+(qt[6]+7>>3),qt}(V),re=He(te[7]<<9),ae=0,Ne=0;{for(ae=0;ae<8;++ae)re.write_shift(1,W[ae]);for(ae=0;ae<8;++ae)re.write_shift(2,0);for(re.write_shift(2,62),re.write_shift(2,3),re.write_shift(2,65534),re.write_shift(2,9),re.write_shift(2,6),ae=0;ae<3;++ae)re.write_shift(2,0);for(re.write_shift(4,0),re.write_shift(4,te[2]),re.write_shift(4,te[0]+te[1]+te[2]+te[3]-1),re.write_shift(4,0),re.write_shift(4,4096),re.write_shift(4,te[3]?te[0]+te[1]+te[2]-1:I),re.write_shift(4,te[3]),re.write_shift(-4,te[1]?te[0]-1:I),re.write_shift(4,te[1]),ae=0;ae<109;++ae)re.write_shift(-4,ae<te[2]?te[1]+ae:-1)}if(te[1])for(Ne=0;Ne<te[1];++Ne){for(;ae<236+Ne*127;++ae)re.write_shift(-4,ae<te[2]?te[1]+ae:-1);re.write_shift(-4,Ne===te[1]-1?I:Ne+1)}var Be=function(ft){for(Ne+=ft;ae<Ne-1;++ae)re.write_shift(-4,ae+1);ft&&(++ae,re.write_shift(-4,I))};for(Ne=ae=0,Ne+=te[1];ae<Ne;++ae)re.write_shift(-4,H.DIFSECT);for(Ne+=te[2];ae<Ne;++ae)re.write_shift(-4,H.FATSECT);Be(te[3]),Be(te[4]);for(var Se=0,Pe=0,pe=V.FileIndex[0];Se<V.FileIndex.length;++Se)pe=V.FileIndex[Se],pe.content&&(Pe=pe.content.length,!(Pe<4096)&&(pe.start=Ne,Be(Pe+511>>9)));for(Be(te[6]+7>>3);re.l&511;)re.write_shift(-4,H.ENDOFCHAIN);for(Ne=ae=0,Se=0;Se<V.FileIndex.length;++Se)pe=V.FileIndex[Se],pe.content&&(Pe=pe.content.length,!(!Pe||Pe>=4096)&&(pe.start=Ne,Be(Pe+63>>6)));for(;re.l&511;)re.write_shift(-4,H.ENDOFCHAIN);for(ae=0;ae<te[4]<<2;++ae){var qe=V.FullPaths[ae];if(!qe||qe.length===0){for(Se=0;Se<17;++Se)re.write_shift(4,0);for(Se=0;Se<3;++Se)re.write_shift(4,-1);for(Se=0;Se<12;++Se)re.write_shift(4,0);continue}pe=V.FileIndex[ae],ae===0&&(pe.start=pe.size?pe.start-1:I);var lt=ae===0&&X.root||pe.name;if(Pe=2*(lt.length+1),re.write_shift(64,lt,"utf16le"),re.write_shift(2,Pe),re.write_shift(1,pe.type),re.write_shift(1,pe.color),re.write_shift(-4,pe.L),re.write_shift(-4,pe.R),re.write_shift(-4,pe.C),pe.clsid)re.write_shift(16,pe.clsid,"hex");else for(Se=0;Se<4;++Se)re.write_shift(4,0);re.write_shift(4,pe.state||0),re.write_shift(4,0),re.write_shift(4,0),re.write_shift(4,0),re.write_shift(4,0),re.write_shift(4,pe.start),re.write_shift(4,pe.size),re.write_shift(4,0)}for(ae=1;ae<V.FileIndex.length;++ae)if(pe=V.FileIndex[ae],pe.size>=4096)if(re.l=pe.start+1<<9,cr&&Buffer.isBuffer(pe.content))pe.content.copy(re,re.l,0,pe.size),re.l+=pe.size+511&-512;else{for(Se=0;Se<pe.size;++Se)re.write_shift(1,pe.content[Se]);for(;Se&511;++Se)re.write_shift(1,0)}for(ae=1;ae<V.FileIndex.length;++ae)if(pe=V.FileIndex[ae],pe.size>0&&pe.size<4096)if(cr&&Buffer.isBuffer(pe.content))pe.content.copy(re,re.l,0,pe.size),re.l+=pe.size+63&-64;else{for(Se=0;Se<pe.size;++Se)re.write_shift(1,pe.content[Se]);for(;Se&63;++Se)re.write_shift(1,0)}if(cr)re.l=re.length;else for(;re.l<re.length;)re.write_shift(1,0);return re}function R(V,J){var X=V.FullPaths.map(function(Se){return Se.toUpperCase()}),te=X.map(function(Se){var Pe=Se.split("/");return Pe[Pe.length-(Se.slice(-1)=="/"?2:1)]}),re=!1;J.charCodeAt(0)===47?(re=!0,J=X[0].slice(0,-1)+J):re=J.indexOf("/")!==-1;var ae=J.toUpperCase(),Ne=re===!0?X.indexOf(ae):te.indexOf(ae);if(Ne!==-1)return V.FileIndex[Ne];var Be=!ae.match(jh);for(ae=ae.replace(un,""),Be&&(ae=ae.replace(jh,"!")),Ne=0;Ne<X.length;++Ne)if((Be?X[Ne].replace(jh,"!"):X[Ne]).replace(un,"")==ae||(Be?te[Ne].replace(jh,"!"):te[Ne]).replace(un,"")==ae)return V.FileIndex[Ne];return null}var C=64,I=-2,ne="d0cf11e0a1b11ae1",W=[208,207,17,224,161,177,26,225],Q="00000000000000000000000000000000",H={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:I,FREESECT:-1,HEADER_SIGNATURE:ne,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Q,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function K(V,J,X){u();var te=E(V,X);c.writeFileSync(J,te)}function q(V){for(var J=new Array(V.length),X=0;X<V.length;++X)J[X]=String.fromCharCode(V[X]);return J.join("")}function ge(V,J){var X=E(V,J);switch(J&&J.type||"buffer"){case"file":return u(),c.writeFileSync(J.filename,X),X;case"binary":return typeof X=="string"?X:q(X);case"base64":return pf(typeof X=="string"?X:q(X));case"buffer":if(cr)return Buffer.isBuffer(X)?X:go(X);case"array":return typeof X=="string"?zn(X):X}return X}var G;function B(V){try{var J=V.InflateRaw,X=new J;if(X._processChunk(new Uint8Array([3,0]),X._finishFlushFlag),X.bytesRead)G=V;else throw new Error("zlib does not expose bytesRead")}catch(te){console.error("cannot use native zlib: "+(te.message||te))}}function se(V,J){if(!G)return xe(V,J);var X=G.InflateRaw,te=new X,re=te._processChunk(V.slice(V.l),te._finishFlushFlag);return V.l+=te.bytesRead,re}function L(V){return G?G.deflateRawSync(V):Le(V)}var Z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],F=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],he=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ye(V){var J=(V<<1|V<<11)&139536|(V<<5|V<<15)&558144;return(J>>16|J>>8|J)&255}for(var z=typeof Uint8Array<"u",A=z?new Uint8Array(256):[],de=0;de<256;++de)A[de]=ye(de);function D(V,J){var X=A[V&255];return J<=8?X>>>8-J:(X=X<<8|A[V>>8&255],J<=16?X>>>16-J:(X=X<<8|A[V>>16&255],X>>>24-J))}function ze(V,J){var X=J&7,te=J>>>3;return(V[te]|(X<=6?0:V[te+1]<<8))>>>X&3}function Fe(V,J){var X=J&7,te=J>>>3;return(V[te]|(X<=5?0:V[te+1]<<8))>>>X&7}function ct(V,J){var X=J&7,te=J>>>3;return(V[te]|(X<=4?0:V[te+1]<<8))>>>X&15}function $e(V,J){var X=J&7,te=J>>>3;return(V[te]|(X<=3?0:V[te+1]<<8))>>>X&31}function We(V,J){var X=J&7,te=J>>>3;return(V[te]|(X<=1?0:V[te+1]<<8))>>>X&127}function Bt(V,J,X){var te=J&7,re=J>>>3,ae=(1<<X)-1,Ne=V[re]>>>te;return X<8-te||(Ne|=V[re+1]<<8-te,X<16-te)||(Ne|=V[re+2]<<16-te,X<24-te)||(Ne|=V[re+3]<<24-te),Ne&ae}function Ee(V,J,X){var te=J&7,re=J>>>3;return te<=5?V[re]|=(X&7)<<te:(V[re]|=X<<te&255,V[re+1]=(X&7)>>8-te),J+3}function it(V,J,X){var te=J&7,re=J>>>3;return X=(X&1)<<te,V[re]|=X,J+1}function we(V,J,X){var te=J&7,re=J>>>3;return X<<=te,V[re]|=X&255,X>>>=8,V[re+1]=X,J+8}function et(V,J,X){var te=J&7,re=J>>>3;return X<<=te,V[re]|=X&255,X>>>=8,V[re+1]=X&255,V[re+2]=X>>>8,J+16}function Ge(V,J){var X=V.length,te=2*X>J?2*X:J+5,re=0;if(X>=J)return V;if(cr){var ae=o4(te);if(V.copy)V.copy(ae);else for(;re<V.length;++re)ae[re]=V[re];return ae}else if(z){var Ne=new Uint8Array(te);if(Ne.set)Ne.set(V);else for(;re<X;++re)Ne[re]=V[re];return Ne}return V.length=te,V}function Nt(V){for(var J=new Array(V),X=0;X<V;++X)J[X]=0;return J}function Rt(V,J,X){var te=1,re=0,ae=0,Ne=0,Be=0,Se=V.length,Pe=z?new Uint16Array(32):Nt(32);for(ae=0;ae<32;++ae)Pe[ae]=0;for(ae=Se;ae<X;++ae)V[ae]=0;Se=V.length;var pe=z?new Uint16Array(Se):Nt(Se);for(ae=0;ae<Se;++ae)Pe[re=V[ae]]++,te<re&&(te=re),pe[ae]=0;for(Pe[0]=0,ae=1;ae<=te;++ae)Pe[ae+16]=Be=Be+Pe[ae-1]<<1;for(ae=0;ae<Se;++ae)Be=V[ae],Be!=0&&(pe[ae]=Pe[Be+16]++);var qe=0;for(ae=0;ae<Se;++ae)if(qe=V[ae],qe!=0)for(Be=D(pe[ae],te)>>te-qe,Ne=(1<<te+4-qe)-1;Ne>=0;--Ne)J[Be|Ne<<qe]=qe&15|ae<<4;return te}var pr=z?new Uint16Array(512):Nt(512),Zt=z?new Uint16Array(32):Nt(32);if(!z){for(var er=0;er<512;++er)pr[er]=0;for(er=0;er<32;++er)Zt[er]=0}(function(){for(var V=[],J=0;J<32;J++)V.push(5);Rt(V,Zt,32);var X=[];for(J=0;J<=143;J++)X.push(8);for(;J<=255;J++)X.push(9);for(;J<=279;J++)X.push(7);for(;J<=287;J++)X.push(8);Rt(X,pr,288)})();var ue=function(){for(var J=z?new Uint8Array(32768):[],X=0,te=0;X<he.length-1;++X)for(;te<he[X+1];++te)J[te]=X;for(;te<32768;++te)J[te]=29;var re=z?new Uint8Array(259):[];for(X=0,te=0;X<F.length-1;++X)for(;te<F[X+1];++te)re[te]=X;function ae(Be,Se){for(var Pe=0;Pe<Be.length;){var pe=Math.min(65535,Be.length-Pe),qe=Pe+pe==Be.length;for(Se.write_shift(1,+qe),Se.write_shift(2,pe),Se.write_shift(2,~pe&65535);pe-- >0;)Se[Se.l++]=Be[Pe++]}return Se.l}function Ne(Be,Se){for(var Pe=0,pe=0,qe=z?new Uint16Array(32768):[];pe<Be.length;){var lt=Math.min(65535,Be.length-pe);if(lt<10){for(Pe=Ee(Se,Pe,+(pe+lt==Be.length)),Pe&7&&(Pe+=8-(Pe&7)),Se.l=Pe/8|0,Se.write_shift(2,lt),Se.write_shift(2,~lt&65535);lt-- >0;)Se[Se.l++]=Be[pe++];Pe=Se.l*8;continue}Pe=Ee(Se,Pe,+(pe+lt==Be.length)+2);for(var ft=0;lt-- >0;){var Ze=Be[pe];ft=(ft<<5^Ze)&32767;var dt=-1,Ot=0;if((dt=qe[ft])&&(dt|=pe&-32768,dt>pe&&(dt-=32768),dt<pe))for(;Be[dt+Ot]==Be[pe+Ot]&&Ot<250;)++Ot;if(Ot>2){Ze=re[Ot],Ze<=22?Pe=we(Se,Pe,A[Ze+1]>>1)-1:(we(Se,Pe,3),Pe+=5,we(Se,Pe,A[Ze-23]>>5),Pe+=3);var Y=Ze<8?0:Ze-4>>2;Y>0&&(et(Se,Pe,Ot-F[Ze]),Pe+=Y),Ze=J[pe-dt],Pe=we(Se,Pe,A[Ze]>>3),Pe-=3;var De=Ze<4?0:Ze-2>>1;De>0&&(et(Se,Pe,pe-dt-he[Ze]),Pe+=De);for(var at=0;at<Ot;++at)qe[ft]=pe&32767,ft=(ft<<5^Be[pe])&32767,++pe;lt-=Ot-1}else Ze<=143?Ze=Ze+48:Pe=it(Se,Pe,1),Pe=we(Se,Pe,A[Ze]),qe[ft]=pe&32767,++pe}Pe=we(Se,Pe,0)-1}return Se.l=(Pe+7)/8|0,Se.l}return function(Se,Pe){return Se.length<8?ae(Se,Pe):Ne(Se,Pe)}}();function Le(V){var J=He(50+Math.floor(V.length*1.1)),X=ue(V,J);return J.slice(0,X)}var Je=z?new Uint16Array(32768):Nt(32768),Xe=z?new Uint16Array(32768):Nt(32768),le=z?new Uint16Array(128):Nt(128),Me=1,ut=1;function ee(V,J){var X=$e(V,J)+257;J+=5;var te=$e(V,J)+1;J+=5;var re=ct(V,J)+4;J+=4;for(var ae=0,Ne=z?new Uint8Array(19):Nt(19),Be=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Se=1,Pe=z?new Uint8Array(8):Nt(8),pe=z?new Uint8Array(8):Nt(8),qe=Ne.length,lt=0;lt<re;++lt)Ne[Z[lt]]=ae=Fe(V,J),Se<ae&&(Se=ae),Pe[ae]++,J+=3;var ft=0;for(Pe[0]=0,lt=1;lt<=Se;++lt)pe[lt]=ft=ft+Pe[lt-1]<<1;for(lt=0;lt<qe;++lt)(ft=Ne[lt])!=0&&(Be[lt]=pe[ft]++);var Ze=0;for(lt=0;lt<qe;++lt)if(Ze=Ne[lt],Ze!=0){ft=A[Be[lt]]>>8-Ze;for(var dt=(1<<7-Ze)-1;dt>=0;--dt)le[ft|dt<<Ze]=Ze&7|lt<<3}var Ot=[];for(Se=1;Ot.length<X+te;)switch(ft=le[We(V,J)],J+=ft&7,ft>>>=3){case 16:for(ae=3+ze(V,J),J+=2,ft=Ot[Ot.length-1];ae-- >0;)Ot.push(ft);break;case 17:for(ae=3+Fe(V,J),J+=3;ae-- >0;)Ot.push(0);break;case 18:for(ae=11+We(V,J),J+=7;ae-- >0;)Ot.push(0);break;default:Ot.push(ft),Se<ft&&(Se=ft);break}var Y=Ot.slice(0,X),De=Ot.slice(X);for(lt=X;lt<286;++lt)Y[lt]=0;for(lt=te;lt<30;++lt)De[lt]=0;return Me=Rt(Y,Je,286),ut=Rt(De,Xe,30),J}function ve(V,J){if(V[0]==3&&!(V[1]&3))return[xc(J),2];for(var X=0,te=0,re=o4(J||1<<18),ae=0,Ne=re.length>>>0,Be=0,Se=0;!(te&1);){if(te=Fe(V,X),X+=3,te>>>1)te>>1==1?(Be=9,Se=5):(X=ee(V,X),Be=Me,Se=ut);else{X&7&&(X+=8-(X&7));var Pe=V[X>>>3]|V[(X>>>3)+1]<<8;if(X+=32,Pe>0)for(!J&&Ne<ae+Pe&&(re=Ge(re,ae+Pe),Ne=re.length);Pe-- >0;)re[ae++]=V[X>>>3],X+=8;continue}for(;;){!J&&Ne<ae+32767&&(re=Ge(re,ae+32767),Ne=re.length);var pe=Bt(V,X,Be),qe=te>>>1==1?pr[pe]:Je[pe];if(X+=qe&15,qe>>>=4,!(qe>>>8&255))re[ae++]=qe;else{if(qe==256)break;qe-=257;var lt=qe<8?0:qe-4>>2;lt>5&&(lt=0);var ft=ae+F[qe];lt>0&&(ft+=Bt(V,X,lt),X+=lt),pe=Bt(V,X,Se),qe=te>>>1==1?Zt[pe]:Xe[pe],X+=qe&15,qe>>>=4;var Ze=qe<4?0:qe-2>>1,dt=he[qe];for(Ze>0&&(dt+=Bt(V,X,Ze),X+=Ze),!J&&Ne<ft&&(re=Ge(re,ft+100),Ne=re.length);ae<ft;)re[ae]=re[ae-dt],++ae}}}return J?[re,X+7>>>3]:[re.slice(0,ae),X+7>>>3]}function xe(V,J){var X=V.slice(V.l||0),te=ve(X,J);return V.l+=te[1],te[0]}function oe(V,J){if(V)typeof console<"u"&&console.error(J);else throw new Error(J)}function Ie(V,J){var X=V;Ps(X,0);var te=[],re=[],ae={FileIndex:te,FullPaths:re};S(ae,{root:J.root});for(var Ne=X.length-4;(X[Ne]!=80||X[Ne+1]!=75||X[Ne+2]!=5||X[Ne+3]!=6)&&Ne>=0;)--Ne;X.l=Ne+4,X.l+=4;var Be=X.read_shift(2);X.l+=6;var Se=X.read_shift(4);for(X.l=Se,Ne=0;Ne<Be;++Ne){X.l+=20;var Pe=X.read_shift(4),pe=X.read_shift(4),qe=X.read_shift(2),lt=X.read_shift(2),ft=X.read_shift(2);X.l+=8;var Ze=X.read_shift(4),dt=o(X.slice(X.l+qe,X.l+qe+lt));X.l+=qe+lt+ft;var Ot=X.l;X.l=Ze+4,me(X,Pe,pe,ae,dt),X.l=Ot}return ae}function me(V,J,X,te,re){V.l+=2;var ae=V.read_shift(2),Ne=V.read_shift(2),Be=l(V);if(ae&8257)throw new Error("Unsupported ZIP encryption");for(var Se=V.read_shift(4),Pe=V.read_shift(4),pe=V.read_shift(4),qe=V.read_shift(2),lt=V.read_shift(2),ft="",Ze=0;Ze<qe;++Ze)ft+=String.fromCharCode(V[V.l++]);if(lt){var dt=o(V.slice(V.l,V.l+lt));(dt[21589]||{}).mt&&(Be=dt[21589].mt),((re||{})[21589]||{}).mt&&(Be=re[21589].mt)}V.l+=lt;var Ot=V.slice(V.l,V.l+Pe);switch(Ne){case 8:Ot=se(V,pe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Ne)}var Y=!1;ae&8&&(Se=V.read_shift(4),Se==134695760&&(Se=V.read_shift(4),Y=!0),Pe=V.read_shift(4),pe=V.read_shift(4)),Pe!=J&&oe(Y,"Bad compressed size: "+J+" != "+Pe),pe!=X&&oe(Y,"Bad uncompressed size: "+X+" != "+pe),Jr(te,ft,Ot,{unsafe:!0,mt:Be})}function ht(V,J){var X=J||{},te=[],re=[],ae=He(1),Ne=X.compression?8:0,Be=0,Se=0,Pe=0,pe=0,qe=0,lt=V.FullPaths[0],ft=lt,Ze=V.FileIndex[0],dt=[],Ot=0;for(Se=1;Se<V.FullPaths.length;++Se)if(ft=V.FullPaths[Se].slice(lt.length),Ze=V.FileIndex[Se],!(!Ze.size||!Ze.content||ft=="Sh33tJ5")){var Y=pe,De=He(ft.length);for(Pe=0;Pe<ft.length;++Pe)De.write_shift(1,ft.charCodeAt(Pe)&127);De=De.slice(0,De.l),dt[qe]=hV.buf(Ze.content,0);var at=Ze.content;Ne==8&&(at=L(at)),ae=He(30),ae.write_shift(4,67324752),ae.write_shift(2,20),ae.write_shift(2,Be),ae.write_shift(2,Ne),Ze.mt?i(ae,Ze.mt):ae.write_shift(4,0),ae.write_shift(-4,dt[qe]),ae.write_shift(4,at.length),ae.write_shift(4,Ze.content.length),ae.write_shift(2,De.length),ae.write_shift(2,0),pe+=ae.length,te.push(ae),pe+=De.length,te.push(De),pe+=at.length,te.push(at),ae=He(46),ae.write_shift(4,33639248),ae.write_shift(2,0),ae.write_shift(2,20),ae.write_shift(2,Be),ae.write_shift(2,Ne),ae.write_shift(4,0),ae.write_shift(-4,dt[qe]),ae.write_shift(4,at.length),ae.write_shift(4,Ze.content.length),ae.write_shift(2,De.length),ae.write_shift(2,0),ae.write_shift(2,0),ae.write_shift(2,0),ae.write_shift(2,0),ae.write_shift(4,0),ae.write_shift(4,Y),Ot+=ae.l,re.push(ae),Ot+=De.length,re.push(De),++qe}return ae=He(22),ae.write_shift(4,101010256),ae.write_shift(2,0),ae.write_shift(2,0),ae.write_shift(2,qe),ae.write_shift(2,qe),ae.write_shift(4,Ot),ae.write_shift(4,pe),ae.write_shift(2,0),ps([ps(te),ps(re),ae])}var At={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Er(V,J){if(V.ctype)return V.ctype;var X=V.name||"",te=X.match(/\.([^\.]+)$/);return te&&At[te[1]]||J&&(te=(X=J).match(/[\.\\]([^\.\\])+$/),te&&At[te[1]])?At[te[1]]:"application/octet-stream"}function or(V){for(var J=pf(V),X=[],te=0;te<J.length;te+=76)X.push(J.slice(te,te+76));return X.join(`\r
`)+`\r
`}function Gt(V){var J=V.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Pe){var pe=Pe.charCodeAt(0).toString(16).toUpperCase();return"="+(pe.length==1?"0"+pe:pe)});J=J.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),J.charAt(0)==`
`&&(J="=0D"+J.slice(1)),J=J.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var X=[],te=J.split(`\r
`),re=0;re<te.length;++re){var ae=te[re];if(ae.length==0){X.push("");continue}for(var Ne=0;Ne<ae.length;){var Be=76,Se=ae.slice(Ne,Ne+Be);Se.charAt(Be-1)=="="?Be--:Se.charAt(Be-2)=="="?Be-=2:Se.charAt(Be-3)=="="&&(Be-=3),Se=ae.slice(Ne,Ne+Be),Ne+=Be,Ne<ae.length&&(Se+="="),X.push(Se)}}return X.join(`\r
`)}function zt(V){for(var J=[],X=0;X<V.length;++X){for(var te=V[X];X<=V.length&&te.charAt(te.length-1)=="=";)te=te.slice(0,te.length-1)+V[++X];J.push(te)}for(var re=0;re<J.length;++re)J[re]=J[re].replace(/[=][0-9A-Fa-f]{2}/g,function(ae){return String.fromCharCode(parseInt(ae.slice(1),16))});return zn(J.join(`\r
`))}function ma(V,J,X){for(var te="",re="",ae="",Ne,Be=0;Be<10;++Be){var Se=J[Be];if(!Se||Se.match(/^\s*$/))break;var Pe=Se.match(/^(.*?):\s*([^\s].*)$/);if(Pe)switch(Pe[1].toLowerCase()){case"content-location":te=Pe[2].trim();break;case"content-type":ae=Pe[2].trim();break;case"content-transfer-encoding":re=Pe[2].trim();break}}switch(++Be,re.toLowerCase()){case"base64":Ne=zn(Qn(J.slice(Be).join("")));break;case"quoted-printable":Ne=zt(J.slice(Be));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+re)}var pe=Jr(V,te.slice(X.length),Ne,{unsafe:!0});ae&&(pe.ctype=ae)}function Or(V,J){if(q(V.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var X=J&&J.root||"",te=(cr&&Buffer.isBuffer(V)?V.toString("binary"):q(V)).split(`\r
`),re=0,ae="";for(re=0;re<te.length;++re)if(ae=te[re],!!/^Content-Location:/i.test(ae)&&(ae=ae.slice(ae.indexOf("file")),X||(X=ae.slice(0,ae.lastIndexOf("/")+1)),ae.slice(0,X.length)!=X))for(;X.length>0&&(X=X.slice(0,X.length-1),X=X.slice(0,X.lastIndexOf("/")+1),ae.slice(0,X.length)!=X););var Ne=(te[1]||"").match(/boundary="(.*?)"/);if(!Ne)throw new Error("MAD cannot find boundary");var Be="--"+(Ne[1]||""),Se=[],Pe=[],pe={FileIndex:Se,FullPaths:Pe};S(pe);var qe,lt=0;for(re=0;re<te.length;++re){var ft=te[re];ft!==Be&&ft!==Be+"--"||(lt++&&ma(pe,te.slice(qe,re),X),qe=re)}return pe}function _r(V,J){var X=J||{},te=X.boundary||"SheetJS";te="------="+te;for(var re=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+te.slice(2)+'"',"","",""],ae=V.FullPaths[0],Ne=ae,Be=V.FileIndex[0],Se=1;Se<V.FullPaths.length;++Se)if(Ne=V.FullPaths[Se].slice(ae.length),Be=V.FileIndex[Se],!(!Be.size||!Be.content||Ne=="Sh33tJ5")){Ne=Ne.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ot){return"_x"+Ot.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ot){return"_u"+Ot.charCodeAt(0).toString(16)+"_"});for(var Pe=Be.content,pe=cr&&Buffer.isBuffer(Pe)?Pe.toString("binary"):q(Pe),qe=0,lt=Math.min(1024,pe.length),ft=0,Ze=0;Ze<=lt;++Ze)(ft=pe.charCodeAt(Ze))>=32&&ft<128&&++qe;var dt=qe>=lt*4/5;re.push(te),re.push("Content-Location: "+(X.root||"file:///C:/SheetJS/")+Ne),re.push("Content-Transfer-Encoding: "+(dt?"quoted-printable":"base64")),re.push("Content-Type: "+Er(Be,Ne)),re.push(""),re.push(dt?Gt(pe):or(pe))}return re.push(te+`--\r
`),re.join(`\r
`)}function Is(V){var J={};return S(J,V),J}function Jr(V,J,X,te){var re=te&&te.unsafe;re||S(V);var ae=!re&&$t.find(V,J);if(!ae){var Ne=V.FullPaths[0];J.slice(0,Ne.length)==Ne?Ne=J:(Ne.slice(-1)!="/"&&(Ne+="/"),Ne=(Ne+J).replace("//","/")),ae={name:n(J),type:2},V.FileIndex.push(ae),V.FullPaths.push(Ne),re||$t.utils.cfb_gc(V)}return ae.content=X,ae.size=X?X.length:0,te&&(te.CLSID&&(ae.clsid=te.CLSID),te.mt&&(ae.mt=te.mt),te.ct&&(ae.ct=te.ct)),ae}function na(V,J){S(V);var X=$t.find(V,J);if(X){for(var te=0;te<V.FileIndex.length;++te)if(V.FileIndex[te]==X)return V.FileIndex.splice(te,1),V.FullPaths.splice(te,1),!0}return!1}function Os(V,J,X){S(V);var te=$t.find(V,J);if(te){for(var re=0;re<V.FileIndex.length;++re)if(V.FileIndex[re]==te)return V.FileIndex[re].name=n(X),V.FullPaths[re]=X,!0}return!1}function gr(V){O(V,!0)}return t.find=R,t.read=N,t.parse=d,t.write=ge,t.writeFile=K,t.utils={cfb_new:Is,cfb_add:Jr,cfb_del:na,cfb_mov:Os,cfb_gc:gr,ReadShift:Mh,CheckField:FI,prep_blob:Ps,bconcat:ps,use_zlib:B,_deflateRaw:Le,_inflateRaw:xe,consts:H},t}();function fV(e){return typeof e=="string"?ky(e):Array.isArray(e)?$W(e):e}function lx(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=ky(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var s=r=="utf8"?fl(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(s,e);if(typeof Blob<"u"){var n=new Blob([fV(s)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(n,e);if(typeof saveAs<"u")return saveAs(n,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(n);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var l=document.createElement("a");if(l.download!=null)return l.download=e,l.href=i,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=Cc(t)),o.write(t),o.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function xV(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(s){if(!s.message||!s.message.match(/onstruct/))throw s}throw new Error("Cannot access file "+e)}function Oa(e){for(var t=Object.keys(e),r=[],s=0;s<t.length;++s)Object.prototype.hasOwnProperty.call(e,t[s])&&r.push(t[s]);return r}function p4(e,t){for(var r=[],s=Oa(e),n=0;n!==s.length;++n)r[e[s[n]][t]]==null&&(r[e[s[n]][t]]=s[n]);return r}function Ey(e){for(var t=[],r=Oa(e),s=0;s!==r.length;++s)t[e[r[s]]]=r[s];return t}function Py(e){for(var t=[],r=Oa(e),s=0;s!==r.length;++s)t[e[r[s]]]=parseInt(r[s],10);return t}function mV(e){for(var t=[],r=Oa(e),s=0;s!==r.length;++s)t[e[r[s]]]==null&&(t[e[r[s]]]=[]),t[e[r[s]]].push(r[s]);return t}var Xp=new Date(1899,11,30,0,0,0);function rs(e,t){var r=e.getTime(),s=Xp.getTime()+(e.getTimezoneOffset()-Xp.getTimezoneOffset())*6e4;return(r-s)/(24*60*60*1e3)}var xI=new Date,pV=Xp.getTime()+(xI.getTimezoneOffset()-Xp.getTimezoneOffset())*6e4,g4=xI.getTimezoneOffset();function Ay(e){var t=new Date;return t.setTime(e*24*60*60*1e3+pV),t.getTimezoneOffset()!==g4&&t.setTime(t.getTime()+(t.getTimezoneOffset()-g4)*6e4),t}function gV(e){var t=0,r=0,s=!1,n=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!n)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=n.length;++i)if(n[i]){switch(r=1,i>3&&(s=!0),n[i].slice(n[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+n[i].slice(n[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(s)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(n[i],10)}return t}var y4=new Date("2017-02-19T19:06:09.000Z"),mI=isNaN(y4.getFullYear())?new Date("2/19/17"):y4,yV=mI.getFullYear()==2017;function aa(e,t){var r=new Date(e);if(yV)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(mI.getFullYear()==1917&&!isNaN(r.getFullYear())){var s=r.getFullYear();return e.indexOf(""+s)>-1||r.setFullYear(r.getFullYear()+100),r}var n=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function Ad(e,t){if(cr&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return fl(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return fl(rI(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return fl(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return fl(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var s=[],n=0;n!=e.length;++n)s.push(String.fromCharCode(e[n]));return s.join("")}function sa(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=sa(e[r]));return t}function _a(e,t){for(var r="";r.length<t;)r+=e;return r}function Ui(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,s=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(s))||(s=s.replace(/[(](.*)[)]/,function(n,i){return r=-r,i}),!isNaN(t=Number(s)))?t/r:t}var vV=["january","february","march","april","may","june","july","august","september","october","november","december"];function u0(e){var t=new Date(e),r=new Date(NaN),s=t.getYear(),n=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var l=e.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&vV.indexOf(l)==-1)return r}else if(l.match(/[a-z]/))return r;return s<0||s>8099?r:(n>0||i>1)&&s!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var bV=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,s,n){if(e||typeof s=="string")return r.split(s);for(var i=r.split(s),l=[i[0]],o=1;o<i.length;++o)l.push(n),l.push(i[o]);return l}}();function pI(e){return e?e.content&&e.type?Ad(e.content,!0):e.data?bh(e.data):e.asNodeBuffer&&cr?bh(e.asNodeBuffer().toString("binary")):e.asBinary?bh(e.asBinary()):e._data&&e._data.getContent?bh(Ad(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function gI(e){if(!e)return null;if(e.data)return i4(e.data);if(e.asNodeBuffer&&cr)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?i4(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function jV(e){return e&&e.name.slice(-4)===".bin"?gI(e):pI(e)}function li(e,t){for(var r=e.FullPaths||Oa(e.files),s=t.toLowerCase().replace(/[\/]/g,"\\"),n=s.replace(/\\/g,"/"),i=0;i<r.length;++i){var l=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(s==l||n==l)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function x2(e,t){var r=li(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Wa(e,t,r){if(!r)return jV(x2(e,t));if(!t)return null;try{return Wa(e,t)}catch{return null}}function Un(e,t,r){if(!r)return pI(x2(e,t));if(!t)return null;try{return Un(e,t)}catch{return null}}function wV(e,t,r){return gI(x2(e,t))}function v4(e){for(var t=e.FullPaths||Oa(e.files),r=[],s=0;s<t.length;++s)t[s].slice(-1)!="/"&&r.push(t[s].replace(/^Root Entry[\/]/,""));return r.sort()}function ir(e,t,r){if(e.FullPaths){if(typeof r=="string"){var s;return cr?s=go(r):s=BW(r),$t.utils.cfb_add(e,t,s)}$t.utils.cfb_add(e,t,r)}else e.file(t,r)}function m2(){return $t.utils.cfb_new()}function yI(e,t){switch(t.type){case"base64":return $t.read(e,{type:"base64"});case"binary":return $t.read(e,{type:"binary"});case"buffer":case"array":return $t.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function wh(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var s=e.split("/");s.length!==0;){var n=s.shift();n===".."?r.pop():n!=="."&&r.push(n)}return r.join("/")}var Ba=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,NV=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,b4=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,SV=/<[^>]*>/g,Js=Ba.match(b4)?b4:SV,kV=/<\w*:/,CV=/<(\/?)\w+:/;function Kt(e,t,r){for(var s={},n=0,i=0;n!==e.length&&!((i=e.charCodeAt(n))===32||i===10||i===13);++n);if(t||(s[0]=e.slice(0,n)),n===e.length)return s;var l=e.match(NV),o=0,c="",u=0,d="",h="",f=1;if(l)for(u=0;u!=l.length;++u){for(h=l[u],i=0;i!=h.length&&h.charCodeAt(i)!==61;++i);for(d=h.slice(0,i).trim();h.charCodeAt(i+1)==32;)++i;for(f=(n=h.charCodeAt(i+1))==34||n==39?1:0,c=h.slice(i+1+f,h.length-f),o=0;o!=d.length&&d.charCodeAt(o)!==58;++o);if(o===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),s[d]=c,s[d.toLowerCase()]=c;else{var x=(o===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(o+1);if(s[x]&&d.slice(o-3,o)=="ext")continue;s[x]=c,s[x.toLowerCase()]=c}}return s}function Nl(e){return e.replace(CV,"<$1")}var vI={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},p2=Ey(vI),wr=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(s){var n=s+"",i=n.indexOf("<![CDATA[");if(i==-1)return n.replace(e,function(o,c){return vI[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,c){return String.fromCharCode(parseInt(c,16))});var l=n.indexOf("]]>");return r(n.slice(0,i))+n.slice(i+9,l)+r(n.slice(l+3))}}(),g2=/[&<>'"]/g,EV=/[\u0000-\u0008\u000b-\u001f]/g;function zr(e){var t=e+"";return t.replace(g2,function(r){return p2[r]}).replace(EV,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function j4(e){return zr(e).replace(/ /g,"_x0020_")}var bI=/[\u0000-\u001f]/g;function y2(e){var t=e+"";return t.replace(g2,function(r){return p2[r]}).replace(/\n/g,"<br/>").replace(bI,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function PV(e){var t=e+"";return t.replace(g2,function(r){return p2[r]}).replace(bI,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var w4=function(){var e=/&#(\d+);/g;function t(r,s){return String.fromCharCode(parseInt(s,10))}return function(s){return s.replace(e,t)}}();function AV(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function ta(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Pb(e){for(var t="",r=0,s=0,n=0,i=0,l=0,o=0;r<e.length;){if(s=e.charCodeAt(r++),s<128){t+=String.fromCharCode(s);continue}if(n=e.charCodeAt(r++),s>191&&s<224){l=(s&31)<<6,l|=n&63,t+=String.fromCharCode(l);continue}if(i=e.charCodeAt(r++),s<240){t+=String.fromCharCode((s&15)<<12|(n&63)<<6|i&63);continue}l=e.charCodeAt(r++),o=((s&7)<<18|(n&63)<<12|(i&63)<<6|l&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function N4(e){var t=xc(2*e.length),r,s,n=1,i=0,l=0,o;for(s=0;s<e.length;s+=n)n=1,(o=e.charCodeAt(s))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(s+1)&63),n=2):o<240?(r=(o&15)*4096+(e.charCodeAt(s+1)&63)*64+(e.charCodeAt(s+2)&63),n=3):(n=4,r=(o&7)*262144+(e.charCodeAt(s+1)&63)*4096+(e.charCodeAt(s+2)&63)*64+(e.charCodeAt(s+3)&63),r-=65536,l=55296+(r>>>10&1023),r=56320+(r&1023)),l!==0&&(t[i++]=l&255,t[i++]=l>>>8,l=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function S4(e){return go(e,"binary").toString("utf8")}var hm="foo bar baz",Hr=cr&&(S4(hm)==Pb(hm)&&S4||N4(hm)==Pb(hm)&&N4)||Pb,fl=cr?function(e){return go(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,s=0,n=0;r<e.length;)switch(s=e.charCodeAt(r++),!0){case s<128:t.push(String.fromCharCode(s));break;case s<2048:t.push(String.fromCharCode(192+(s>>6))),t.push(String.fromCharCode(128+(s&63)));break;case(s>=55296&&s<57344):s-=55296,n=e.charCodeAt(r++)-56320+(s<<10),t.push(String.fromCharCode(240+(n>>18&7))),t.push(String.fromCharCode(144+(n>>12&63))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)));break;default:t.push(String.fromCharCode(224+(s>>12))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)))}return t.join("")},yf=function(){var e={};return function(r,s){var n=r+"|"+(s||"");return e[n]?e[n]:e[n]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",s||"")}}(),jI=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var s=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<e.length;++n)s=s.replace(e[n][0],e[n][1]);return s}}(),_V=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),TV=/<\/?(?:vt:)?variant>/g,IV=/<(?:vt:)([^>]*)>([\s\S]*)</;function k4(e,t){var r=Kt(e),s=e.match(_V(r.baseType))||[],n=[];if(s.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+s.length+" != "+r.size);return n}return s.forEach(function(i){var l=i.replace(TV,"").match(IV);l&&n.push({v:Hr(l[2]),t:l[1]})}),n}var wI=/(^\s|\s$|\n)/;function As(e,t){return"<"+e+(t.match(wI)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function vf(e){return Oa(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function xt(e,t,r){return"<"+e+(r!=null?vf(r):"")+(t!=null?(t.match(wI)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function $j(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function OV(e,t){switch(typeof e){case"string":var r=xt("vt:lpwstr",zr(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return xt((e|0)==e?"vt:i4":"vt:r8",zr(String(e)));case"boolean":return xt("vt:bool",e?"true":"false")}if(e instanceof Date)return xt("vt:filetime",$j(e));throw new Error("Unable to serialize "+e)}function v2(e){if(cr&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Hr(Cc(u2(e)));throw new Error("Bad input format: expected Buffer or string")}var bf=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,es={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},qd=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],$n={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function DV(e,t){for(var r=1-2*(e[t+7]>>>7),s=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),n=e[t+6]&15,i=5;i>=0;--i)n=n*256+e[t+i];return s==2047?n==0?r*(1/0):NaN:(s==0?s=-1022:(s-=1023,n+=Math.pow(2,52)),r*Math.pow(2,s-52)*n)}function FV(e,t,r){var s=(t<0||1/t==-1/0?1:0)<<7,n=0,i=0,l=s?-t:t;isFinite(l)?l==0?n=i=0:(n=Math.floor(Math.log(l)/Math.LN2),i=l*Math.pow(2,52-n),n<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?n=-1022:(i-=Math.pow(2,52),n+=1023)):(n=2047,i=isNaN(t)?26985:0);for(var o=0;o<=5;++o,i/=256)e[r+o]=i&255;e[r+6]=(n&15)<<4|i&15,e[r+7]=n>>4|s}var C4=function(e){for(var t=[],r=10240,s=0;s<e[0].length;++s)if(e[0][s])for(var n=0,i=e[0][s].length;n<i;n+=r)t.push.apply(t,e[0][s].slice(n,n+r));return t},E4=cr?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:go(t)})):C4(e)}:C4,P4=function(e,t,r){for(var s=[],n=t;n<r;n+=2)s.push(String.fromCharCode(Ul(e,n)));return s.join("").replace(un,"")},b2=cr?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(un,""):P4(e,t,r)}:P4,A4=function(e,t,r){for(var s=[],n=t;n<t+r;++n)s.push(("0"+e[n].toString(16)).slice(-2));return s.join("")},NI=cr?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):A4(e,t,r)}:A4,_4=function(e,t,r){for(var s=[],n=t;n<r;n++)s.push(String.fromCharCode(uu(e,n)));return s.join("")},ox=cr?function(t,r,s){return Buffer.isBuffer(t)?t.toString("utf8",r,s):_4(t,r,s)}:_4,SI=function(e,t){var r=Bn(e,t);return r>0?ox(e,t+4,t+4+r-1):""},kI=SI,CI=function(e,t){var r=Bn(e,t);return r>0?ox(e,t+4,t+4+r-1):""},EI=CI,PI=function(e,t){var r=2*Bn(e,t);return r>0?ox(e,t+4,t+4+r-1):""},AI=PI,_I=function(t,r){var s=Bn(t,r);return s>0?b2(t,r+4,r+4+s):""},TI=_I,II=function(e,t){var r=Bn(e,t);return r>0?ox(e,t+4,t+4+r):""},OI=II,DI=function(e,t){return DV(e,t)},Yp=DI,j2=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};cr&&(kI=function(t,r){if(!Buffer.isBuffer(t))return SI(t,r);var s=t.readUInt32LE(r);return s>0?t.toString("utf8",r+4,r+4+s-1):""},EI=function(t,r){if(!Buffer.isBuffer(t))return CI(t,r);var s=t.readUInt32LE(r);return s>0?t.toString("utf8",r+4,r+4+s-1):""},AI=function(t,r){if(!Buffer.isBuffer(t))return PI(t,r);var s=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+s-1)},TI=function(t,r){if(!Buffer.isBuffer(t))return _I(t,r);var s=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+s)},OI=function(t,r){if(!Buffer.isBuffer(t))return II(t,r);var s=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+s)},Yp=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):DI(t,r)},j2=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var uu=function(e,t){return e[t]},Ul=function(e,t){return e[t+1]*256+e[t]},RV=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Bn=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Bc=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},MV=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Mh(e,t){var r="",s,n,i=[],l,o,c,u;switch(t){case"dbcs":if(u=this.l,cr&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(Ul(this,u)),u+=2;e*=2;break;case"utf8":r=ox(this,this.l,this.l+e);break;case"utf16le":e*=2,r=b2(this,this.l,this.l+e);break;case"wstr":return Mh.call(this,e,"dbcs");case"lpstr-ansi":r=kI(this,this.l),e=4+Bn(this,this.l);break;case"lpstr-cp":r=EI(this,this.l),e=4+Bn(this,this.l);break;case"lpwstr":r=AI(this,this.l),e=4+2*Bn(this,this.l);break;case"lpp4":e=4+Bn(this,this.l),r=TI(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Bn(this,this.l),r=OI(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(l=uu(this,this.l+e++))!==0;)i.push(um(l));r=i.join("");break;case"_wstr":for(e=0,r="";(l=Ul(this,this.l+e))!==0;)i.push(um(l)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return l=uu(this,u),this.l=u+1,o=Mh.call(this,e-c,l?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(um(Ul(this,u))),u+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return l=uu(this,u),this.l=u+1,o=Mh.call(this,e-c,l?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(um(uu(this,u))),u+=1}r=i.join("");break;default:switch(e){case 1:return s=uu(this,this.l),this.l++,s;case 2:return s=(t==="i"?RV:Ul)(this,this.l),this.l+=2,s;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(s=(e>0?Bc:MV)(this,this.l),this.l+=4,s):(n=Bn(this,this.l),this.l+=4,n);case 8:case-8:if(t==="f")return e==8?n=Yp(this,this.l):n=Yp([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;e=8;case 16:r=NI(this,this.l,e);break}}return this.l+=e,r}var LV=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},$V=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},BV=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function zV(e,t,r){var s=0,n=0;if(r==="dbcs"){for(n=0;n!=t.length;++n)BV(this,t.charCodeAt(n),this.l+2*n);s=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=t.length;++n)this[this.l+n]=t.charCodeAt(n)&255;s=t.length}else if(r==="hex"){for(;n<e;++n)this[this.l++]=parseInt(t.slice(2*n,2*n+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(n=0;n<Math.min(t.length,e);++n){var l=t.charCodeAt(n);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:s=1,this[this.l]=t&255;break;case 2:s=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:s=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:s=4,LV(this,t,this.l);break;case 8:if(s=8,r==="f"){FV(this,t,this.l);break}case 16:break;case-4:s=4,$V(this,t,this.l);break}return this.l+=s,this}function FI(e,t){var r=NI(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Ps(e,t){e.l=t,e.read_shift=Mh,e.chk=FI,e.write_shift=zV}function Ys(e,t){e.l+=t}function He(e){var t=xc(e);return Ps(t,0),t}function yo(e,t,r){if(e){var s,n,i;Ps(e,e.l||0);for(var l=e.length,o=0,c=0;e.l<l;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var u=Cf[o]||Cf[65535];for(s=e.read_shift(1),i=s&127,n=1;n<4&&s&128;++n)i+=((s=e.read_shift(1))&127)<<7*n;c=e.l+i;var d=u.f&&u.f(e,i,r);if(e.l=c,t(d,u,o))return}}}function In(){var e=[],t=cr?256:2048,r=function(u){var d=He(u);return Ps(d,0),d},s=r(t),n=function(){s&&(s.length>s.l&&(s=s.slice(0,s.l),s.l=s.length),s.length>0&&e.push(s),s=null)},i=function(u){return s&&u<s.length-s.l?s:(n(),s=r(Math.max(u+1,t)))},l=function(){return n(),ps(e)},o=function(u){n(),s=u,s.l==null&&(s.l=s.length),i(t)};return{next:i,push:o,end:l,_bufs:e}}function Ye(e,t,r,s){var n=+t,i;if(!isNaN(n)){s||(s=Cf[n].p||(r||[]).length||0),i=1+(n>=128?1:0)+1,s>=128&&++i,s>=16384&&++i,s>=2097152&&++i;var l=e.next(i);n<=127?l.write_shift(1,n):(l.write_shift(1,(n&127)+128),l.write_shift(1,n>>7));for(var o=0;o!=4;++o)if(s>=128)l.write_shift(1,(s&127)+128),s>>=7;else{l.write_shift(1,s);break}s>0&&j2(r)&&e.push(r)}}function Lh(e,t,r){var s=sa(e);if(t.s?(s.cRel&&(s.c+=t.s.c),s.rRel&&(s.r+=t.s.r)):(s.cRel&&(s.c+=t.c),s.rRel&&(s.r+=t.r)),!r||r.biff<12){for(;s.c>=256;)s.c-=256;for(;s.r>=65536;)s.r-=65536}return s}function T4(e,t,r){var s=sa(e);return s.s=Lh(s.s,t.s,r),s.e=Lh(s.e,t.s,r),s}function $h(e,t){if(e.cRel&&e.c<0)for(e=sa(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=sa(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Ht(e);return!e.cRel&&e.cRel!=null&&(r=VV(r)),!e.rRel&&e.rRel!=null&&(r=UV(r)),r}function Ab(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+va(e.s.c)+":"+(e.e.cRel?"":"$")+va(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Ma(e.s.r)+":"+(e.e.rRel?"":"$")+Ma(e.e.r):$h(e.s,t.biff)+":"+$h(e.e,t.biff)}function w2(e){return parseInt(WV(e),10)-1}function Ma(e){return""+(e+1)}function UV(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function WV(e){return e.replace(/\$(\d+)$/,"$1")}function N2(e){for(var t=HV(e),r=0,s=0;s!==t.length;++s)r=26*r+t.charCodeAt(s)-64;return r-1}function va(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function VV(e){return e.replace(/^([A-Z])/,"$$$1")}function HV(e){return e.replace(/^\$([A-Z])/,"$1")}function qV(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function ba(e){for(var t=0,r=0,s=0;s<e.length;++s){var n=e.charCodeAt(s);n>=48&&n<=57?t=10*t+(n-48):n>=65&&n<=90&&(r=26*r+(n-64))}return{c:r-1,r:t-1}}function Ht(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Dn(e){var t=e.indexOf(":");return t==-1?{s:ba(e),e:ba(e)}:{s:ba(e.slice(0,t)),e:ba(e.slice(t+1))}}function sr(e,t){return typeof t>"u"||typeof t=="number"?sr(e.s,e.e):(typeof e!="string"&&(e=Ht(e)),typeof t!="string"&&(t=Ht(t)),e==t?e:e+":"+t)}function Nr(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,s=0,n=0,i=e.length;for(r=0;s<i&&!((n=e.charCodeAt(s)-64)<1||n>26);++s)r=26*r+n;for(t.s.c=--r,r=0;s<i&&!((n=e.charCodeAt(s)-48)<0||n>9);++s)r=10*r+n;if(t.s.r=--r,s===i||n!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++s,r=0;s!=i&&!((n=e.charCodeAt(s)-64)<1||n>26);++s)r=26*r+n;for(t.e.c=--r,r=0;s!=i&&!((n=e.charCodeAt(s)-48)<0||n>9);++s)r=10*r+n;return t.e.r=--r,t}function I4(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=vi(e.z,r?rs(t):t)}catch{}try{return e.w=vi((e.XF||{}).numFmtId||(r?14:0),r?rs(t):t)}catch{return""+t}}function no(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?vo[e.v]||e.v:t==null?I4(e,e.v):I4(e,t))}function Ec(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",s={};return s[r]=e,{SheetNames:[r],Sheets:s}}function RI(e,t,r){var s=r||{},n=e?Array.isArray(e):s.dense,i=e||(n?[]:{}),l=0,o=0;if(i&&s.origin!=null){if(typeof s.origin=="number")l=s.origin;else{var c=typeof s.origin=="string"?ba(s.origin):s.origin;l=c.r,o=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var d=Nr(i["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),l==-1&&(u.e.r=l=d.e.r+1)}for(var h=0;h!=t.length;++h)if(t[h]){if(!Array.isArray(t[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var f=0;f!=t[h].length;++f)if(!(typeof t[h][f]>"u")){var x={v:t[h][f]},p=l+h,g=o+f;if(u.s.r>p&&(u.s.r=p),u.s.c>g&&(u.s.c=g),u.e.r<p&&(u.e.r=p),u.e.c<g&&(u.e.c=g),t[h][f]&&typeof t[h][f]=="object"&&!Array.isArray(t[h][f])&&!(t[h][f]instanceof Date))x=t[h][f];else if(Array.isArray(x.v)&&(x.f=t[h][f][1],x.v=x.v[0]),x.v===null)if(x.f)x.t="n";else if(s.nullError)x.t="e",x.v=0;else if(s.sheetStubs)x.t="z";else continue;else typeof x.v=="number"?x.t="n":typeof x.v=="boolean"?x.t="b":x.v instanceof Date?(x.z=s.dateNF||Wt[14],s.cellDates?(x.t="d",x.w=vi(x.z,rs(x.v))):(x.t="n",x.v=rs(x.v),x.w=vi(x.z,x.v))):x.t="s";if(n)i[p]||(i[p]=[]),i[p][g]&&i[p][g].z&&(x.z=i[p][g].z),i[p][g]=x;else{var y=Ht({c:g,r:p});i[y]&&i[y].z&&(x.z=i[y].z),i[y]=x}}}return u.s.c<1e7&&(i["!ref"]=sr(u)),i}function F0(e,t){return RI(null,e,t)}function KV(e){return e.read_shift(4,"i")}function Wi(e,t){return t||(t=He(4)),t.write_shift(4,e),t}function Gs(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function ys(e,t){var r=!1;return t==null&&(r=!0,t=He(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function GV(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function QV(e,t){return t||(t=He(4)),t.write_shift(2,0),t.write_shift(2,0),t}function S2(e,t){var r=e.l,s=e.read_shift(1),n=Gs(e),i=[],l={t:n,h:n};if(s&1){for(var o=e.read_shift(4),c=0;c!=o;++c)i.push(GV(e));l.r=i}else l.r=[{ich:0,ifnt:0}];return e.l=r+t,l}function XV(e,t){var r=!1;return t==null&&(r=!0,t=He(15+4*e.t.length)),t.write_shift(1,0),ys(e.t,t),r?t.slice(0,t.l):t}var YV=S2;function JV(e,t){var r=!1;return t==null&&(r=!0,t=He(23+4*e.t.length)),t.write_shift(1,1),ys(e.t,t),t.write_shift(4,1),QV({},t),r?t.slice(0,t.l):t}function wi(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Kd(e,t){return t==null&&(t=He(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Gd(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Qd(e,t){return t==null&&(t=He(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var ZV=Gs,MI=ys;function k2(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Jp(e,t){var r=!1;return t==null&&(r=!0,t=He(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var eH=Gs,Bj=k2,C2=Jp;function E2(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,s=t[0]&2;e.l+=4;var n=s===0?Yp([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Bc(t,0)>>2;return r?n/100:n}function LI(e,t){t==null&&(t=He(4));var r=0,s=0,n=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?s=1:n==(n|0)&&n>=-536870912&&n<1<<29&&(s=1,r=1),s)t.write_shift(-4,((r?n:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function $I(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function tH(e,t){return t||(t=He(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Xd=$I,R0=tH;function qs(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function _d(e,t){return(t||He(8)).write_shift(8,e,"f")}function rH(e){var t={},r=e.read_shift(1),s=r>>>1,n=e.read_shift(1),i=e.read_shift(2,"i"),l=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(1);switch(e.l++,s){case 0:t.auto=1;break;case 1:t.index=n;var u=dd[n];u&&(t.rgb=wf(u));break;case 2:t.rgb=wf([l,o,c]);break;case 3:t.theme=n;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function Zp(e,t){if(t||(t=He(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var s=e.rgb||"FFFFFF";typeof s=="number"&&(s=("000000"+s.toString(16)).slice(-6)),t.write_shift(1,parseInt(s.slice(0,2),16)),t.write_shift(1,parseInt(s.slice(2,4),16)),t.write_shift(1,parseInt(s.slice(4,6),16)),t.write_shift(1,255)}return t}function aH(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function sH(e,t){t||(t=He(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function BI(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},s=e.read_shift(4);switch(s){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(s>400)throw new Error("Unsupported Clipboard: "+s.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function nH(e){return BI(e,1)}function iH(e){return BI(e,2)}var P2=2,jn=3,fm=11,O4=12,eg=19,xm=64,lH=65,oH=71,cH=4108,dH=4126,fs=80,zI=81,uH=[fs,zI],zj={1:{n:"CodePage",t:P2},2:{n:"Category",t:fs},3:{n:"PresentationFormat",t:fs},4:{n:"ByteCount",t:jn},5:{n:"LineCount",t:jn},6:{n:"ParagraphCount",t:jn},7:{n:"SlideCount",t:jn},8:{n:"NoteCount",t:jn},9:{n:"HiddenCount",t:jn},10:{n:"MultimediaClipCount",t:jn},11:{n:"ScaleCrop",t:fm},12:{n:"HeadingPairs",t:cH},13:{n:"TitlesOfParts",t:dH},14:{n:"Manager",t:fs},15:{n:"Company",t:fs},16:{n:"LinksUpToDate",t:fm},17:{n:"CharacterCount",t:jn},19:{n:"SharedDoc",t:fm},22:{n:"HyperlinksChanged",t:fm},23:{n:"AppVersion",t:jn,p:"version"},24:{n:"DigSig",t:lH},26:{n:"ContentType",t:fs},27:{n:"ContentStatus",t:fs},28:{n:"Language",t:fs},29:{n:"Version",t:fs},255:{},2147483648:{n:"Locale",t:eg},2147483651:{n:"Behavior",t:eg},1919054434:{}},Uj={1:{n:"CodePage",t:P2},2:{n:"Title",t:fs},3:{n:"Subject",t:fs},4:{n:"Author",t:fs},5:{n:"Keywords",t:fs},6:{n:"Comments",t:fs},7:{n:"Template",t:fs},8:{n:"LastAuthor",t:fs},9:{n:"RevNumber",t:fs},10:{n:"EditTime",t:xm},11:{n:"LastPrinted",t:xm},12:{n:"CreatedDate",t:xm},13:{n:"ModifiedDate",t:xm},14:{n:"PageCount",t:jn},15:{n:"WordCount",t:jn},16:{n:"CharCount",t:jn},17:{n:"Thumbnail",t:oH},18:{n:"Application",t:fs},19:{n:"DocSecurity",t:jn},255:{},2147483648:{n:"Locale",t:eg},2147483651:{n:"Behavior",t:eg},1919054434:{}},D4={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},hH=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function fH(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var xH=fH([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),dd=sa(xH),vo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},UI={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Wj={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},mm={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function A2(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function mH(e){var t=A2();if(!e||!e.match)return t;var r={};if((e.match(Js)||[]).forEach(function(s){var n=Kt(s);switch(n[0].replace(kV,"<")){case"<?xml":break;case"<Types":t.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[n.Extension]=n.ContentType;break;case"<Override":t[Wj[n.ContentType]]!==void 0&&t[Wj[n.ContentType]].push(n.PartName);break}}),t.xmlns!==es.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function WI(e,t){var r=mV(Wj),s=[],n;s[s.length]=Ba,s[s.length]=xt("Types",null,{xmlns:es.CT,"xmlns:xsd":es.xsd,"xmlns:xsi":es.xsi}),s=s.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return xt("Default",null,{Extension:c[0],ContentType:c[1]})}));var i=function(c){e[c]&&e[c].length>0&&(n=e[c][0],s[s.length]=xt("Override",null,{PartName:(n[0]=="/"?"":"/")+n,ContentType:mm[c][t.bookType]||mm[c].xlsx}))},l=function(c){(e[c]||[]).forEach(function(u){s[s.length]=xt("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:mm[c][t.bookType]||mm[c].xlsx})})},o=function(c){(e[c]||[]).forEach(function(u){s[s.length]=xt("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[c][0]})})};return i("workbooks"),l("sheets"),l("charts"),o("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),l("metadata"),o("people"),s.length>2&&(s[s.length]="</Types>",s[1]=s[1].replace("/>",">")),s.join("")}var ur={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function jf(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Bh(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var s={};return(e.match(Js)||[]).forEach(function(n){var i=Kt(n);if(i[0]==="<Relationship"){var l={};l.Type=i.Type,l.Target=i.Target,l.Id=i.Id,i.TargetMode&&(l.TargetMode=i.TargetMode);var o=i.TargetMode==="External"?i.Target:wh(i.Target,t);r[o]=l,s[i.Id]=l}}),r["!id"]=s,r}function Ru(e){var t=[Ba,xt("Relationships",null,{xmlns:es.RELS})];return Oa(e["!id"]).forEach(function(r){t[t.length]=xt("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Lr(e,t,r,s,n,i){if(n||(n={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,n.Id="rId"+t,n.Type=s,n.Target=r,[ur.HLINK,ur.XPATH,ur.XMISS].indexOf(n.Type)>-1&&(n.TargetMode="External"),e["!id"][n.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][n.Id]=n,e[("/"+n.Target).replace("//","/")]=n,t}var pH="application/vnd.oasis.opendocument.spreadsheet";function gH(e,t){for(var r=v2(e),s,n;s=bf.exec(r);)switch(s[3]){case"manifest":break;case"file-entry":if(n=Kt(s[0],!1),n.path=="/"&&n.type!==pH)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw s}}function yH(e){var t=[Ba];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function F4(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function vH(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function bH(e){var t=[Ba];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(F4(e[r][0],e[r][1])),t.push(vH("",e[r][0]));return t.push(F4("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function VI(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+qp.version+"</meta:generator></office:meta></office:document-meta>"}var pi=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],jH=function(){for(var e=new Array(pi.length),t=0;t<pi.length;++t){var r=pi[t],s="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+s+"[^>]*>([\\s\\S]*?)</"+s+">")}return e}();function HI(e){var t={};e=Hr(e);for(var r=0;r<pi.length;++r){var s=pi[r],n=e.match(jH[r]);n!=null&&n.length>0&&(t[s[1]]=wr(n[1])),s[2]==="date"&&t[s[1]]&&(t[s[1]]=aa(t[s[1]]))}return t}function _b(e,t,r,s,n){n[e]!=null||t==null||t===""||(n[e]=t,t=zr(t),s[s.length]=r?xt(e,t,r):As(e,t))}function qI(e,t){var r=t||{},s=[Ba,xt("cp:coreProperties",null,{"xmlns:cp":es.CORE_PROPS,"xmlns:dc":es.dc,"xmlns:dcterms":es.dcterms,"xmlns:dcmitype":es.dcmitype,"xmlns:xsi":es.xsi})],n={};if(!e&&!r.Props)return s.join("");e&&(e.CreatedDate!=null&&_b("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:$j(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},s,n),e.ModifiedDate!=null&&_b("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:$j(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},s,n));for(var i=0;i!=pi.length;++i){var l=pi[i],o=r.Props&&r.Props[l[1]]!=null?r.Props[l[1]]:e?e[l[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&_b(l[0],o,null,s,n)}return s.length>2&&(s[s.length]="</cp:coreProperties>",s[1]=s[1].replace("/>",">")),s.join("")}var ud=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],KI=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function GI(e,t,r,s){var n=[];if(typeof e=="string")n=k4(e,s);else for(var i=0;i<e.length;++i)n=n.concat(e[i].map(function(d){return{v:d}}));var l=typeof t=="string"?k4(t,s).map(function(d){return d.v}):t,o=0,c=0;if(l.length>0)for(var u=0;u!==n.length;u+=2){switch(c=+n[u+1].v,n[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=l.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=l.slice(o,o+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=l.slice(o,o+c);break}o+=c}}function wH(e,t,r){var s={};return t||(t={}),e=Hr(e),ud.forEach(function(n){var i=(e.match(yf(n[0]))||[])[1];switch(n[2]){case"string":i&&(t[n[1]]=wr(i));break;case"bool":t[n[1]]=i==="true";break;case"raw":var l=e.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));l&&l.length>0&&(s[n[1]]=l[1]);break}}),s.HeadingPairs&&s.TitlesOfParts&&GI(s.HeadingPairs,s.TitlesOfParts,t,r),t}function QI(e){var t=[],r=xt;return e||(e={}),e.Application="SheetJS",t[t.length]=Ba,t[t.length]=xt("Properties",null,{xmlns:es.EXT_PROPS,"xmlns:vt":es.vt}),ud.forEach(function(s){if(e[s[1]]!==void 0){var n;switch(s[2]){case"string":n=zr(String(e[s[1]]));break;case"bool":n=e[s[1]]?"true":"false";break}n!==void 0&&(t[t.length]=r(s[0],n))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(s){return"<vt:lpstr>"+zr(s)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var NH=/<[^>]+>[^<]*/g;function SH(e,t){var r={},s="",n=e.match(NH);if(n)for(var i=0;i!=n.length;++i){var l=n[i],o=Kt(l);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":s=wr(o.name);break;case"</property>":s=null;break;default:if(l.indexOf("<vt:")===0){var c=l.split(">"),u=c[0].slice(4),d=c[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[s]=wr(d);break;case"bool":r[s]=ta(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[s]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[s]=parseFloat(d);break;case"filetime":case"date":r[s]=aa(d);break;case"cy":case"error":r[s]=wr(d);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",l,u,c)}}else if(l.slice(0,2)!=="</"){if(t.WTF)throw new Error(l)}}}return r}function XI(e){var t=[Ba,xt("Properties",null,{xmlns:es.CUST_PROPS,"xmlns:vt":es.vt})];if(!e)return t.join("");var r=1;return Oa(e).forEach(function(n){++r,t[t.length]=xt("property",OV(e[n]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:zr(n)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Vj={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Tb;function kH(e,t,r){Tb||(Tb=Ey(Vj)),t=Tb[t]||t,e[t]=r}function CH(e,t){var r=[];return Oa(Vj).map(function(s){for(var n=0;n<pi.length;++n)if(pi[n][1]==s)return pi[n];for(n=0;n<ud.length;++n)if(ud[n][1]==s)return ud[n];throw s}).forEach(function(s){if(e[s[1]]!=null){var n=t&&t.Props&&t.Props[s[1]]!=null?t.Props[s[1]]:e[s[1]];switch(s[2]){case"date":n=new Date(n).toISOString().replace(/\.\d*Z/,"Z");break}typeof n=="number"?n=String(n):n===!0||n===!1?n=n?"1":"0":n instanceof Date&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"")),r.push(As(Vj[s[1]]||s[1],n))}}),xt("DocumentProperties",r.join(""),{xmlns:$n.o})}function EH(e,t){var r=["Worksheets","SheetNames"],s="CustomDocumentProperties",n=[];return e&&Oa(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var l=0;l<pi.length;++l)if(i==pi[l][1])return;for(l=0;l<ud.length;++l)if(i==ud[l][1])return;for(l=0;l<r.length;++l)if(i==r[l])return;var o=e[i],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),n.push(xt(j4(i),o,{"dt:dt":c}))}}),t&&Oa(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var l=t[i],o="string";typeof l=="number"?(o="float",l=String(l)):l===!0||l===!1?(o="boolean",l=l?"1":"0"):l instanceof Date?(o="dateTime.tz",l=l.toISOString()):l=String(l),n.push(xt(j4(i),l,{"dt:dt":o}))}}),"<"+s+' xmlns="'+$n.o+'">'+n.join("")+"</"+s+">"}function _2(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function PH(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,s=r%Math.pow(2,32),n=(r-s)/Math.pow(2,32);s*=1e7,n*=1e7;var i=s/Math.pow(2,32)|0;i>0&&(s=s%Math.pow(2,32),n+=i);var l=He(8);return l.write_shift(4,s),l.write_shift(4,n),l}function YI(e,t,r){var s=e.l,n=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-s&3;)++e.l;return n}function JI(e,t,r){var s=e.read_shift(0,"lpwstr");return s}function ZI(e,t,r){return t===31?JI(e):YI(e,t,r)}function Hj(e,t,r){return ZI(e,t,r===!1?0:4)}function AH(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return ZI(e,t,0)}function _H(e){for(var t=e.read_shift(4),r=[],s=0;s!=t;++s){var n=e.l;r[s]=e.read_shift(0,"lpwstr").replace(un,""),e.l-n&2&&(e.l+=2)}return r}function TH(e){for(var t=e.read_shift(4),r=[],s=0;s!=t;++s)r[s]=e.read_shift(0,"lpstr-cp").replace(un,"");return r}function IH(e){var t=e.l,r=tg(e,zI);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var s=tg(e,jn);return[r,s]}function OH(e){for(var t=e.read_shift(4),r=[],s=0;s<t/2;++s)r.push(IH(e));return r}function R4(e,t){for(var r=e.read_shift(4),s={},n=0;n!=r;++n){var i=e.read_shift(4),l=e.read_shift(4);s[i]=e.read_shift(l,t===1200?"utf16le":"utf8").replace(un,"").replace(jh,"!"),t===1200&&l%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),s}function eO(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function DH(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function tg(e,t,r){var s=e.read_shift(2),n,i=r||{};if(e.l+=2,t!==O4&&s!==t&&uH.indexOf(t)===-1&&!((t&65534)==4126&&(s&65534)==4126))throw new Error("Expected type "+t+" saw "+s);switch(t===O4?s:t){case 2:return n=e.read_shift(2,"i"),i.raw||(e.l+=2),n;case 3:return n=e.read_shift(4,"i"),n;case 11:return e.read_shift(4)!==0;case 19:return n=e.read_shift(4),n;case 30:return YI(e,s,4).replace(un,"");case 31:return JI(e);case 64:return _2(e);case 65:return eO(e);case 71:return DH(e);case 80:return Hj(e,s,!i.raw).replace(un,"");case 81:return AH(e,s).replace(un,"");case 4108:return OH(e);case 4126:case 4127:return s==4127?_H(e):TH(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+s)}}function M4(e,t){var r=He(4),s=He(4);switch(r.write_shift(4,e==80?31:e),e){case 3:s.write_shift(-4,t);break;case 5:s=He(8),s.write_shift(8,t,"f");break;case 11:s.write_shift(4,t?1:0);break;case 64:s=PH(t);break;case 31:case 80:for(s=He(4+2*(t.length+1)+(t.length%2?0:2)),s.write_shift(4,t.length+1),s.write_shift(0,t,"dbcs");s.l!=s.length;)s.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return ps([r,s])}function L4(e,t){var r=e.l,s=e.read_shift(4),n=e.read_shift(4),i=[],l=0,o=0,c=-1,u={};for(l=0;l!=n;++l){var d=e.read_shift(4),h=e.read_shift(4);i[l]=[d,h+r]}i.sort(function(j,b){return j[1]-b[1]});var f={};for(l=0;l!=n;++l){if(e.l!==i[l][1]){var x=!0;if(l>0&&t)switch(t[i[l-1][0]].t){case 2:e.l+2===i[l][1]&&(e.l+=2,x=!1);break;case 80:e.l<=i[l][1]&&(e.l=i[l][1],x=!1);break;case 4108:e.l<=i[l][1]&&(e.l=i[l][1],x=!1);break}if((!t||l==0)&&e.l<=i[l][1]&&(x=!1,e.l=i[l][1]),x)throw new Error("Read Error: Expected address "+i[l][1]+" at "+e.l+" :"+l)}if(t){var p=t[i[l][0]];if(f[p.n]=tg(e,p.t,{raw:!0}),p.p==="version"&&(f[p.n]=String(f[p.n]>>16)+"."+("0000"+String(f[p.n]&65535)).slice(-4)),p.n=="CodePage")switch(f[p.n]){case 0:f[p.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Li(o=f[p.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+f[p.n])}}else if(i[l][0]===1){if(o=f.CodePage=tg(e,P2),Li(o),c!==-1){var g=e.l;e.l=i[c][1],u=R4(e,o),e.l=g}}else if(i[l][0]===0){if(o===0){c=l,e.l=i[l+1][1];continue}u=R4(e,o)}else{var y=u[i[l][0]],v;switch(e[e.l]){case 65:e.l+=4,v=eO(e);break;case 30:e.l+=4,v=Hj(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,v=Hj(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,v=e.read_shift(4,"i");break;case 19:e.l+=4,v=e.read_shift(4);break;case 5:e.l+=4,v=e.read_shift(8,"f");break;case 11:e.l+=4,v=Da(e,4);break;case 64:e.l+=4,v=aa(_2(e));break;default:throw new Error("unparsed value: "+e[e.l])}f[y]=v}}return e.l=r+s,f}var tO=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function FH(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function $4(e,t,r){var s=He(8),n=[],i=[],l=8,o=0,c=He(8),u=He(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),i.push(c),n.push(u),l+=8+c.length,!t){u=He(8),u.write_shift(4,0),n.unshift(u);var d=[He(4)];for(d[0].write_shift(4,e.length),o=0;o<e.length;++o){var h=e[o][0];for(c=He(8+2*(h.length+1)+(h.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,h.length+1),c.write_shift(0,h,"dbcs");c.l!=c.length;)c.write_shift(1,0);d.push(c)}c=ps(d),i.unshift(c),l+=8+c.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(tO.indexOf(e[o][0])>-1||KI.indexOf(e[o][0])>-1)&&e[o][1]!=null){var f=e[o][1],x=0;if(t){x=+t[e[o][0]];var p=r[x];if(p.p=="version"&&typeof f=="string"){var g=f.split(".");f=(+g[0]<<16)+(+g[1]||0)}c=M4(p.t,f)}else{var y=FH(f);y==-1&&(y=31,f=String(f)),c=M4(y,f)}i.push(c),u=He(8),u.write_shift(4,t?x:2+o),n.push(u),l+=8+c.length}var v=8*(i.length+1);for(o=0;o<i.length;++o)n[o].write_shift(4,v),v+=i[o].length;return s.write_shift(4,l),s.write_shift(4,i.length),ps([s].concat(n).concat(i))}function B4(e,t,r){var s=e.content;if(!s)return{};Ps(s,0);var n,i,l,o,c=0;s.chk("feff","Byte Order: "),s.read_shift(2);var u=s.read_shift(4),d=s.read_shift(16);if(d!==$t.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(n=s.read_shift(4),n!==1&&n!==2)throw new Error("Unrecognized #Sets: "+n);if(i=s.read_shift(16),o=s.read_shift(4),n===1&&o!==s.l)throw new Error("Length mismatch: "+o+" !== "+s.l);n===2&&(l=s.read_shift(16),c=s.read_shift(4));var h=L4(s,t),f={SystemIdentifier:u};for(var x in h)f[x]=h[x];if(f.FMTID=i,n===1)return f;if(c-s.l==2&&(s.l+=2),s.l!==c)throw new Error("Length mismatch 2: "+s.l+" !== "+c);var p;try{p=L4(s,null)}catch{}for(x in p)f[x]=p[x];return f.FMTID=[i,l],f}function z4(e,t,r,s,n,i){var l=He(n?68:48),o=[l];l.write_shift(2,65534),l.write_shift(2,0),l.write_shift(4,842412599),l.write_shift(16,$t.utils.consts.HEADER_CLSID,"hex"),l.write_shift(4,n?2:1),l.write_shift(16,t,"hex"),l.write_shift(4,n?68:48);var c=$4(e,r,s);if(o.push(c),n){var u=$4(n,null,null);l.write_shift(16,i,"hex"),l.write_shift(4,68+c.length),o.push(u)}return ps(o)}function Po(e,t){return e.read_shift(t),null}function RH(e,t){t||(t=He(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function MH(e,t,r){for(var s=[],n=e.l+t;e.l<n;)s.push(r(e,n-e.l));if(n!==e.l)throw new Error("Slurp error");return s}function Da(e,t){return e.read_shift(t)===1}function ln(e,t){return t||(t=He(2)),t.write_shift(2,+!!e),t}function Va(e){return e.read_shift(2,"u")}function ci(e,t){return t||(t=He(2)),t.write_shift(2,e),t}function rO(e,t){return MH(e,t,Va)}function LH(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function aO(e,t,r){return r||(r=He(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function cx(e,t,r){var s=e.read_shift(r&&r.biff>=12?2:1),n="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(n="dbcs-cont")}else r.biff==12&&(n="wstr");r.biff>=2&&r.biff<=5&&(n="cpstr");var l=s?e.read_shift(s,n):"";return l}function $H(e){var t=e.read_shift(2),r=e.read_shift(1),s=r&4,n=r&8,i=1+(r&1),l=0,o,c={};n&&(l=e.read_shift(2)),s&&(o=e.read_shift(4));var u=i==2?"dbcs-cont":"sbcs-cont",d=t===0?"":e.read_shift(t,u);return n&&(e.l+=4*l),s&&(e.l+=o),c.t=d,n||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function BH(e){var t=e.t||"",r=He(3);r.write_shift(2,t.length),r.write_shift(1,1);var s=He(2*t.length);s.write_shift(2*t.length,t,"utf16le");var n=[r,s];return ps(n)}function Td(e,t,r){var s;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var n=e.read_shift(1);return n===0?s=e.read_shift(t,"sbcs-cont"):s=e.read_shift(t,"dbcs-cont"),s}function dx(e,t,r){var s=e.read_shift(r&&r.biff==2?1:2);return s===0?(e.l++,""):Td(e,s,r)}function Yd(e,t,r){if(r.biff>5)return dx(e,t,r);var s=e.read_shift(1);return s===0?(e.l++,""):e.read_shift(s,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function sO(e,t,r){return r||(r=He(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function zH(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function UH(e){var t=e.read_shift(4),r=e.l,s=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(s=!0),e.l=r);var n=e.read_shift((s?t-24:t)>>1,"utf16le").replace(un,"");return s&&(e.l+=24),n}function WH(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var s=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var n=e.read_shift(4);if(n===0)return r+s.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=e.read_shift(i>>1,"utf16le").replace(un,"");return r+l}function VH(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return UH(e);case"0303000000000000c000000000000046":return WH(e);default:throw new Error("Unsupported Moniker "+r)}}function pm(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(un,""):"";return r}function U4(e,t){t||(t=He(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function HH(e,t){var r=e.l+t,s=e.read_shift(4);if(s!==2)throw new Error("Unrecognized streamVersion: "+s);var n=e.read_shift(2);e.l+=2;var i,l,o,c,u="",d,h;n&16&&(i=pm(e,r-e.l)),n&128&&(l=pm(e,r-e.l)),(n&257)===257&&(o=pm(e,r-e.l)),(n&257)===1&&(c=VH(e,r-e.l)),n&8&&(u=pm(e,r-e.l)),n&32&&(d=e.read_shift(16)),n&64&&(h=_2(e)),e.l=r;var f=l||o||c||"";f&&u&&(f+="#"+u),f||(f="#"+u),n&2&&f.charAt(0)=="/"&&f.charAt(1)!="/"&&(f="file://"+f);var x={Target:f};return d&&(x.guid=d),h&&(x.time=h),i&&(x.Tooltip=i),x}function qH(e){var t=He(512),r=0,s=e.Target;s.slice(0,7)=="file://"&&(s=s.slice(7));var n=s.indexOf("#"),i=n>-1?31:23;switch(s.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var l=[8,6815827,6619237,4849780,83];for(r=0;r<l.length;++r)t.write_shift(4,l[r]);if(i==28)s=s.slice(1),U4(s,t);else if(i&2){for(l="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<l.length;++r)t.write_shift(1,parseInt(l[r],16));var o=n>-1?s.slice(0,n):s;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),i&8&&U4(n>-1?s.slice(n+1):"",t)}else{for(l="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<l.length;++r)t.write_shift(1,parseInt(l[r],16));for(var c=0;s.slice(c*3,c*3+3)=="../"||s.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,s.length-3*c+1),r=0;r<s.length-3*c;++r)t.write_shift(1,s.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function nO(e){var t=e.read_shift(1),r=e.read_shift(1),s=e.read_shift(1),n=e.read_shift(1);return[t,r,s,n]}function iO(e,t){var r=nO(e);return r[3]=0,r}function Sl(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2);return{r:t,c:r,ixfe:s}}function Id(e,t,r,s){return s||(s=He(6)),s.write_shift(2,e),s.write_shift(2,t),s.write_shift(2,r||0),s}function KH(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function GH(e,t,r){return t===0?"":Yd(e,t,r)}function QH(e,t,r){var s=r.biff>8?4:2,n=e.read_shift(s),i=e.read_shift(s,"i"),l=e.read_shift(s,"i");return[n,i,l]}function lO(e){var t=e.read_shift(2),r=E2(e);return[t,r]}function XH(e,t,r){e.l+=4,t-=4;var s=e.l+t,n=cx(e,t,r),i=e.read_shift(2);if(s-=e.l,i!==s)throw new Error("Malformed AddinUdf: padding = "+s+" != "+i);return e.l+=i,n}function _y(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2),n=e.read_shift(2);return{s:{c:s,r:t},e:{c:n,r}}}function oO(e,t){return t||(t=He(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function cO(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(1),n=e.read_shift(1);return{s:{c:s,r:t},e:{c:n,r}}}var YH=cO;function dO(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2);return e.l+=12,[r,t,s]}function JH(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function ZH(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Ls(e){e.l+=2,e.l+=e.read_shift(2)}var eq={0:Ls,4:Ls,5:Ls,6:Ls,7:ZH,8:Ls,9:Ls,10:Ls,11:Ls,12:Ls,13:JH,14:Ls,15:Ls,16:Ls,17:Ls,18:Ls,19:Ls,20:Ls,21:dO};function tq(e,t){for(var r=e.l+t,s=[];e.l<r;){var n=e.read_shift(2);e.l-=2;try{s.push(eq[n](e,r-e.l))}catch{return e.l=r,s}}return e.l!=r&&(e.l=r),s}function gm(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function T2(e,t,r){var s=1536,n=16;switch(r.bookType){case"biff8":break;case"biff5":s=1280,n=8;break;case"biff4":s=4,n=6;break;case"biff3":s=3,n=6;break;case"biff2":s=2,n=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=He(n);return i.write_shift(2,s),i.write_shift(2,t),n>4&&i.write_shift(2,29282),n>6&&i.write_shift(2,1997),n>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function rq(e,t){return t===0||e.read_shift(2),1200}function aq(e,t,r){if(r.enc)return e.l+=t,"";var s=e.l,n=Yd(e,0,r);return e.read_shift(t+s-e.l),n}function sq(e,t){var r=!t||t.biff==8,s=He(r?112:54);for(s.write_shift(t.biff==8?2:1,7),r&&s.write_shift(1,0),s.write_shift(4,859007059),s.write_shift(4,5458548|(r?0:536870912));s.l<s.length;)s.write_shift(1,r?0:32);return s}function nq(e,t,r){var s=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:s&16,fBelow:s&64,fRight:s&128}}function iq(e,t,r){var s=e.read_shift(4),n=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var l=cx(e,0,r);return l.length===0&&(l="Sheet1"),{pos:s,hs:n,dt:i,name:l}}function lq(e,t){var r=!t||t.biff>=8?2:1,s=He(8+r*e.name.length);s.write_shift(4,e.pos),s.write_shift(1,e.hs||0),s.write_shift(1,e.dt),s.write_shift(1,e.name.length),t.biff>=8&&s.write_shift(1,1),s.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var n=s.slice(0,s.l);return n.l=s.l,n}function oq(e,t){for(var r=e.l+t,s=e.read_shift(4),n=e.read_shift(4),i=[],l=0;l!=n&&e.l<r;++l)i.push($H(e));return i.Count=s,i.Unique=n,i}function cq(e,t){var r=He(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var s=[],n=0;n<e.length;++n)s[n]=BH(e[n]);var i=ps([r].concat(s));return i.parts=[r.length].concat(s.map(function(l){return l.length})),i}function dq(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function uq(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var s=e.read_shift(1);return e.l+=3,s&7&&(t.level=s&7),s&32&&(t.hidden=!0),s&64&&(t.hpt=r/20),t}function hq(e){var t=KH(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function fq(e){return e.read_shift(2),e.read_shift(4)}function W4(e,t,r){var s=0;r&&r.biff==2||(s=e.read_shift(2));var n=e.read_shift(2);r&&r.biff==2&&(s=1-(n>>15),n&=32767);var i={Unsynced:s&1,DyZero:(s&2)>>1,ExAsc:(s&4)>>2,ExDsc:(s&8)>>3};return[i,n]}function xq(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),l=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[s,n],Flags:i,CurTab:l,FirstTab:o,Selected:c,TabRatio:u}}function mq(){var e=He(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function pq(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var s=e.read_shift(2);return{RTL:s&64}}function gq(e){var t=He(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function yq(){}function vq(e,t,r){var s={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return s.name=cx(e,0,r),s}function bq(e,t){var r=e.name||"Arial",s=t&&t.biff==5,n=s?15+r.length:16+2*r.length,i=He(n);return i.write_shift(2,e.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),s||i.write_shift(1,1),i.write_shift((s?1:2)*r.length,r,s?"sbcs":"utf16le"),i}function jq(e){var t=Sl(e);return t.isst=e.read_shift(4),t}function wq(e,t,r,s){var n=He(10);return Id(e,t,s,n),n.write_shift(4,r),n}function Nq(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var s=e.l+t,n=Sl(e);r.biff==2&&e.l++;var i=dx(e,s-e.l,r);return n.val=i,n}function Sq(e,t,r,s,n){var i=!n||n.biff==8,l=He(8+ +i+(1+i)*r.length);return Id(e,t,s,l),l.write_shift(2,r.length),i&&l.write_shift(1,1),l.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),l}function kq(e,t,r){var s=e.read_shift(2),n=Yd(e,0,r);return[s,n]}function Cq(e,t,r,s){var n=r&&r.biff==5;s||(s=He(n?3+t.length:5+2*t.length)),s.write_shift(2,e),s.write_shift(n?1:2,t.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le");var i=s.length>s.l?s.slice(0,s.l):s;return i.l==null&&(i.l=i.length),i}var Eq=Yd;function V4(e,t,r){var s=e.l+t,n=r.biff==8||!r.biff?4:2,i=e.read_shift(n),l=e.read_shift(n),o=e.read_shift(2),c=e.read_shift(2);return e.l=s,{s:{r:i,c:o},e:{r:l,c}}}function Pq(e,t){var r=t.biff==8||!t.biff?4:2,s=He(2*r+6);return s.write_shift(r,e.s.r),s.write_shift(r,e.e.r+1),s.write_shift(2,e.s.c),s.write_shift(2,e.e.c+1),s.write_shift(2,0),s}function Aq(e){var t=e.read_shift(2),r=e.read_shift(2),s=lO(e);return{r:t,c:r,ixfe:s[0],rknum:s[1]}}function _q(e,t){for(var r=e.l+t-2,s=e.read_shift(2),n=e.read_shift(2),i=[];e.l<r;)i.push(lO(e));if(e.l!==r)throw new Error("MulRK read error");var l=e.read_shift(2);if(i.length!=l-n+1)throw new Error("MulRK length mismatch");return{r:s,c:n,C:l,rkrec:i}}function Tq(e,t){for(var r=e.l+t-2,s=e.read_shift(2),n=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var l=e.read_shift(2);if(i.length!=l-n+1)throw new Error("MulBlank length mismatch");return{r:s,c:n,C:l,ixfe:i}}function Iq(e,t,r,s){var n={},i=e.read_shift(4),l=e.read_shift(4),o=e.read_shift(4),c=e.read_shift(2);return n.patternType=hH[o>>26],s.cellStyles&&(n.alc=i&7,n.fWrap=i>>3&1,n.alcV=i>>4&7,n.fJustLast=i>>7&1,n.trot=i>>8&255,n.cIndent=i>>16&15,n.fShrinkToFit=i>>20&1,n.iReadOrder=i>>22&2,n.fAtrNum=i>>26&1,n.fAtrFnt=i>>27&1,n.fAtrAlc=i>>28&1,n.fAtrBdr=i>>29&1,n.fAtrPat=i>>30&1,n.fAtrProt=i>>31&1,n.dgLeft=l&15,n.dgRight=l>>4&15,n.dgTop=l>>8&15,n.dgBottom=l>>12&15,n.icvLeft=l>>16&127,n.icvRight=l>>23&127,n.grbitDiag=l>>30&3,n.icvTop=o&127,n.icvBottom=o>>7&127,n.icvDiag=o>>14&127,n.dgDiag=o>>21&15,n.icvFore=c&127,n.icvBack=c>>7&127,n.fsxButton=c>>14&1),n}function Oq(e,t,r){var s={};return s.ifnt=e.read_shift(2),s.numFmtId=e.read_shift(2),s.flags=e.read_shift(2),s.fStyle=s.flags>>2&1,t-=6,s.data=Iq(e,t,s.fStyle,r),s}function H4(e,t,r,s){var n=r&&r.biff==5;s||(s=He(n?16:20)),s.write_shift(2,0),e.style?(s.write_shift(2,e.numFmtId||0),s.write_shift(2,65524)):(s.write_shift(2,e.numFmtId||0),s.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&n&&(i|=1024),s.write_shift(4,i),s.write_shift(4,0),n||s.write_shift(4,0),s.write_shift(2,0),s}function Dq(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function Fq(e){var t=He(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function q4(e,t,r){var s=Sl(e);(r.biff==2||t==9)&&++e.l;var n=LH(e);return s.val=n,s.t=n===!0||n===!1?"b":"e",s}function Rq(e,t,r,s,n,i){var l=He(8);return Id(e,t,s,l),aO(r,i,l),l}function Mq(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var s=Sl(e),n=qs(e);return s.val=n,s}function Lq(e,t,r,s){var n=He(14);return Id(e,t,s,n),_d(r,n),n}var K4=GH;function $q(e,t,r){var s=e.l+t,n=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,n];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var l=Td(e,i),o=[];s>e.l;)o.push(dx(e));return[i,n,l,o]}function G4(e,t,r){var s=e.read_shift(2),n,i={fBuiltIn:s&1,fWantAdvise:s>>>1&1,fWantPict:s>>>2&1,fOle:s>>>3&1,fOleLink:s>>>4&1,cf:s>>>5&1023,fIcon:s>>>15&1};return r.sbcch===14849&&(n=XH(e,t-2,r)),i.body=n||e.read_shift(t-2),typeof n=="string"&&(i.Name=n),i}var Bq=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Q4(e,t,r){var s=e.l+t,n=e.read_shift(2),i=e.read_shift(1),l=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=Td(e,l,r);n&32&&(u=Bq[u.charCodeAt(0)]);var d=s-e.l;r&&r.biff==2&&--d;var h=s==e.l||o===0||!(d>0)?[]:tY(e,d,r,o);return{chKey:i,Name:u,itab:c,rgce:h}}function uO(e,t,r){if(r.biff<8)return zq(e,t,r);for(var s=[],n=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)s.push(QH(e,r.biff>8?12:6,r));if(e.l!=n)throw new Error("Bad ExternSheet: "+e.l+" != "+n);return s}function zq(e,t,r){e[e.l+1]==3&&e[e.l]++;var s=cx(e,t,r);return s.charCodeAt(0)==3?s.slice(1):s}function Uq(e,t,r){if(r.biff<8){e.l+=t;return}var s=e.read_shift(2),n=e.read_shift(2),i=Td(e,s,r),l=Td(e,n,r);return[i,l]}function Wq(e,t,r){var s=cO(e);e.l++;var n=e.read_shift(1);return t-=8,[rY(e,t,r),n,s]}function X4(e,t,r){var s=YH(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[s,ZX(e,t,r)]}function Vq(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,s=e.read_shift(4);return[t,r,s]}function Hq(e,t,r){if(!(r.biff<8)){var s=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),l=e.read_shift(2),o=Yd(e,0,r);return r.biff<8&&e.read_shift(1),[{r:s,c:n},o,l,i]}}function qq(e,t,r){return Hq(e,t,r)}function Kq(e,t){for(var r=[],s=e.read_shift(2);s--;)r.push(_y(e));return r}function Gq(e){var t=He(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)oO(e[r],t);return t}function Qq(e,t,r){if(r&&r.biff<8)return Yq(e,t,r);var s=dO(e),n=tq(e,t-22,s[1]);return{cmo:s,ft:n}}var Xq={8:function(e,t){var r=e.l+t;e.l+=10;var s=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var n=e.read_shift(1);return e.l+=n,e.l=r,{fmt:s}}};function Yq(e,t,r){e.l+=4;var s=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var l=[];return l.push((Xq[s]||Ys)(e,t,r)),{cmo:[n,s,i],ft:l}}function Jq(e,t,r){var s=e.l,n="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:l=zH(e,6,r);var o=e.read_shift(2);e.read_shift(2),Va(e,2);var c=e.read_shift(2);e.l+=c;for(var u=1;u<e.lens.length-1;++u){if(e.l-s!=e.lens[u])throw new Error("TxO: bad continue record");var d=e[e.l],h=Td(e,e.lens[u+1]-e.lens[u]-1);if(n+=h,n.length>=(d?o:2*o))break}if(n.length!==o&&n.length!==o*2)throw new Error("cchText: "+o+" != "+n.length);return e.l=s+t,{t:n}}catch{return e.l=s+t,{t:n}}}function Zq(e,t){var r=_y(e);e.l+=16;var s=HH(e,t-24);return[r,s]}function eK(e){var t=He(24),r=ba(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var s="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<16;++n)t.write_shift(1,parseInt(s[n],16));return ps([t,qH(e[1])])}function tK(e,t){e.read_shift(2);var r=_y(e),s=e.read_shift((t-10)/2,"dbcs-cont");return s=s.replace(un,""),[r,s]}function rK(e){var t=e[1].Tooltip,r=He(10+2*(t.length+1));r.write_shift(2,2048);var s=ba(e[0]);r.write_shift(2,s.r),r.write_shift(2,s.r),r.write_shift(2,s.c),r.write_shift(2,s.c);for(var n=0;n<t.length;++n)r.write_shift(2,t.charCodeAt(n));return r.write_shift(2,0),r}function aK(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=D4[r]||r,r=e.read_shift(2),t[1]=D4[r]||r,t}function sK(e){return e||(e=He(4)),e.write_shift(2,1),e.write_shift(2,1),e}function nK(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(iO(e));return r}function iK(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(iO(e));return r}function lK(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function hO(e,t,r){if(!r.cellStyles)return Ys(e,t);var s=r&&r.biff>=12?4:2,n=e.read_shift(s),i=e.read_shift(s),l=e.read_shift(s),o=e.read_shift(s),c=e.read_shift(2);s==2&&(e.l+=2);var u={s:n,e:i,w:l,ixfe:o,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function oK(e,t){var r=He(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var s=0;return e.hidden&&(s|=1),r.write_shift(1,s),s=e.level||0,r.write_shift(1,s),r.write_shift(2,0),r}function cK(e,t){var r={};return t<32||(e.l+=16,r.header=qs(e),r.footer=qs(e),e.l+=2),r}function dK(e,t,r){var s={area:!1};if(r.biff!=5)return e.l+=t,s;var n=e.read_shift(1);return e.l+=3,n&16&&(s.area=!0),s}function uK(e){for(var t=He(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var hK=Sl,fK=rO,xK=dx;function mK(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(4),n={fmt:t,env:r,len:s,data:e.slice(e.l,e.l+s)};return e.l+=s,n}function pK(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var s=Sl(e);++e.l;var n=Yd(e,t-7,r);return s.t="str",s.val=n,s}function gK(e){var t=Sl(e);++e.l;var r=qs(e);return t.t="n",t.val=r,t}function yK(e,t,r){var s=He(15);return xx(s,e,t),s.write_shift(8,r,"f"),s}function vK(e){var t=Sl(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function bK(e,t,r){var s=He(9);return xx(s,e,t),s.write_shift(2,r),s}function jK(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function wK(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function NK(e,t,r){var s=e.l+t,n=Sl(e),i=e.read_shift(2),l=Td(e,i,r);return e.l=s,n.t="str",n.val=l,n}var SK=[2,3,48,49,131,139,140,245],qj=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Ey({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,c){var u=[],d=xc(1);switch(c.type){case"base64":d=zn(Qn(o));break;case"binary":d=zn(o);break;case"buffer":case"array":d=o;break}Ps(d,0);var h=d.read_shift(1),f=!!(h&136),x=!1,p=!1;switch(h){case 2:break;case 3:break;case 48:x=!0,f=!0;break;case 49:x=!0,f=!0;break;case 131:break;case 139:break;case 140:p=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var g=0,y=521;h==2&&(g=d.read_shift(2)),d.l+=3,h!=2&&(g=d.read_shift(4)),g>1048576&&(g=1e6),h!=2&&(y=d.read_shift(2));var v=d.read_shift(2),j=c.codepage||1252;h!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(j=e[d[d.l]]),d.l+=1,d.l+=2),p&&(d.l+=36);for(var b=[],w={},k=Math.min(d.length,h==2?521:y-10-(x?264:0)),N=p?32:11;d.l<k&&d[d.l]!=13;)switch(w={},w.name=mf.utils.decode(j,d.slice(d.l,d.l+N)).replace(/[\u0000\r\n].*$/g,""),d.l+=N,w.type=String.fromCharCode(d.read_shift(1)),h!=2&&!p&&(w.offset=d.read_shift(4)),w.len=d.read_shift(1),h==2&&(w.offset=d.read_shift(2)),w.dec=d.read_shift(1),w.name.length&&b.push(w),h!=2&&(d.l+=p?13:14),w.type){case"B":(!x||w.len!=8)&&c.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+w.type)}if(d[d.l]!==13&&(d.l=y-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=y;var S=0,_=0;for(u[0]=[],_=0;_!=b.length;++_)u[0][_]=b[_].name;for(;g-- >0;){if(d[d.l]===42){d.l+=v;continue}for(++d.l,u[++S]=[],_=0,_=0;_!=b.length;++_){var O=d.slice(d.l,d.l+b[_].len);d.l+=b[_].len,Ps(O,0);var E=mf.utils.decode(j,O);switch(b[_].type){case"C":E.trim().length&&(u[S][_]=E.replace(/\s+$/,""));break;case"D":E.length===8?u[S][_]=new Date(+E.slice(0,4),+E.slice(4,6)-1,+E.slice(6,8)):u[S][_]=E;break;case"F":u[S][_]=parseFloat(E.trim());break;case"+":case"I":u[S][_]=p?O.read_shift(-4,"i")^2147483648:O.read_shift(4,"i");break;case"L":switch(E.trim().toUpperCase()){case"Y":case"T":u[S][_]=!0;break;case"N":case"F":u[S][_]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+E+"|")}break;case"M":if(!f)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));u[S][_]="##MEMO##"+(p?parseInt(E.trim(),10):O.read_shift(4));break;case"N":E=E.replace(/\u0000/g,"").trim(),E&&E!="."&&(u[S][_]=+E||0);break;case"@":u[S][_]=new Date(O.read_shift(-8,"f")-621356832e5);break;case"T":u[S][_]=new Date((O.read_shift(4)-2440588)*864e5+O.read_shift(4));break;case"Y":u[S][_]=O.read_shift(4,"i")/1e4+O.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[S][_]=-O.read_shift(-8,"f");break;case"B":if(x&&b[_].len==8){u[S][_]=O.read_shift(8,"f");break}case"G":case"P":O.l+=b[_].len;break;case"0":if(b[_].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+b[_].type)}}}if(h!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=b,u}function s(o,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var d=F0(r(o,u),u);return d["!cols"]=u.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete u.DBF,d}function n(o,c){try{return Ec(s(o,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function l(o,c){var u=c||{};if(+u.codepage>=0&&Li(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=In(),h=sg(o,{header:1,raw:!0,cellDates:!0}),f=h[0],x=h.slice(1),p=o["!cols"]||[],g=0,y=0,v=0,j=1;for(g=0;g<f.length;++g){if(((p[g]||{}).DBF||{}).name){f[g]=p[g].DBF.name,++v;continue}if(f[g]!=null){if(++v,typeof f[g]=="number"&&(f[g]=f[g].toString(10)),typeof f[g]!="string")throw new Error("DBF Invalid column name "+f[g]+" |"+typeof f[g]+"|");if(f.indexOf(f[g])!==g){for(y=0;y<1024;++y)if(f.indexOf(f[g]+"_"+y)==-1){f[g]+="_"+y;break}}}}var b=Nr(o["!ref"]),w=[],k=[],N=[];for(g=0;g<=b.e.c-b.s.c;++g){var S="",_="",O=0,E=[];for(y=0;y<x.length;++y)x[y][g]!=null&&E.push(x[y][g]);if(E.length==0||f[g]==null){w[g]="?";continue}for(y=0;y<E.length;++y){switch(typeof E[y]){case"number":_="B";break;case"string":_="C";break;case"boolean":_="L";break;case"object":_=E[y]instanceof Date?"D":"C";break;default:_="C"}O=Math.max(O,String(E[y]).length),S=S&&S!=_?"C":_}O>250&&(O=250),_=((p[g]||{}).DBF||{}).type,_=="C"&&p[g].DBF.len>O&&(O=p[g].DBF.len),S=="B"&&_=="N"&&(S="N",N[g]=p[g].DBF.dec,O=p[g].DBF.len),k[g]=S=="C"||_=="N"?O:i[S]||0,j+=k[g],w[g]=S}var R=d.next(32);for(R.write_shift(4,318902576),R.write_shift(4,x.length),R.write_shift(2,296+32*v),R.write_shift(2,j),g=0;g<4;++g)R.write_shift(4,0);for(R.write_shift(4,0|(+t[tI]||3)<<8),g=0,y=0;g<f.length;++g)if(f[g]!=null){var C=d.next(32),I=(f[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);C.write_shift(1,I,"sbcs"),C.write_shift(1,w[g]=="?"?"C":w[g],"sbcs"),C.write_shift(4,y),C.write_shift(1,k[g]||i[w[g]]||0),C.write_shift(1,N[g]||0),C.write_shift(1,2),C.write_shift(4,0),C.write_shift(1,0),C.write_shift(4,0),C.write_shift(4,0),y+=k[g]||i[w[g]]||0}var ne=d.next(264);for(ne.write_shift(4,13),g=0;g<65;++g)ne.write_shift(4,0);for(g=0;g<x.length;++g){var W=d.next(j);for(W.write_shift(1,0),y=0;y<f.length;++y)if(f[y]!=null)switch(w[y]){case"L":W.write_shift(1,x[g][y]==null?63:x[g][y]?84:70);break;case"B":W.write_shift(8,x[g][y]||0,"f");break;case"N":var Q="0";for(typeof x[g][y]=="number"&&(Q=x[g][y].toFixed(N[y]||0)),v=0;v<k[y]-Q.length;++v)W.write_shift(1,32);W.write_shift(1,Q,"sbcs");break;case"D":x[g][y]?(W.write_shift(4,("0000"+x[g][y].getFullYear()).slice(-4),"sbcs"),W.write_shift(2,("00"+(x[g][y].getMonth()+1)).slice(-2),"sbcs"),W.write_shift(2,("00"+x[g][y].getDate()).slice(-2),"sbcs")):W.write_shift(8,"00000000","sbcs");break;case"C":var H=String(x[g][y]!=null?x[g][y]:"").slice(0,k[y]);for(W.write_shift(1,H,"sbcs"),v=0;v<k[y]-H.length;++v)W.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:n,to_sheet:s,from_sheet:l}}(),fO=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Oa(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(f,x){var p=e[x];return typeof p=="number"?l4(p):p},s=function(f,x,p){var g=x.charCodeAt(0)-32<<4|p.charCodeAt(0)-48;return g==59?f:l4(g)};e["|"]=254;function n(f,x){switch(x.type){case"base64":return i(Qn(f),x);case"binary":return i(f,x);case"buffer":return i(cr&&Buffer.isBuffer(f)?f.toString("binary"):Cc(f),x);case"array":return i(Ad(f),x)}throw new Error("Unrecognized type "+x.type)}function i(f,x){var p=f.split(/[\n\r]+/),g=-1,y=-1,v=0,j=0,b=[],w=[],k=null,N={},S=[],_=[],O=[],E=0,R;for(+x.codepage>=0&&Li(+x.codepage);v!==p.length;++v){E=0;var C=p[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,s).replace(t,r),I=C.replace(/;;/g,"\0").split(";").map(function(Z){return Z.replace(/\u0000/g,";")}),ne=I[0],W;if(C.length>0)switch(ne){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":I[1].charAt(0)=="P"&&w.push(C.slice(3).replace(/;;/g,";"));break;case"C":var Q=!1,H=!1,K=!1,q=!1,ge=-1,G=-1;for(j=1;j<I.length;++j)switch(I[j].charAt(0)){case"A":break;case"X":y=parseInt(I[j].slice(1))-1,H=!0;break;case"Y":for(g=parseInt(I[j].slice(1))-1,H||(y=0),R=b.length;R<=g;++R)b[R]=[];break;case"K":W=I[j].slice(1),W.charAt(0)==='"'?W=W.slice(1,W.length-1):W==="TRUE"?W=!0:W==="FALSE"?W=!1:isNaN(Ui(W))?isNaN(u0(W).getDate())||(W=aa(W)):(W=Ui(W),k!==null&&O0(k)&&(W=Ay(W))),Q=!0;break;case"E":q=!0;var B=Mu(I[j].slice(1),{r:g,c:y});b[g][y]=[b[g][y],B];break;case"S":K=!0,b[g][y]=[b[g][y],"S5S"];break;case"G":break;case"R":ge=parseInt(I[j].slice(1))-1;break;case"C":G=parseInt(I[j].slice(1))-1;break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+C)}if(Q&&(b[g][y]&&b[g][y].length==2?b[g][y][0]=W:b[g][y]=W,k=null),K){if(q)throw new Error("SYLK shared formula cannot have own formula");var se=ge>-1&&b[ge][G];if(!se||!se[1])throw new Error("SYLK shared formula cannot find base");b[g][y][1]=TO(se[1],{r:g-ge,c:y-G})}break;case"F":var L=0;for(j=1;j<I.length;++j)switch(I[j].charAt(0)){case"X":y=parseInt(I[j].slice(1))-1,++L;break;case"Y":for(g=parseInt(I[j].slice(1))-1,R=b.length;R<=g;++R)b[R]=[];break;case"M":E=parseInt(I[j].slice(1))/20;break;case"F":break;case"G":break;case"P":k=w[parseInt(I[j].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(O=I[j].slice(1).split(" "),R=parseInt(O[0],10);R<=parseInt(O[1],10);++R)E=parseInt(O[2],10),_[R-1]=E===0?{hidden:!0}:{wch:E},mc(_[R-1]);break;case"C":y=parseInt(I[j].slice(1))-1,_[y]||(_[y]={});break;case"R":g=parseInt(I[j].slice(1))-1,S[g]||(S[g]={}),E>0?(S[g].hpt=E,S[g].hpx=f0(E)):E===0&&(S[g].hidden=!0);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+C)}L<1&&(k=null);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+C)}}return S.length>0&&(N["!rows"]=S),_.length>0&&(N["!cols"]=_),x&&x.sheetRows&&(b=b.slice(0,x.sheetRows)),[b,N]}function l(f,x){var p=n(f,x),g=p[0],y=p[1],v=F0(g,x);return Oa(y).forEach(function(j){v[j]=y[j]}),v}function o(f,x){return Ec(l(f,x),x)}function c(f,x,p,g){var y="C;Y"+(p+1)+";X"+(g+1)+";K";switch(f.t){case"n":y+=f.v||0,f.f&&!f.F&&(y+=";E"+M2(f.f,{r:p,c:g}));break;case"b":y+=f.v?"TRUE":"FALSE";break;case"e":y+=f.w||f.v;break;case"d":y+='"'+(f.w||f.v)+'"';break;case"s":y+='"'+f.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return y}function u(f,x){x.forEach(function(p,g){var y="F;W"+(g+1)+" "+(g+1)+" ";p.hidden?y+="0":(typeof p.width=="number"&&!p.wpx&&(p.wpx=Nf(p.width)),typeof p.wpx=="number"&&!p.wch&&(p.wch=Sf(p.wpx)),typeof p.wch=="number"&&(y+=Math.round(p.wch))),y.charAt(y.length-1)!=" "&&f.push(y)})}function d(f,x){x.forEach(function(p,g){var y="F;";p.hidden?y+="M0;":p.hpt?y+="M"+20*p.hpt+";":p.hpx&&(y+="M"+20*kf(p.hpx)+";"),y.length>2&&f.push(y+"R"+(g+1))})}function h(f,x){var p=["ID;PWXL;N;E"],g=[],y=Nr(f["!ref"]),v,j=Array.isArray(f),b=`\r
`;p.push("P;PGeneral"),p.push("F;P0;DG0G8;M255"),f["!cols"]&&u(p,f["!cols"]),f["!rows"]&&d(p,f["!rows"]),p.push("B;Y"+(y.e.r-y.s.r+1)+";X"+(y.e.c-y.s.c+1)+";D"+[y.s.c,y.s.r,y.e.c,y.e.r].join(" "));for(var w=y.s.r;w<=y.e.r;++w)for(var k=y.s.c;k<=y.e.c;++k){var N=Ht({r:w,c:k});v=j?(f[w]||[])[k]:f[N],!(!v||v.v==null&&(!v.f||v.F))&&g.push(c(v,f,w,k))}return p.join(b)+b+g.join(b)+b+"E"+b}return{to_workbook:o,to_sheet:l,from_sheet:h}}(),xO=function(){function e(i,l){switch(l.type){case"base64":return t(Qn(i),l);case"binary":return t(i,l);case"buffer":return t(cr&&Buffer.isBuffer(i)?i.toString("binary"):Cc(i),l);case"array":return t(Ad(i),l)}throw new Error("Unrecognized type "+l.type)}function t(i,l){for(var o=i.split(`
`),c=-1,u=-1,d=0,h=[];d!==o.length;++d){if(o[d].trim()==="BOT"){h[++c]=[],u=0;continue}if(!(c<0)){var f=o[d].trim().split(","),x=f[0],p=f[1];++d;for(var g=o[d]||"";(g.match(/["]/g)||[]).length&1&&d<o.length-1;)g+=`
`+o[++d];switch(g=g.trim(),+x){case-1:if(g==="BOT"){h[++c]=[],u=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?h[c][u]=!0:g==="FALSE"?h[c][u]=!1:isNaN(Ui(p))?isNaN(u0(p).getDate())?h[c][u]=p:h[c][u]=aa(p):h[c][u]=Ui(p),++u;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),h[c][u++]=g!==""?g:null;break}if(g==="EOD")break}}return l&&l.sheetRows&&(h=h.slice(0,l.sheetRows)),h}function r(i,l){return F0(e(i,l),l)}function s(i,l){return Ec(r(i,l),l)}var n=function(){var i=function(c,u,d,h,f){c.push(u),c.push(d+","+h),c.push('"'+f.replace(/"/g,'""')+'"')},l=function(c,u,d,h){c.push(u+","+d),c.push(u==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(c){var u=[],d=Nr(c["!ref"]),h,f=Array.isArray(c);i(u,"TABLE",0,1,"sheetjs"),i(u,"VECTORS",0,d.e.r-d.s.r+1,""),i(u,"TUPLES",0,d.e.c-d.s.c+1,""),i(u,"DATA",0,0,"");for(var x=d.s.r;x<=d.e.r;++x){l(u,-1,0,"BOT");for(var p=d.s.c;p<=d.e.c;++p){var g=Ht({r:x,c:p});if(h=f?(c[x]||[])[p]:c[g],!h){l(u,1,0,"");continue}switch(h.t){case"n":var y=h.w;!y&&h.v!=null&&(y=h.v),y==null?h.f&&!h.F?l(u,1,0,"="+h.f):l(u,1,0,""):l(u,0,y,"V");break;case"b":l(u,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":l(u,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=vi(h.z||Wt[14],rs(aa(h.v)))),l(u,0,h.w,"V");break;default:l(u,1,0,"")}}}l(u,-1,0,"EOD");var v=`\r
`,j=u.join(v);return j}}();return{to_workbook:s,to_sheet:r,from_sheet:n}}(),mO=function(){function e(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,f){for(var x=h.split(`
`),p=-1,g=-1,y=0,v=[];y!==x.length;++y){var j=x[y].trim().split(":");if(j[0]==="cell"){var b=ba(j[1]);if(v.length<=b.r)for(p=v.length;p<=b.r;++p)v[p]||(v[p]=[]);switch(p=b.r,g=b.c,j[2]){case"t":v[p][g]=e(j[3]);break;case"v":v[p][g]=+j[3];break;case"vtf":var w=j[j.length-1];case"vtc":switch(j[3]){case"nl":v[p][g]=!!+j[4];break;default:v[p][g]=+j[4];break}j[2]=="vtf"&&(v[p][g]=[v[p][g],w])}}}return f&&f.sheetRows&&(v=v.slice(0,f.sheetRows)),v}function s(h,f){return F0(r(h,f),f)}function n(h,f){return Ec(s(h,f),f)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(h){if(!h||!h["!ref"])return"";for(var f=[],x=[],p,g="",y=Dn(h["!ref"]),v=Array.isArray(h),j=y.s.r;j<=y.e.r;++j)for(var b=y.s.c;b<=y.e.c;++b)if(g=Ht({r:j,c:b}),p=v?(h[j]||[])[b]:h[g],!(!p||p.v==null||p.t==="z")){switch(x=["cell",g,"t"],p.t){case"s":case"str":x.push(t(p.v));break;case"n":p.f?(x[2]="vtf",x[3]="n",x[4]=p.v,x[5]=t(p.f)):(x[2]="v",x[3]=p.v);break;case"b":x[2]="vt"+(p.f?"f":"c"),x[3]="nl",x[4]=p.v?"1":"0",x[5]=t(p.f||(p.v?"TRUE":"FALSE"));break;case"d":var w=rs(aa(p.v));x[2]="vtc",x[3]="nd",x[4]=""+w,x[5]=p.w||vi(p.z||Wt[14],w);break;case"e":continue}f.push(x.join(":"))}return f.push("sheet:c:"+(y.e.c-y.s.c+1)+":r:"+(y.e.r-y.s.r+1)+":tvf:1"),f.push("valueformat:1:text-wiki"),f.join(`
`)}function d(h){return[i,l,o,l,u(h),c].join(`
`)}return{to_workbook:n,to_sheet:s,from_sheet:d}}(),h0=function(){function e(d,h,f,x,p){p.raw?h[f][x]=d:d===""||(d==="TRUE"?h[f][x]=!0:d==="FALSE"?h[f][x]=!1:isNaN(Ui(d))?isNaN(u0(d).getDate())?h[f][x]=d:h[f][x]=aa(d):h[f][x]=Ui(d))}function t(d,h){var f=h||{},x=[];if(!d||d.length===0)return x;for(var p=d.split(/[\r\n]/),g=p.length-1;g>=0&&p[g].length===0;)--g;for(var y=10,v=0,j=0;j<=g;++j)v=p[j].indexOf(" "),v==-1?v=p[j].length:v++,y=Math.max(y,v);for(j=0;j<=g;++j){x[j]=[];var b=0;for(e(p[j].slice(0,y).trim(),x,j,b,f),b=1;b<=(p[j].length-y)/10+1;++b)e(p[j].slice(y+(b-1)*10,y+b*10).trim(),x,j,b,f)}return f.sheetRows&&(x=x.slice(0,f.sheetRows)),x}var r={44:",",9:"	",59:";",124:"|"},s={44:3,9:2,59:1,124:0};function n(d){for(var h={},f=!1,x=0,p=0;x<d.length;++x)(p=d.charCodeAt(x))==34?f=!f:!f&&p in r&&(h[p]=(h[p]||0)+1);p=[];for(x in h)Object.prototype.hasOwnProperty.call(h,x)&&p.push([h[x],x]);if(!p.length){h=s;for(x in h)Object.prototype.hasOwnProperty.call(h,x)&&p.push([h[x],x])}return p.sort(function(g,y){return g[0]-y[0]||s[g[1]]-s[y[1]]}),r[p.pop()[1]]||44}function i(d,h){var f=h||{},x="",p=f.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(x=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(x=d.charAt(4),d=d.slice(6)):x=n(d.slice(0,1024)):f&&f.FS?x=f.FS:x=n(d.slice(0,1024));var y=0,v=0,j=0,b=0,w=0,k=x.charCodeAt(0),N=!1,S=0,_=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var O=f.dateNF!=null?dV(f.dateNF):null;function E(){var R=d.slice(b,w),C={};if(R.charAt(0)=='"'&&R.charAt(R.length-1)=='"'&&(R=R.slice(1,-1).replace(/""/g,'"')),R.length===0)C.t="z";else if(f.raw)C.t="s",C.v=R;else if(R.trim().length===0)C.t="s",C.v=R;else if(R.charCodeAt(0)==61)R.charCodeAt(1)==34&&R.charCodeAt(R.length-1)==34?(C.t="s",C.v=R.slice(2,-1).replace(/""/g,'"')):$Q(R)?(C.t="n",C.f=R.slice(1)):(C.t="s",C.v=R);else if(R=="TRUE")C.t="b",C.v=!0;else if(R=="FALSE")C.t="b",C.v=!1;else if(!isNaN(j=Ui(R)))C.t="n",f.cellText!==!1&&(C.w=R),C.v=j;else if(!isNaN(u0(R).getDate())||O&&R.match(O)){C.z=f.dateNF||Wt[14];var I=0;O&&R.match(O)&&(R=uV(R,f.dateNF,R.match(O)||[]),I=1),f.cellDates?(C.t="d",C.v=aa(R,I)):(C.t="n",C.v=rs(aa(R,I))),f.cellText!==!1&&(C.w=vi(C.z,C.v instanceof Date?rs(C.v):C.v)),f.cellNF||delete C.z}else C.t="s",C.v=R;if(C.t=="z"||(f.dense?(p[y]||(p[y]=[]),p[y][v]=C):p[Ht({c:v,r:y})]=C),b=w+1,_=d.charCodeAt(b),g.e.c<v&&(g.e.c=v),g.e.r<y&&(g.e.r=y),S==k)++v;else if(v=0,++y,f.sheetRows&&f.sheetRows<=y)return!0}e:for(;w<d.length;++w)switch(S=d.charCodeAt(w)){case 34:_===34&&(N=!N);break;case k:case 10:case 13:if(!N&&E())break e;break}return w-b>0&&E(),p["!ref"]=sr(g),p}function l(d,h){return!(h&&h.PRN)||h.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?i(d,h):F0(t(d,h),h)}function o(d,h){var f="",x=h.type=="string"?[0,0,0,0]:H2(d,h);switch(h.type){case"base64":f=Qn(d);break;case"binary":f=d;break;case"buffer":h.codepage==65001?f=d.toString("utf8"):h.codepage&&typeof mf<"u"||(f=cr&&Buffer.isBuffer(d)?d.toString("binary"):Cc(d));break;case"array":f=Ad(d);break;case"string":f=d;break;default:throw new Error("Unrecognized type "+h.type)}return x[0]==239&&x[1]==187&&x[2]==191?f=Hr(f.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?f=Hr(f):h.type=="binary"&&typeof mf<"u",f.slice(0,19)=="socialcalc:version:"?mO.to_sheet(h.type=="string"?f:Hr(f),h):l(f,h)}function c(d,h){return Ec(o(d,h),h)}function u(d){for(var h=[],f=Nr(d["!ref"]),x,p=Array.isArray(d),g=f.s.r;g<=f.e.r;++g){for(var y=[],v=f.s.c;v<=f.e.c;++v){var j=Ht({r:g,c:v});if(x=p?(d[g]||[])[v]:d[j],!x||x.v==null){y.push("          ");continue}for(var b=(x.w||(no(x),x.w)||"").slice(0,10);b.length<10;)b+=" ";y.push(b+(v===0?" ":""))}h.push(y.join(""))}return h.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:u}}();function kK(e,t){var r=t||{},s=!!r.WTF;r.WTF=!0;try{var n=fO.to_workbook(e,r);return r.WTF=s,n}catch(i){if(r.WTF=s,!i.message.match(/SYLK bad record ID/)&&s)throw i;return h0.to_workbook(e,t)}}var hd=function(){function e(B,se,L){if(B){Ps(B,B.l||0);for(var Z=L.Enum||ge;B.l<B.length;){var F=B.read_shift(2),he=Z[F]||Z[65535],ye=B.read_shift(2),z=B.l+ye,A=he.f&&he.f(B,ye,L);if(B.l=z,se(A,he,F))return}}}function t(B,se){switch(se.type){case"base64":return r(zn(Qn(B)),se);case"binary":return r(zn(B),se);case"buffer":case"array":return r(B,se)}throw"Unsupported type "+se.type}function r(B,se){if(!B)return B;var L=se||{},Z=L.dense?[]:{},F="Sheet1",he="",ye=0,z={},A=[],de=[],D={s:{r:0,c:0},e:{r:0,c:0}},ze=L.sheetRows||0;if(B[2]==0&&(B[3]==8||B[3]==9)&&B.length>=16&&B[14]==5&&B[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(B[2]==2)L.Enum=ge,e(B,function(We,Bt,Ee){switch(Ee){case 0:L.vers=We,We>=4096&&(L.qpro=!0);break;case 6:D=We;break;case 204:We&&(he=We);break;case 222:he=We;break;case 15:case 51:L.qpro||(We[1].v=We[1].v.slice(1));case 13:case 14:case 16:Ee==14&&(We[2]&112)==112&&(We[2]&15)>1&&(We[2]&15)<15&&(We[1].z=L.dateNF||Wt[14],L.cellDates&&(We[1].t="d",We[1].v=Ay(We[1].v))),L.qpro&&We[3]>ye&&(Z["!ref"]=sr(D),z[F]=Z,A.push(F),Z=L.dense?[]:{},D={s:{r:0,c:0},e:{r:0,c:0}},ye=We[3],F=he||"Sheet"+(ye+1),he="");var it=L.dense?(Z[We[0].r]||[])[We[0].c]:Z[Ht(We[0])];if(it){it.t=We[1].t,it.v=We[1].v,We[1].z!=null&&(it.z=We[1].z),We[1].f!=null&&(it.f=We[1].f);break}L.dense?(Z[We[0].r]||(Z[We[0].r]=[]),Z[We[0].r][We[0].c]=We[1]):Z[Ht(We[0])]=We[1];break}},L);else if(B[2]==26||B[2]==14)L.Enum=G,B[2]==14&&(L.qpro=!0,B.l=0),e(B,function(We,Bt,Ee){switch(Ee){case 204:F=We;break;case 22:We[1].v=We[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(We[3]>ye&&(Z["!ref"]=sr(D),z[F]=Z,A.push(F),Z=L.dense?[]:{},D={s:{r:0,c:0},e:{r:0,c:0}},ye=We[3],F="Sheet"+(ye+1)),ze>0&&We[0].r>=ze)break;L.dense?(Z[We[0].r]||(Z[We[0].r]=[]),Z[We[0].r][We[0].c]=We[1]):Z[Ht(We[0])]=We[1],D.e.c<We[0].c&&(D.e.c=We[0].c),D.e.r<We[0].r&&(D.e.r=We[0].r);break;case 27:We[14e3]&&(de[We[14e3][0]]=We[14e3][1]);break;case 1537:de[We[0]]=We[1],We[0]==ye&&(F=We[1]);break}},L);else throw new Error("Unrecognized LOTUS BOF "+B[2]);if(Z["!ref"]=sr(D),z[he||F]=Z,A.push(he||F),!de.length)return{SheetNames:A,Sheets:z};for(var Fe={},ct=[],$e=0;$e<de.length;++$e)z[A[$e]]?(ct.push(de[$e]||A[$e]),Fe[de[$e]]=z[de[$e]]||z[A[$e]]):(ct.push(de[$e]),Fe[de[$e]]={"!ref":"A1"});return{SheetNames:ct,Sheets:Fe}}function s(B,se){var L=se||{};if(+L.codepage>=0&&Li(+L.codepage),L.type=="string")throw new Error("Cannot write WK1 to JS string");var Z=In(),F=Nr(B["!ref"]),he=Array.isArray(B),ye=[];mt(Z,0,i(1030)),mt(Z,6,c(F));for(var z=Math.min(F.e.r,8191),A=F.s.r;A<=z;++A)for(var de=Ma(A),D=F.s.c;D<=F.e.c;++D){A===F.s.r&&(ye[D]=va(D));var ze=ye[D]+de,Fe=he?(B[A]||[])[D]:B[ze];if(!(!Fe||Fe.t=="z"))if(Fe.t=="n")(Fe.v|0)==Fe.v&&Fe.v>=-32768&&Fe.v<=32767?mt(Z,13,x(A,D,Fe.v)):mt(Z,14,g(A,D,Fe.v));else{var ct=no(Fe);mt(Z,15,h(A,D,ct.slice(0,239)))}}return mt(Z,1),Z.end()}function n(B,se){var L=se||{};if(+L.codepage>=0&&Li(+L.codepage),L.type=="string")throw new Error("Cannot write WK3 to JS string");var Z=In();mt(Z,0,l(B));for(var F=0,he=0;F<B.SheetNames.length;++F)(B.Sheets[B.SheetNames[F]]||{})["!ref"]&&mt(Z,27,q(B.SheetNames[F],he++));var ye=0;for(F=0;F<B.SheetNames.length;++F){var z=B.Sheets[B.SheetNames[F]];if(!(!z||!z["!ref"])){for(var A=Nr(z["!ref"]),de=Array.isArray(z),D=[],ze=Math.min(A.e.r,8191),Fe=A.s.r;Fe<=ze;++Fe)for(var ct=Ma(Fe),$e=A.s.c;$e<=A.e.c;++$e){Fe===A.s.r&&(D[$e]=va($e));var We=D[$e]+ct,Bt=de?(z[Fe]||[])[$e]:z[We];if(!(!Bt||Bt.t=="z"))if(Bt.t=="n")mt(Z,23,E(Fe,$e,ye,Bt.v));else{var Ee=no(Bt);mt(Z,22,S(Fe,$e,ye,Ee.slice(0,239)))}}++ye}}return mt(Z,1),Z.end()}function i(B){var se=He(2);return se.write_shift(2,B),se}function l(B){var se=He(26);se.write_shift(2,4096),se.write_shift(2,4),se.write_shift(4,0);for(var L=0,Z=0,F=0,he=0;he<B.SheetNames.length;++he){var ye=B.SheetNames[he],z=B.Sheets[ye];if(!(!z||!z["!ref"])){++F;var A=Dn(z["!ref"]);L<A.e.r&&(L=A.e.r),Z<A.e.c&&(Z=A.e.c)}}return L>8191&&(L=8191),se.write_shift(2,L),se.write_shift(1,F),se.write_shift(1,Z),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(1,1),se.write_shift(1,2),se.write_shift(4,0),se.write_shift(4,0),se}function o(B,se,L){var Z={s:{c:0,r:0},e:{c:0,r:0}};return se==8&&L.qpro?(Z.s.c=B.read_shift(1),B.l++,Z.s.r=B.read_shift(2),Z.e.c=B.read_shift(1),B.l++,Z.e.r=B.read_shift(2),Z):(Z.s.c=B.read_shift(2),Z.s.r=B.read_shift(2),se==12&&L.qpro&&(B.l+=2),Z.e.c=B.read_shift(2),Z.e.r=B.read_shift(2),se==12&&L.qpro&&(B.l+=2),Z.s.c==65535&&(Z.s.c=Z.e.c=Z.s.r=Z.e.r=0),Z)}function c(B){var se=He(8);return se.write_shift(2,B.s.c),se.write_shift(2,B.s.r),se.write_shift(2,B.e.c),se.write_shift(2,B.e.r),se}function u(B,se,L){var Z=[{c:0,r:0},{t:"n",v:0},0,0];return L.qpro&&L.vers!=20768?(Z[0].c=B.read_shift(1),Z[3]=B.read_shift(1),Z[0].r=B.read_shift(2),B.l+=2):(Z[2]=B.read_shift(1),Z[0].c=B.read_shift(2),Z[0].r=B.read_shift(2)),Z}function d(B,se,L){var Z=B.l+se,F=u(B,se,L);if(F[1].t="s",L.vers==20768){B.l++;var he=B.read_shift(1);return F[1].v=B.read_shift(he,"utf8"),F}return L.qpro&&B.l++,F[1].v=B.read_shift(Z-B.l,"cstr"),F}function h(B,se,L){var Z=He(7+L.length);Z.write_shift(1,255),Z.write_shift(2,se),Z.write_shift(2,B),Z.write_shift(1,39);for(var F=0;F<Z.length;++F){var he=L.charCodeAt(F);Z.write_shift(1,he>=128?95:he)}return Z.write_shift(1,0),Z}function f(B,se,L){var Z=u(B,se,L);return Z[1].v=B.read_shift(2,"i"),Z}function x(B,se,L){var Z=He(7);return Z.write_shift(1,255),Z.write_shift(2,se),Z.write_shift(2,B),Z.write_shift(2,L,"i"),Z}function p(B,se,L){var Z=u(B,se,L);return Z[1].v=B.read_shift(8,"f"),Z}function g(B,se,L){var Z=He(13);return Z.write_shift(1,255),Z.write_shift(2,se),Z.write_shift(2,B),Z.write_shift(8,L,"f"),Z}function y(B,se,L){var Z=B.l+se,F=u(B,se,L);if(F[1].v=B.read_shift(8,"f"),L.qpro)B.l=Z;else{var he=B.read_shift(2);w(B.slice(B.l,B.l+he),F),B.l+=he}return F}function v(B,se,L){var Z=se&32768;return se&=-32769,se=(Z?B:0)+(se>=8192?se-16384:se),(Z?"":"$")+(L?va(se):Ma(se))}var j={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},b=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function w(B,se){Ps(B,0);for(var L=[],Z=0,F="",he="",ye="",z="";B.l<B.length;){var A=B[B.l++];switch(A){case 0:L.push(B.read_shift(8,"f"));break;case 1:he=v(se[0].c,B.read_shift(2),!0),F=v(se[0].r,B.read_shift(2),!1),L.push(he+F);break;case 2:{var de=v(se[0].c,B.read_shift(2),!0),D=v(se[0].r,B.read_shift(2),!1);he=v(se[0].c,B.read_shift(2),!0),F=v(se[0].r,B.read_shift(2),!1),L.push(de+D+":"+he+F)}break;case 3:if(B.l<B.length){console.error("WK1 premature formula end");return}break;case 4:L.push("("+L.pop()+")");break;case 5:L.push(B.read_shift(2));break;case 6:{for(var ze="";A=B[B.l++];)ze+=String.fromCharCode(A);L.push('"'+ze.replace(/"/g,'""')+'"')}break;case 8:L.push("-"+L.pop());break;case 23:L.push("+"+L.pop());break;case 22:L.push("NOT("+L.pop()+")");break;case 20:case 21:z=L.pop(),ye=L.pop(),L.push(["AND","OR"][A-20]+"("+ye+","+z+")");break;default:if(A<32&&b[A])z=L.pop(),ye=L.pop(),L.push(ye+b[A]+z);else if(j[A]){if(Z=j[A][1],Z==69&&(Z=B[B.l++]),Z>L.length){console.error("WK1 bad formula parse 0x"+A.toString(16)+":|"+L.join("|")+"|");return}var Fe=L.slice(-Z);L.length-=Z,L.push(j[A][0]+"("+Fe.join(",")+")")}else return A<=7?console.error("WK1 invalid opcode "+A.toString(16)):A<=24?console.error("WK1 unsupported op "+A.toString(16)):A<=30?console.error("WK1 invalid opcode "+A.toString(16)):A<=115?console.error("WK1 unsupported function opcode "+A.toString(16)):console.error("WK1 unrecognized opcode "+A.toString(16))}}L.length==1?se[1].f=""+L[0]:console.error("WK1 bad formula parse |"+L.join("|")+"|")}function k(B){var se=[{c:0,r:0},{t:"n",v:0},0];return se[0].r=B.read_shift(2),se[3]=B[B.l++],se[0].c=B[B.l++],se}function N(B,se){var L=k(B);return L[1].t="s",L[1].v=B.read_shift(se-4,"cstr"),L}function S(B,se,L,Z){var F=He(6+Z.length);F.write_shift(2,B),F.write_shift(1,L),F.write_shift(1,se),F.write_shift(1,39);for(var he=0;he<Z.length;++he){var ye=Z.charCodeAt(he);F.write_shift(1,ye>=128?95:ye)}return F.write_shift(1,0),F}function _(B,se){var L=k(B);L[1].v=B.read_shift(2);var Z=L[1].v>>1;if(L[1].v&1)switch(Z&7){case 0:Z=(Z>>3)*5e3;break;case 1:Z=(Z>>3)*500;break;case 2:Z=(Z>>3)/20;break;case 3:Z=(Z>>3)/200;break;case 4:Z=(Z>>3)/2e3;break;case 5:Z=(Z>>3)/2e4;break;case 6:Z=(Z>>3)/16;break;case 7:Z=(Z>>3)/64;break}return L[1].v=Z,L}function O(B,se){var L=k(B),Z=B.read_shift(4),F=B.read_shift(4),he=B.read_shift(2);if(he==65535)return Z===0&&F===3221225472?(L[1].t="e",L[1].v=15):Z===0&&F===3489660928?(L[1].t="e",L[1].v=42):L[1].v=0,L;var ye=he&32768;return he=(he&32767)-16446,L[1].v=(1-ye*2)*(F*Math.pow(2,he+32)+Z*Math.pow(2,he)),L}function E(B,se,L,Z){var F=He(14);if(F.write_shift(2,B),F.write_shift(1,L),F.write_shift(1,se),Z==0)return F.write_shift(4,0),F.write_shift(4,0),F.write_shift(2,65535),F;var he=0,ye=0,z=0,A=0;return Z<0&&(he=1,Z=-Z),ye=Math.log2(Z)|0,Z/=Math.pow(2,ye-31),A=Z>>>0,A&2147483648||(Z/=2,++ye,A=Z>>>0),Z-=A,A|=2147483648,A>>>=0,Z*=Math.pow(2,32),z=Z>>>0,F.write_shift(4,z),F.write_shift(4,A),ye+=16383+(he?32768:0),F.write_shift(2,ye),F}function R(B,se){var L=O(B);return B.l+=se-14,L}function C(B,se){var L=k(B),Z=B.read_shift(4);return L[1].v=Z>>6,L}function I(B,se){var L=k(B),Z=B.read_shift(8,"f");return L[1].v=Z,L}function ne(B,se){var L=I(B);return B.l+=se-10,L}function W(B,se){return B[B.l+se-1]==0?B.read_shift(se,"cstr"):""}function Q(B,se){var L=B[B.l++];L>se-1&&(L=se-1);for(var Z="";Z.length<L;)Z+=String.fromCharCode(B[B.l++]);return Z}function H(B,se,L){if(!(!L.qpro||se<21)){var Z=B.read_shift(1);B.l+=17,B.l+=1,B.l+=2;var F=B.read_shift(se-21,"cstr");return[Z,F]}}function K(B,se){for(var L={},Z=B.l+se;B.l<Z;){var F=B.read_shift(2);if(F==14e3){for(L[F]=[0,""],L[F][0]=B.read_shift(2);B[B.l];)L[F][1]+=String.fromCharCode(B[B.l]),B.l++;B.l++}}return L}function q(B,se){var L=He(5+B.length);L.write_shift(2,14e3),L.write_shift(2,se);for(var Z=0;Z<B.length;++Z){var F=B.charCodeAt(Z);L[L.l++]=F>127?95:F}return L[L.l++]=0,L}var ge={0:{n:"BOF",f:Va},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f},14:{n:"NUMBER",f:p},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:y},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:W},222:{n:"SHEETNAMELP",f:Q},65535:{n:""}},G={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:N},23:{n:"NUMBER17",f:O},24:{n:"NUMBER18",f:_},25:{n:"FORMULA19",f:R},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:K},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:C},38:{n:"??"},39:{n:"NUMBER27",f:I},40:{n:"FORMULA28",f:ne},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:W},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:H},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:s,book_to_wk3:n,to_workbook:t}}();function CK(e){var t={},r=e.match(Js),s=0,n=!1;if(r)for(;s!=r.length;++s){var i=Kt(r[s]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=o2[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(i[0].charCodeAt(1)!==47&&!n)throw new Error("Unrecognized rich format "+i[0])}}return t}var EK=function(){var e=yf("t"),t=yf("rPr");function r(i){var l=i.match(e);if(!l)return{t:"s",v:""};var o={t:"s",v:wr(l[1])},c=i.match(t);return c&&(o.s=CK(c[1])),o}var s=/<(?:\w+:)?r>/g,n=/<\/(?:\w+:)?r>/;return function(l){return l.replace(s,"").split(n).map(r).filter(function(o){return o.v})}}(),PK=function(){var t=/(\r\n|\n)/g;function r(n,i,l){var o=[];n.u&&o.push("text-decoration: underline;"),n.uval&&o.push("text-underline-style:"+n.uval+";"),n.sz&&o.push("font-size:"+n.sz+"pt;"),n.outline&&o.push("text-effect: outline;"),n.shadow&&o.push("text-shadow: auto;"),i.push('<span style="'+o.join("")+'">'),n.b&&(i.push("<b>"),l.push("</b>")),n.i&&(i.push("<i>"),l.push("</i>")),n.strike&&(i.push("<s>"),l.push("</s>"));var c=n.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(i.push("<"+c+">"),l.push("</"+c+">")),l.push("</span>"),n}function s(n){var i=[[],n.v,[]];return n.v?(n.s&&r(n.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(s).join("")}}(),AK=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,_K=/<(?:\w+:)?r>/,TK=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function I2(e,t){var r=t?t.cellHTML:!0,s={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(s.t=wr(Hr(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),s.r=Hr(e),r&&(s.h=y2(s.t))):e.match(_K)&&(s.r=Hr(e),s.t=wr(Hr((e.replace(TK,"").match(AK)||[]).join("").replace(Js,""))),r&&(s.h=PK(EK(s.r)))),s):{t:""}}var IK=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,OK=/<(?:\w+:)?(?:si|sstItem)>/g,DK=/<\/(?:\w+:)?(?:si|sstItem)>/;function FK(e,t){var r=[],s="";if(!e)return r;var n=e.match(IK);if(n){s=n[2].replace(OK,"").split(DK);for(var i=0;i!=s.length;++i){var l=I2(s[i].trim(),t);l!=null&&(r[r.length]=l)}n=Kt(n[1]),r.Count=n.count,r.Unique=n.uniqueCount}return r}var RK=/^\s|\s$|[\t\n\r]/;function pO(e,t){if(!t.bookSST)return"";var r=[Ba];r[r.length]=xt("sst",null,{xmlns:qd[0],count:e.Count,uniqueCount:e.Unique});for(var s=0;s!=e.length;++s)if(e[s]!=null){var n=e[s],i="<si>";n.r?i+=n.r:(i+="<t",n.t||(n.t=""),n.t.match(RK)&&(i+=' xml:space="preserve"'),i+=">"+zr(n.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function MK(e){return[e.read_shift(4),e.read_shift(4)]}function LK(e,t){var r=[],s=!1;return yo(e,function(i,l,o){switch(o){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:s=!0;break;case 36:s=!1;break;default:if(l.T,!s||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function $K(e,t){return t||(t=He(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var BK=XV;function zK(e){var t=In();Ye(t,159,$K(e));for(var r=0;r<e.length;++r)Ye(t,19,BK(e[r]));return Ye(t,160),t.end()}function gO(e){for(var t=[],r=e.split(""),s=0;s<r.length;++s)t[s]=r[s].charCodeAt(0);return t}function Gl(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function UK(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Gl(e,4),t.U=Gl(e,4),t.W=Gl(e,4),t}function WK(e){for(var t=e.read_shift(4),r=e.l+t-4,s={},n=e.read_shift(4),i=[];n-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(s.name=e.read_shift(0,"lpp4"),s.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return s}function VK(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(WK(e));return t}function HK(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function qK(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Gl(e,4),t.U=Gl(e,4),t.W=Gl(e,4),t}function KK(e){var t=qK(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function yO(e,t){var r=e.l+t,s={};s.Flags=e.read_shift(4)&63,e.l+=4,s.AlgID=e.read_shift(4);var n=!1;switch(s.AlgID){case 26126:case 26127:case 26128:n=s.Flags==36;break;case 26625:n=s.Flags==4;break;case 0:n=s.Flags==16||s.Flags==4||s.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+s.AlgID}if(!n)throw new Error("Encryption Flags/AlgID mismatch");return s.AlgIDHash=e.read_shift(4),s.KeySize=e.read_shift(4),s.ProviderType=e.read_shift(4),e.l+=8,s.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,s}function vO(e,t){var r={},s=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,s),e.l=s,r}function GK(e){var t=Gl(e);switch(t.Minor){case 2:return[t.Minor,QK(e)];case 3:return[t.Minor,XK()];case 4:return[t.Minor,YK(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function QK(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),s=yO(e,r),n=vO(e,e.length-e.l);return{t:"Std",h:s,v:n}}function XK(){throw new Error("File is password-protected: ECMA-376 Extensible")}function YK(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),s={};return r.replace(Js,function(i){var l=Kt(i);switch(Nl(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){s[o]=l[o]});break;case"<dataIntegrity":s.encryptedHmacKey=l.encryptedHmacKey,s.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":s.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":s.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":s.encs.push(l);break;default:throw l[0]}}),s}function JK(e,t){var r={},s=r.EncryptionVersionInfo=Gl(e,4);if(t-=4,s.Minor!=2)throw new Error("unrecognized minor version code: "+s.Minor);if(s.Major>4||s.Major<2)throw new Error("unrecognized major version code: "+s.Major);r.Flags=e.read_shift(4),t-=4;var n=e.read_shift(4);return t-=4,r.EncryptionHeader=yO(e,n),t-=n,r.EncryptionVerifier=vO(e,t),r}function ZK(e){var t={},r=t.EncryptionVersionInfo=Gl(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function O2(e){var t=0,r,s=gO(e),n=s.length+1,i,l,o,c,u;for(r=xc(n),r[0]=s.length,i=1;i!=n;++i)r[i]=s[i-1];for(i=n-1;i>=0;--i)l=r[i],o=t&16384?1:0,c=t<<1&32767,u=o|c,t=u^l;return t^52811}var bO=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],s=function(l){return(l/2|l*128)&255},n=function(l,o){return s(l^o)},i=function(l){for(var o=t[l.length-1],c=104,u=l.length-1;u>=0;--u)for(var d=l[u],h=0;h!=7;++h)d&64&&(o^=r[c]),d*=2,--c;return o};return function(l){for(var o=gO(l),c=i(o),u=o.length,d=xc(16),h=0;h!=16;++h)d[h]=0;var f,x,p;for((u&1)===1&&(f=c>>8,d[u]=n(e[0],f),--u,f=c&255,x=o[o.length-1],d[u]=n(x,f));u>0;)--u,f=c>>8,d[u]=n(o[u],f),--u,f=c&255,d[u]=n(o[u],f);for(u=15,p=15-o.length;p>0;)f=c>>8,d[u]=n(e[p],f),--u,--p,f=c&255,d[u]=n(o[u],f),--u,--p;return d}}(),eG=function(e,t,r,s,n){n||(n=t),s||(s=bO(e));var i,l;for(i=0;i!=t.length;++i)l=t[i],l^=s[r],l=(l>>5|l<<3)&255,n[i]=l,++r;return[n,r,s]},tG=function(e){var t=0,r=bO(e);return function(s){var n=eG("",s,t,r);return t=n[1],n[0]}};function rG(e,t,r,s){var n={key:Va(e),verificationBytes:Va(e)};return r.password&&(n.verifier=O2(r.password)),s.valid=n.verificationBytes===n.verifier,s.valid&&(s.insitu=tG(r.password)),n}function aG(e,t,r){var s=r||{};return s.Info=e.read_shift(2),e.l-=2,s.Info===1?s.Data=ZK(e):s.Data=JK(e,t),s}function sG(e,t,r){var s={Type:r.biff>=8?e.read_shift(2):0};return s.Type?aG(e,t-2,s):rG(e,r.biff>=8?t:t-2,r,s),s}var jO=function(){function e(n,i){switch(i.type){case"base64":return t(Qn(n),i);case"binary":return t(n,i);case"buffer":return t(cr&&Buffer.isBuffer(n)?n.toString("binary"):Cc(n),i);case"array":return t(Ad(n),i)}throw new Error("Unrecognized type "+i.type)}function t(n,i){var l=i||{},o=l.dense?[]:{},c=n.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(d,h){Array.isArray(o)&&(o[h]=[]);for(var f=/\\\w+\b/g,x=0,p,g=-1;p=f.exec(d);){switch(p[0]){case"\\cell":var y=d.slice(x,f.lastIndex-p[0].length);if(y[0]==" "&&(y=y.slice(1)),++g,y.length){var v={v:y,t:"s"};Array.isArray(o)?o[h][g]=v:o[Ht({r:h,c:g})]=v}break}x=f.lastIndex}g>u.e.c&&(u.e.c=g)}),o["!ref"]=sr(u),o}function r(n,i){return Ec(e(n,i),i)}function s(n){for(var i=["{\\rtf1\\ansi"],l=Nr(n["!ref"]),o,c=Array.isArray(n),u=l.s.r;u<=l.e.r;++u){i.push("\\trowd\\trautofit1");for(var d=l.s.c;d<=l.e.c;++d)i.push("\\cellx"+(d+1));for(i.push("\\pard\\intbl"),d=l.s.c;d<=l.e.c;++d){var h=Ht({r:u,c:d});o=c?(n[u]||[])[d]:n[h],!(!o||o.v==null&&(!o.f||o.F))&&(i.push(" "+(o.w||(no(o),o.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:s}}();function nG(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function wf(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function iG(e){var t=e[0]/255,r=e[1]/255,s=e[2]/255,n=Math.max(t,r,s),i=Math.min(t,r,s),l=n-i;if(l===0)return[0,0,t];var o=0,c=0,u=n+i;switch(c=l/(u>1?2-u:u),n){case t:o=((r-s)/l+6)%6;break;case r:o=(s-t)/l+2;break;case s:o=(t-r)/l+4;break}return[o/6,c,u/2]}function lG(e){var t=e[0],r=e[1],s=e[2],n=r*2*(s<.5?s:1-s),i=s-n/2,l=[i,i,i],o=6*t,c;if(r!==0)switch(o|0){case 0:case 6:c=n*o,l[0]+=n,l[1]+=c;break;case 1:c=n*(2-o),l[0]+=c,l[1]+=n;break;case 2:c=n*(o-2),l[1]+=n,l[2]+=c;break;case 3:c=n*(4-o),l[1]+=c,l[2]+=n;break;case 4:c=n*(o-4),l[2]+=n,l[0]+=c;break;case 5:c=n*(6-o),l[2]+=c,l[0]+=n;break}for(var u=0;u!=3;++u)l[u]=Math.round(l[u]*255);return l}function rg(e,t){if(t===0)return e;var r=iG(nG(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),wf(lG(r))}var wO=6,oG=15,cG=1,Ws=wO;function Nf(e){return Math.floor((e+Math.round(128/Ws)/256)*Ws)}function Sf(e){return Math.floor((e-5)/Ws*100+.5)/100}function ag(e){return Math.round((e*Ws+5)/Ws*256)/256}function Ib(e){return ag(Sf(Nf(e)))}function D2(e){var t=Math.abs(e-Ib(e)),r=Ws;if(t>.005)for(Ws=cG;Ws<oG;++Ws)Math.abs(e-Ib(e))<=t&&(t=Math.abs(e-Ib(e)),r=Ws);Ws=r}function mc(e){e.width?(e.wpx=Nf(e.width),e.wch=Sf(e.wpx),e.MDW=Ws):e.wpx?(e.wch=Sf(e.wpx),e.width=ag(e.wch),e.MDW=Ws):typeof e.wch=="number"&&(e.width=ag(e.wch),e.wpx=Nf(e.width),e.MDW=Ws),e.customWidth&&delete e.customWidth}var dG=96,NO=dG;function kf(e){return e*96/NO}function f0(e){return e*NO/96}var uG={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function hG(e,t,r,s){t.Borders=[];var n={},i=!1;(e[0].match(Js)||[]).forEach(function(l){var o=Kt(l);switch(Nl(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":n={},o.diagonalUp&&(n.diagonalUp=ta(o.diagonalUp)),o.diagonalDown&&(n.diagonalDown=ta(o.diagonalDown)),t.Borders.push(n);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s&&s.WTF&&!i)throw new Error("unrecognized "+o[0]+" in borders")}})}function fG(e,t,r,s){t.Fills=[];var n={},i=!1;(e[0].match(Js)||[]).forEach(function(l){var o=Kt(l);switch(Nl(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":n={},t.Fills.push(n);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(n),n={};break;case"<patternFill":case"<patternFill>":o.patternType&&(n.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":n.bgColor||(n.bgColor={}),o.indexed&&(n.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(n.bgColor.theme=parseInt(o.theme,10)),o.tint&&(n.bgColor.tint=parseFloat(o.tint)),o.rgb&&(n.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":n.fgColor||(n.fgColor={}),o.theme&&(n.fgColor.theme=parseInt(o.theme,10)),o.tint&&(n.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(n.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s&&s.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fills")}})}function xG(e,t,r,s){t.Fonts=[];var n={},i=!1;(e[0].match(Js)||[]).forEach(function(l){var o=Kt(l);switch(Nl(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(n),n={};break;case"<name":o.val&&(n.name=Hr(o.val));break;case"<name/>":case"</name>":break;case"<b":n.bold=o.val?ta(o.val):1;break;case"<b/>":n.bold=1;break;case"<i":n.italic=o.val?ta(o.val):1;break;case"<i/>":n.italic=1;break;case"<u":switch(o.val){case"none":n.underline=0;break;case"single":n.underline=1;break;case"double":n.underline=2;break;case"singleAccounting":n.underline=33;break;case"doubleAccounting":n.underline=34;break}break;case"<u/>":n.underline=1;break;case"<strike":n.strike=o.val?ta(o.val):1;break;case"<strike/>":n.strike=1;break;case"<outline":n.outline=o.val?ta(o.val):1;break;case"<outline/>":n.outline=1;break;case"<shadow":n.shadow=o.val?ta(o.val):1;break;case"<shadow/>":n.shadow=1;break;case"<condense":n.condense=o.val?ta(o.val):1;break;case"<condense/>":n.condense=1;break;case"<extend":n.extend=o.val?ta(o.val):1;break;case"<extend/>":n.extend=1;break;case"<sz":o.val&&(n.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(n.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(n.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(n.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=o2[parseInt(o.val,10)];break;case"<color":if(n.color||(n.color={}),o.auto&&(n.color.auto=ta(o.auto)),o.rgb)n.color.rgb=o.rgb.slice(-6);else if(o.indexed){n.color.index=parseInt(o.indexed,10);var c=dd[n.color.index];n.color.index==81&&(c=dd[1]),c||(c=dd[1]),n.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(n.color.theme=parseInt(o.theme,10),o.tint&&(n.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(n.color.rgb=rg(r.themeElements.clrScheme[n.color.theme].rgb,n.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s&&s.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fonts")}})}function mG(e,t,r){t.NumberFmt=[];for(var s=Oa(Wt),n=0;n<s.length;++n)t.NumberFmt[s[n]]=Wt[s[n]];var i=e[0].match(Js);if(i)for(n=0;n<i.length;++n){var l=Kt(i[n]);switch(Nl(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=wr(Hr(l.formatCode)),c=parseInt(l.numFmtId,10);if(t.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=o}Kl(o,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}function pG(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var s=r[0];s<=r[1];++s)e[s]!=null&&(t[t.length]=xt("numFmt",null,{numFmtId:s,formatCode:zr(e[s])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=xt("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var ym=["numFmtId","fillId","fontId","borderId","xfId"],vm=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function gG(e,t,r){t.CellXf=[];var s,n=!1;(e[0].match(Js)||[]).forEach(function(i){var l=Kt(i),o=0;switch(Nl(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(s=l,delete s[0],o=0;o<ym.length;++o)s[ym[o]]&&(s[ym[o]]=parseInt(s[ym[o]],10));for(o=0;o<vm.length;++o)s[vm[o]]&&(s[vm[o]]=ta(s[vm[o]]));if(t.NumberFmt&&s.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[s.numFmtId]==t.NumberFmt[o]){s.numFmtId=o;break}}t.CellXf.push(s);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};l.vertical&&(c.vertical=l.vertical),l.horizontal&&(c.horizontal=l.horizontal),l.textRotation!=null&&(c.textRotation=l.textRotation),l.indent&&(c.indent=l.indent),l.wrapText&&(c.wrapText=ta(l.wrapText)),s.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(r&&r.WTF&&!n)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}function yG(e){var t=[];return t[t.length]=xt("cellXfs",null),e.forEach(function(r){t[t.length]=xt("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=xt("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var vG=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,s=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,c,u){var d={};if(!o)return d;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=o.match(t))&&mG(h,d,u),(h=o.match(n))&&xG(h,d,c,u),(h=o.match(s))&&fG(h,d,c,u),(h=o.match(i))&&hG(h,d,c,u),(h=o.match(r))&&gG(h,d,u),d}}();function SO(e,t){var r=[Ba,xt("styleSheet",null,{xmlns:qd[0],"xmlns:vt":es.vt})],s;return e.SSF&&(s=pG(e.SSF))!=null&&(r[r.length]=s),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(s=yG(t.cellXfs))&&(r[r.length]=s),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function bG(e,t){var r=e.read_shift(2),s=Gs(e);return[r,s]}function jG(e,t,r){r||(r=He(6+4*t.length)),r.write_shift(2,e),ys(t,r);var s=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),s}function wG(e,t,r){var s={};s.sz=e.read_shift(2)/20;var n=aH(e);n.fItalic&&(s.italic=1),n.fCondense&&(s.condense=1),n.fExtend&&(s.extend=1),n.fShadow&&(s.shadow=1),n.fOutline&&(s.outline=1),n.fStrikeout&&(s.strike=1);var i=e.read_shift(2);switch(i===700&&(s.bold=1),e.read_shift(2)){case 1:s.vertAlign="superscript";break;case 2:s.vertAlign="subscript";break}var l=e.read_shift(1);l!=0&&(s.underline=l);var o=e.read_shift(1);o>0&&(s.family=o);var c=e.read_shift(1);switch(c>0&&(s.charset=c),e.l++,s.color=rH(e),e.read_shift(1)){case 1:s.scheme="major";break;case 2:s.scheme="minor";break}return s.name=Gs(e),s}function NG(e,t){t||(t=He(25+4*32)),t.write_shift(2,e.sz*20),sH(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Zp(e.color,t);var s=0;return s=2,t.write_shift(1,s),ys(e.name,t),t.length>t.l?t.slice(0,t.l):t}var SG=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Ob,kG=Ys;function Y4(e,t){t||(t=He(4*3+8*7+16*1)),Ob||(Ob=Ey(SG));var r=Ob[e.patternType];r==null&&(r=40),t.write_shift(4,r);var s=0;if(r!=40)for(Zp({auto:1},t),Zp({auto:1},t);s<12;++s)t.write_shift(4,0);else{for(;s<4;++s)t.write_shift(4,0);for(;s<12;++s)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function CG(e,t){var r=e.l+t,s=e.read_shift(2),n=e.read_shift(2);return e.l=r,{ixfe:s,numFmtId:n}}function kO(e,t,r){r||(r=He(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var s=0;return r.write_shift(1,s),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function nh(e,t){return t||(t=He(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var EG=Ys;function PG(e,t){return t||(t=He(51)),t.write_shift(1,0),nh(null,t),nh(null,t),nh(null,t),nh(null,t),nh(null,t),t.length>t.l?t.slice(0,t.l):t}function AG(e,t){return t||(t=He(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Jp(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function _G(e,t,r){var s=He(2052);return s.write_shift(4,e),Jp(t,s),Jp(r,s),s.length>s.l?s.slice(0,s.l):s}function TG(e,t,r){var s={};s.NumberFmt=[];for(var n in Wt)s.NumberFmt[n]=Wt[n];s.CellXf=[],s.Fonts=[];var i=[],l=!1;return yo(e,function(c,u,d){switch(d){case 44:s.NumberFmt[c[0]]=c[1],Kl(c[1],c[0]);break;case 43:s.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=rg(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&s.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:i.push(d),l=!0;break;case 38:i.pop(),l=!1;break;default:if(u.T>0)i.push(d);else if(u.T<0)i.pop();else if(!l||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),s}function IG(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var n=s[0];n<=s[1];++n)t[n]!=null&&++r}),r!=0&&(Ye(e,615,Wi(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var n=s[0];n<=s[1];++n)t[n]!=null&&Ye(e,44,jG(n,t[n]))}),Ye(e,616))}}function OG(e){var t=1;Ye(e,611,Wi(t)),Ye(e,43,NG({sz:12,color:{theme:1},name:"Calibri",family:2})),Ye(e,612)}function DG(e){var t=2;Ye(e,603,Wi(t)),Ye(e,45,Y4({patternType:"none"})),Ye(e,45,Y4({patternType:"gray125"})),Ye(e,604)}function FG(e){var t=1;Ye(e,613,Wi(t)),Ye(e,46,PG()),Ye(e,614)}function RG(e){var t=1;Ye(e,626,Wi(t)),Ye(e,47,kO({numFmtId:0},65535)),Ye(e,627)}function MG(e,t){Ye(e,617,Wi(t.length)),t.forEach(function(r){Ye(e,47,kO(r,0))}),Ye(e,618)}function LG(e){var t=1;Ye(e,619,Wi(t)),Ye(e,48,AG({xfId:0,name:"Normal"})),Ye(e,620)}function $G(e){var t=0;Ye(e,505,Wi(t)),Ye(e,506)}function BG(e){var t=0;Ye(e,508,_G(t,"TableStyleMedium9","PivotStyleMedium4")),Ye(e,509)}function zG(e,t){var r=In();return Ye(r,278),IG(r,e.SSF),OG(r),DG(r),FG(r),RG(r),MG(r,t.cellXfs),LG(r),$G(r),BG(r),Ye(r,279),r.end()}var UG=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function WG(e,t,r){t.themeElements.clrScheme=[];var s={};(e[0].match(Js)||[]).forEach(function(n){var i=Kt(n);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":s.rgb=i.val;break;case"<a:sysClr":s.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[UG.indexOf(i[0])]=s,s={}):s.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function VG(){}function HG(){}var qG=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,KG=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,GG=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function QG(e,t,r){t.themeElements={};var s;[["clrScheme",qG,WG],["fontScheme",KG,VG],["fmtScheme",GG,HG]].forEach(function(n){if(!(s=e.match(n[1])))throw new Error(n[0]+" not found in themeElements");n[2](s,t,r)})}var XG=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function CO(e,t){(!e||e.length===0)&&(e=F2());var r,s={};if(!(r=e.match(XG)))throw new Error("themeElements not found in theme");return QG(r[0],s,t),s.raw=e,s}function F2(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Ba];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function YG(e,t,r){var s=e.l+t,n=e.read_shift(4);if(n!==124226){if(!r.cellStyles){e.l=s;return}var i=e.slice(e.l);e.l=s;var l;try{l=yI(i,{type:"array"})}catch{return}var o=Un(l,"theme/theme/theme1.xml",!0);if(o)return CO(o,r)}}function JG(e){return e.read_shift(4)}function ZG(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=eQ(e,4);break;case 2:t.xclrValue=nO(e);break;case 3:t.xclrValue=JG(e);break;case 4:e.l+=4;break}return e.l+=8,t}function eQ(e,t){return Ys(e,t)}function tQ(e,t){return Ys(e,t)}function rQ(e){var t=e.read_shift(2),r=e.read_shift(2)-4,s=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:s[1]=ZG(e);break;case 6:s[1]=tQ(e,r);break;case 14:case 15:s[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return s}function aQ(e,t){var r=e.l+t;e.l+=2;var s=e.read_shift(2);e.l+=2;for(var n=e.read_shift(2),i=[];n-- >0;)i.push(rQ(e,r-e.l));return{ixfe:s,ext:i}}function sQ(e,t){t.forEach(function(r){switch(r[0]){}})}function nQ(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Gs(e)}}function iQ(e){var t=He(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),ys(e.name,t),t.slice(0,t.l)}function lQ(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function oQ(e){var t=He(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function cQ(e,t){var r=He(8+2*t.length);return r.write_shift(4,e),ys(t,r),r.slice(0,r.l)}function dQ(e){return e.l+=4,e.read_shift(4)!=0}function uQ(e,t){var r=He(8);return r.write_shift(4,e),r.write_shift(4,1),r}function hQ(e,t,r){var s={Types:[],Cell:[],Value:[]},n=r||{},i=[],l=!1,o=2;return yo(e,function(c,u,d){switch(d){case 335:s.Types.push({name:c.name});break;case 51:c.forEach(function(h){o==1?s.Cell.push({type:s.Types[h[0]-1].name,index:h[1]}):o==0&&s.Value.push({type:s.Types[h[0]-1].name,index:h[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:i.push(d),l=!0;break;case 36:i.pop(),l=!1;break;default:if(!u.T){if(!l||n.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),s}function fQ(){var e=In();return Ye(e,332),Ye(e,334,Wi(1)),Ye(e,335,iQ({name:"XLDAPR",version:12e4,flags:3496657072})),Ye(e,336),Ye(e,339,cQ(1,"XLDAPR")),Ye(e,52),Ye(e,35,Wi(514)),Ye(e,4096,Wi(0)),Ye(e,4097,ci(1)),Ye(e,36),Ye(e,53),Ye(e,340),Ye(e,337,uQ(1)),Ye(e,51,oQ([[1,0]])),Ye(e,338),Ye(e,333),e.end()}function xQ(e,t,r){var s={Types:[],Cell:[],Value:[]};if(!e)return s;var n=!1,i=2,l;return e.replace(Js,function(o){var c=Kt(o);switch(Nl(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":s.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<s.Types.length;++u)s.Types[u].name==c.name&&(l=s.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?s.Cell.push({type:s.Types[c.t-1].name,index:+c.v}):i==0&&s.Value.push({type:s.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+c.i);break;default:if(!n&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return o}),s}function EO(){var e=[Ba];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function mQ(e){var t=[];if(!e)return t;var r=1;return(e.match(Js)||[]).forEach(function(s){var n=Kt(s);switch(n[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?r=n.i:n.i=r,t.push(n);break}}),t}function pQ(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Ht(r);var s=e.read_shift(1);return s&2&&(t.l="1"),s&8&&(t.a="1"),t}function gQ(e,t,r){var s=[];return yo(e,function(i,l,o){switch(o){case 63:s.push(i);break;default:if(!l.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),s}function yQ(e,t,r,s){if(!e)return e;var n=s||{},i=!1;yo(e,function(o,c,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!c.T){if(!i||n.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},n)}function vQ(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var Cu=1024;function PO(e,t){for(var r=[21600,21600],s=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),n=[xt("xml",null,{"xmlns:v":$n.v,"xmlns:o":$n.o,"xmlns:x":$n.x,"xmlns:mv":$n.mv}).replace(/\/>/,">"),xt("o:shapelayout",xt("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),xt("v:shapetype",[xt("v:stroke",null,{joinstyle:"miter"}),xt("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:s})];Cu<e*1e3;)Cu+=1e3;return t.forEach(function(i){var l=ba(i[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var c=o.type=="gradient"?xt("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=xt("v:fill",c,o),d={on:"t",obscured:"t"};++Cu,n=n.concat(["<v:shape"+vf({id:"_x0000_s"+Cu,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,xt("v:shadow",null,d),xt("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",As("x:Anchor",[l.c+1,0,l.r+1,0,l.c+3,20,l.r+5,20].join(",")),As("x:AutoFill","False"),As("x:Row",String(l.r)),As("x:Column",String(l.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),n.push("</xml>"),n.join("")}function J4(e,t,r,s){var n=Array.isArray(e),i;t.forEach(function(l){var o=ba(l.ref);if(n?(e[o.r]||(e[o.r]=[]),i=e[o.r][o.c]):i=e[l.ref],!i){i={t:"z"},n?e[o.r][o.c]=i:e[l.ref]=i;var c=Nr(e["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var u=sr(c);u!==e["!ref"]&&(e["!ref"]=u)}i.c||(i.c=[]);var d={a:l.author,t:l.t,r:l.r,T:r};l.h&&(d.h=l.h);for(var h=i.c.length-1;h>=0;--h){if(!r&&i.c[h].T)return;r&&!i.c[h].T&&i.c.splice(h,1)}if(r&&s){for(h=0;h<s.length;++h)if(d.a==s[h].id){d.a=s[h].name||d.a;break}}i.c.push(d)})}function bQ(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],s=[],n=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);n&&n[1]&&n[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var o=l.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var o=l.match(/<(?:\w+:)?comment[^>]*>/);if(o){var c=Kt(o[0]),u={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},d=ba(c.ref);if(!(t.sheetRows&&t.sheetRows<=d.r)){var h=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),f=!!h&&!!h[1]&&I2(h[1])||{r:"",t:"",h:""};u.r=f.r,f.r=="<t></t>"&&(f.t=f.h=""),u.t=(f.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=f.h),s.push(u)}}}}),s}function AO(e){var t=[Ba,xt("comments",null,{xmlns:qd[0]})],r=[];return t.push("<authors>"),e.forEach(function(s){s[1].forEach(function(n){var i=zr(n.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),n.T&&n.ID&&r.indexOf("tc="+n.ID)==-1&&(r.push("tc="+n.ID),t.push("<author>tc="+n.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(s){var n=0,i=[];if(s[1][0]&&s[1][0].T&&s[1][0].ID?n=r.indexOf("tc="+s[1][0].ID):s[1].forEach(function(c){c.a&&(n=r.indexOf(zr(c.a))),i.push(c.t||"")}),t.push('<comment ref="'+s[0]+'" authorId="'+n+'"><text>'),i.length<=1)t.push(As("t",zr(i[0]||"")));else{for(var l=`Comment:
    `+i[0]+`
`,o=1;o<i.length;++o)l+=`Reply:
    `+i[o]+`
`;t.push(As("t",zr(l)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function jQ(e,t){var r=[],s=!1,n={},i=0;return e.replace(Js,function(o,c){var u=Kt(o);switch(Nl(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":n={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":n.t!=null&&r.push(n);break;case"<text>":case"<text":i=c+o.length;break;case"</text>":n.t=e.slice(i,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":s=!0;break;case"</mentions>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(!s&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return o}),r}function wQ(e,t,r){var s=[Ba,xt("ThreadedComments",null,{xmlns:es.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(n){var i="";(n[1]||[]).forEach(function(l,o){if(!l.T){delete l.ID;return}l.a&&t.indexOf(l.a)==-1&&t.push(l.a);var c={ref:n[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?i=c.id:c.parentId=i,l.ID=c.id,l.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(l.a)).slice(-12)+"}"),s.push(xt("threadedComment",As("text",l.t||""),c))})}),s.push("</ThreadedComments>"),s.join("")}function NQ(e,t){var r=[],s=!1;return e.replace(Js,function(i){var l=Kt(i);switch(Nl(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(!s&&t.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return i}),r}function SQ(e){var t=[Ba,xt("personList",null,{xmlns:es.TCMNT,"xmlns:x":qd[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,s){t.push(xt("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+s).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function kQ(e){var t={};t.iauthor=e.read_shift(4);var r=Xd(e);return t.rfx=r.s,t.ref=Ht(r.s),e.l+=16,t}function CQ(e,t){return t==null&&(t=He(36)),t.write_shift(4,e[1].iauthor),R0(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var EQ=Gs;function PQ(e){return ys(e.slice(0,54))}function AQ(e,t){var r=[],s=[],n={},i=!1;return yo(e,function(o,c,u){switch(u){case 632:s.push(o);break;case 635:n=o;break;case 637:n.t=o.t,n.h=o.h,n.r=o.r;break;case 636:if(n.author=s[n.iauthor],delete n.iauthor,t.sheetRows&&n.rfx&&t.sheetRows<=n.rfx.r)break;n.t||(n.t=""),delete n.rfx,r.push(n);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function _Q(e){var t=In(),r=[];return Ye(t,628),Ye(t,630),e.forEach(function(s){s[1].forEach(function(n){r.indexOf(n.a)>-1||(r.push(n.a.slice(0,54)),Ye(t,632,PQ(n.a)))})}),Ye(t,631),Ye(t,633),e.forEach(function(s){s[1].forEach(function(n){n.iauthor=r.indexOf(n.a);var i={s:ba(s[0]),e:ba(s[0])};Ye(t,635,CQ([i,n])),n.t&&n.t.length>0&&Ye(t,637,JV(n)),Ye(t,636),delete n.iauthor})}),Ye(t,634),Ye(t,629),t.end()}var TQ="application/vnd.ms-office.vbaProject";function IQ(e){var t=$t.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,s){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var n=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");$t.utils.cfb_add(t,n,e.FileIndex[s].content)}}),$t.write(t)}function OQ(e,t){t.FullPaths.forEach(function(r,s){if(s!=0){var n=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");n.slice(-1)!=="/"&&$t.utils.cfb_add(e,n,t.FileIndex[s].content)}})}var _O=["xlsb","xlsm","xlam","biff8","xla"];function DQ(){return{"!type":"dialog"}}function FQ(){return{"!type":"dialog"}}function RQ(){return{"!type":"macro"}}function MQ(){return{"!type":"macro"}}var Mu=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(s,n,i,l){var o=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),l.length==0?o=!0:l.charAt(0)=="["&&(o=!0,l=l.slice(1,-1));var u=i.length>0?parseInt(i,10)|0:0,d=l.length>0?parseInt(l,10)|0:0;return o?d+=t.c:--d,c?u+=t.r:--u,n+(o?"":"$")+va(d)+(c?"":"$")+Ma(u)}return function(n,i){return t=i,n.replace(e,r)}}(),R2=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,M2=function(){return function(t,r){return t.replace(R2,function(s,n,i,l,o,c){var u=N2(l)-(i?0:r.c),d=w2(c)-(o?0:r.r),h=d==0?"":o?d+1:"["+d+"]",f=u==0?"":i?u+1:"["+u+"]";return n+"R"+h+"C"+f})}}();function TO(e,t){return e.replace(R2,function(r,s,n,i,l,o){return s+(n=="$"?n+i:va(N2(i)+t.c))+(l=="$"?l+o:Ma(w2(o)+t.r))})}function LQ(e,t,r){var s=Dn(t),n=s.s,i=ba(r),l={r:i.r-n.r,c:i.c-n.c};return TO(e,l)}function $Q(e){return e.length!=1}function Z4(e){return e.replace(/_xlfn\./g,"")}function Ua(e){e.l+=1}function pc(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function IO(e,t,r){var s=2;if(r){if(r.biff>=2&&r.biff<=5)return OO(e);r.biff==12&&(s=4)}var n=e.read_shift(s),i=e.read_shift(s),l=pc(e),o=pc(e);return{s:{r:n,c:l[0],cRel:l[1],rRel:l[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function OO(e){var t=pc(e),r=pc(e),s=e.read_shift(1),n=e.read_shift(1);return{s:{r:t[0],c:s,cRel:t[1],rRel:t[2]},e:{r:r[0],c:n,cRel:r[1],rRel:r[2]}}}function BQ(e,t,r){if(r.biff<8)return OO(e);var s=e.read_shift(r.biff==12?4:2),n=e.read_shift(r.biff==12?4:2),i=pc(e),l=pc(e);return{s:{r:s,c:i[0],cRel:i[1],rRel:i[2]},e:{r:n,c:l[0],cRel:l[1],rRel:l[2]}}}function DO(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return zQ(e);var s=e.read_shift(r&&r.biff==12?4:2),n=pc(e);return{r:s,c:n[0],cRel:n[1],rRel:n[2]}}function zQ(e){var t=pc(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function UQ(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function WQ(e,t,r){var s=r&&r.biff?r.biff:8;if(s>=2&&s<=5)return VQ(e);var n=e.read_shift(s>=12?4:2),i=e.read_shift(2),l=(i&16384)>>14,o=(i&32768)>>15;if(i&=16383,o==1)for(;n>524287;)n-=1048576;if(l==1)for(;i>8191;)i=i-16384;return{r:n,c:i,cRel:l,rRel:o}}function VQ(e){var t=e.read_shift(2),r=e.read_shift(1),s=(t&32768)>>15,n=(t&16384)>>14;return t&=16383,s==1&&t>=8192&&(t=t-16384),n==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:n,rRel:s}}function HQ(e,t,r){var s=(e[e.l++]&96)>>5,n=IO(e,r.biff>=2&&r.biff<=5?6:8,r);return[s,n]}function qQ(e,t,r){var s=(e[e.l++]&96)>>5,n=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var l=IO(e,i,r);return[s,n,l]}function KQ(e,t,r){var s=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[s]}function GQ(e,t,r){var s=(e[e.l++]&96)>>5,n=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[s,n]}function QQ(e,t,r){var s=(e[e.l++]&96)>>5,n=BQ(e,t-1,r);return[s,n]}function XQ(e,t,r){var s=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[s]}function eE(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function YQ(e,t,r){e.l+=2;for(var s=e.read_shift(r&&r.biff==2?1:2),n=[],i=0;i<=s;++i)n.push(e.read_shift(r&&r.biff==2?1:2));return n}function JQ(e,t,r){var s=e[e.l+1]&255?1:0;return e.l+=2,[s,e.read_shift(r&&r.biff==2?1:2)]}function ZQ(e,t,r){var s=e[e.l+1]&255?1:0;return e.l+=2,[s,e.read_shift(r&&r.biff==2?1:2)]}function eX(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function tX(e,t,r){var s=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[s]}function FO(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function rX(e){return e.read_shift(2),FO(e)}function aX(e){return e.read_shift(2),FO(e)}function sX(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var n=DO(e,0,r);return[s,n]}function nX(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var n=WQ(e,0,r);return[s,n]}function iX(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=DO(e,0,r);return[s,n,i]}function lX(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(r&&r.biff<=3?1:2);return[dY[n],LO[n],s]}function oX(e,t,r){var s=e[e.l++],n=e.read_shift(1),i=r&&r.biff<=3?[s==88?-1:0,e.read_shift(1)]:cX(e);return[n,(i[0]===0?LO:cY)[i[1]]]}function cX(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function dX(e,t,r){e.l+=r&&r.biff==2?3:4}function uX(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var s=e.read_shift(2),n=e.read_shift(r&&r.biff==2?1:2);return[s,n]}function hX(e){return e.l++,vo[e.read_shift(1)]}function fX(e){return e.l++,e.read_shift(2)}function xX(e){return e.l++,e.read_shift(1)!==0}function mX(e){return e.l++,qs(e)}function pX(e,t,r){return e.l++,cx(e,t-1,r)}function gX(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Da(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=vo[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=qs(e);break;case 2:r[1]=Yd(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function yX(e,t,r){for(var s=e.read_shift(r.biff==12?4:2),n=[],i=0;i!=s;++i)n.push((r.biff==12?Xd:_y)(e));return n}function vX(e,t,r){var s=0,n=0;r.biff==12?(s=e.read_shift(4),n=e.read_shift(4)):(n=1+e.read_shift(1),s=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--s,--n==0&&(n=256));for(var i=0,l=[];i!=s&&(l[i]=[]);++i)for(var o=0;o!=n;++o)l[i][o]=gX(e,r.biff);return l}function bX(e,t,r){var s=e.read_shift(1)>>>5&3,n=!r||r.biff>=8?4:2,i=e.read_shift(n);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[s,0,i]}function jX(e,t,r){if(r.biff==5)return wX(e);var s=e.read_shift(1)>>>5&3,n=e.read_shift(2),i=e.read_shift(4);return[s,n,i]}function wX(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var s=e.read_shift(2);return e.l+=12,[t,r,s]}function NX(e,t,r){var s=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var n=e.read_shift(r&&r.biff==2?1:2);return[s,n]}function SX(e,t,r){var s=e.read_shift(1)>>>5&3,n=e.read_shift(r&&r.biff==2?1:2);return[s,n]}function kX(e,t,r){var s=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[s]}function CX(e,t,r){var s=(e[e.l++]&96)>>5,n=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[s,n]}var EX=Ys,PX=Ys,AX=Ys;function ux(e,t,r){return e.l+=2,[UQ(e)]}function L2(e){return e.l+=6,[]}var _X=ux,TX=L2,IX=L2,OX=ux;function RO(e){return e.l+=2,[Va(e),e.read_shift(2)&1]}var DX=ux,FX=RO,RX=L2,MX=ux,LX=ux,$X=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function BX(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(4),n=e.read_shift(2),i=e.read_shift(2),l=$X[r>>2&31];return{ixti:t,coltype:r&3,rt:l,idx:s,c:n,C:i}}function zX(e){return e.l+=2,[e.read_shift(4)]}function UX(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function WX(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function VX(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function HX(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function qX(e){return e.l+=4,[0,0]}var tE={1:{n:"PtgExp",f:uX},2:{n:"PtgTbl",f:AX},3:{n:"PtgAdd",f:Ua},4:{n:"PtgSub",f:Ua},5:{n:"PtgMul",f:Ua},6:{n:"PtgDiv",f:Ua},7:{n:"PtgPower",f:Ua},8:{n:"PtgConcat",f:Ua},9:{n:"PtgLt",f:Ua},10:{n:"PtgLe",f:Ua},11:{n:"PtgEq",f:Ua},12:{n:"PtgGe",f:Ua},13:{n:"PtgGt",f:Ua},14:{n:"PtgNe",f:Ua},15:{n:"PtgIsect",f:Ua},16:{n:"PtgUnion",f:Ua},17:{n:"PtgRange",f:Ua},18:{n:"PtgUplus",f:Ua},19:{n:"PtgUminus",f:Ua},20:{n:"PtgPercent",f:Ua},21:{n:"PtgParen",f:Ua},22:{n:"PtgMissArg",f:Ua},23:{n:"PtgStr",f:pX},26:{n:"PtgSheet",f:UX},27:{n:"PtgEndSheet",f:WX},28:{n:"PtgErr",f:hX},29:{n:"PtgBool",f:xX},30:{n:"PtgInt",f:fX},31:{n:"PtgNum",f:mX},32:{n:"PtgArray",f:XQ},33:{n:"PtgFunc",f:lX},34:{n:"PtgFuncVar",f:oX},35:{n:"PtgName",f:bX},36:{n:"PtgRef",f:sX},37:{n:"PtgArea",f:HQ},38:{n:"PtgMemArea",f:NX},39:{n:"PtgMemErr",f:EX},40:{n:"PtgMemNoMem",f:PX},41:{n:"PtgMemFunc",f:SX},42:{n:"PtgRefErr",f:kX},43:{n:"PtgAreaErr",f:KQ},44:{n:"PtgRefN",f:nX},45:{n:"PtgAreaN",f:QQ},46:{n:"PtgMemAreaN",f:VX},47:{n:"PtgMemNoMemN",f:HX},57:{n:"PtgNameX",f:jX},58:{n:"PtgRef3d",f:iX},59:{n:"PtgArea3d",f:qQ},60:{n:"PtgRefErr3d",f:CX},61:{n:"PtgAreaErr3d",f:GQ},255:{}},KX={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},GX={1:{n:"PtgElfLel",f:RO},2:{n:"PtgElfRw",f:MX},3:{n:"PtgElfCol",f:_X},6:{n:"PtgElfRwV",f:LX},7:{n:"PtgElfColV",f:OX},10:{n:"PtgElfRadical",f:DX},11:{n:"PtgElfRadicalS",f:RX},13:{n:"PtgElfColS",f:TX},15:{n:"PtgElfColSV",f:IX},16:{n:"PtgElfRadicalLel",f:FX},25:{n:"PtgList",f:BX},29:{n:"PtgSxName",f:zX},255:{}},QX={0:{n:"PtgAttrNoop",f:qX},1:{n:"PtgAttrSemi",f:tX},2:{n:"PtgAttrIf",f:ZQ},4:{n:"PtgAttrChoose",f:YQ},8:{n:"PtgAttrGoto",f:JQ},16:{n:"PtgAttrSum",f:dX},32:{n:"PtgAttrBaxcel",f:eE},33:{n:"PtgAttrBaxcel",f:eE},64:{n:"PtgAttrSpace",f:rX},65:{n:"PtgAttrSpaceSemi",f:aX},128:{n:"PtgAttrIfError",f:eX},255:{}};function hx(e,t,r,s){if(s.biff<8)return Ys(e,t);for(var n=e.l+t,i=[],l=0;l!==r.length;++l)switch(r[l][0]){case"PtgArray":r[l][1]=vX(e,0,s),i.push(r[l][1]);break;case"PtgMemArea":r[l][2]=yX(e,r[l][1],s),i.push(r[l][2]);break;case"PtgExp":s&&s.biff==12&&(r[l][1][1]=e.read_shift(4),i.push(r[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[l][0]}return t=n-e.l,t!==0&&i.push(Ys(e,t)),i}function fx(e,t,r){for(var s=e.l+t,n,i,l=[];s!=e.l;)t=s-e.l,i=e[e.l],n=tE[i]||tE[KX[i]],(i===24||i===25)&&(n=(i===24?GX:QX)[e[e.l+1]]),!n||!n.f?Ys(e,t):l.push([n.n,n.f(e,t,r)]);return l}function XX(e){for(var t=[],r=0;r<e.length;++r){for(var s=e[r],n=[],i=0;i<s.length;++i){var l=s[i];if(l)switch(l[0]){case 2:n.push('"'+l[1].replace(/"/g,'""')+'"');break;default:n.push(l[1])}else n.push("")}t.push(n.join(","))}return t.join(";")}var YX={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function JX(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function MO(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var s=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!s)return"SH33TJSERR1";var n="";if(r.biff>8)switch(e[s[0]][0]){case 357:return n=s[1]==-1?"#REF":e.SheetNames[s[1]],s[1]==s[2]?n:n+":"+e.SheetNames[s[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[s[0]][0];case 355:default:return"SH33TJSSRC"+e[s[0]][0]}switch(e[s[0]][0][0]){case 1025:return n=s[1]==-1?"#REF":e.SheetNames[s[1]]||"SH33TJSERR3",s[1]==s[2]?n:n+":"+e.SheetNames[s[2]];case 14849:return e[s[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[s[0]][0][3]?(n=s[1]==-1?"#REF":e[s[0]][0][3][s[1]]||"SH33TJSERR4",s[1]==s[2]?n:n+":"+e[s[0]][0][3][s[2]]):"SH33TJSERR2"}}function rE(e,t,r){var s=MO(e,t,r);return s=="#REF"?s:JX(s,r)}function zs(e,t,r,s,n){var i=n&&n.biff||8,l={s:{c:0,r:0}},o=[],c,u,d,h=0,f=0,x,p="";if(!e[0]||!e[0][0])return"";for(var g=-1,y="",v=0,j=e[0].length;v<j;++v){var b=e[0][v];switch(b[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),u=o.pop(),g>=0){switch(e[0][g][1][0]){case 0:y=_a(" ",e[0][g][1][1]);break;case 1:y=_a("\r",e[0][g][1][1]);break;default:if(y="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}u=u+y,g=-1}o.push(u+YX[b[0]]+c);break;case"PtgIsect":c=o.pop(),u=o.pop(),o.push(u+" "+c);break;case"PtgUnion":c=o.pop(),u=o.pop(),o.push(u+","+c);break;case"PtgRange":c=o.pop(),u=o.pop(),o.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=Lh(b[1][1],l,n),o.push($h(d,i));break;case"PtgRefN":d=r?Lh(b[1][1],r,n):b[1][1],o.push($h(d,i));break;case"PtgRef3d":h=b[1][1],d=Lh(b[1][2],l,n),p=rE(s,h,n),o.push(p+"!"+$h(d,i));break;case"PtgFunc":case"PtgFuncVar":var w=b[1][0],k=b[1][1];w||(w=0),w&=127;var N=w==0?[]:o.slice(-w);o.length-=w,k==="User"&&(k=N.shift()),o.push(k+"("+N.join(",")+")");break;case"PtgBool":o.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(b[1]);break;case"PtgNum":o.push(String(b[1]));break;case"PtgStr":o.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(b[1]);break;case"PtgAreaN":x=T4(b[1][1],r?{s:r}:l,n),o.push(Ab(x,n));break;case"PtgArea":x=T4(b[1][1],l,n),o.push(Ab(x,n));break;case"PtgArea3d":h=b[1][1],x=b[1][2],p=rE(s,h,n),o.push(p+"!"+Ab(x,n));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":f=b[1][2];var S=(s.names||[])[f-1]||(s[0]||[])[f],_=S?S.Name:"SH33TJSNAME"+String(f);_&&_.slice(0,6)=="_xlfn."&&!n.xlfn&&(_=_.slice(6)),o.push(_);break;case"PtgNameX":var O=b[1][1];f=b[1][2];var E;if(n.biff<=5)O<0&&(O=-O),s[O]&&(E=s[O][f]);else{var R="";if(((s[O]||[])[0]||[])[0]==14849||(((s[O]||[])[0]||[])[0]==1025?s[O][f]&&s[O][f].itab>0&&(R=s.SheetNames[s[O][f].itab-1]+"!"):R=s.SheetNames[f-1]+"!"),s[O]&&s[O][f])R+=s[O][f].Name;else if(s[0]&&s[0][f])R+=s[0][f].Name;else{var C=(MO(s,O,n)||"").split(";;");C[f-1]?R=C[f-1]:R+="SH33TJSERRX"}o.push(R);break}E||(E={Name:"SH33TJSERRY"}),o.push(E.Name);break;case"PtgParen":var I="(",ne=")";if(g>=0){switch(y="",e[0][g][1][0]){case 2:I=_a(" ",e[0][g][1][1])+I;break;case 3:I=_a("\r",e[0][g][1][1])+I;break;case 4:ne=_a(" ",e[0][g][1][1])+ne;break;case 5:ne=_a("\r",e[0][g][1][1])+ne;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}o.push(I+o.pop()+ne);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":d={c:b[1][1],r:b[1][0]};var W={c:r.c,r:r.r};if(s.sharedf[Ht(d)]){var Q=s.sharedf[Ht(d)];o.push(zs(Q,l,W,s,n))}else{var H=!1;for(c=0;c!=s.arrayf.length;++c)if(u=s.arrayf[c],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){o.push(zs(u[1],l,W,s,n)),H=!0;break}H||o.push(b[1])}break;case"PtgArray":o.push("{"+XX(b[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(b));default:throw new Error("Unrecognized Formula Token: "+String(b))}var K=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&g>=0&&K.indexOf(e[0][v][0])==-1){b=e[0][g];var q=!0;switch(b[1][0]){case 4:q=!1;case 0:y=_a(" ",b[1][1]);break;case 5:q=!1;case 1:y=_a("\r",b[1][1]);break;default:if(y="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}o.push((q?y:"")+o.pop()+(q?"":y)),g=-1}}if(o.length>1&&n.WTF)throw new Error("bad formula stack");return o[0]}function ZX(e,t,r){var s=e.l+t,n=r.biff==2?1:2,i,l=e.read_shift(n);if(l==65535)return[[],Ys(e,t-2)];var o=fx(e,l,r);return t!==l+n&&(i=hx(e,t-l-n,o,r)),e.l=s,[o,i]}function eY(e,t,r){var s=e.l+t,n=r.biff==2?1:2,i,l=e.read_shift(n);if(l==65535)return[[],Ys(e,t-2)];var o=fx(e,l,r);return t!==l+n&&(i=hx(e,t-l-n,o,r)),e.l=s,[o,i]}function tY(e,t,r,s){var n=e.l+t,i=fx(e,s,r),l;return n!==e.l&&(l=hx(e,n-e.l,i,r)),[i,l]}function rY(e,t,r){var s=e.l+t,n,i=e.read_shift(2),l=fx(e,i,r);return i==65535?[[],Ys(e,t-2)]:(t!==i+2&&(n=hx(e,s-i-2,l,r)),[l,n])}function aY(e){var t;if(Ul(e,e.l+6)!==65535)return[qs(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function sY(e){if(e==null){var t=He(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return _d(e);return _d(0)}function Db(e,t,r){var s=e.l+t,n=Sl(e);r.biff==2&&++e.l;var i=aY(e),l=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=eY(e,s-e.l,r);return{cell:n,val:i[0],formula:o,shared:l>>3&1,tt:i[1]}}function nY(e,t,r,s,n){var i=Id(t,r,n),l=sY(e.v),o=He(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var u=He(e.bf.length),d=0;d<e.bf.length;++d)u[d]=e.bf[d];var h=ps([i,l,o,u]);return h}function Ty(e,t,r){var s=e.read_shift(4),n=fx(e,s,r),i=e.read_shift(4),l=i>0?hx(e,i,n,r):null;return[n,l]}var iY=Ty,Iy=Ty,lY=Ty,oY=Ty,cY={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},LO={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},dY={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function aE(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function uY(e){var t="of:="+e.replace(R2,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Fb(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function hY(e){return e.replace(/\./,"!")}var zh={},Lu={},Uh=typeof Map<"u";function $2(e,t,r){var s=0,n=e.length;if(r){if(Uh?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=Uh?r.get(t):r[t];s<i.length;++s)if(e[i[s]].t===t)return e.Count++,i[s]}}else for(;s<n;++s)if(e[s].t===t)return e.Count++,s;return e[n]={t},e.Count++,e.Unique++,r&&(Uh?(r.has(t)||r.set(t,[]),r.get(t).push(n)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(n))),n}function Oy(e,t){var r={min:e+1,max:e+1},s=-1;return t.MDW&&(Ws=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?s=Sf(t.wpx):t.wch!=null&&(s=t.wch),s>-1?(r.width=ag(s),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function fd(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Pc(e,t,r){var s=r.revssf[t.z!=null?t.z:"General"],n=60,i=e.length;if(s==null&&r.ssf){for(;n<392;++n)if(r.ssf[n]==null){Kl(t.z,n),r.ssf[n]=t.z,r.revssf[t.z]=s=n;break}}for(n=0;n!=i;++n)if(e[n].numFmtId===s)return n;return e[i]={numFmtId:s,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function $O(e,t,r,s,n,i){try{s.cellNF&&(e.z=Wt[t])}catch(o){if(s.WTF)throw o}if(!(e.t==="z"&&!s.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=aa(e.v)),(!s||s.cellText!==!1)&&e.t!=="z")try{if(Wt[t]==null&&Kl(cV[t]||"General",t),e.t==="e")e.w=e.w||vo[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=gf(e.v);else if(e.t==="d"){var l=rs(e.v);(l|0)===l?e.w=l.toString(10):e.w=gf(l)}else{if(e.v===void 0)return"";e.w=Pd(e.v,Lu)}else e.t==="d"?e.w=vi(t,rs(e.v),Lu):e.w=vi(t,e.v,Lu)}catch(o){if(s.WTF)throw o}if(s.cellStyles&&r!=null)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=rg(n.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),s.WTF&&(e.s.fgColor.raw_rgb=n.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=rg(n.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),s.WTF&&(e.s.bgColor.raw_rgb=n.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(s.WTF&&i.Fills)throw o}}}function fY(e,t,r){if(e&&e["!ref"]){var s=Nr(e["!ref"]);if(s.e.c<s.s.c||s.e.r<s.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function xY(e,t){var r=Nr(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=sr(r))}var mY=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,pY=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,gY=/<(?:\w:)?hyperlink [^>]*>/mg,yY=/"(\w*:\w*)"/,vY=/<(?:\w:)?col\b[^>]*[\/]?>/g,bY=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,jY=/<(?:\w:)?pageMargins[^>]*\/>/g,BO=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,wY=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,NY=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function SY(e,t,r,s,n,i,l){if(!e)return e;s||(s={"!id":{}});var o=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",d="",h=e.match(pY);h?(u=e.slice(0,h.index),d=e.slice(h.index+h[0].length)):u=d=e;var f=u.match(BO);f?B2(f[0],o,n,r):(f=u.match(wY))&&CY(f[0],f[1]||"",o,n,r);var x=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(x>0){var p=u.slice(x,x+50).match(yY);p&&xY(o,p[1])}var g=u.match(NY);g&&g[1]&&$Y(g[1],n);var y=[];if(t.cellStyles){var v=u.match(vY);v&&DY(y,v)}h&&UY(h[1],o,t,c,i,l);var j=d.match(bY);j&&(o["!autofilter"]=RY(j[0]));var b=[],w=d.match(mY);if(w)for(x=0;x!=w.length;++x)b[x]=Nr(w[x].slice(w[x].indexOf('"')+1));var k=d.match(gY);k&&TY(o,k,s);var N=d.match(jY);if(N&&(o["!margins"]=IY(Kt(N[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=sr(c)),t.sheetRows>0&&o["!ref"]){var S=Nr(o["!ref"]);t.sheetRows<=+S.e.r&&(S.e.r=t.sheetRows-1,S.e.r>c.e.r&&(S.e.r=c.e.r),S.e.r<S.s.r&&(S.s.r=S.e.r),S.e.c>c.e.c&&(S.e.c=c.e.c),S.e.c<S.s.c&&(S.s.c=S.e.c),o["!fullref"]=o["!ref"],o["!ref"]=sr(S))}return y.length>0&&(o["!cols"]=y),b.length>0&&(o["!merges"]=b),o}function kY(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+sr(e[r])+'"/>';return t+"</mergeCells>"}function B2(e,t,r,s){var n=Kt(e);r.Sheets[s]||(r.Sheets[s]={}),n.codeName&&(r.Sheets[s].CodeName=wr(Hr(n.codeName)))}function CY(e,t,r,s,n){B2(e.slice(0,e.indexOf(">")),r,s,n)}function EY(e,t,r,s,n){var i=!1,l={},o=null;if(s.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}i=!0,l.codeName=fl(zr(c))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),o=(o||"")+xt("outlinePr",null,u)}!i&&!o||(n[n.length]=xt("sheetPr",o,l))}var PY=["objects","scenarios","selectLockedCells","selectUnlockedCells"],AY=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function _Y(e){var t={sheet:1};return PY.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),AY.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=O2(e.password).toString(16).toUpperCase()),xt("sheetProtection",null,t)}function TY(e,t,r){for(var s=Array.isArray(e),n=0;n!=t.length;++n){var i=Kt(Hr(t[n]),!0);if(!i.ref)return;var l=((r||{})["!id"]||[])[i.id];l?(i.Target=l.Target,i.location&&(i.Target+="#"+wr(i.location))):(i.Target="#"+wr(i.location),l={Target:i.Target,TargetMode:"Internal"}),i.Rel=l,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var o=Nr(i.ref),c=o.s.r;c<=o.e.r;++c)for(var u=o.s.c;u<=o.e.c;++u){var d=Ht({c:u,r:c});s?(e[c]||(e[c]=[]),e[c][u]||(e[c][u]={t:"z",v:void 0}),e[c][u].l=i):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=i)}}}function IY(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function OY(e){return fd(e),xt("pageMargins",null,e)}function DY(e,t){for(var r=!1,s=0;s!=t.length;++s){var n=Kt(t[s],!0);n.hidden&&(n.hidden=ta(n.hidden));var i=parseInt(n.min,10)-1,l=parseInt(n.max,10)-1;for(n.outlineLevel&&(n.level=+n.outlineLevel||0),delete n.min,delete n.max,n.width=+n.width,!r&&n.width&&(r=!0,D2(n.width)),mc(n);i<=l;)e[i++]=sa(n)}}function FY(e,t){for(var r=["<cols>"],s,n=0;n!=t.length;++n)(s=t[n])&&(r[r.length]=xt("col",null,Oy(n,s)));return r[r.length]="</cols>",r.join("")}function RY(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function MY(e,t,r,s){var n=typeof e.ref=="string"?e.ref:sr(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,l=Dn(n);l.s.r==l.e.r&&(l.e.r=Dn(t["!ref"]).e.r,n=sr(l));for(var o=0;o<i.length;++o){var c=i[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==s){c.Ref="'"+r.SheetNames[s]+"'!"+n;break}}return o==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+r.SheetNames[s]+"'!"+n}),xt("autoFilter",null,{ref:n})}var LY=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function $Y(e,t){t.Views||(t.Views=[{}]),(e.match(LY)||[]).forEach(function(r,s){var n=Kt(r);t.Views[s]||(t.Views[s]={}),+n.zoomScale&&(t.Views[s].zoom=+n.zoomScale),ta(n.rightToLeft)&&(t.Views[s].RTL=!0)})}function BY(e,t,r,s){var n={workbookViewId:"0"};return(((s||{}).Workbook||{}).Views||[])[0]&&(n.rightToLeft=s.Workbook.Views[0].RTL?"1":"0"),xt("sheetViews",xt("sheetView",null,n),{})}function zY(e,t,r,s){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var n="",i=e.t,l=e.v;if(e.t!=="z")switch(e.t){case"b":n=e.v?"1":"0";break;case"n":n=""+e.v;break;case"e":n=vo[e.v];break;case"d":s&&s.cellDates?n=aa(e.v,-1).toISOString():(e=sa(e),e.t="n",n=""+(e.v=rs(aa(e.v)))),typeof e.z>"u"&&(e.z=Wt[14]);break;default:n=e.v;break}var o=As("v",zr(n)),c={r:t},u=Pc(s.cellXfs,e,s);switch(u!==0&&(c.s=u),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(s&&s.bookSST){o=As("v",""+$2(s.Strings,e.v,s.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=i&&(e.t=i,e.v=l),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=xt("f",zr(e.f),d)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),xt("c",o,c)}var UY=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,s=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,n=/ref=["']([^"']*)["']/,i=yf("v"),l=yf("f");return function(c,u,d,h,f,x){for(var p=0,g="",y=[],v=[],j=0,b=0,w=0,k="",N,S,_=0,O=0,E,R,C=0,I=0,ne=Array.isArray(x.CellXf),W,Q=[],H=[],K=Array.isArray(u),q=[],ge={},G=!1,B=!!d.sheetStubs,se=c.split(t),L=0,Z=se.length;L!=Z;++L){g=se[L].trim();var F=g.length;if(F!==0){var he=0;e:for(p=0;p<F;++p)switch(g[p]){case">":if(g[p-1]!="/"){++p;break e}if(d&&d.cellStyles){if(S=Kt(g.slice(he,p),!0),_=S.r!=null?parseInt(S.r,10):_+1,O=-1,d.sheetRows&&d.sheetRows<_)continue;ge={},G=!1,S.ht&&(G=!0,ge.hpt=parseFloat(S.ht),ge.hpx=f0(ge.hpt)),S.hidden=="1"&&(G=!0,ge.hidden=!0),S.outlineLevel!=null&&(G=!0,ge.level=+S.outlineLevel),G&&(q[_-1]=ge)}break;case"<":he=p;break}if(he>=p)break;if(S=Kt(g.slice(he,p),!0),_=S.r!=null?parseInt(S.r,10):_+1,O=-1,!(d.sheetRows&&d.sheetRows<_)){h.s.r>_-1&&(h.s.r=_-1),h.e.r<_-1&&(h.e.r=_-1),d&&d.cellStyles&&(ge={},G=!1,S.ht&&(G=!0,ge.hpt=parseFloat(S.ht),ge.hpx=f0(ge.hpt)),S.hidden=="1"&&(G=!0,ge.hidden=!0),S.outlineLevel!=null&&(G=!0,ge.level=+S.outlineLevel),G&&(q[_-1]=ge)),y=g.slice(p).split(e);for(var ye=0;ye!=y.length&&y[ye].trim().charAt(0)=="<";++ye);for(y=y.slice(ye),p=0;p!=y.length;++p)if(g=y[p].trim(),g.length!==0){if(v=g.match(r),j=p,b=0,w=0,g="<c "+(g.slice(0,1)=="<"?">":"")+g,v!=null&&v.length===2){for(j=0,k=v[1],b=0;b!=k.length&&!((w=k.charCodeAt(b)-64)<1||w>26);++b)j=26*j+w;--j,O=j}else++O;for(b=0;b!=g.length&&g.charCodeAt(b)!==62;++b);if(++b,S=Kt(g.slice(0,b),!0),S.r||(S.r=Ht({r:_-1,c:O})),k=g.slice(b),N={t:""},(v=k.match(i))!=null&&v[1]!==""&&(N.v=wr(v[1])),d.cellFormula){if((v=k.match(l))!=null&&v[1]!==""){if(N.f=wr(Hr(v[1])).replace(/\r\n/g,`
`),d.xlfn||(N.f=Z4(N.f)),v[0].indexOf('t="array"')>-1)N.F=(k.match(n)||[])[1],N.F.indexOf(":")>-1&&Q.push([Nr(N.F),N.F]);else if(v[0].indexOf('t="shared"')>-1){R=Kt(v[0]);var z=wr(Hr(v[1]));d.xlfn||(z=Z4(z)),H[parseInt(R.si,10)]=[R,z,S.r]}}else(v=k.match(/<f[^>]*\/>/))&&(R=Kt(v[0]),H[R.si]&&(N.f=LQ(H[R.si][1],H[R.si][2],S.r)));var A=ba(S.r);for(b=0;b<Q.length;++b)A.r>=Q[b][0].s.r&&A.r<=Q[b][0].e.r&&A.c>=Q[b][0].s.c&&A.c<=Q[b][0].e.c&&(N.F=Q[b][1])}if(S.t==null&&N.v===void 0)if(N.f||N.F)N.v=0,N.t="n";else if(B)N.t="z";else continue;else N.t=S.t||"n";switch(h.s.c>O&&(h.s.c=O),h.e.c<O&&(h.e.c=O),N.t){case"n":if(N.v==""||N.v==null){if(!B)continue;N.t="z"}else N.v=parseFloat(N.v);break;case"s":if(typeof N.v>"u"){if(!B)continue;N.t="z"}else E=zh[parseInt(N.v,10)],N.v=E.t,N.r=E.r,d.cellHTML&&(N.h=E.h);break;case"str":N.t="s",N.v=N.v!=null?Hr(N.v):"",d.cellHTML&&(N.h=y2(N.v));break;case"inlineStr":v=k.match(s),N.t="s",v!=null&&(E=I2(v[1]))?(N.v=E.t,d.cellHTML&&(N.h=E.h)):N.v="";break;case"b":N.v=ta(N.v);break;case"d":d.cellDates?N.v=aa(N.v,1):(N.v=rs(aa(N.v,1)),N.t="n");break;case"e":(!d||d.cellText!==!1)&&(N.w=N.v),N.v=UI[N.v];break}if(C=I=0,W=null,ne&&S.s!==void 0&&(W=x.CellXf[S.s],W!=null&&(W.numFmtId!=null&&(C=W.numFmtId),d.cellStyles&&W.fillId!=null&&(I=W.fillId))),$O(N,C,I,d,f,x),d.cellDates&&ne&&N.t=="n"&&O0(Wt[C])&&(N.t="d",N.v=Ay(N.v)),S.cm&&d.xlmeta){var de=(d.xlmeta.Cell||[])[+S.cm-1];de&&de.type=="XLDAPR"&&(N.D=!0)}if(K){var D=ba(S.r);u[D.r]||(u[D.r]=[]),u[D.r][D.c]=N}else u[S.r]=N}}}}q.length>0&&(u["!rows"]=q)}}();function WY(e,t,r,s){var n=[],i=[],l=Nr(e["!ref"]),o="",c,u="",d=[],h=0,f=0,x=e["!rows"],p=Array.isArray(e),g={r:u},y,v=-1;for(f=l.s.c;f<=l.e.c;++f)d[f]=va(f);for(h=l.s.r;h<=l.e.r;++h){for(i=[],u=Ma(h),f=l.s.c;f<=l.e.c;++f){c=d[f]+u;var j=p?(e[h]||[])[f]:e[c];j!==void 0&&(o=zY(j,c,e,t))!=null&&i.push(o)}(i.length>0||x&&x[h])&&(g={r:u},x&&x[h]&&(y=x[h],y.hidden&&(g.hidden=1),v=-1,y.hpx?v=kf(y.hpx):y.hpt&&(v=y.hpt),v>-1&&(g.ht=v,g.customHeight=1),y.level&&(g.outlineLevel=y.level)),n[n.length]=xt("row",i.join(""),g))}if(x)for(;h<x.length;++h)x&&x[h]&&(g={r:h+1},y=x[h],y.hidden&&(g.hidden=1),v=-1,y.hpx?v=kf(y.hpx):y.hpt&&(v=y.hpt),v>-1&&(g.ht=v,g.customHeight=1),y.level&&(g.outlineLevel=y.level),n[n.length]=xt("row","",g));return n.join("")}function zO(e,t,r,s){var n=[Ba,xt("worksheet",null,{xmlns:qd[0],"xmlns:r":es.r})],i=r.SheetNames[e],l=0,o="",c=r.Sheets[i];c==null&&(c={});var u=c["!ref"]||"A1",d=Nr(u);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=sr(d)}s||(s={}),c["!comments"]=[];var h=[];EY(c,r,e,t,n),n[n.length]=xt("dimension",null,{ref:u}),n[n.length]=BY(c,t,e,r),t.sheetFormat&&(n[n.length]=xt("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(n[n.length]=FY(c,c["!cols"])),n[l=n.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=WY(c,t),o.length>0&&(n[n.length]=o)),n.length>l+1&&(n[n.length]="</sheetData>",n[l]=n[l].replace("/>",">")),c["!protect"]&&(n[n.length]=_Y(c["!protect"])),c["!autofilter"]!=null&&(n[n.length]=MY(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(n[n.length]=kY(c["!merges"]));var f=-1,x,p=-1;return c["!links"].length>0&&(n[n.length]="<hyperlinks>",c["!links"].forEach(function(g){g[1].Target&&(x={ref:g[0]},g[1].Target.charAt(0)!="#"&&(p=Lr(s,-1,zr(g[1].Target).replace(/#.*$/,""),ur.HLINK),x["r:id"]="rId"+p),(f=g[1].Target.indexOf("#"))>-1&&(x.location=zr(g[1].Target.slice(f+1))),g[1].Tooltip&&(x.tooltip=zr(g[1].Tooltip)),n[n.length]=xt("hyperlink",null,x))}),n[n.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(n[n.length]=OY(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(n[n.length]=As("ignoredErrors",xt("ignoredError",null,{numberStoredAsText:1,sqref:u}))),h.length>0&&(p=Lr(s,-1,"../drawings/drawing"+(e+1)+".xml",ur.DRAW),n[n.length]=xt("drawing",null,{"r:id":"rId"+p}),c["!drawing"]=h),c["!comments"].length>0&&(p=Lr(s,-1,"../drawings/vmlDrawing"+(e+1)+".vml",ur.VML),n[n.length]=xt("legacyDrawing",null,{"r:id":"rId"+p}),c["!legacy"]=p),n.length>1&&(n[n.length]="</worksheet>",n[1]=n[1].replace("/>",">")),n.join("")}function VY(e,t){var r={},s=e.l+t;r.r=e.read_shift(4),e.l+=4;var n=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=s,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=n/20),r}function HY(e,t,r){var s=He(145),n=(r["!rows"]||[])[e]||{};s.write_shift(4,e),s.write_shift(4,0);var i=320;n.hpx?i=kf(n.hpx)*20:n.hpt&&(i=n.hpt*20),s.write_shift(2,i),s.write_shift(1,0);var l=0;n.level&&(l|=n.level),n.hidden&&(l|=16),(n.hpx||n.hpt)&&(l|=32),s.write_shift(1,l),s.write_shift(1,0);var o=0,c=s.l;s.l+=4;for(var u={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var h=-1,f=-1,x=d<<10;x<d+1<<10;++x){u.c=x;var p=Array.isArray(r)?(r[u.r]||[])[u.c]:r[Ht(u)];p&&(h<0&&(h=x),f=x)}h<0||(++o,s.write_shift(4,h),s.write_shift(4,f))}var g=s.l;return s.l=c,s.write_shift(4,o),s.l=g,s.length>s.l?s.slice(0,s.l):s}function qY(e,t,r,s){var n=HY(s,r,t);(n.length>17||(t["!rows"]||[])[s])&&Ye(e,0,n)}var KY=Xd,GY=R0;function QY(){}function XY(e,t){var r={},s=e[e.l];return++e.l,r.above=!(s&64),r.left=!(s&128),e.l+=18,r.name=ZV(e),r}function YY(e,t,r){r==null&&(r=He(84+4*e.length));var s=192;t&&(t.above&&(s&=-65),t.left&&(s&=-129)),r.write_shift(1,s);for(var n=1;n<3;++n)r.write_shift(1,0);return Zp({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),MI(e,r),r.slice(0,r.l)}function JY(e){var t=wi(e);return[t]}function ZY(e,t,r){return r==null&&(r=He(8)),Kd(t,r)}function eJ(e){var t=Gd(e);return[t]}function tJ(e,t,r){return r==null&&(r=He(4)),Qd(t,r)}function rJ(e){var t=wi(e),r=e.read_shift(1);return[t,r,"b"]}function aJ(e,t,r){return r==null&&(r=He(9)),Kd(t,r),r.write_shift(1,e.v?1:0),r}function sJ(e){var t=Gd(e),r=e.read_shift(1);return[t,r,"b"]}function nJ(e,t,r){return r==null&&(r=He(5)),Qd(t,r),r.write_shift(1,e.v?1:0),r}function iJ(e){var t=wi(e),r=e.read_shift(1);return[t,r,"e"]}function lJ(e,t,r){return r==null&&(r=He(9)),Kd(t,r),r.write_shift(1,e.v),r}function oJ(e){var t=Gd(e),r=e.read_shift(1);return[t,r,"e"]}function cJ(e,t,r){return r==null&&(r=He(8)),Qd(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function dJ(e){var t=wi(e),r=e.read_shift(4);return[t,r,"s"]}function uJ(e,t,r){return r==null&&(r=He(12)),Kd(t,r),r.write_shift(4,t.v),r}function hJ(e){var t=Gd(e),r=e.read_shift(4);return[t,r,"s"]}function fJ(e,t,r){return r==null&&(r=He(8)),Qd(t,r),r.write_shift(4,t.v),r}function xJ(e){var t=wi(e),r=qs(e);return[t,r,"n"]}function mJ(e,t,r){return r==null&&(r=He(16)),Kd(t,r),_d(e.v,r),r}function UO(e){var t=Gd(e),r=qs(e);return[t,r,"n"]}function pJ(e,t,r){return r==null&&(r=He(12)),Qd(t,r),_d(e.v,r),r}function gJ(e){var t=wi(e),r=E2(e);return[t,r,"n"]}function yJ(e,t,r){return r==null&&(r=He(12)),Kd(t,r),LI(e.v,r),r}function vJ(e){var t=Gd(e),r=E2(e);return[t,r,"n"]}function bJ(e,t,r){return r==null&&(r=He(8)),Qd(t,r),LI(e.v,r),r}function jJ(e){var t=wi(e),r=S2(e);return[t,r,"is"]}function wJ(e){var t=wi(e),r=Gs(e);return[t,r,"str"]}function NJ(e,t,r){return r==null&&(r=He(12+4*e.v.length)),Kd(t,r),ys(e.v,r),r.length>r.l?r.slice(0,r.l):r}function SJ(e){var t=Gd(e),r=Gs(e);return[t,r,"str"]}function kJ(e,t,r){return r==null&&(r=He(8+4*e.v.length)),Qd(t,r),ys(e.v,r),r.length>r.l?r.slice(0,r.l):r}function CJ(e,t,r){var s=e.l+t,n=wi(e);n.r=r["!row"];var i=e.read_shift(1),l=[n,i,"b"];if(r.cellFormula){e.l+=2;var o=Iy(e,s-e.l,r);l[3]=zs(o,null,n,r.supbooks,r)}else e.l=s;return l}function EJ(e,t,r){var s=e.l+t,n=wi(e);n.r=r["!row"];var i=e.read_shift(1),l=[n,i,"e"];if(r.cellFormula){e.l+=2;var o=Iy(e,s-e.l,r);l[3]=zs(o,null,n,r.supbooks,r)}else e.l=s;return l}function PJ(e,t,r){var s=e.l+t,n=wi(e);n.r=r["!row"];var i=qs(e),l=[n,i,"n"];if(r.cellFormula){e.l+=2;var o=Iy(e,s-e.l,r);l[3]=zs(o,null,n,r.supbooks,r)}else e.l=s;return l}function AJ(e,t,r){var s=e.l+t,n=wi(e);n.r=r["!row"];var i=Gs(e),l=[n,i,"str"];if(r.cellFormula){e.l+=2;var o=Iy(e,s-e.l,r);l[3]=zs(o,null,n,r.supbooks,r)}else e.l=s;return l}var _J=Xd,TJ=R0;function IJ(e,t){return t==null&&(t=He(4)),t.write_shift(4,e),t}function OJ(e,t){var r=e.l+t,s=Xd(e),n=k2(e),i=Gs(e),l=Gs(e),o=Gs(e);e.l=r;var c={rfx:s,relId:n,loc:i,display:o};return l&&(c.Tooltip=l),c}function DJ(e,t){var r=He(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));R0({s:ba(e[0]),e:ba(e[0])},r),C2("rId"+t,r);var s=e[1].Target.indexOf("#"),n=s==-1?"":e[1].Target.slice(s+1);return ys(n||"",r),ys(e[1].Tooltip||"",r),ys("",r),r.slice(0,r.l)}function FJ(){}function RJ(e,t,r){var s=e.l+t,n=$I(e),i=e.read_shift(1),l=[n];if(l[2]=i,r.cellFormula){var o=iY(e,s-e.l,r);l[1]=o}else e.l=s;return l}function MJ(e,t,r){var s=e.l+t,n=Xd(e),i=[n];if(r.cellFormula){var l=oY(e,s-e.l,r);i[1]=l,e.l=s}else e.l=s;return i}function LJ(e,t,r){r==null&&(r=He(18));var s=Oy(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(s.width||10)*256),r.write_shift(4,0);var n=0;return t.hidden&&(n|=1),typeof s.width=="number"&&(n|=2),t.level&&(n|=t.level<<8),r.write_shift(2,n),r}var WO=["left","right","top","bottom","header","footer"];function $J(e){var t={};return WO.forEach(function(r){t[r]=qs(e)}),t}function BJ(e,t){return t==null&&(t=He(6*8)),fd(e),WO.forEach(function(r){_d(e[r],t)}),t}function zJ(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function UJ(e,t,r){r==null&&(r=He(30));var s=924;return(((t||{}).Views||[])[0]||{}).RTL&&(s|=32),r.write_shift(2,s),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function WJ(e){var t=He(24);return t.write_shift(4,4),t.write_shift(4,1),R0(e,t),t}function VJ(e,t){return t==null&&(t=He(16*4+2)),t.write_shift(2,e.password?O2(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function HJ(){}function qJ(){}function KJ(e,t,r,s,n,i,l){if(!e)return e;var o=t||{};s||(s={"!id":{}});var c=o.dense?[]:{},u,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,f=!1,x,p,g,y,v,j,b,w,k,N=[];o.biff=12,o["!row"]=0;var S=0,_=!1,O=[],E={},R=o.supbooks||n.supbooks||[[]];if(R.sharedf=E,R.arrayf=O,R.SheetNames=n.SheetNames||n.Sheets.map(function(K){return K.name}),!o.supbooks&&(o.supbooks=R,n.Names))for(var C=0;C<n.Names.length;++C)R[0][C+1]=n.Names[C];var I=[],ne=[],W=!1;Cf[16]={n:"BrtShortReal",f:UO};var Q;if(yo(e,function(q,ge,G){if(!f)switch(G){case 148:u=q;break;case 0:x=q,o.sheetRows&&o.sheetRows<=x.r&&(f=!0),w=Ma(y=x.r),o["!row"]=x.r,(q.hidden||q.hpt||q.level!=null)&&(q.hpt&&(q.hpx=f0(q.hpt)),ne[q.r]=q);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(p={t:q[2]},q[2]){case"n":p.v=q[1];break;case"s":b=zh[q[1]],p.v=b.t,p.r=b.r;break;case"b":p.v=!!q[1];break;case"e":p.v=q[1],o.cellText!==!1&&(p.w=vo[p.v]);break;case"str":p.t="s",p.v=q[1];break;case"is":p.t="s",p.v=q[1].t;break}if((g=l.CellXf[q[0].iStyleRef])&&$O(p,g.numFmtId,null,o,i,l),v=q[0].c==-1?v+1:q[0].c,o.dense?(c[y]||(c[y]=[]),c[y][v]=p):c[va(v)+w]=p,o.cellFormula){for(_=!1,S=0;S<O.length;++S){var B=O[S];x.r>=B[0].s.r&&x.r<=B[0].e.r&&v>=B[0].s.c&&v<=B[0].e.c&&(p.F=sr(B[0]),_=!0)}!_&&q.length>3&&(p.f=q[3])}if(d.s.r>x.r&&(d.s.r=x.r),d.s.c>v&&(d.s.c=v),d.e.r<x.r&&(d.e.r=x.r),d.e.c<v&&(d.e.c=v),o.cellDates&&g&&p.t=="n"&&O0(Wt[g.numFmtId])){var se=Gc(p.v);se&&(p.t="d",p.v=new Date(se.y,se.m-1,se.d,se.H,se.M,se.S,se.u))}Q&&(Q.type=="XLDAPR"&&(p.D=!0),Q=void 0);break;case 1:case 12:if(!o.sheetStubs||h)break;p={t:"z",v:void 0},v=q[0].c==-1?v+1:q[0].c,o.dense?(c[y]||(c[y]=[]),c[y][v]=p):c[va(v)+w]=p,d.s.r>x.r&&(d.s.r=x.r),d.s.c>v&&(d.s.c=v),d.e.r<x.r&&(d.e.r=x.r),d.e.c<v&&(d.e.c=v),Q&&(Q.type=="XLDAPR"&&(p.D=!0),Q=void 0);break;case 176:N.push(q);break;case 49:Q=((o.xlmeta||{}).Cell||[])[q-1];break;case 494:var L=s["!id"][q.relId];for(L?(q.Target=L.Target,q.loc&&(q.Target+="#"+q.loc),q.Rel=L):q.relId==""&&(q.Target="#"+q.loc),y=q.rfx.s.r;y<=q.rfx.e.r;++y)for(v=q.rfx.s.c;v<=q.rfx.e.c;++v)o.dense?(c[y]||(c[y]=[]),c[y][v]||(c[y][v]={t:"z",v:void 0}),c[y][v].l=q):(j=Ht({c:v,r:y}),c[j]||(c[j]={t:"z",v:void 0}),c[j].l=q);break;case 426:if(!o.cellFormula)break;O.push(q),k=o.dense?c[y][v]:c[va(v)+w],k.f=zs(q[1],d,{r:x.r,c:v},R,o),k.F=sr(q[0]);break;case 427:if(!o.cellFormula)break;E[Ht(q[0].s)]=q[1],k=o.dense?c[y][v]:c[va(v)+w],k.f=zs(q[1],d,{r:x.r,c:v},R,o);break;case 60:if(!o.cellStyles)break;for(;q.e>=q.s;)I[q.e--]={width:q.w/256,hidden:!!(q.flags&1),level:q.level},W||(W=!0,D2(q.w/256)),mc(I[q.e+1]);break;case 161:c["!autofilter"]={ref:sr(q)};break;case 476:c["!margins"]=q;break;case 147:n.Sheets[r]||(n.Sheets[r]={}),q.name&&(n.Sheets[r].CodeName=q.name),(q.above||q.left)&&(c["!outline"]={above:q.above,left:q.left});break;case 137:n.Views||(n.Views=[{}]),n.Views[0]||(n.Views[0]={}),q.RTL&&(n.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!ge.T){if(!h||o.WTF)throw new Error("Unexpected record 0x"+G.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(d.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(c["!ref"]=sr(u||d)),o.sheetRows&&c["!ref"]){var H=Nr(c["!ref"]);o.sheetRows<=+H.e.r&&(H.e.r=o.sheetRows-1,H.e.r>d.e.r&&(H.e.r=d.e.r),H.e.r<H.s.r&&(H.s.r=H.e.r),H.e.c>d.e.c&&(H.e.c=d.e.c),H.e.c<H.s.c&&(H.s.c=H.e.c),c["!fullref"]=c["!ref"],c["!ref"]=sr(H))}return N.length>0&&(c["!merges"]=N),I.length>0&&(c["!cols"]=I),ne.length>0&&(c["!rows"]=ne),c}function GJ(e,t,r,s,n,i,l){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=sa(t),t.z=t.z||Wt[14],t.v=rs(aa(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var c={r,c:s};switch(c.s=Pc(n.cellXfs,t,n),t.l&&i["!links"].push([Ht(c),t.l]),t.c&&i["!comments"].push([Ht(c),t.c]),t.t){case"s":case"str":return n.bookSST?(o=$2(n.Strings,t.v,n.revStrings),c.t="s",c.v=o,l?Ye(e,18,fJ(t,c)):Ye(e,7,uJ(t,c))):(c.t="str",l?Ye(e,17,kJ(t,c)):Ye(e,6,NJ(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?l?Ye(e,13,bJ(t,c)):Ye(e,2,yJ(t,c)):l?Ye(e,16,pJ(t,c)):Ye(e,5,mJ(t,c)),!0;case"b":return c.t="b",l?Ye(e,15,nJ(t,c)):Ye(e,4,aJ(t,c)),!0;case"e":return c.t="e",l?Ye(e,14,cJ(t,c)):Ye(e,3,lJ(t,c)),!0}return l?Ye(e,12,tJ(t,c)):Ye(e,1,ZY(t,c)),!0}function QJ(e,t,r,s){var n=Nr(t["!ref"]||"A1"),i,l="",o=[];Ye(e,145);var c=Array.isArray(t),u=n.e.r;t["!rows"]&&(u=Math.max(n.e.r,t["!rows"].length-1));for(var d=n.s.r;d<=u;++d){l=Ma(d),qY(e,t,n,d);var h=!1;if(d<=n.e.r)for(var f=n.s.c;f<=n.e.c;++f){d===n.s.r&&(o[f]=va(f)),i=o[f]+l;var x=c?(t[d]||[])[f]:t[i];if(!x){h=!1;continue}h=GJ(e,x,d,f,s,t,h)}}Ye(e,146)}function XJ(e,t){!t||!t["!merges"]||(Ye(e,177,IJ(t["!merges"].length)),t["!merges"].forEach(function(r){Ye(e,176,TJ(r))}),Ye(e,178))}function YJ(e,t){!t||!t["!cols"]||(Ye(e,390),t["!cols"].forEach(function(r,s){r&&Ye(e,60,LJ(s,r))}),Ye(e,391))}function JJ(e,t){!t||!t["!ref"]||(Ye(e,648),Ye(e,649,WJ(Nr(t["!ref"]))),Ye(e,650))}function ZJ(e,t,r){t["!links"].forEach(function(s){if(s[1].Target){var n=Lr(r,-1,s[1].Target.replace(/#.*$/,""),ur.HLINK);Ye(e,494,DJ(s,n))}}),delete t["!links"]}function eZ(e,t,r,s){if(t["!comments"].length>0){var n=Lr(s,-1,"../drawings/vmlDrawing"+(r+1)+".vml",ur.VML);Ye(e,551,C2("rId"+n)),t["!legacy"]=n}}function tZ(e,t,r,s){if(t["!autofilter"]){var n=t["!autofilter"],i=typeof n.ref=="string"?n.ref:sr(n.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var l=r.Workbook.Names,o=Dn(i);o.s.r==o.e.r&&(o.e.r=Dn(t["!ref"]).e.r,i=sr(o));for(var c=0;c<l.length;++c){var u=l[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==s){u.Ref="'"+r.SheetNames[s]+"'!"+i;break}}c==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+r.SheetNames[s]+"'!"+i}),Ye(e,161,R0(Nr(i))),Ye(e,162)}}function rZ(e,t,r){Ye(e,133),Ye(e,137,UJ(t,r)),Ye(e,138),Ye(e,134)}function aZ(e,t){t["!protect"]&&Ye(e,535,VJ(t["!protect"]))}function sZ(e,t,r,s){var n=In(),i=r.SheetNames[e],l=r.Sheets[i]||{},o=i;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var c=Nr(l["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return l["!links"]=[],l["!comments"]=[],Ye(n,129),(r.vbaraw||l["!outline"])&&Ye(n,147,YY(o,l["!outline"])),Ye(n,148,GY(c)),rZ(n,l,r.Workbook),YJ(n,l),QJ(n,l,e,t),aZ(n,l),tZ(n,l,r,e),XJ(n,l),ZJ(n,l,s),l["!margins"]&&Ye(n,476,BJ(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&JJ(n,l),eZ(n,l,e,s),Ye(n,130),n.end()}function nZ(e){var t=[],r=e.match(/^<c:numCache>/),s;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var l=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(t[+l[1]]=r?+l[2]:l[2])});var n=wr((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){s=i.replace(/<.*?>/g,"")}),[t,n,s]}function iZ(e,t,r,s,n,i){var l=i||{"!type":"chart"};if(!e)return i;var o=0,c=0,u="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var f=nZ(h);d.s.r=d.s.c=0,d.e.c=o,u=va(o),f[0].forEach(function(x,p){l[u+Ma(p)]={t:"n",v:x,z:f[1]},c=p}),d.e.r<c&&(d.e.r=c),++o}),o>0&&(l["!ref"]=sr(d)),l}function lZ(e,t,r,s,n){if(!e)return e;s||(s={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},l,o=e.match(BO);return o&&B2(o[0],i,n,r),(l=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=l[1]),s["!id"][i["!rel"]]&&(i["!drawel"]=s["!id"][i["!rel"]]),i}function oZ(e,t){e.l+=10;var r=Gs(e);return{name:r}}function cZ(e,t,r,s,n){if(!e)return e;s||(s={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},l=!1;return yo(e,function(c,u,d){switch(d){case 550:i["!rel"]=c;break;case 651:n.Sheets[r]||(n.Sheets[r]={}),c.name&&(n.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!l||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},t),s["!id"][i["!rel"]]&&(i["!drawel"]=s["!id"][i["!rel"]]),i}var z2=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],dZ=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],uZ=[],hZ=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function sE(e,t){for(var r=0;r!=e.length;++r)for(var s=e[r],n=0;n!=t.length;++n){var i=t[n];if(s[i[0]]==null)s[i[0]]=i[1];else switch(i[2]){case"bool":typeof s[i[0]]=="string"&&(s[i[0]]=ta(s[i[0]]));break;case"int":typeof s[i[0]]=="string"&&(s[i[0]]=parseInt(s[i[0]],10));break}}}function nE(e,t){for(var r=0;r!=t.length;++r){var s=t[r];if(e[s[0]]==null)e[s[0]]=s[1];else switch(s[2]){case"bool":typeof e[s[0]]=="string"&&(e[s[0]]=ta(e[s[0]]));break;case"int":typeof e[s[0]]=="string"&&(e[s[0]]=parseInt(e[s[0]],10));break}}}function VO(e){nE(e.WBProps,z2),nE(e.CalcPr,hZ),sE(e.WBView,dZ),sE(e.Sheets,uZ),Lu.date1904=ta(e.WBProps.date1904)}function fZ(e){return!e.Workbook||!e.Workbook.WBProps?"false":ta(e.Workbook.WBProps.date1904)?"true":"false"}var xZ="][*?/\\".split("");function HO(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return xZ.forEach(function(s){if(e.indexOf(s)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function mZ(e,t,r){e.forEach(function(s,n){HO(s);for(var i=0;i<n;++i)if(s==e[i])throw new Error("Duplicate Sheet Name: "+s);if(r){var l=t&&t[n]&&t[n].CodeName||s;if(l.charCodeAt(0)==95&&l.length>22)throw new Error("Bad Code Name: Worksheet"+l)}})}function pZ(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];mZ(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)fY(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var gZ=/<\w+:workbook/;function yZ(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},s=!1,n="xmlns",i={},l=0;if(e.replace(Js,function(c,u){var d=Kt(c);switch(Nl(d[0])){case"<?xml":break;case"<workbook":c.match(gZ)&&(n="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=d[n];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":z2.forEach(function(h){if(d[h[0]]!=null)switch(h[2]){case"bool":r.WBProps[h[0]]=ta(d[h[0]]);break;case"int":r.WBProps[h[0]]=parseInt(d[h[0]],10);break;default:r.WBProps[h[0]]=d[h[0]]}}),d.codeName&&(r.WBProps.CodeName=Hr(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=wr(Hr(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":s=!0;break;case"</definedNames>":s=!1;break;case"<definedName":i={},i.Name=Hr(d.name),d.comment&&(i.Comment=d.comment),d.localSheetId&&(i.Sheet=+d.localSheetId),ta(d.hidden||"0")&&(i.Hidden=!0),l=u+c.length;break;case"</definedName>":i.Ref=wr(Hr(e.slice(l,u))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":s=!0;break;case"</AlternateContent>":s=!1;break;case"<revisionPtr":break;default:if(!s&&t.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return c}),qd.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return VO(r),r}function qO(e){var t=[Ba];t[t.length]=xt("workbook",null,{xmlns:qd[0],"xmlns:r":es.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,s={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(z2.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(s[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(s.codeName=e.Workbook.WBProps.CodeName,delete s.CodeName)),t[t.length]=xt("workbookPr",null,s);var n=e.Workbook&&e.Workbook.Sheets||[],i=0;if(n&&n[0]&&n[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!n[i]||!n[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var l={name:zr(e.SheetNames[i].slice(0,31))};if(l.sheetId=""+(i+1),l["r:id"]="rId"+(i+1),n[i])switch(n[i].Hidden){case 1:l.state="hidden";break;case 2:l.state="veryHidden";break}t[t.length]=xt("sheet",null,l)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(t[t.length]=xt("definedName",zr(o.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function vZ(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Bj(e),r.name=Gs(e),r}function bZ(e,t){return t||(t=He(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),C2(e.strRelID,t),ys(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function jZ(e,t){var r={},s=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var n=t>8?Gs(e):"";return n.length>0&&(r.CodeName=n),r.autoCompressPictures=!!(s&65536),r.backupFile=!!(s&64),r.checkCompatibility=!!(s&4096),r.date1904=!!(s&1),r.filterPrivacy=!!(s&8),r.hidePivotFieldList=!!(s&1024),r.promptedSolutions=!!(s&16),r.publishItems=!!(s&2048),r.refreshAllConnections=!!(s&262144),r.saveExternalLinkValues=!!(s&128),r.showBorderUnselectedTables=!!(s&4),r.showInkAnnotation=!!(s&32),r.showObjects=["all","placeholders","none"][s>>13&3],r.showPivotChartFilter=!!(s&32768),r.updateLinks=["userSet","never","always"][s>>8&3],r}function wZ(e,t){t||(t=He(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),MI(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function NZ(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function SZ(e,t,r){var s=e.l+t;e.l+=4,e.l+=1;var n=e.read_shift(4),i=eH(e),l=lY(e,0,r),o=k2(e);e.l=s;var c={Name:i,Ptg:l};return n<268435455&&(c.Sheet=n),o&&(c.Comment=o),c}function kZ(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},s=[],n=!1;t||(t={}),t.biff=12;var i=[],l=[[]];return l.SheetNames=[],l.XTI=[],Cf[16]={n:"BrtFRTArchID$",f:NZ},yo(e,function(c,u,d){switch(d){case 156:l.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=zs(c.Ptg,null,null,l,t),delete t.SID,delete c.Ptg,i.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([d,c]):l[0]=[d,c],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(c),l.XTI=l.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:s.push(d),n=!0;break;case 36:s.pop(),n=!1;break;case 37:s.push(d),n=!0;break;case 38:s.pop(),n=!1;break;case 16:break;default:if(!u.T){if(!n||t.WTF&&s[s.length-1]!=37&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},t),VO(r),r.Names=i,r.supbooks=l,r}function CZ(e,t){Ye(e,143);for(var r=0;r!=t.SheetNames.length;++r){var s=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,n={Hidden:s,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Ye(e,156,bZ(n))}Ye(e,144)}function EZ(e,t){t||(t=He(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return ys("SheetJS",t),ys(qp.version,t),ys(qp.version,t),ys("7262",t),t.length>t.l?t.slice(0,t.l):t}function PZ(e,t){t||(t=He(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function AZ(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,s=0,n=-1,i=-1;s<r.length;++s)!r[s]||!r[s].Hidden&&n==-1?n=s:r[s].Hidden==1&&i==-1&&(i=s);i>n||(Ye(e,135),Ye(e,158,PZ(n)),Ye(e,136))}}function _Z(e,t){var r=In();return Ye(r,131),Ye(r,128,EZ()),Ye(r,153,wZ(e.Workbook&&e.Workbook.WBProps||null)),AZ(r,e),CZ(r,e),Ye(r,132),r.end()}function TZ(e,t,r){return t.slice(-4)===".bin"?kZ(e,r):yZ(e,r)}function IZ(e,t,r,s,n,i,l,o){return t.slice(-4)===".bin"?KJ(e,s,r,n,i,l,o):SY(e,s,r,n,i,l,o)}function OZ(e,t,r,s,n,i,l,o){return t.slice(-4)===".bin"?cZ(e,s,r,n,i):lZ(e,s,r,n,i)}function DZ(e,t,r,s,n,i,l,o){return t.slice(-4)===".bin"?RQ():MQ()}function FZ(e,t,r,s,n,i,l,o){return t.slice(-4)===".bin"?DQ():FQ()}function RZ(e,t,r,s){return t.slice(-4)===".bin"?TG(e,r,s):vG(e,r,s)}function MZ(e,t,r){return CO(e,r)}function LZ(e,t,r){return t.slice(-4)===".bin"?LK(e,r):FK(e,r)}function $Z(e,t,r){return t.slice(-4)===".bin"?AQ(e,r):bQ(e,r)}function BZ(e,t,r){return t.slice(-4)===".bin"?gQ(e):mQ(e)}function zZ(e,t,r,s){return r.slice(-4)===".bin"?yQ(e,t,r,s):void 0}function UZ(e,t,r){return t.slice(-4)===".bin"?hQ(e,t,r):xQ(e,t,r)}function WZ(e,t,r){return(t.slice(-4)===".bin"?_Z:qO)(e)}function VZ(e,t,r,s,n){return(t.slice(-4)===".bin"?sZ:zO)(e,r,s,n)}function HZ(e,t,r){return(t.slice(-4)===".bin"?zG:SO)(e,r)}function qZ(e,t,r){return(t.slice(-4)===".bin"?zK:pO)(e,r)}function KZ(e,t,r){return(t.slice(-4)===".bin"?_Q:AO)(e)}function GZ(e){return(e.slice(-4)===".bin"?fQ:EO)()}var KO=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,GO=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Ei(e,t){var r=e.split(/\s+/),s=[];if(s[0]=r[0],r.length===1)return s;var n=e.match(KO),i,l,o,c;if(n)for(c=0;c!=n.length;++c)i=n[c].match(GO),(l=i[1].indexOf(":"))===-1?s[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(l+1),s[o]=i[2].slice(1,i[2].length-1));return s}function QZ(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var s=e.match(KO),n,i,l,o;if(s)for(o=0;o!=s.length;++o)n=s[o].match(GO),(i=n[1].indexOf(":"))===-1?r[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?l="xmlns"+n[1].slice(6):l=n[1].slice(i+1),r[l]=n[2].slice(1,n[2].length-1));return r}var Wh;function XZ(e,t){var r=Wh[e]||wr(e);return r==="General"?Pd(t):vi(r,t)}function YZ(e,t,r,s){var n=s;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":n=ta(s);break;case"i2":case"int":n=parseInt(s,10);break;case"r4":case"float":n=parseFloat(s);break;case"date":case"dateTime.tz":n=aa(s);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[wr(t)]=n}function JZ(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||vo[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=gf(e.v):e.w=Pd(e.v):e.w=XZ(t||"General",e.v)}catch(i){if(r.WTF)throw i}try{var s=Wh[t]||t||"General";if(r.cellNF&&(e.z=s),r.cellDates&&e.t=="n"&&O0(s)){var n=Gc(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}catch(i){if(r.WTF)throw i}}}function ZZ(e,t,r){if(r.cellStyles&&t.Interior){var s=t.Interior;s.Pattern&&(s.patternType=uG[s.Pattern]||s.Pattern)}e[t.ID]=t}function eee(e,t,r,s,n,i,l,o,c,u){var d="General",h=s.StyleID,f={};u=u||{};var x=[],p=0;for(h===void 0&&o&&(h=o.StyleID),h===void 0&&l&&(h=l.StyleID);i[h]!==void 0&&(i[h].nf&&(d=i[h].nf),i[h].Interior&&x.push(i[h].Interior),!!i[h].Parent);)h=i[h].Parent;switch(r.Type){case"Boolean":s.t="b",s.v=ta(e);break;case"String":s.t="s",s.r=w4(wr(e)),s.v=e.indexOf("<")>-1?wr(t||e).replace(/<.*?>/g,""):s.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),s.v=(aa(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),s.v!==s.v?s.v=wr(e):s.v<60&&(s.v=s.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":s.v===void 0&&(s.v=+e),s.t||(s.t="n");break;case"Error":s.t="e",s.v=UI[e],u.cellText!==!1&&(s.w=e);break;default:e==""&&t==""?s.t="z":(s.t="s",s.v=w4(t||e));break}if(JZ(s,d,u),u.cellFormula!==!1)if(s.Formula){var g=wr(s.Formula);g.charCodeAt(0)==61&&(g=g.slice(1)),s.f=Mu(g,n),delete s.Formula,s.ArrayRange=="RC"?s.F=Mu("RC:RC",n):s.ArrayRange&&(s.F=Mu(s.ArrayRange,n),c.push([Nr(s.F),s.F]))}else for(p=0;p<c.length;++p)n.r>=c[p][0].s.r&&n.r<=c[p][0].e.r&&n.c>=c[p][0].s.c&&n.c<=c[p][0].e.c&&(s.F=c[p][1]);u.cellStyles&&(x.forEach(function(y){!f.patternType&&y.patternType&&(f.patternType=y.patternType)}),s.s=f),s.StyleID!==void 0&&(s.ixfe=s.StyleID)}function tee(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Rb(e,t){var r=t||{};D0();var s=bh(v2(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(s=Hr(s));var n=s.slice(0,1024).toLowerCase(),i=!1;if(n=n.replace(/".*?"/g,""),(n.indexOf(">")&1023)>Math.min(n.indexOf(",")&1023,n.indexOf(";")&1023)){var l=sa(r);return l.type="string",h0.to_workbook(s,l)}if(n.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Bt){n.indexOf("<"+Bt)>=0&&(i=!0)}),i)return Bee(s,r);Wh={"General Number":"General","General Date":Wt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Wt[15],"Short Date":Wt[14],"Long Time":Wt[19],"Medium Time":Wt[18],"Short Time":Wt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Wt[2],Standard:Wt[4],Percent:Wt[10],Scientific:Wt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],u,d={},h=[],f=r.dense?[]:{},x="",p={},g={},y=Ei('<Data ss:Type="String">'),v=0,j=0,b=0,w={s:{r:2e6,c:2e6},e:{r:0,c:0}},k={},N={},S="",_=0,O=[],E={},R={},C=0,I=[],ne=[],W={},Q=[],H,K=!1,q=[],ge=[],G={},B=0,se=0,L={Sheets:[],WBProps:{date1904:!1}},Z={};bf.lastIndex=0,s=s.replace(/<!--([\s\S]*?)-->/mg,"");for(var F="";o=bf.exec(s);)switch(o[3]=(F=o[3]).toLowerCase()){case"data":if(F=="data"){if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?eee(s.slice(v,o.index),S,y,c[c.length-1][0]=="comment"?W:p,{c:j,r:b},k,Q[j],g,q,r):(S="",y=Ei(o[0]),v=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(ne.length>0&&(p.c=ne),(!r.sheetRows||r.sheetRows>b)&&p.v!==void 0&&(r.dense?(f[b]||(f[b]=[]),f[b][j]=p):f[va(j)+Ma(b)]=p),p.HRef&&(p.l={Target:wr(p.HRef)},p.HRefScreenTip&&(p.l.Tooltip=p.HRefScreenTip),delete p.HRef,delete p.HRefScreenTip),(p.MergeAcross||p.MergeDown)&&(B=j+(parseInt(p.MergeAcross,10)|0),se=b+(parseInt(p.MergeDown,10)|0),O.push({s:{c:j,r:b},e:{c:B,r:se}})),!r.sheetStubs)p.MergeAcross?j=B+1:++j;else if(p.MergeAcross||p.MergeDown){for(var he=j;he<=B;++he)for(var ye=b;ye<=se;++ye)(he>j||ye>b)&&(r.dense?(f[ye]||(f[ye]=[]),f[ye][he]={t:"z"}):f[va(he)+Ma(ye)]={t:"z"});j=B+1}else++j;else p=QZ(o[0]),p.Index&&(j=+p.Index-1),j<w.s.c&&(w.s.c=j),j>w.e.c&&(w.e.c=j),o[0].slice(-2)==="/>"&&++j,ne=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(b<w.s.r&&(w.s.r=b),b>w.e.r&&(w.e.r=b),o[0].slice(-2)==="/>"&&(g=Ei(o[0]),g.Index&&(b=+g.Index-1)),j=0,++b):(g=Ei(o[0]),g.Index&&(b=+g.Index-1),G={},(g.AutoFitHeight=="0"||g.Height)&&(G.hpx=parseInt(g.Height,10),G.hpt=kf(G.hpx),ge[b]=G),g.Hidden=="1"&&(G.hidden=!0,ge[b]=G));break;case"worksheet":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));h.push(x),w.s.r<=w.e.r&&w.s.c<=w.e.c&&(f["!ref"]=sr(w),r.sheetRows&&r.sheetRows<=w.e.r&&(f["!fullref"]=f["!ref"],w.e.r=r.sheetRows-1,f["!ref"]=sr(w))),O.length&&(f["!merges"]=O),Q.length>0&&(f["!cols"]=Q),ge.length>0&&(f["!rows"]=ge),d[x]=f}else w={s:{r:2e6,c:2e6},e:{r:0,c:0}},b=j=0,c.push([o[3],!1]),u=Ei(o[0]),x=wr(u.Name),f=r.dense?[]:{},O=[],q=[],ge=[],Z={name:x,Hidden:0},L.Sheets.push(Z);break;case"table":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),Q=[],K=!1}break;case"style":o[1]==="/"?ZZ(k,N,r):N=Ei(o[0]);break;case"numberformat":N.nf=wr(Ei(o[0]).Format||"General"),Wh[N.nf]&&(N.nf=Wh[N.nf]);for(var z=0;z!=392&&Wt[z]!=N.nf;++z);if(z==392){for(z=57;z!=392;++z)if(Wt[z]==null){Kl(N.nf,z);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(H=Ei(o[0]),H.Hidden&&(H.hidden=!0,delete H.Hidden),H.Width&&(H.wpx=parseInt(H.Width,10)),!K&&H.wpx>10){K=!0,Ws=wO;for(var A=0;A<Q.length;++A)Q[A]&&mc(Q[A])}K&&mc(H),Q[H.Index-1||Q.length]=H;for(var de=0;de<+H.Span;++de)Q[Q.length]=sa(H);break;case"namedrange":if(o[1]==="/")break;L.Names||(L.Names=[]);var D=Kt(o[0]),ze={Name:D.Name,Ref:Mu(D.RefersTo.slice(1),{r:0,c:0})};L.Sheets.length>0&&(ze.Sheet=L.Sheets.length-1),L.Names.push(ze);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?S+=s.slice(_,o.index):_=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;N.Interior=Ei(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?kH(E,F,s.slice(C,o.index)):C=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));tee(W),ne.push(W)}else c.push([o[3],!1]),u=Ei(o[0]),W={a:u.Author};break;case"autofilter":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Fe=Ei(o[0]);f["!autofilter"]={ref:Mu(Fe.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return dE(s,r);var ct=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:ct=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:ct=!1}break;case"excelworkbook":switch(o[3]){case"date1904":L.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:ct=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:ct=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(s.slice(C,o.index)){case"SheetHidden":Z.Hidden=1;break;case"SheetVeryHidden":Z.Hidden=2;break}else C=o.index+o[0].length;break;case"header":f["!margins"]||fd(f["!margins"]={},"xlml"),isNaN(+Kt(o[0]).Margin)||(f["!margins"].header=+Kt(o[0]).Margin);break;case"footer":f["!margins"]||fd(f["!margins"]={},"xlml"),isNaN(+Kt(o[0]).Margin)||(f["!margins"].footer=+Kt(o[0]).Margin);break;case"pagemargins":var $e=Kt(o[0]);f["!margins"]||fd(f["!margins"]={},"xlml"),isNaN(+$e.Top)||(f["!margins"].top=+$e.Top),isNaN(+$e.Left)||(f["!margins"].left=+$e.Left),isNaN(+$e.Right)||(f["!margins"].right=+$e.Right),isNaN(+$e.Bottom)||(f["!margins"].bottom=+$e.Bottom);break;case"displayrighttoleft":L.Views||(L.Views=[]),L.Views[0]||(L.Views[0]={}),L.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:ct=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:ct=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:ct=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:ct=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:ct=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:ct=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:ct=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:ct=!1}break;case"smarttags":break;default:ct=!1;break}if(ct||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?YZ(R,F,I,s.slice(C,o.index)):(I=o,C=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var We={};return!r.bookSheets&&!r.bookProps&&(We.Sheets=d),We.SheetNames=h,We.Workbook=L,We.SSF=sa(Wt),We.Props=E,We.Custprops=R,We}function Kj(e,t){switch(W2(t=t||{}),t.type||"base64"){case"base64":return Rb(Qn(e),t);case"binary":case"buffer":case"file":return Rb(e,t);case"array":return Rb(Cc(e),t)}}function ree(e,t){var r=[];return e.Props&&r.push(CH(e.Props,t)),e.Custprops&&r.push(EH(e.Props,e.Custprops)),r.join("")}function aee(){return""}function see(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(s,n){var i=[];i.push(xt("NumberFormat",null,{"ss:Format":zr(Wt[s.numFmtId])}));var l={"ss:ID":"s"+(21+n)};r.push(xt("Style",i.join(""),l))}),xt("Styles",r.join(""))}function QO(e){return xt("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+M2(e.Ref,{r:0,c:0})})}function nee(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],s=0;s<t.length;++s){var n=t[s];n.Sheet==null&&(n.Name.match(/^_xlfn\./)||r.push(QO(n)))}return xt("Names",r.join(""))}function iee(e,t,r,s){if(!e||!((s||{}).Workbook||{}).Names)return"";for(var n=s.Workbook.Names,i=[],l=0;l<n.length;++l){var o=n[l];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||i.push(QO(o)))}return i.join("")}function lee(e,t,r,s){if(!e)return"";var n=[];if(e["!margins"]&&(n.push("<PageSetup>"),e["!margins"].header&&n.push(xt("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&n.push(xt("Footer",null,{"x:Margin":e["!margins"].footer})),n.push(xt("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),n.push("</PageSetup>")),s&&s.Workbook&&s.Workbook.Sheets&&s.Workbook.Sheets[r])if(s.Workbook.Sheets[r].Hidden)n.push(xt("Visible",s.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(s.Workbook.Sheets[i]&&!s.Workbook.Sheets[i].Hidden);++i);i==r&&n.push("<Selected/>")}return((((s||{}).Workbook||{}).Views||[])[0]||{}).RTL&&n.push("<DisplayRightToLeft/>"),e["!protect"]&&(n.push(As("ProtectContents","True")),e["!protect"].objects&&n.push(As("ProtectObjects","True")),e["!protect"].scenarios&&n.push(As("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?n.push(As("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&n.push(As("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(l){e["!protect"][l[0]]&&n.push("<"+l[1]+"/>")})),n.length==0?"":xt("WorksheetOptions",n.join(""),{xmlns:$n.x})}function oee(e){return e.map(function(t){var r=AV(t.t||""),s=xt("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return xt("Comment",s,{"ss:Author":t.a})}).join("")}function cee(e,t,r,s,n,i,l){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+zr(M2(e.f,l))),e.F&&e.F.slice(0,t.length)==t){var c=ba(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==l.r?"":"["+(c.r-l.r)+"]")+"C"+(c.c==l.c?"":"["+(c.c-l.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=zr(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=zr(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],d=0;d!=u.length;++d)u[d].s.c!=l.c||u[d].s.r!=l.r||(u[d].e.c>u[d].s.c&&(o["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(o["ss:MergeDown"]=u[d].e.r-u[d].s.r));var h="",f="";switch(e.t){case"z":if(!s.sheetStubs)return"";break;case"n":h="Number",f=String(e.v);break;case"b":h="Boolean",f=e.v?"1":"0";break;case"e":h="Error",f=vo[e.v];break;case"d":h="DateTime",f=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Wt[14]);break;case"s":h="String",f=PV(e.v||"");break}var x=Pc(s.cellXfs,e,s);o["ss:StyleID"]="s"+(21+x),o["ss:Index"]=l.c+1;var p=e.v!=null?f:"",g=e.t=="z"?"":'<Data ss:Type="'+h+'">'+p+"</Data>";return(e.c||[]).length>0&&(g+=oee(e.c)),xt("Cell",g,o)}function dee(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=f0(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function uee(e,t,r,s){if(!e["!ref"])return"";var n=Nr(e["!ref"]),i=e["!merges"]||[],l=0,o=[];e["!cols"]&&e["!cols"].forEach(function(y,v){mc(y);var j=!!y.width,b=Oy(v,y),w={"ss:Index":v+1};j&&(w["ss:Width"]=Nf(b.width)),y.hidden&&(w["ss:Hidden"]="1"),o.push(xt("Column",null,w))});for(var c=Array.isArray(e),u=n.s.r;u<=n.e.r;++u){for(var d=[dee(u,(e["!rows"]||[])[u])],h=n.s.c;h<=n.e.c;++h){var f=!1;for(l=0;l!=i.length;++l)if(!(i[l].s.c>h)&&!(i[l].s.r>u)&&!(i[l].e.c<h)&&!(i[l].e.r<u)){(i[l].s.c!=h||i[l].s.r!=u)&&(f=!0);break}if(!f){var x={r:u,c:h},p=Ht(x),g=c?(e[u]||[])[h]:e[p];d.push(cee(g,p,e,t,r,s,x))}}d.push("</Row>"),d.length>2&&o.push(d.join(""))}return o.join("")}function hee(e,t,r){var s=[],n=r.SheetNames[e],i=r.Sheets[n],l=i?iee(i,t,e,r):"";return l.length>0&&s.push("<Names>"+l+"</Names>"),l=i?uee(i,t,e,r):"",l.length>0&&s.push("<Table>"+l+"</Table>"),s.push(lee(i,t,e,r)),s.join("")}function fee(e,t){t||(t={}),e.SSF||(e.SSF=sa(Wt)),e.SSF&&(D0(),Cy(e.SSF),t.revssf=Py(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Pc(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(ree(e,t)),r.push(aee()),r.push(""),r.push("");for(var s=0;s<e.SheetNames.length;++s)r.push(xt("Worksheet",hee(s,t,e),{"ss:Name":zr(e.SheetNames[s])}));return r[2]=see(e,t),r[3]=nee(e),Ba+xt("Workbook",r.join(""),{xmlns:$n.ss,"xmlns:o":$n.o,"xmlns:x":$n.x,"xmlns:ss":$n.ss,"xmlns:dt":$n.dt,"xmlns:html":$n.html})}function xee(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=nH(r),r.length-r.l<=4)return t;var s=r.read_shift(4);if(s==0||s>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(s=r.read_shift(4),s!==1907505652)||(t.UnicodeClipboardFormat=iH(r),s=r.read_shift(4),s==0||s>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var mee=[60,1084,2066,2165,2175];function pee(e,t,r,s,n){var i=s,l=[],o=r.slice(r.l,r.l+i);if(n&&n.enc&&n.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:n.enc.insitu(o)}l.push(o),r.l+=i;for(var c=Ul(r,r.l),u=Gj[c],d=0;u!=null&&mee.indexOf(c)>-1;)i=Ul(r,r.l+2),d=r.l+4,c==2066?d+=4:(c==2165||c==2175)&&(d+=12),o=r.slice(d,r.l+4+i),l.push(o),r.l+=4+i,u=Gj[c=Ul(r,r.l)];var h=ps(l);Ps(h,0);var f=0;h.lens=[];for(var x=0;x<l.length;++x)h.lens.push(f),f+=l[x].length;if(h.length<s)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+h.length+" < "+s;return t.f(h,h.length,n)}function tl(e,t,r){if(e.t!=="z"&&e.XF){var s=0;try{s=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Wt[s])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||vo[e.v]:s===0||s=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=gf(e.v):e.w=Pd(e.v):e.w=vi(s,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&s&&e.t=="n"&&O0(Wt[s]||String(s))){var n=Gc(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}}function bm(e,t,r){return{v:e,ixfe:t,t:r}}function gee(e,t){var r={opts:{}},s={},n=t.dense?[]:{},i={},l={},o=null,c=[],u="",d={},h,f="",x,p,g,y,v={},j=[],b,w,k=[],N=[],S={Sheets:[],WBProps:{date1904:!1},Views:[{}]},_={},O=function(Le){return Le<8?dd[Le]:Le<64&&N[Le-8]||dd[Le]},E=function(Le,Je,Xe){var le=Je.XF.data;if(!(!le||!le.patternType||!Xe||!Xe.cellStyles)){Je.s={},Je.s.patternType=le.patternType;var Me;(Me=wf(O(le.icvFore)))&&(Je.s.fgColor={rgb:Me}),(Me=wf(O(le.icvBack)))&&(Je.s.bgColor={rgb:Me})}},R=function(Le,Je,Xe){if(!(G>1)&&!(Xe.sheetRows&&Le.r>=Xe.sheetRows)){if(Xe.cellStyles&&Je.XF&&Je.XF.data&&E(Le,Je,Xe),delete Je.ixfe,delete Je.XF,h=Le,f=Ht(Le),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),Le.r<l.s.r&&(l.s.r=Le.r),Le.c<l.s.c&&(l.s.c=Le.c),Le.r+1>l.e.r&&(l.e.r=Le.r+1),Le.c+1>l.e.c&&(l.e.c=Le.c+1),Xe.cellFormula&&Je.f){for(var le=0;le<j.length;++le)if(!(j[le][0].s.c>Le.c||j[le][0].s.r>Le.r)&&!(j[le][0].e.c<Le.c||j[le][0].e.r<Le.r)){Je.F=sr(j[le][0]),(j[le][0].s.c!=Le.c||j[le][0].s.r!=Le.r)&&delete Je.f,Je.f&&(Je.f=""+zs(j[le][1],l,Le,q,C));break}}Xe.dense?(n[Le.r]||(n[Le.r]=[]),n[Le.r][Le.c]=Je):n[f]=Je}},C={enc:!1,sbcch:0,snames:[],sharedf:v,arrayf:j,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(C.password=t.password);var I,ne=[],W=[],Q=[],H=[],K=!1,q=[];q.SheetNames=C.snames,q.sharedf=C.sharedf,q.arrayf=C.arrayf,q.names=[],q.XTI=[];var ge=0,G=0,B=0,se=[],L=[],Z;C.codepage=1200,Li(1200);for(var F=!1;e.l<e.length-1;){var he=e.l,ye=e.read_shift(2);if(ye===0&&ge===10)break;var z=e.l===e.length?0:e.read_shift(2),A=Gj[ye];if(A&&A.f){if(t.bookSheets&&ge===133&&ye!==133)break;if(ge=ye,A.r===2||A.r==12){var de=e.read_shift(2);if(z-=2,!C.enc&&de!==ye&&((de&255)<<8|de>>8)!==ye)throw new Error("rt mismatch: "+de+"!="+ye);A.r==12&&(e.l+=10,z-=10)}var D={};if(ye===10?D=A.f(e,z,C):D=pee(ye,A,e,z,C),G==0&&[9,521,1033,2057].indexOf(ge)===-1)continue;switch(ye){case 34:r.opts.Date1904=S.WBProps.date1904=D;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(C.enc||(e.l=0),C.enc=D,!t.password)throw new Error("File is password-protected");if(D.valid==null)throw new Error("Encryption scheme unsupported");if(!D.valid)throw new Error("Password is incorrect");break;case 92:C.lastuser=D;break;case 66:var ze=Number(D);switch(ze){case 21010:ze=1200;break;case 32768:ze=1e4;break;case 32769:ze=1252;break}Li(C.codepage=ze),F=!0;break;case 317:C.rrtabid=D;break;case 25:C.winlocked=D;break;case 439:r.opts.RefreshAll=D;break;case 12:r.opts.CalcCount=D;break;case 16:r.opts.CalcDelta=D;break;case 17:r.opts.CalcIter=D;break;case 13:r.opts.CalcMode=D;break;case 14:r.opts.CalcPrecision=D;break;case 95:r.opts.CalcSaveRecalc=D;break;case 15:C.CalcRefMode=D;break;case 2211:r.opts.FullCalc=D;break;case 129:D.fDialog&&(n["!type"]="dialog"),D.fBelow||((n["!outline"]||(n["!outline"]={})).above=!0),D.fRight||((n["!outline"]||(n["!outline"]={})).left=!0);break;case 224:k.push(D);break;case 430:q.push([D]),q[q.length-1].XTI=[];break;case 35:case 547:q[q.length-1].push(D);break;case 24:case 536:Z={Name:D.Name,Ref:zs(D.rgce,l,null,q,C)},D.itab>0&&(Z.Sheet=D.itab-1),q.names.push(Z),q[0]||(q[0]=[],q[0].XTI=[]),q[q.length-1].push(D),D.Name=="_xlnm._FilterDatabase"&&D.itab>0&&D.rgce&&D.rgce[0]&&D.rgce[0][0]&&D.rgce[0][0][0]=="PtgArea3d"&&(L[D.itab-1]={ref:sr(D.rgce[0][0][1][2])});break;case 22:C.ExternCount=D;break;case 23:q.length==0&&(q[0]=[],q[0].XTI=[]),q[q.length-1].XTI=q[q.length-1].XTI.concat(D),q.XTI=q.XTI.concat(D);break;case 2196:if(C.biff<8)break;Z!=null&&(Z.Comment=D[1]);break;case 18:n["!protect"]=D;break;case 19:D!==0&&C.WTF&&console.error("Password verifier: "+D);break;case 133:i[D.pos]=D,C.snames.push(D.name);break;case 10:{if(--G)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,n["!ref"]=sr(l),t.sheetRows&&t.sheetRows<=l.e.r){var Fe=l.e.r;l.e.r=t.sheetRows-1,n["!fullref"]=n["!ref"],n["!ref"]=sr(l),l.e.r=Fe}l.e.r++,l.e.c++}ne.length>0&&(n["!merges"]=ne),W.length>0&&(n["!objects"]=W),Q.length>0&&(n["!cols"]=Q),H.length>0&&(n["!rows"]=H),S.Sheets.push(_)}u===""?d=n:s[u]=n,n=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(C.biff===8&&(C.biff={9:2,521:3,1033:4}[ye]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[D.BIFFVer]||8),C.biffguess=D.BIFFVer==0,D.BIFFVer==0&&D.dt==4096&&(C.biff=5,F=!0,Li(C.codepage=28591)),C.biff==8&&D.BIFFVer==0&&D.dt==16&&(C.biff=2),G++)break;if(n=t.dense?[]:{},C.biff<8&&!F&&(F=!0,Li(C.codepage=t.codepage||1252)),C.biff<5||D.BIFFVer==0&&D.dt==4096){u===""&&(u="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var ct={pos:e.l-z,name:u};i[ct.pos]=ct,C.snames.push(u)}else u=(i[he]||{name:""}).name;D.dt==32&&(n["!type"]="chart"),D.dt==64&&(n["!type"]="macro"),ne=[],W=[],C.arrayf=j=[],Q=[],H=[],K=!1,_={Hidden:(i[he]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:n["!type"]=="chart"&&(t.dense?(n[D.r]||[])[D.c]:n[Ht({c:D.c,r:D.r})])&&++D.c,b={ixfe:D.ixfe,XF:k[D.ixfe]||{},v:D.val,t:"n"},B>0&&(b.z=se[b.ixfe>>8&63]),tl(b,t,r.opts.Date1904),R({c:D.c,r:D.r},b,t);break;case 5:case 517:b={ixfe:D.ixfe,XF:k[D.ixfe],v:D.val,t:D.t},B>0&&(b.z=se[b.ixfe>>8&63]),tl(b,t,r.opts.Date1904),R({c:D.c,r:D.r},b,t);break;case 638:b={ixfe:D.ixfe,XF:k[D.ixfe],v:D.rknum,t:"n"},B>0&&(b.z=se[b.ixfe>>8&63]),tl(b,t,r.opts.Date1904),R({c:D.c,r:D.r},b,t);break;case 189:for(var $e=D.c;$e<=D.C;++$e){var We=D.rkrec[$e-D.c][0];b={ixfe:We,XF:k[We],v:D.rkrec[$e-D.c][1],t:"n"},B>0&&(b.z=se[b.ixfe>>8&63]),tl(b,t,r.opts.Date1904),R({c:$e,r:D.r},b,t)}break;case 6:case 518:case 1030:{if(D.val=="String"){o=D;break}if(b=bm(D.val,D.cell.ixfe,D.tt),b.XF=k[b.ixfe],t.cellFormula){var Bt=D.formula;if(Bt&&Bt[0]&&Bt[0][0]&&Bt[0][0][0]=="PtgExp"){var Ee=Bt[0][0][1][0],it=Bt[0][0][1][1],we=Ht({r:Ee,c:it});v[we]?b.f=""+zs(D.formula,l,D.cell,q,C):b.F=((t.dense?(n[Ee]||[])[it]:n[we])||{}).F}else b.f=""+zs(D.formula,l,D.cell,q,C)}B>0&&(b.z=se[b.ixfe>>8&63]),tl(b,t,r.opts.Date1904),R(D.cell,b,t),o=D}break;case 7:case 519:if(o)o.val=D,b=bm(D,o.cell.ixfe,"s"),b.XF=k[b.ixfe],t.cellFormula&&(b.f=""+zs(o.formula,l,o.cell,q,C)),B>0&&(b.z=se[b.ixfe>>8&63]),tl(b,t,r.opts.Date1904),R(o.cell,b,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{j.push(D);var et=Ht(D[0].s);if(x=t.dense?(n[D[0].s.r]||[])[D[0].s.c]:n[et],t.cellFormula&&x){if(!o||!et||!x)break;x.f=""+zs(D[1],l,D[0],q,C),x.F=sr(D[0])}}break;case 1212:{if(!t.cellFormula)break;if(f){if(!o)break;v[Ht(o.cell)]=D[0],x=t.dense?(n[o.cell.r]||[])[o.cell.c]:n[Ht(o.cell)],(x||{}).f=""+zs(D[0],l,h,q,C)}}break;case 253:b=bm(c[D.isst].t,D.ixfe,"s"),c[D.isst].h&&(b.h=c[D.isst].h),b.XF=k[b.ixfe],B>0&&(b.z=se[b.ixfe>>8&63]),tl(b,t,r.opts.Date1904),R({c:D.c,r:D.r},b,t);break;case 513:t.sheetStubs&&(b={ixfe:D.ixfe,XF:k[D.ixfe],t:"z"},B>0&&(b.z=se[b.ixfe>>8&63]),tl(b,t,r.opts.Date1904),R({c:D.c,r:D.r},b,t));break;case 190:if(t.sheetStubs)for(var Ge=D.c;Ge<=D.C;++Ge){var Nt=D.ixfe[Ge-D.c];b={ixfe:Nt,XF:k[Nt],t:"z"},B>0&&(b.z=se[b.ixfe>>8&63]),tl(b,t,r.opts.Date1904),R({c:Ge,r:D.r},b,t)}break;case 214:case 516:case 4:b=bm(D.val,D.ixfe,"s"),b.XF=k[b.ixfe],B>0&&(b.z=se[b.ixfe>>8&63]),tl(b,t,r.opts.Date1904),R({c:D.c,r:D.r},b,t);break;case 0:case 512:G===1&&(l=D);break;case 252:c=D;break;case 1054:if(C.biff==4){se[B++]=D[1];for(var Rt=0;Rt<B+163&&Wt[Rt]!=D[1];++Rt);Rt>=163&&Kl(D[1],B+163)}else Kl(D[1],D[0]);break;case 30:{se[B++]=D;for(var pr=0;pr<B+163&&Wt[pr]!=D;++pr);pr>=163&&Kl(D,B+163)}break;case 229:ne=ne.concat(D);break;case 93:W[D.cmo[0]]=C.lastobj=D;break;case 438:C.lastobj.TxO=D;break;case 127:C.lastobj.ImData=D;break;case 440:for(y=D[0].s.r;y<=D[0].e.r;++y)for(g=D[0].s.c;g<=D[0].e.c;++g)x=t.dense?(n[y]||[])[g]:n[Ht({c:g,r:y})],x&&(x.l=D[1]);break;case 2048:for(y=D[0].s.r;y<=D[0].e.r;++y)for(g=D[0].s.c;g<=D[0].e.c;++g)x=t.dense?(n[y]||[])[g]:n[Ht({c:g,r:y})],x&&x.l&&(x.l.Tooltip=D[1]);break;case 28:{if(C.biff<=5&&C.biff>=2)break;x=t.dense?(n[D[0].r]||[])[D[0].c]:n[Ht(D[0])];var Zt=W[D[2]];x||(t.dense?(n[D[0].r]||(n[D[0].r]=[]),x=n[D[0].r][D[0].c]={t:"z"}):x=n[Ht(D[0])]={t:"z"},l.e.r=Math.max(l.e.r,D[0].r),l.s.r=Math.min(l.s.r,D[0].r),l.e.c=Math.max(l.e.c,D[0].c),l.s.c=Math.min(l.s.c,D[0].c)),x.c||(x.c=[]),p={a:D[1],t:Zt.TxO.t},x.c.push(p)}break;case 2173:sQ(k[D.ixfe],D.ext);break;case 125:{if(!C.cellStyles)break;for(;D.e>=D.s;)Q[D.e--]={width:D.w/256,level:D.level||0,hidden:!!(D.flags&1)},K||(K=!0,D2(D.w/256)),mc(Q[D.e+1])}break;case 520:{var er={};D.level!=null&&(H[D.r]=er,er.level=D.level),D.hidden&&(H[D.r]=er,er.hidden=!0),D.hpt&&(H[D.r]=er,er.hpt=D.hpt,er.hpx=f0(D.hpt))}break;case 38:case 39:case 40:case 41:n["!margins"]||fd(n["!margins"]={}),n["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ye]]=D;break;case 161:n["!margins"]||fd(n["!margins"]={}),n["!margins"].header=D.header,n["!margins"].footer=D.footer;break;case 574:D.RTL&&(S.Views[0].RTL=!0);break;case 146:N=D;break;case 2198:I=D;break;case 140:w=D;break;case 442:u?_.CodeName=D||_.name:S.WBProps.CodeName=D||"ThisWorkbook";break}}else A||console.error("Missing Info for XLS Record 0x"+ye.toString(16)),e.l+=z}return r.SheetNames=Oa(i).sort(function(ue,Le){return Number(ue)-Number(Le)}).map(function(ue){return i[ue].name}),t.bookSheets||(r.Sheets=s),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&L.forEach(function(ue,Le){r.Sheets[r.SheetNames[Le]]["!autofilter"]=ue}),r.Strings=c,r.SSF=sa(Wt),C.enc&&(r.Encryption=C.enc),I&&(r.Themes=I),r.Metadata={},w!==void 0&&(r.Metadata.Country=w),q.names.length>0&&(S.Names=q.names),r.Workbook=S,r}var Vh={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function yee(e,t,r){var s=$t.find(e,"/!DocumentSummaryInformation");if(s&&s.size>0)try{var n=B4(s,zj,Vh.DSI);for(var i in n)t[i]=n[i]}catch(u){if(r.WTF)throw u}var l=$t.find(e,"/!SummaryInformation");if(l&&l.size>0)try{var o=B4(l,Uj,Vh.SI);for(var c in o)t[c]==null&&(t[c]=o[c])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(GI(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function vee(e,t){var r=[],s=[],n=[],i=0,l,o=p4(zj,"n"),c=p4(Uj,"n");if(e.Props)for(l=Oa(e.Props),i=0;i<l.length;++i)(Object.prototype.hasOwnProperty.call(o,l[i])?r:Object.prototype.hasOwnProperty.call(c,l[i])?s:n).push([l[i],e.Props[l[i]]]);if(e.Custprops)for(l=Oa(e.Custprops),i=0;i<l.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},l[i])||(Object.prototype.hasOwnProperty.call(o,l[i])?r:Object.prototype.hasOwnProperty.call(c,l[i])?s:n).push([l[i],e.Custprops[l[i]]]);var u=[];for(i=0;i<n.length;++i)tO.indexOf(n[i][0])>-1||KI.indexOf(n[i][0])>-1||n[i][1]!=null&&u.push(n[i]);s.length&&$t.utils.cfb_add(t,"/SummaryInformation",z4(s,Vh.SI,c,Uj)),(r.length||u.length)&&$t.utils.cfb_add(t,"/DocumentSummaryInformation",z4(r,Vh.DSI,o,zj,u.length?u:null,Vh.UDI))}function XO(e,t){t||(t={}),W2(t),d2(),t.codepage&&c2(t.codepage);var r,s;if(e.FullPaths){if($t.find(e,"/encryption"))throw new Error("File is password-protected");r=$t.find(e,"!CompObj"),s=$t.find(e,"/Workbook")||$t.find(e,"/Book")}else{switch(t.type){case"base64":e=zn(Qn(e));break;case"binary":e=zn(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Ps(e,0),s={content:e}}var n,i;if(r&&xee(r),t.bookProps&&!t.bookSheets)n={};else{var l=cr?"buffer":"array";if(s&&s.content)n=gee(s.content,t);else if((i=$t.find(e,"PerfectOffice_MAIN"))&&i.content)n=hd.to_workbook(i.content,(t.type=l,t));else if((i=$t.find(e,"NativeContent_MAIN"))&&i.content)n=hd.to_workbook(i.content,(t.type=l,t));else throw(i=$t.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&$t.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(n.vbaraw=IQ(e))}var o={};return e.FullPaths&&yee(e,o,t),n.Props=n.Custprops=o,t.bookFiles&&(n.cfb=e),n}function bee(e,t){var r=t||{},s=$t.utils.cfb_new({root:"R"}),n="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":n="/Workbook",r.biff=8;break;case"biff5":n="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return $t.utils.cfb_add(s,n,YO(e,r)),r.biff==8&&(e.Props||e.Custprops)&&vee(e,s),r.biff==8&&e.vbaraw&&OQ(s,$t.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),s}var Cf={0:{f:VY},1:{f:JY},2:{f:gJ},3:{f:iJ},4:{f:rJ},5:{f:xJ},6:{f:wJ},7:{f:dJ},8:{f:AJ},9:{f:PJ},10:{f:CJ},11:{f:EJ},12:{f:eJ},13:{f:vJ},14:{f:oJ},15:{f:sJ},16:{f:UO},17:{f:SJ},18:{f:hJ},19:{f:S2},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:SZ},40:{},42:{},43:{f:wG},44:{f:bG},45:{f:kG},46:{f:EG},47:{f:CG},48:{},49:{f:KV},50:{},51:{f:lQ},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:hO},62:{f:jJ},63:{f:pQ},64:{f:HJ},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Ys,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:zJ},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:XY},148:{f:KY,p:16},151:{f:FJ},152:{},153:{f:jZ},154:{},155:{},156:{f:vZ},157:{},158:{},159:{T:1,f:MK},160:{T:-1},161:{T:1,f:Xd},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:_J},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:nQ},336:{T:-1},337:{f:dQ,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Bj},357:{},358:{},359:{},360:{T:1},361:{},362:{f:uO},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:RJ},427:{f:MJ},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:$J},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:QY},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:OJ},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Bj},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:EQ},633:{T:1},634:{T:-1},635:{T:1,f:kQ},636:{T:-1},637:{f:YV},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:oZ},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:qJ},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Gj={6:{f:Db},10:{f:Po},12:{f:Va},13:{f:Va},14:{f:Da},15:{f:Da},16:{f:qs},17:{f:Da},18:{f:Da},19:{f:Va},20:{f:K4},21:{f:K4},23:{f:uO},24:{f:Q4},25:{f:Da},26:{},27:{},28:{f:qq},29:{},34:{f:Da},35:{f:G4},38:{f:qs},39:{f:qs},40:{f:qs},41:{f:qs},42:{f:Da},43:{f:Da},47:{f:sG},49:{f:vq},51:{f:Va},60:{},61:{f:xq},64:{f:Da},65:{f:yq},66:{f:Va},77:{},80:{},81:{},82:{},85:{f:Va},89:{},90:{},91:{},92:{f:aq},93:{f:Qq},94:{},95:{f:Da},96:{},97:{},99:{f:Da},125:{f:hO},128:{f:Dq},129:{f:nq},130:{f:Va},131:{f:Da},132:{f:Da},133:{f:iq},134:{},140:{f:aK},141:{f:Va},144:{},146:{f:iK},151:{},152:{},153:{},154:{},155:{},156:{f:Va},157:{},158:{},160:{f:fK},161:{f:cK},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:_q},190:{f:Tq},193:{f:Po},197:{},198:{},199:{},200:{},201:{},202:{f:Da},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Va},220:{},221:{f:Da},222:{},224:{f:Oq},225:{f:rq},226:{f:Po},227:{},229:{f:Kq},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:oq},253:{f:jq},255:{f:dq},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:rO},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Da},353:{f:Po},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:$q},431:{f:Da},432:{},433:{},434:{},437:{},438:{f:Jq},439:{f:Da},440:{f:Zq},441:{},442:{f:dx},443:{},444:{f:Va},445:{},446:{},448:{f:Po},449:{f:fq,r:2},450:{f:Po},512:{f:V4},513:{f:hK},515:{f:Mq},516:{f:Nq},517:{f:q4},519:{f:xK},520:{f:uq},523:{},545:{f:X4},549:{f:W4},566:{},574:{f:pq},638:{f:Aq},659:{},1048:{},1054:{f:kq},1084:{},1212:{f:Wq},2048:{f:tK},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:gm},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Po},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:lK,r:12},2173:{f:aQ,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Da,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:Uq,r:12},2197:{},2198:{f:YG,r:12},2199:{},2200:{},2201:{},2202:{f:Vq,r:12},2203:{f:Po},2204:{},2205:{},2206:{},2207:{},2211:{f:hq},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Va},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:dK},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:nK},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:V4},1:{},2:{f:vK},3:{f:gK},4:{f:pK},5:{f:q4},7:{f:jK},8:{},9:{f:gm},11:{},22:{f:Va},30:{f:Eq},31:{},32:{},33:{f:X4},36:{},37:{f:W4},50:{f:wK},62:{},52:{},67:{},68:{f:Va},69:{},86:{},126:{},127:{f:mK},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:NK},223:{},234:{},354:{},421:{},518:{f:Db},521:{f:gm},536:{f:Q4},547:{f:G4},561:{},579:{},1030:{f:Db},1033:{f:gm},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function mt(e,t,r,s){var n=t;if(!isNaN(n)){var i=s||(r||[]).length||0,l=e.next(4);l.write_shift(2,n),l.write_shift(2,i),i>0&&j2(r)&&e.push(r)}}function jee(e,t,r,s){var n=(r||[]).length||0;if(n<=8224)return mt(e,t,r,n);var i=t;if(!isNaN(i)){for(var l=r.parts||[],o=0,c=0,u=0;u+(l[o]||8224)<=8224;)u+=l[o]||8224,o++;var d=e.next(4);for(d.write_shift(2,i),d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u;c<n;){for(d=e.next(4),d.write_shift(2,60),u=0;u+(l[o]||8224)<=8224;)u+=l[o]||8224,o++;d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u}}}function xx(e,t,r){return e||(e=He(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function wee(e,t,r,s){var n=He(9);return xx(n,e,t),aO(r,s||"b",n),n}function Nee(e,t,r){var s=He(8+2*r.length);return xx(s,e,t),s.write_shift(1,r.length),s.write_shift(r.length,r,"sbcs"),s.l<s.length?s.slice(0,s.l):s}function See(e,t,r,s){if(t.v!=null)switch(t.t){case"d":case"n":var n=t.t=="d"?rs(aa(t.v)):t.v;n==(n|0)&&n>=0&&n<65536?mt(e,2,bK(r,s,n)):mt(e,3,yK(r,s,n));return;case"b":case"e":mt(e,5,wee(r,s,t.v,t.t));return;case"s":case"str":mt(e,4,Nee(r,s,(t.v||"").slice(0,255)));return}mt(e,1,xx(null,r,s))}function kee(e,t,r,s){var n=Array.isArray(t),i=Nr(t["!ref"]||"A1"),l,o="",c=[];if(i.e.c>255||i.e.r>16383){if(s.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),l=sr(i)}for(var u=i.s.r;u<=i.e.r;++u){o=Ma(u);for(var d=i.s.c;d<=i.e.c;++d){u===i.s.r&&(c[d]=va(d)),l=c[d]+o;var h=n?(t[u]||[])[d]:t[l];h&&See(e,h,u,d)}}}function Cee(e,t){for(var r=t||{},s=In(),n=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(n=i);if(n==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return mt(s,r.biff==4?1033:r.biff==3?521:9,T2(e,16,r)),kee(s,e.Sheets[e.SheetNames[n]],n,r),mt(s,10),s.end()}function Eee(e,t,r){mt(e,49,bq({sz:12,name:"Arial"},r))}function Pee(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var n=s[0];n<=s[1];++n)t[n]!=null&&mt(e,1054,Cq(n,t[n],r))})}function Aee(e,t){var r=He(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),mt(e,2151,r),r=He(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),oO(Nr(t["!ref"]||"A1"),r),r.write_shift(4,4),mt(e,2152,r)}function _ee(e,t){for(var r=0;r<16;++r)mt(e,224,H4({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(s){mt(e,224,H4(s,0,t))})}function Tee(e,t){for(var r=0;r<t["!links"].length;++r){var s=t["!links"][r];mt(e,440,eK(s)),s[1].Tooltip&&mt(e,2048,rK(s))}delete t["!links"]}function Iee(e,t){if(t){var r=0;t.forEach(function(s,n){++r<=256&&s&&mt(e,125,oK(Oy(n,s),n))})}}function Oee(e,t,r,s,n){var i=16+Pc(n.cellXfs,t,n);if(t.v==null&&!t.bf){mt(e,513,Id(r,s,i));return}if(t.bf)mt(e,6,nY(t,r,s,n,i));else switch(t.t){case"d":case"n":var l=t.t=="d"?rs(aa(t.v)):t.v;mt(e,515,Lq(r,s,l,i));break;case"b":case"e":mt(e,517,Rq(r,s,t.v,i,n,t.t));break;case"s":case"str":if(n.bookSST){var o=$2(n.Strings,t.v,n.revStrings);mt(e,253,wq(r,s,o,i))}else mt(e,516,Sq(r,s,(t.v||"").slice(0,255),i,n));break;default:mt(e,513,Id(r,s,i))}}function Dee(e,t,r){var s=In(),n=r.SheetNames[e],i=r.Sheets[n]||{},l=(r||{}).Workbook||{},o=(l.Sheets||[])[e]||{},c=Array.isArray(i),u=t.biff==8,d,h="",f=[],x=Nr(i["!ref"]||"A1"),p=u?65536:16384;if(x.e.c>255||x.e.r>=p){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");x.e.c=Math.min(x.e.c,255),x.e.r=Math.min(x.e.c,p-1)}mt(s,2057,T2(r,16,t)),mt(s,13,ci(1)),mt(s,12,ci(100)),mt(s,15,ln(!0)),mt(s,17,ln(!1)),mt(s,16,_d(.001)),mt(s,95,ln(!0)),mt(s,42,ln(!1)),mt(s,43,ln(!1)),mt(s,130,ci(1)),mt(s,128,Fq()),mt(s,131,ln(!1)),mt(s,132,ln(!1)),u&&Iee(s,i["!cols"]),mt(s,512,Pq(x,t)),u&&(i["!links"]=[]);for(var g=x.s.r;g<=x.e.r;++g){h=Ma(g);for(var y=x.s.c;y<=x.e.c;++y){g===x.s.r&&(f[y]=va(y)),d=f[y]+h;var v=c?(i[g]||[])[y]:i[d];v&&(Oee(s,v,g,y,t),u&&v.l&&i["!links"].push([d,v.l]))}}var j=o.CodeName||o.name||n;return u&&mt(s,574,gq((l.Views||[])[0])),u&&(i["!merges"]||[]).length&&mt(s,229,Gq(i["!merges"])),u&&Tee(s,i),mt(s,442,sO(j)),u&&Aee(s,i),mt(s,10),s.end()}function Fee(e,t,r){var s=In(),n=(e||{}).Workbook||{},i=n.Sheets||[],l=n.WBProps||{},o=r.biff==8,c=r.biff==5;if(mt(s,2057,T2(e,5,r)),r.bookType=="xla"&&mt(s,135),mt(s,225,o?ci(1200):null),mt(s,193,RH(2)),c&&mt(s,191),c&&mt(s,192),mt(s,226),mt(s,92,sq("SheetJS",r)),mt(s,66,ci(o?1200:1252)),o&&mt(s,353,ci(0)),o&&mt(s,448),mt(s,317,uK(e.SheetNames.length)),o&&e.vbaraw&&mt(s,211),o&&e.vbaraw){var u=l.CodeName||"ThisWorkbook";mt(s,442,sO(u))}mt(s,156,ci(17)),mt(s,25,ln(!1)),mt(s,18,ln(!1)),mt(s,19,ci(0)),o&&mt(s,431,ln(!1)),o&&mt(s,444,ci(0)),mt(s,61,mq()),mt(s,64,ln(!1)),mt(s,141,ci(0)),mt(s,34,ln(fZ(e)=="true")),mt(s,14,ln(!0)),o&&mt(s,439,ln(!1)),mt(s,218,ci(0)),Eee(s,e,r),Pee(s,e.SSF,r),_ee(s,r),o&&mt(s,352,ln(!1));var d=s.end(),h=In();o&&mt(h,140,sK()),o&&r.Strings&&jee(h,252,cq(r.Strings)),mt(h,10);var f=h.end(),x=In(),p=0,g=0;for(g=0;g<e.SheetNames.length;++g)p+=(o?12:11)+(o?2:1)*e.SheetNames[g].length;var y=d.length+p+f.length;for(g=0;g<e.SheetNames.length;++g){var v=i[g]||{};mt(x,133,lq({pos:y,hs:v.Hidden||0,dt:0,name:e.SheetNames[g]},r)),y+=t[g].length}var j=x.end();if(p!=j.length)throw new Error("BS8 "+p+" != "+j.length);var b=[];return d.length&&b.push(d),j.length&&b.push(j),f.length&&b.push(f),ps(b)}function Ree(e,t){var r=t||{},s=[];e&&!e.SSF&&(e.SSF=sa(Wt)),e&&e.SSF&&(D0(),Cy(e.SSF),r.revssf=Py(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,V2(r),r.cellXfs=[],Pc(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var n=0;n<e.SheetNames.length;++n)s[s.length]=Dee(n,r,e);return s.unshift(Fee(e,s,r)),ps(s)}function YO(e,t){for(var r=0;r<=e.SheetNames.length;++r){var s=e.Sheets[e.SheetNames[r]];if(!(!s||!s["!ref"])){var n=Dn(s["!ref"]);n.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return Ree(e,t);case 4:case 3:case 2:return Cee(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function iE(e,t){var r=t||{},s=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var n=e.match(/<table/i);if(!n)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),l=n.index,o=i&&i.index||e.length,c=bV(e.slice(l,o),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,d=0,h=0,f=0,x={s:{r:1e7,c:1e7},e:{r:0,c:0}},p=[];for(l=0;l<c.length;++l){var g=c[l].trim(),y=g.slice(0,3).toLowerCase();if(y=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}d=0;continue}if(!(y!="<td"&&y!="<th")){var v=g.split(/<\/t[dh]>/i);for(o=0;o<v.length;++o){var j=v[o].trim();if(j.match(/<t[dh]/i)){for(var b=j,w=0;b.charAt(0)=="<"&&(w=b.indexOf(">"))>-1;)b=b.slice(w+1);for(var k=0;k<p.length;++k){var N=p[k];N.s.c==d&&N.s.r<u&&u<=N.e.r&&(d=N.e.c+1,k=-1)}var S=Kt(j.slice(0,j.indexOf(">")));f=S.colspan?+S.colspan:1,((h=+S.rowspan)>1||f>1)&&p.push({s:{r:u,c:d},e:{r:u+(h||1)-1,c:d+f-1}});var _=S.t||S["data-t"]||"";if(!b.length){d+=f;continue}if(b=jI(b),x.s.r>u&&(x.s.r=u),x.e.r<u&&(x.e.r=u),x.s.c>d&&(x.s.c=d),x.e.c<d&&(x.e.c=d),!b.length){d+=f;continue}var O={t:"s",v:b};r.raw||!b.trim().length||_=="s"||(b==="TRUE"?O={t:"b",v:!0}:b==="FALSE"?O={t:"b",v:!1}:isNaN(Ui(b))?isNaN(u0(b).getDate())||(O={t:"d",v:aa(b)},r.cellDates||(O={t:"n",v:rs(O.v)}),O.z=r.dateNF||Wt[14]):O={t:"n",v:Ui(b)}),r.dense?(s[u]||(s[u]=[]),s[u][d]=O):s[Ht({r:u,c:d})]=O,d+=f}}}}return s["!ref"]=sr(x),p.length&&(s["!merges"]=p),s}function Mee(e,t,r,s){for(var n=e["!merges"]||[],i=[],l=t.s.c;l<=t.e.c;++l){for(var o=0,c=0,u=0;u<n.length;++u)if(!(n[u].s.r>r||n[u].s.c>l)&&!(n[u].e.r<r||n[u].e.c<l)){if(n[u].s.r<r||n[u].s.c<l){o=-1;break}o=n[u].e.r-n[u].s.r+1,c=n[u].e.c-n[u].s.c+1;break}if(!(o<0)){var d=Ht({r,c:l}),h=s.dense?(e[r]||[])[l]:e[d],f=h&&h.v!=null&&(h.h||y2(h.w||(no(h),h.w)||""))||"",x={};o>1&&(x.rowspan=o),c>1&&(x.colspan=c),s.editable?f='<span contenteditable="true">'+f+"</span>":h&&(x["data-t"]=h&&h.t||"z",h.v!=null&&(x["data-v"]=h.v),h.z!=null&&(x["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(f='<a href="'+h.l.Target+'">'+f+"</a>")),x.id=(s.id||"sjs")+"-"+d,i.push(xt("td",f,x))}}var p="<tr>";return p+i.join("")+"</tr>"}var Lee='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',$ee="</body></html>";function Bee(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Ec(iE(r[0],t),t);var s=K2();return r.forEach(function(n,i){G2(s,iE(n,t),"Sheet"+(i+1))}),s}function zee(e,t,r){var s=[];return s.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function JO(e,t){var r=t||{},s=r.header!=null?r.header:Lee,n=r.footer!=null?r.footer:$ee,i=[s],l=Dn(e["!ref"]);r.dense=Array.isArray(e),i.push(zee(e,l,r));for(var o=l.s.r;o<=l.e.r;++o)i.push(Mee(e,l,o,r));return i.push("</table>"+n),i.join("")}function ZO(e,t,r){var s=r||{},n=0,i=0;if(s.origin!=null)if(typeof s.origin=="number")n=s.origin;else{var l=typeof s.origin=="string"?ba(s.origin):s.origin;n=l.r,i=l.c}var o=t.getElementsByTagName("tr"),c=Math.min(s.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:n,c:i}};if(e["!ref"]){var d=Dn(e["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),n==-1&&(u.e.r=n=d.e.r+1)}var h=[],f=0,x=e["!rows"]||(e["!rows"]=[]),p=0,g=0,y=0,v=0,j=0,b=0;for(e["!cols"]||(e["!cols"]=[]);p<o.length&&g<c;++p){var w=o[p];if(lE(w)){if(s.display)continue;x[g]={hidden:!0}}var k=w.children;for(y=v=0;y<k.length;++y){var N=k[y];if(!(s.display&&lE(N))){var S=N.hasAttribute("data-v")?N.getAttribute("data-v"):N.hasAttribute("v")?N.getAttribute("v"):jI(N.innerHTML),_=N.getAttribute("data-z")||N.getAttribute("z");for(f=0;f<h.length;++f){var O=h[f];O.s.c==v+i&&O.s.r<g+n&&g+n<=O.e.r&&(v=O.e.c+1-i,f=-1)}b=+N.getAttribute("colspan")||1,((j=+N.getAttribute("rowspan")||1)>1||b>1)&&h.push({s:{r:g+n,c:v+i},e:{r:g+n+(j||1)-1,c:v+i+(b||1)-1}});var E={t:"s",v:S},R=N.getAttribute("data-t")||N.getAttribute("t")||"";S!=null&&(S.length==0?E.t=R||"z":s.raw||S.trim().length==0||R=="s"||(S==="TRUE"?E={t:"b",v:!0}:S==="FALSE"?E={t:"b",v:!1}:isNaN(Ui(S))?isNaN(u0(S).getDate())||(E={t:"d",v:aa(S)},s.cellDates||(E={t:"n",v:rs(E.v)}),E.z=s.dateNF||Wt[14]):E={t:"n",v:Ui(S)})),E.z===void 0&&_!=null&&(E.z=_);var C="",I=N.getElementsByTagName("A");if(I&&I.length)for(var ne=0;ne<I.length&&!(I[ne].hasAttribute("href")&&(C=I[ne].getAttribute("href"),C.charAt(0)!="#"));++ne);C&&C.charAt(0)!="#"&&(E.l={Target:C}),s.dense?(e[g+n]||(e[g+n]=[]),e[g+n][v+i]=E):e[Ht({c:v+i,r:g+n})]=E,u.e.c<v+i&&(u.e.c=v+i),v+=b}}++g}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),u.e.r=Math.max(u.e.r,g-1+n),e["!ref"]=sr(u),g>=c&&(e["!fullref"]=sr((u.e.r=o.length-p+g-1+n,u))),e}function eD(e,t){var r=t||{},s=r.dense?[]:{};return ZO(s,e,t)}function Uee(e,t){return Ec(eD(e,t),t)}function lE(e){var t="",r=Wee(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function Wee(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Vee(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(s,n){return Array(parseInt(n,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=wr(t.replace(/<[^>]*>/g,""));return[r]}var oE={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function tD(e,t){var r=t||{},s=v2(e),n=[],i,l,o={name:""},c="",u=0,d,h,f={},x=[],p=r.dense?[]:{},g,y,v={value:""},j="",b=0,w=[],k=-1,N=-1,S={s:{r:1e6,c:1e7},e:{r:0,c:0}},_=0,O={},E=[],R={},C=0,I=0,ne=[],W=1,Q=1,H=[],K={Names:[]},q={},ge=["",""],G=[],B={},se="",L=0,Z=!1,F=!1,he=0;for(bf.lastIndex=0,s=s.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");g=bf.exec(s);)switch(g[3]=g[3].replace(/_.*$/,"")){case"table":case"":g[1]==="/"?(S.e.c>=S.s.c&&S.e.r>=S.s.r?p["!ref"]=sr(S):p["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=S.e.r&&(p["!fullref"]=p["!ref"],S.e.r=r.sheetRows-1,p["!ref"]=sr(S)),E.length&&(p["!merges"]=E),ne.length&&(p["!rows"]=ne),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),x.push(d.name),f[d.name]=p,F=!1):g[0].charAt(g[0].length-2)!=="/"&&(d=Kt(g[0],!1),k=N=-1,S.s.r=S.s.c=1e7,S.e.r=S.e.c=0,p=r.dense?[]:{},E=[],ne=[],F=!0);break;case"table-row-group":g[1]==="/"?--_:++_;break;case"table-row":case"":if(g[1]==="/"){k+=W,W=1;break}if(h=Kt(g[0],!1),h.?k=h.-1:k==-1&&(k=0),W=+h["number-rows-repeated"]||1,W<10)for(he=0;he<W;++he)_>0&&(ne[k+he]={level:_});N=-1;break;case"covered-table-cell":g[1]!=="/"&&++N,r.sheetStubs&&(r.dense?(p[k]||(p[k]=[]),p[k][N]={t:"z"}):p[Ht({r:k,c:N})]={t:"z"}),j="",w=[];break;case"table-cell":case"":if(g[0].charAt(g[0].length-2)==="/")++N,v=Kt(g[0],!1),Q=parseInt(v["number-columns-repeated"]||"1",10),y={t:"z",v:null},v.formula&&r.cellFormula!=!1&&(y.f=aE(wr(v.formula))),(v.||v["value-type"])=="string"&&(y.t="s",y.v=wr(v["string-value"]||""),r.dense?(p[k]||(p[k]=[]),p[k][N]=y):p[Ht({r:k,c:N})]=y),N+=Q-1;else if(g[1]!=="/"){++N,j="",b=0,w=[],Q=1;var ye=W?k+W-1:k;if(N>S.e.c&&(S.e.c=N),N<S.s.c&&(S.s.c=N),k<S.s.r&&(S.s.r=k),ye>S.e.r&&(S.e.r=ye),v=Kt(g[0],!1),G=[],B={},y={t:v.||v["value-type"],v:null},r.cellFormula)if(v.formula&&(v.formula=wr(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(C=parseInt(v["number-matrix-rows-spanned"],10)||0,I=parseInt(v["number-matrix-columns-spanned"],10)||0,R={s:{r:k,c:N},e:{r:k+C-1,c:N+I-1}},y.F=sr(R),H.push([R,y.F])),v.formula)y.f=aE(v.formula);else for(he=0;he<H.length;++he)k>=H[he][0].s.r&&k<=H[he][0].e.r&&N>=H[he][0].s.c&&N<=H[he][0].e.c&&(y.F=H[he][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(C=parseInt(v["number-rows-spanned"],10)||0,I=parseInt(v["number-columns-spanned"],10)||0,R={s:{r:k,c:N},e:{r:k+C-1,c:N+I-1}},E.push(R)),v["number-columns-repeated"]&&(Q=parseInt(v["number-columns-repeated"],10)),y.t){case"boolean":y.t="b",y.v=ta(v["boolean-value"]);break;case"float":y.t="n",y.v=parseFloat(v.value);break;case"percentage":y.t="n",y.v=parseFloat(v.value);break;case"currency":y.t="n",y.v=parseFloat(v.value);break;case"date":y.t="d",y.v=aa(v["date-value"]),r.cellDates||(y.t="n",y.v=rs(y.v)),y.z="m/d/yy";break;case"time":y.t="n",y.v=gV(v["time-value"])/86400,r.cellDates&&(y.t="d",y.v=Ay(y.v)),y.z="HH:MM:SS";break;case"number":y.t="n",y.v=parseFloat(v.);break;default:if(y.t==="string"||y.t==="text"||!y.t)y.t="s",v["string-value"]!=null&&(j=wr(v["string-value"]),w=[]);else throw new Error("Unsupported value type "+y.t)}}else{if(Z=!1,y.t==="s"&&(y.v=j||"",w.length&&(y.R=w),Z=b==0),q.Target&&(y.l=q),G.length>0&&(y.c=G,G=[]),j&&r.cellText!==!1&&(y.w=j),Z&&(y.t="z",delete y.v),(!Z||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=k))for(var z=0;z<W;++z){if(Q=parseInt(v["number-columns-repeated"]||"1",10),r.dense)for(p[k+z]||(p[k+z]=[]),p[k+z][N]=z==0?y:sa(y);--Q>0;)p[k+z][N+Q]=sa(y);else for(p[Ht({r:k+z,c:N})]=y;--Q>0;)p[Ht({r:k+z,c:N+Q})]=sa(y);S.e.c<=N&&(S.e.c=N)}Q=parseInt(v["number-columns-repeated"]||"1",10),N+=Q-1,Q=0,y={},j="",w=[]}q={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(g[1]==="/"){if((i=n.pop())[0]!==g[3])throw"Bad state: "+i}else g[0].charAt(g[0].length-2)!=="/"&&n.push([g[3],!0]);break;case"annotation":if(g[1]==="/"){if((i=n.pop())[0]!==g[3])throw"Bad state: "+i;B.t=j,w.length&&(B.R=w),B.a=se,G.push(B)}else g[0].charAt(g[0].length-2)!=="/"&&n.push([g[3],!1]);se="",L=0,j="",b=0,w=[];break;case"creator":g[1]==="/"?se=s.slice(L,g.index):L=g.index+g[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(g[1]==="/"){if((i=n.pop())[0]!==g[3])throw"Bad state: "+i}else g[0].charAt(g[0].length-2)!=="/"&&n.push([g[3],!1]);j="",b=0,w=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(g[1]==="/"){if(O[o.name]=c,(i=n.pop())[0]!==g[3])throw"Bad state: "+i}else g[0].charAt(g[0].length-2)!=="/"&&(c="",o=Kt(g[0],!1),n.push([g[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(n[n.length-1][0]){case"time-style":case"date-style":l=Kt(g[0],!1),c+=oE[g[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(n[n.length-1][0]){case"time-style":case"date-style":l=Kt(g[0],!1),c+=oE[g[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(g[0].slice(-2)==="/>")break;if(g[1]==="/")switch(n[n.length-1][0]){case"number-style":case"date-style":case"time-style":c+=s.slice(u,g.index);break}else u=g.index+g[0].length;break;case"named-range":l=Kt(g[0],!1),ge=Fb(l["cell-range-address"]);var A={Name:l.name,Ref:ge[0]+"!"+ge[1]};F&&(A.Sheet=x.length),K.Names.push(A);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(n[n.length-1][0])>-1)break;if(g[1]==="/"&&(!v||!v["string-value"])){var de=Vee(s.slice(b,g.index));j=(j.length>0?j+`
`:"")+de[0]}else Kt(g[0],!1),b=g.index+g[0].length;break;case"s":break;case"database-range":if(g[1]==="/")break;try{ge=Fb(Kt(g[0])["target-range-address"]),f[ge[0]]["!autofilter"]={ref:ge[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(g[1]!=="/"){if(q=Kt(g[0],!1),!q.href)break;q.Target=wr(q.href),delete q.href,q.Target.charAt(0)=="#"&&q.Target.indexOf(".")>-1?(ge=Fb(q.Target.slice(1)),q.Target="#"+ge[0]+"!"+ge[1]):q.Target.match(/^\.\.[\\\/]/)&&(q.Target=q.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(g[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(g)}}var D={Sheets:f,SheetNames:x,Workbook:K};return r.bookSheets&&delete D.Sheets,D}function cE(e,t){t=t||{},li(e,"META-INF/manifest.xml")&&gH(Wa(e,"META-INF/manifest.xml"),t);var r=Un(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var s=tD(Hr(r),t);return li(e,"meta.xml")&&(s.Props=HI(Wa(e,"meta.xml"))),s}function dE(e,t){return tD(e,t)}var Hee=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+vf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Ba+t}}(),uE=function(){var e=function(i){return zr(i).replace(/  +/g,function(l){return'<text:s text:c="'+l.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,s=function(i,l,o){var c=[];c.push('      <table:table table:name="'+zr(l.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,d=0,h=Dn(i["!ref"]||"A1"),f=i["!merges"]||[],x=0,p=Array.isArray(i);if(i["!cols"])for(d=0;d<=h.e.c;++d)c.push("        <table:table-column"+(i["!cols"][d]?' table:style-name="co'+i["!cols"][d].ods+'"':"")+`></table:table-column>
`);var g="",y=i["!rows"]||[];for(u=0;u<h.s.r;++u)g=y[u]?' table:style-name="ro'+y[u].ods+'"':"",c.push("        <table:table-row"+g+`></table:table-row>
`);for(;u<=h.e.r;++u){for(g=y[u]?' table:style-name="ro'+y[u].ods+'"':"",c.push("        <table:table-row"+g+`>
`),d=0;d<h.s.c;++d)c.push(t);for(;d<=h.e.c;++d){var v=!1,j={},b="";for(x=0;x!=f.length;++x)if(!(f[x].s.c>d)&&!(f[x].s.r>u)&&!(f[x].e.c<d)&&!(f[x].e.r<u)){(f[x].s.c!=d||f[x].s.r!=u)&&(v=!0),j["table:number-columns-spanned"]=f[x].e.c-f[x].s.c+1,j["table:number-rows-spanned"]=f[x].e.r-f[x].s.r+1;break}if(v){c.push(r);continue}var w=Ht({r:u,c:d}),k=p?(i[u]||[])[d]:i[w];if(k&&k.f&&(j["table:formula"]=zr(uY(k.f)),k.F&&k.F.slice(0,w.length)==w)){var N=Dn(k.F);j["table:number-matrix-columns-spanned"]=N.e.c-N.s.c+1,j["table:number-matrix-rows-spanned"]=N.e.r-N.s.r+1}if(!k){c.push(t);continue}switch(k.t){case"b":b=k.v?"TRUE":"FALSE",j["office:value-type"]="boolean",j["office:boolean-value"]=k.v?"true":"false";break;case"n":b=k.w||String(k.v||0),j["office:value-type"]="float",j["office:value"]=k.v||0;break;case"s":case"str":b=k.v==null?"":k.v,j["office:value-type"]="string";break;case"d":b=k.w||aa(k.v).toISOString(),j["office:value-type"]="date",j["office:date-value"]=aa(k.v).toISOString(),j["table:style-name"]="ce1";break;default:c.push(t);continue}var S=e(b);if(k.l&&k.l.Target){var _=k.l.Target;_=_.charAt(0)=="#"?"#"+hY(_.slice(1)):_,_.charAt(0)!="#"&&!_.match(/^\w+:/)&&(_="../"+_),S=xt("text:a",S,{"xlink:href":_.replace(/&/g,"&amp;")})}c.push("          "+xt("table:table-cell",xt("text:p",S,{}),j)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},n=function(i,l){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var o=0;l.SheetNames.map(function(u){return l.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var h=u["!cols"][d];if(h.width==null&&h.wpx==null&&h.wch==null)continue;mc(h),h.ods=o;var f=u["!cols"][d].wpx+"px";i.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+f+`"/>
`),i.push(`  </style:style>
`),++o}}});var c=0;l.SheetNames.map(function(u){return l.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=c;var h=u["!rows"][d].hpx+"px";i.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),i.push(`  </style:style>
`),++c}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(l,o){var c=[Ba],u=vf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=vf({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+u+d+`>
`),c.push(VI().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),n(c,l),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var h=0;h!=l.SheetNames.length;++h)c.push(s(l.Sheets[l.SheetNames[h]],l,h));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function rD(e,t){if(t.bookType=="fods")return uE(e,t);var r=m2(),s="",n=[],i=[];return s="mimetype",ir(r,s,"application/vnd.oasis.opendocument.spreadsheet"),s="content.xml",ir(r,s,uE(e,t)),n.push([s,"text/xml"]),i.push([s,"ContentFile"]),s="styles.xml",ir(r,s,Hee(e,t)),n.push([s,"text/xml"]),i.push([s,"StylesFile"]),s="meta.xml",ir(r,s,Ba+VI()),n.push([s,"text/xml"]),i.push([s,"MetadataFile"]),s="manifest.rdf",ir(r,s,bH(i)),n.push([s,"application/rdf+xml"]),s="META-INF/manifest.xml",ir(r,s,yH(n)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Od(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Qj(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Hr(Cc(e))}function qee(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):zn(fl(e))}function Kee(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var s=0;s<t.length;++s)if(e[r+s]!=t[s])continue e;return!0}return!1}function gc(e){var t=e.reduce(function(n,i){return n+i.length},0),r=new Uint8Array(t),s=0;return e.forEach(function(n){r.set(n,s),s+=n.length}),r}function hE(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function Gee(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,s=e[t+14]&1,n=t+13;n>=t;--n)s=s*256+e[n];return(e[t+15]&128?-s:s)*Math.pow(10,r-6176)}function Qee(e,t,r){var s=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,n=r/Math.pow(10,s-6176);e[t+15]|=s>>7,e[t+14]|=(s&127)<<1;for(var i=0;n>=1;++i,n/=256)e[t+i]=n&255;e[t+15]|=r>=0?0:128}function Ef(e,t){var r=t?t[0]:0,s=e[r]&127;e:if(e[r++]>=128&&(s|=(e[r]&127)<<7,e[r++]<128||(s|=(e[r]&127)<<14,e[r++]<128)||(s|=(e[r]&127)<<21,e[r++]<128)||(s+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(s+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(s+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),s}function Mr(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Ia(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function kr(e){for(var t=[],r=[0];r[0]<e.length;){var s=r[0],n=Ef(e,r),i=n&7;n=Math.floor(n/8);var l=0,o;if(n==0)break;switch(i){case 0:{for(var c=r[0];e[r[0]++]>=128;);o=e.slice(c,r[0])}break;case 5:l=4,o=e.slice(r[0],r[0]+l),r[0]+=l;break;case 1:l=8,o=e.slice(r[0],r[0]+l),r[0]+=l;break;case 2:l=Ef(e,r),o=e.slice(r[0],r[0]+l),r[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(n," at offset ").concat(s))}var u={data:o,type:i};t[n]==null?t[n]=[u]:t[n].push(u)}return t}function ks(e){var t=[];return e.forEach(function(r,s){r.forEach(function(n){n.data&&(t.push(Mr(s*8+n.type)),n.type==2&&t.push(Mr(n.data.length)),t.push(n.data))})}),gc(t)}function U2(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function si(e){for(var t,r=[],s=[0];s[0]<e.length;){var n=Ef(e,s),i=kr(e.slice(s[0],s[0]+n));s[0]+=n;var l={id:Ia(i[1][0].data),messages:[]};i[2].forEach(function(o){var c=kr(o.data),u=Ia(c[3][0].data);l.messages.push({meta:c,data:e.slice(s[0],s[0]+u)}),s[0]+=u}),(t=i[3])!=null&&t[0]&&(l.merge=Ia(i[3][0].data)>>>0>0),r.push(l)}return r}function iu(e){var t=[];return e.forEach(function(r){var s=[];s[1]=[{data:Mr(r.id),type:0}],s[2]=[],r.merge!=null&&(s[3]=[{data:Mr(+!!r.merge),type:0}]);var n=[];r.messages.forEach(function(l){n.push(l.data),l.meta[3]=[{type:0,data:Mr(l.data.length)}],s[2].push({data:ks(l.meta),type:2})});var i=ks(s);t.push(Mr(i.length)),t.push(i),n.forEach(function(l){return t.push(l)})}),gc(t)}function Xee(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],s=Ef(t,r),n=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var l=t[r[0]++]>>2;if(l<60)++l;else{var o=l-59;l=t[r[0]],o>1&&(l|=t[r[0]+1]<<8),o>2&&(l|=t[r[0]+2]<<16),o>3&&(l|=t[r[0]+3]<<24),l>>>=0,l++,r[0]+=o}n.push(t.slice(r[0],r[0]+l)),r[0]+=l;continue}else{var c=0,u=0;if(i==1?(u=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,i==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),n=[gc(n)],c==0)throw new Error("Invalid offset 0");if(c>n[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(n.push(n[0].slice(-c)),u-=c;u>=n[n.length-1].length;)n.push(n[n.length-1]),u-=n[n.length-1].length;n.push(n[0].slice(-c,-c+u))}}var d=gc(n);if(d.length!=s)throw new Error("Unexpected length: ".concat(d.length," != ").concat(s));return d}function ni(e){for(var t=[],r=0;r<e.length;){var s=e[r++],n=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(Xee(s,e.slice(r,r+n))),r+=n}if(r!==e.length)throw new Error("data is not a valid framed stream!");return gc(t)}function lu(e){for(var t=[],r=0;r<e.length;){var s=Math.min(e.length-r,268435455),n=new Uint8Array(4);t.push(n);var i=Mr(s),l=i.length;t.push(i),s<=60?(l++,t.push(new Uint8Array([s-1<<2]))):s<=256?(l+=2,t.push(new Uint8Array([240,s-1&255]))):s<=65536?(l+=3,t.push(new Uint8Array([244,s-1&255,s-1>>8&255]))):s<=16777216?(l+=4,t.push(new Uint8Array([248,s-1&255,s-1>>8&255,s-1>>16&255]))):s<=4294967296&&(l+=5,t.push(new Uint8Array([252,s-1&255,s-1>>8&255,s-1>>16&255,s-1>>>24&255]))),t.push(e.slice(r,r+s)),l+=s,n[0]=0,n[1]=l&255,n[2]=l>>8&255,n[3]=l>>16&255,r+=s}return gc(t)}function Yee(e,t,r,s){var n=Od(e),i=n.getUint32(4,!0),l=(s>1?12:8)+hE(i&(s>1?3470:398))*4,o=-1,c=-1,u=NaN,d=new Date(2001,0,1);i&512&&(o=n.getUint32(l,!0),l+=4),l+=hE(i&(s>1?12288:4096))*4,i&16&&(c=n.getUint32(l,!0),l+=4),i&32&&(u=n.getFloat64(l,!0),l+=8),i&64&&(d.setTime(d.getTime()+n.getFloat64(l,!0)*1e3),l+=8);var h;switch(e[2]){case 0:break;case 2:h={t:"n",v:u};break;case 3:h={t:"s",v:t[c]};break;case 5:h={t:"d",v:d};break;case 6:h={t:"b",v:u>0};break;case 7:h={t:"n",v:u/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:r[o]};else if(c>-1)h={t:"s",v:t[c]};else if(!isNaN(u))h={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return h}function Jee(e,t,r){var s=Od(e),n=s.getUint32(8,!0),i=12,l=-1,o=-1,c=NaN,u=NaN,d=new Date(2001,0,1);n&1&&(c=Gee(e,i),i+=16),n&2&&(u=s.getFloat64(i,!0),i+=8),n&4&&(d.setTime(d.getTime()+s.getFloat64(i,!0)*1e3),i+=8),n&8&&(o=s.getUint32(i,!0),i+=4),n&16&&(l=s.getUint32(i,!0),i+=4);var h;switch(e[1]){case 0:break;case 2:h={t:"n",v:c};break;case 3:h={t:"s",v:t[o]};break;case 5:h={t:"d",v:d};break;case 6:h={t:"b",v:u>0};break;case 7:h={t:"n",v:u/86400};break;case 8:h={t:"e",v:0};break;case 9:if(l>-1)h={t:"s",v:r[l]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)));break;case 10:h={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)))}return h}function Mb(e,t){var r=new Uint8Array(32),s=Od(r),n=12,i=0;switch(r[0]=5,e.t){case"n":r[1]=2,Qee(r,n,e.v),i|=1,n+=16;break;case"b":r[1]=6,s.setFloat64(n,e.v?1:0,!0),i|=2,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,s.setUint32(n,t.indexOf(e.v),!0),i|=8,n+=4;break;default:throw"unsupported cell type "+e.t}return s.setUint32(8,i,!0),r.slice(0,n)}function Lb(e,t){var r=new Uint8Array(32),s=Od(r),n=12,i=0;switch(r[0]=3,e.t){case"n":r[2]=2,s.setFloat64(n,e.v,!0),i|=32,n+=8;break;case"b":r[2]=6,s.setFloat64(n,e.v?1:0,!0),i|=32,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,s.setUint32(n,t.indexOf(e.v),!0),i|=16,n+=4;break;default:throw"unsupported cell type "+e.t}return s.setUint32(4,i,!0),r.slice(0,n)}function Zee(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return Yee(e,t,r,e[0]);case 5:return Jee(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Bs(e){var t=kr(e);return Ef(t[1][0].data)}function fE(e,t){var r=kr(t.data),s=Ia(r[1][0].data),n=r[3],i=[];return(n||[]).forEach(function(l){var o=kr(l.data),c=Ia(o[1][0].data)>>>0;switch(s){case 1:i[c]=Qj(o[3][0].data);break;case 8:{var u=e[Bs(o[9][0].data)][0],d=kr(u.data),h=e[Bs(d[1][0].data)][0],f=Ia(h.meta[1][0].data);if(f!=2001)throw new Error("2000 unexpected reference to ".concat(f));var x=kr(h.data);i[c]=x[3].map(function(p){return Qj(p.data)}).join("")}break}}),i}function ete(e,t){var r,s,n,i,l,o,c,u,d,h,f,x,p,g,y=kr(e),v=Ia(y[1][0].data)>>>0,j=Ia(y[2][0].data)>>>0,b=((s=(r=y[8])==null?void 0:r[0])==null?void 0:s.data)&&Ia(y[8][0].data)>0||!1,w,k;if((i=(n=y[7])==null?void 0:n[0])!=null&&i.data&&t!=0)w=(o=(l=y[7])==null?void 0:l[0])==null?void 0:o.data,k=(u=(c=y[6])==null?void 0:c[0])==null?void 0:u.data;else if((h=(d=y[4])==null?void 0:d[0])!=null&&h.data&&t!=1)w=(x=(f=y[4])==null?void 0:f[0])==null?void 0:x.data,k=(g=(p=y[3])==null?void 0:p[0])==null?void 0:g.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var N=b?4:1,S=Od(w),_=[],O=0;O<w.length/2;++O){var E=S.getUint16(O*2,!0);E<65535&&_.push([O,E])}if(_.length!=j)throw"Expected ".concat(j," cells, found ").concat(_.length);var R=[];for(O=0;O<_.length-1;++O)R[_[O][0]]=k.subarray(_[O][1]*N,_[O+1][1]*N);return _.length>=1&&(R[_[_.length-1][0]]=k.subarray(_[_.length-1][1]*N)),{R:v,cells:R}}function tte(e,t){var r,s=kr(t.data),n=(r=s==null?void 0:s[7])!=null&&r[0]?Ia(s[7][0].data)>>>0>0?1:0:-1,i=U2(s[5],function(l){return ete(l,n)});return{nrows:Ia(s[4][0].data)>>>0,data:i.reduce(function(l,o){return l[o.R]||(l[o.R]=[]),o.cells.forEach(function(c,u){if(l[o.R][u])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(u));l[o.R][u]=c}),l},[])}}function rte(e,t,r){var s,n=kr(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(Ia(n[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(n[6][0].data));if(i.e.c=(Ia(n[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(n[7][0].data));r["!ref"]=sr(i);var l=kr(n[4][0].data),o=fE(e,e[Bs(l[4][0].data)][0]),c=(s=l[17])!=null&&s[0]?fE(e,e[Bs(l[17][0].data)][0]):[],u=kr(l[3][0].data),d=0;u[1].forEach(function(h){var f=kr(h.data),x=e[Bs(f[2][0].data)][0],p=Ia(x.meta[1][0].data);if(p!=6002)throw new Error("6001 unexpected reference to ".concat(p));var g=tte(e,x);g.data.forEach(function(y,v){y.forEach(function(j,b){var w=Ht({r:d+v,c:b}),k=Zee(j,o,c);k&&(r[w]=k)})}),d+=g.nrows})}function ate(e,t){var r=kr(t.data),s={"!ref":"A1"},n=e[Bs(r[2][0].data)],i=Ia(n[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return rte(e,n[0],s),s}function ste(e,t){var r,s=kr(t.data),n={name:(r=s[1])!=null&&r[0]?Qj(s[1][0].data):"",sheets:[]},i=U2(s[2],Bs);return i.forEach(function(l){e[l].forEach(function(o){var c=Ia(o.meta[1][0].data);c==6e3&&n.sheets.push(ate(e,o))})}),n}function nte(e,t){var r=K2(),s=kr(t.data),n=U2(s[1],Bs);if(n.forEach(function(i){e[i].forEach(function(l){var o=Ia(l.meta[1][0].data);if(o==2){var c=ste(e,l);c.sheets.forEach(function(u,d){G2(r,u,d==0?c.name:c.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function $b(e){var t,r,s,n,i={},l=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var u;try{u=ni(c.content)}catch(h){return console.log("?? "+c.content.length+" "+(h.message||h))}var d;try{d=si(u)}catch(h){return console.log("## "+(h.message||h))}d.forEach(function(h){i[h.id]=h.messages,l.push(h.id)})}}),!l.length)throw new Error("File has no messages");var o=((n=(s=(r=(t=i==null?void 0:i[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:s[1])==null?void 0:n[0].data)&&Ia(i[1][0].meta[1][0].data)==1&&i[1][0];if(o||l.forEach(function(c){i[c].forEach(function(u){var d=Ia(u.meta[1][0].data)>>>0;if(d==1)if(!o)o=u;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return nte(i,o)}function ite(e,t,r){var s,n,i,l;if(!((s=e[6])!=null&&s[0])||!((n=e[7])!=null&&n[0]))throw"Mutation only works on post-BNC storages!";var o=((l=(i=e[8])==null?void 0:i[0])==null?void 0:l.data)&&Ia(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var c=0,u=Od(e[7][0].data),d=0,h=[],f=Od(e[4][0].data),x=0,p=[],g=0;g<t.length;++g){if(t[g]==null){u.setUint16(g*2,65535,!0),f.setUint16(g*2,65535);continue}u.setUint16(g*2,d,!0),f.setUint16(g*2,x,!0);var y,v;switch(typeof t[g]){case"string":y=Mb({t:"s",v:t[g]},r),v=Lb({t:"s",v:t[g]},r);break;case"number":y=Mb({t:"n",v:t[g]},r),v=Lb({t:"n",v:t[g]},r);break;case"boolean":y=Mb({t:"b",v:t[g]},r),v=Lb({t:"b",v:t[g]},r);break;default:throw new Error("Unsupported value "+t[g])}h.push(y),d+=y.length,p.push(v),x+=v.length,++c}for(e[2][0].data=Mr(c);g<e[7][0].data.length/2;++g)u.setUint16(g*2,65535,!0),f.setUint16(g*2,65535,!0);return e[6][0].data=gc(h),e[3][0].data=gc(p),c}function lte(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var s=Dn(r["!ref"]);s.s.r=s.s.c=0;var n=!1;s.e.c>9&&(n=!0,s.e.c=9),s.e.r>49&&(n=!0,s.e.r=49),n&&console.error("The Numbers writer is currently limited to ".concat(sr(s)));var i=sg(r,{range:s,header:1}),l=["~Sh33tJ5~"];i.forEach(function(se){return se.forEach(function(L){typeof L=="string"&&l.push(L)})});var o={},c=[],u=$t.read(t.numbers,{type:"base64"});u.FileIndex.map(function(se,L){return[se,u.FullPaths[L]]}).forEach(function(se){var L=se[0],Z=se[1];if(L.type==2&&L.name.match(/\.iwa/)){var F=L.content,he=ni(F),ye=si(he);ye.forEach(function(z){c.push(z.id),o[z.id]={deps:[],location:Z,type:Ia(z.messages[0].meta[1][0].data)}})}}),c.sort(function(se,L){return se-L});var d=c.filter(function(se){return se>1}).map(function(se){return[se,Mr(se)]});u.FileIndex.map(function(se,L){return[se,u.FullPaths[L]]}).forEach(function(se){var L=se[0];if(se[1],!!L.name.match(/\.iwa/)){var Z=si(ni(L.content));Z.forEach(function(F){F.messages.forEach(function(he){d.forEach(function(ye){F.messages.some(function(z){return Ia(z.meta[1][0].data)!=11006&&Kee(z.data,ye[1])})&&o[ye[0]].deps.push(F.id)})})})}});for(var h=$t.find(u,o[1].location),f=si(ni(h.content)),x,p=0;p<f.length;++p){var g=f[p];g.id==1&&(x=g)}var y=Bs(kr(x.messages[0].data)[1][0].data);for(h=$t.find(u,o[y].location),f=si(ni(h.content)),p=0;p<f.length;++p)g=f[p],g.id==y&&(x=g);for(y=Bs(kr(x.messages[0].data)[2][0].data),h=$t.find(u,o[y].location),f=si(ni(h.content)),p=0;p<f.length;++p)g=f[p],g.id==y&&(x=g);for(y=Bs(kr(x.messages[0].data)[2][0].data),h=$t.find(u,o[y].location),f=si(ni(h.content)),p=0;p<f.length;++p)g=f[p],g.id==y&&(x=g);var v=kr(x.messages[0].data);{v[6][0].data=Mr(s.e.r+1),v[7][0].data=Mr(s.e.c+1);var j=Bs(v[46][0].data),b=$t.find(u,o[j].location),w=si(ni(b.content));{for(var k=0;k<w.length&&w[k].id!=j;++k);if(w[k].id!=j)throw"Bad ColumnRowUIDMapArchive";var N=kr(w[k].messages[0].data);N[1]=[],N[2]=[],N[3]=[];for(var S=0;S<=s.e.c;++S){var _=[];_[1]=_[2]=[{type:0,data:Mr(S+420690)}],N[1].push({type:2,data:ks(_)}),N[2].push({type:0,data:Mr(S)}),N[3].push({type:0,data:Mr(S)})}N[4]=[],N[5]=[],N[6]=[];for(var O=0;O<=s.e.r;++O)_=[],_[1]=_[2]=[{type:0,data:Mr(O+726270)}],N[4].push({type:2,data:ks(_)}),N[5].push({type:0,data:Mr(O)}),N[6].push({type:0,data:Mr(O)});w[k].messages[0].data=ks(N)}b.content=lu(iu(w)),b.size=b.content.length,delete v[46];var E=kr(v[4][0].data);{E[7][0].data=Mr(s.e.r+1);var R=kr(E[1][0].data),C=Bs(R[2][0].data);b=$t.find(u,o[C].location),w=si(ni(b.content));{if(w[0].id!=C)throw"Bad HeaderStorageBucket";var I=kr(w[0].messages[0].data);for(O=0;O<i.length;++O){var ne=kr(I[2][0].data);ne[1][0].data=Mr(O),ne[4][0].data=Mr(i[O].length),I[2][O]={type:I[2][0].type,data:ks(ne)}}w[0].messages[0].data=ks(I)}b.content=lu(iu(w)),b.size=b.content.length;var W=Bs(E[2][0].data);b=$t.find(u,o[W].location),w=si(ni(b.content));{if(w[0].id!=W)throw"Bad HeaderStorageBucket";for(I=kr(w[0].messages[0].data),S=0;S<=s.e.c;++S)ne=kr(I[2][0].data),ne[1][0].data=Mr(S),ne[4][0].data=Mr(s.e.r+1),I[2][S]={type:I[2][0].type,data:ks(ne)};w[0].messages[0].data=ks(I)}b.content=lu(iu(w)),b.size=b.content.length;var Q=Bs(E[4][0].data);(function(){for(var se=$t.find(u,o[Q].location),L=si(ni(se.content)),Z,F=0;F<L.length;++F){var he=L[F];he.id==Q&&(Z=he)}var ye=kr(Z.messages[0].data);{ye[3]=[];var z=[];l.forEach(function(D,ze){z[1]=[{type:0,data:Mr(ze)}],z[2]=[{type:0,data:Mr(1)}],z[3]=[{type:2,data:qee(D)}],ye[3].push({type:2,data:ks(z)})})}Z.messages[0].data=ks(ye);var A=iu(L),de=lu(A);se.content=de,se.size=se.content.length})();var H=kr(E[3][0].data);{var K=H[1][0];delete H[2];var q=kr(K.data);{var ge=Bs(q[2][0].data);(function(){for(var se=$t.find(u,o[ge].location),L=si(ni(se.content)),Z,F=0;F<L.length;++F){var he=L[F];he.id==ge&&(Z=he)}var ye=kr(Z.messages[0].data);{delete ye[6],delete H[7];var z=new Uint8Array(ye[5][0].data);ye[5]=[];for(var A=0,de=0;de<=s.e.r;++de){var D=kr(z);A+=ite(D,i[de],l),D[1][0].data=Mr(de),ye[5].push({data:ks(D),type:2})}ye[1]=[{type:0,data:Mr(s.e.c+1)}],ye[2]=[{type:0,data:Mr(s.e.r+1)}],ye[3]=[{type:0,data:Mr(A)}],ye[4]=[{type:0,data:Mr(s.e.r+1)}]}Z.messages[0].data=ks(ye);var ze=iu(L),Fe=lu(ze);se.content=Fe,se.size=se.content.length})()}K.data=ks(q)}E[3][0].data=ks(H)}v[4][0].data=ks(E)}x.messages[0].data=ks(v);var G=iu(f),B=lu(G);return h.content=B,h.size=h.content.length,u}function aD(e){return function(r){for(var s=0;s!=e.length;++s){var n=e[s];r[n[0]]===void 0&&(r[n[0]]=n[1]),n[2]==="n"&&(r[n[0]]=Number(r[n[0]]))}}}function W2(e){aD([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function V2(e){aD([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function ote(e){return ur.WS.indexOf(e)>-1?"sheet":e==ur.CS?"chart":e==ur.DS?"dialog":e==ur.MS?"macro":e&&e.length?e:"sheet"}function cte(e,t){if(!e)return 0;try{e=t.map(function(s){return s.id||(s.id=s.strRelID),[s.name,e["!id"][s.id].Target,ote(e["!id"][s.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function dte(e,t,r,s,n,i,l,o,c,u,d,h){try{i[s]=Bh(Un(e,r,!0),t);var f=Wa(e,t),x;switch(o){case"sheet":x=IZ(f,t,n,c,i[s],u,d,h);break;case"chart":if(x=OZ(f,t,n,c,i[s],u,d,h),!x||!x["!drawel"])break;var p=wh(x["!drawel"].Target,t),g=jf(p),y=vQ(Un(e,p,!0),Bh(Un(e,g,!0),p)),v=wh(y,p),j=jf(v);x=iZ(Un(e,v,!0),v,c,Bh(Un(e,j,!0),v),u,x);break;case"macro":x=DZ(f,t,n,c,i[s],u,d,h);break;case"dialog":x=FZ(f,t,n,c,i[s],u,d,h);break;default:throw new Error("Unrecognized sheet type "+o)}l[s]=x;var b=[];i&&i[s]&&Oa(i[s]).forEach(function(w){var k="";if(i[s][w].Type==ur.CMNT){k=wh(i[s][w].Target,t);var N=$Z(Wa(e,k,!0),k,c);if(!N||!N.length)return;J4(x,N,!1)}i[s][w].Type==ur.TCMNT&&(k=wh(i[s][w].Target,t),b=b.concat(jQ(Wa(e,k,!0),c)))}),b&&b.length&&J4(x,b,!0,c.people||[])}catch(w){if(c.WTF)throw w}}function ei(e){return e.charAt(0)=="/"?e.slice(1):e}function ute(e,t){if(D0(),t=t||{},W2(t),li(e,"META-INF/manifest.xml")||li(e,"objectdata.xml"))return cE(e,t);if(li(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof $b<"u"){if(e.FileIndex)return $b(e);var r=$t.utils.cfb_new();return v4(e).forEach(function(ne){ir(r,ne,wV(e,ne))}),$b(r)}throw new Error("Unsupported NUMBERS file")}if(!li(e,"[Content_Types].xml"))throw li(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):li(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var s=v4(e),n=mH(Un(e,"[Content_Types].xml")),i=!1,l,o;if(n.workbooks.length===0&&(o="xl/workbook.xml",Wa(e,o,!0)&&n.workbooks.push(o)),n.workbooks.length===0){if(o="xl/workbook.bin",!Wa(e,o,!0))throw new Error("Could not find workbook");n.workbooks.push(o),i=!0}n.workbooks[0].slice(-3)=="bin"&&(i=!0);var c={},u={};if(!t.bookSheets&&!t.bookProps){if(zh=[],n.sst)try{zh=LZ(Wa(e,ei(n.sst)),n.sst,t)}catch(ne){if(t.WTF)throw ne}t.cellStyles&&n.themes.length&&(c=MZ(Un(e,n.themes[0].replace(/^\//,""),!0)||"",n.themes[0],t)),n.style&&(u=RZ(Wa(e,ei(n.style)),n.style,c,t))}n.links.map(function(ne){try{var W=Bh(Un(e,jf(ei(ne))),ne);return zZ(Wa(e,ei(ne)),W,ne,t)}catch{}});var d=TZ(Wa(e,ei(n.workbooks[0])),n.workbooks[0],t),h={},f="";n.coreprops.length&&(f=Wa(e,ei(n.coreprops[0]),!0),f&&(h=HI(f)),n.extprops.length!==0&&(f=Wa(e,ei(n.extprops[0]),!0),f&&wH(f,h,t)));var x={};(!t.bookSheets||t.bookProps)&&n.custprops.length!==0&&(f=Un(e,ei(n.custprops[0]),!0),f&&(x=SH(f,t)));var p={};if((t.bookSheets||t.bookProps)&&(d.Sheets?l=d.Sheets.map(function(W){return W.name}):h.Worksheets&&h.SheetNames.length>0&&(l=h.SheetNames),t.bookProps&&(p.Props=h,p.Custprops=x),t.bookSheets&&typeof l<"u"&&(p.SheetNames=l),t.bookSheets?p.SheetNames:t.bookProps))return p;l={};var g={};t.bookDeps&&n.calcchain&&(g=BZ(Wa(e,ei(n.calcchain)),n.calcchain));var y=0,v={},j,b;{var w=d.Sheets;h.Worksheets=w.length,h.SheetNames=[];for(var k=0;k!=w.length;++k)h.SheetNames[k]=w[k].name}var N=i?"bin":"xml",S=n.workbooks[0].lastIndexOf("/"),_=(n.workbooks[0].slice(0,S+1)+"_rels/"+n.workbooks[0].slice(S+1)+".rels").replace(/^\//,"");li(e,_)||(_="xl/_rels/workbook."+N+".rels");var O=Bh(Un(e,_,!0),_.replace(/_rels.*/,"s5s"));(n.metadata||[]).length>=1&&(t.xlmeta=UZ(Wa(e,ei(n.metadata[0])),n.metadata[0],t)),(n.people||[]).length>=1&&(t.people=NQ(Wa(e,ei(n.people[0])),t)),O&&(O=cte(O,d.Sheets));var E=Wa(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(y=0;y!=h.Worksheets;++y){var R="sheet";if(O&&O[y]?(j="xl/"+O[y][1].replace(/[\/]?xl\//,""),li(e,j)||(j=O[y][1]),li(e,j)||(j=_.replace(/_rels\/.*$/,"")+O[y][1]),R=O[y][2]):(j="xl/worksheets/sheet"+(y+1-E)+"."+N,j=j.replace(/sheet0\./,"sheet.")),b=j.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(y!=t.sheets)continue e;break;case"string":if(h.SheetNames[y].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var C=!1,I=0;I!=t.sheets.length;++I)typeof t.sheets[I]=="number"&&t.sheets[I]==y&&(C=1),typeof t.sheets[I]=="string"&&t.sheets[I].toLowerCase()==h.SheetNames[y].toLowerCase()&&(C=1);if(!C)continue e}}dte(e,j,b,h.SheetNames[y],y,v,l,R,t,d,c,u)}return p={Directory:n,Workbook:d,Props:h,Custprops:x,Deps:g,Sheets:l,SheetNames:h.SheetNames,Strings:zh,Styles:u,Themes:c,SSF:sa(Wt)},t&&t.bookFiles&&(e.files?(p.keys=s,p.files=e.files):(p.keys=[],p.files={},e.FullPaths.forEach(function(ne,W){ne=ne.replace(/^Root Entry[\/]/,""),p.keys.push(ne),p.files[ne]=e.FileIndex[W]}))),t&&t.bookVBA&&(n.vba.length>0?p.vbaraw=Wa(e,ei(n.vba[0]),!0):n.defaults&&n.defaults.bin===TQ&&(p.vbaraw=Wa(e,"xl/vbaProject.bin",!0))),p}function hte(e,t){var r=t||{},s="Workbook",n=$t.find(e,s);try{if(s="/!DataSpaces/Version",n=$t.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);if(UK(n.content),s="/!DataSpaces/DataSpaceMap",n=$t.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);var i=VK(n.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+s);if(s="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",n=$t.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);var l=HK(n.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+s);if(s="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",n=$t.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);KK(n.content)}catch{}if(s="/EncryptionInfo",n=$t.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);var o=GK(n.content);if(s="/EncryptedPackage",n=$t.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],n.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],n.content,r.password||"",r);throw new Error("File is password-protected")}function fte(e,t){return t.bookType=="ods"?rD(e,t):t.bookType=="numbers"?lte(e,t):t.bookType=="xlsb"?xte(e,t):mte(e,t)}function xte(e,t){Cu=1024,e&&!e.SSF&&(e.SSF=sa(Wt)),e&&e.SSF&&(D0(),Cy(e.SSF),t.revssf=Py(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Uh?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",s=_O.indexOf(t.bookType)>-1,n=A2();V2(t=t||{});var i=m2(),l="",o=0;if(t.cellXfs=[],Pc(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",ir(i,l,qI(e.Props,t)),n.coreprops.push(l),Lr(t.rels,2,l,ur.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,ir(i,l,QI(e.Props)),n.extprops.push(l),Lr(t.rels,3,l,ur.EXT_PROPS),e.Custprops!==e.Props&&Oa(e.Custprops||{}).length>0&&(l="docProps/custom.xml",ir(i,l,XI(e.Custprops)),n.custprops.push(l),Lr(t.rels,4,l,ur.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var d={"!id":{}},h=e.Sheets[e.SheetNames[o-1]],f=(h||{})["!type"]||"sheet";switch(f){case"chart":default:l="xl/worksheets/sheet"+o+"."+r,ir(i,l,VZ(o-1,l,t,e,d)),n.sheets.push(l),Lr(t.wbrels,-1,"worksheets/sheet"+o+"."+r,ur.WS[0])}if(h){var x=h["!comments"],p=!1,g="";x&&x.length>0&&(g="xl/comments"+o+"."+r,ir(i,g,KZ(x,g)),n.comments.push(g),Lr(d,-1,"../comments"+o+"."+r,ur.CMNT),p=!0),h["!legacy"]&&p&&ir(i,"xl/drawings/vmlDrawing"+o+".vml",PO(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}d["!id"].rId1&&ir(i,jf(l),Ru(d))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+r,ir(i,l,qZ(t.Strings,l,t)),n.strs.push(l),Lr(t.wbrels,-1,"sharedStrings."+r,ur.SST)),l="xl/workbook."+r,ir(i,l,WZ(e,l)),n.workbooks.push(l),Lr(t.rels,1,l,ur.WB),l="xl/theme/theme1.xml",ir(i,l,F2(e.Themes,t)),n.themes.push(l),Lr(t.wbrels,-1,"theme/theme1.xml",ur.THEME),l="xl/styles."+r,ir(i,l,HZ(e,l,t)),n.styles.push(l),Lr(t.wbrels,-1,"styles."+r,ur.STY),e.vbaraw&&s&&(l="xl/vbaProject.bin",ir(i,l,e.vbaraw),n.vba.push(l),Lr(t.wbrels,-1,"vbaProject.bin",ur.VBA)),l="xl/metadata."+r,ir(i,l,GZ(l)),n.metadata.push(l),Lr(t.wbrels,-1,"metadata."+r,ur.XLMETA),ir(i,"[Content_Types].xml",WI(n,t)),ir(i,"_rels/.rels",Ru(t.rels)),ir(i,"xl/_rels/workbook."+r+".rels",Ru(t.wbrels)),delete t.revssf,delete t.ssf,i}function mte(e,t){Cu=1024,e&&!e.SSF&&(e.SSF=sa(Wt)),e&&e.SSF&&(D0(),Cy(e.SSF),t.revssf=Py(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Uh?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",s=_O.indexOf(t.bookType)>-1,n=A2();V2(t=t||{});var i=m2(),l="",o=0;if(t.cellXfs=[],Pc(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",ir(i,l,qI(e.Props,t)),n.coreprops.push(l),Lr(t.rels,2,l,ur.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,ir(i,l,QI(e.Props)),n.extprops.push(l),Lr(t.rels,3,l,ur.EXT_PROPS),e.Custprops!==e.Props&&Oa(e.Custprops||{}).length>0&&(l="docProps/custom.xml",ir(i,l,XI(e.Custprops)),n.custprops.push(l),Lr(t.rels,4,l,ur.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var h={"!id":{}},f=e.Sheets[e.SheetNames[o-1]],x=(f||{})["!type"]||"sheet";switch(x){case"chart":default:l="xl/worksheets/sheet"+o+"."+r,ir(i,l,zO(o-1,t,e,h)),n.sheets.push(l),Lr(t.wbrels,-1,"worksheets/sheet"+o+"."+r,ur.WS[0])}if(f){var p=f["!comments"],g=!1,y="";if(p&&p.length>0){var v=!1;p.forEach(function(j){j[1].forEach(function(b){b.T==!0&&(v=!0)})}),v&&(y="xl/threadedComments/threadedComment"+o+"."+r,ir(i,y,wQ(p,d,t)),n.threadedcomments.push(y),Lr(h,-1,"../threadedComments/threadedComment"+o+"."+r,ur.TCMNT)),y="xl/comments"+o+"."+r,ir(i,y,AO(p)),n.comments.push(y),Lr(h,-1,"../comments"+o+"."+r,ur.CMNT),g=!0}f["!legacy"]&&g&&ir(i,"xl/drawings/vmlDrawing"+o+".vml",PO(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}h["!id"].rId1&&ir(i,jf(l),Ru(h))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+r,ir(i,l,pO(t.Strings,t)),n.strs.push(l),Lr(t.wbrels,-1,"sharedStrings."+r,ur.SST)),l="xl/workbook."+r,ir(i,l,qO(e)),n.workbooks.push(l),Lr(t.rels,1,l,ur.WB),l="xl/theme/theme1.xml",ir(i,l,F2(e.Themes,t)),n.themes.push(l),Lr(t.wbrels,-1,"theme/theme1.xml",ur.THEME),l="xl/styles."+r,ir(i,l,SO(e,t)),n.styles.push(l),Lr(t.wbrels,-1,"styles."+r,ur.STY),e.vbaraw&&s&&(l="xl/vbaProject.bin",ir(i,l,e.vbaraw),n.vba.push(l),Lr(t.wbrels,-1,"vbaProject.bin",ur.VBA)),l="xl/metadata."+r,ir(i,l,EO()),n.metadata.push(l),Lr(t.wbrels,-1,"metadata."+r,ur.XLMETA),d.length>1&&(l="xl/persons/person.xml",ir(i,l,SQ(d)),n.people.push(l),Lr(t.wbrels,-1,"persons/person.xml",ur.PEOPLE)),ir(i,"[Content_Types].xml",WI(n,t)),ir(i,"_rels/.rels",Ru(t.rels)),ir(i,"xl/_rels/workbook."+r+".rels",Ru(t.wbrels)),delete t.revssf,delete t.ssf,i}function H2(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Qn(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function pte(e,t){return $t.find(e,"EncryptedPackage")?hte(e,t):XO(e,t)}function gte(e,t){var r,s=e,n=t||{};return n.type||(n.type=cr&&Buffer.isBuffer(e)?"buffer":"base64"),r=yI(s,n),ute(r,n)}function sD(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Kj(e.slice(r),t);default:break e}return h0.to_workbook(e,t)}function yte(e,t){var r="",s=H2(e,t);switch(t.type){case"base64":r=Qn(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Ad(e);break;default:throw new Error("Unrecognized type "+t.type)}return s[0]==239&&s[1]==187&&s[2]==191&&(r=Hr(r)),t.type="binary",sD(r,t)}function vte(e,t){var r=e;return t.type=="base64"&&(r=Qn(r)),r=mf.utils.decode(1200,r.slice(2),"str"),t.type="binary",sD(r,t)}function bte(e){return e.match(/[^\x00-\x7F]/)?fl(e):e}function Bb(e,t,r,s){return s?(r.type="string",h0.to_workbook(e,r)):h0.to_workbook(t,r)}function Xj(e,t){d2();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Xj(new Uint8Array(e),(r=sa(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var s=e,n=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Lu={},r.dateNF&&(Lu.dateNF=r.dateNF),r.type||(r.type=cr&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=cr?"buffer":"binary",s=xV(e),typeof Uint8Array<"u"&&!cr&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,s=bte(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),o=new Uint8Array(l);if(o.foo="bar",!o.foo)return r=sa(r),r.type="array",Xj(u2(s),r)}switch((n=H2(s,r))[0]){case 208:if(n[1]===207&&n[2]===17&&n[3]===224&&n[4]===161&&n[5]===177&&n[6]===26&&n[7]===225)return pte($t.read(s,r),r);break;case 9:if(n[1]<=8)return XO(s,r);break;case 60:return Kj(s,r);case 73:if(n[1]===73&&n[2]===42&&n[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(n[1]===68)return kK(s,r);break;case 84:if(n[1]===65&&n[2]===66&&n[3]===76)return xO.to_workbook(s,r);break;case 80:return n[1]===75&&n[2]<9&&n[3]<9?gte(s,r):Bb(e,s,r,i);case 239:return n[3]===60?Kj(s,r):Bb(e,s,r,i);case 255:if(n[1]===254)return vte(s,r);if(n[1]===0&&n[2]===2&&n[3]===0)return hd.to_workbook(s,r);break;case 0:if(n[1]===0&&(n[2]>=2&&n[3]===0||n[2]===0&&(n[3]===8||n[3]===9)))return hd.to_workbook(s,r);break;case 3:case 131:case 139:case 140:return qj.to_workbook(s,r);case 123:if(n[1]===92&&n[2]===114&&n[3]===116)return jO.to_workbook(s,r);break;case 10:case 13:case 32:return yte(s,r);case 137:if(n[1]===80&&n[2]===78&&n[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return SK.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?qj.to_workbook(s,r):Bb(e,s,r,i)}function nD(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return lx(t.file,$t.write(e,{type:cr?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return $t.write(e,t)}function jte(e,t){var r=sa(t||{}),s=fte(e,r);return wte(s,r)}function wte(e,t){var r={},s=cr?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=s;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=s;break;default:throw new Error("Unrecognized type "+t.type)}var n=e.FullPaths?$t.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof n=="string"){if(t.type=="binary"||t.type=="base64")return n;n=new Uint8Array(ky(n))}return t.password&&typeof encrypt_agile<"u"?nD(encrypt_agile(n,t.password),t):t.type==="file"?lx(t.file,n):t.type=="string"?Hr(n):n}function Nte(e,t){var r=t||{},s=bee(e,r);return nD(s,r)}function sl(e,t,r){r||(r="");var s=r+e;switch(t.type){case"base64":return pf(fl(s));case"binary":return fl(s);case"string":return e;case"file":return lx(t.file,s,"utf8");case"buffer":return cr?go(s,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(s):sl(s,{type:"binary"}).split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Ste(e,t){switch(t.type){case"base64":return pf(e);case"binary":return e;case"string":return e;case"file":return lx(t.file,e,"binary");case"buffer":return cr?go(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function jm(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",s=0;s<e.length;++s)r+=String.fromCharCode(e[s]);return t.type=="base64"?pf(r):t.type=="string"?Hr(r):r;case"file":return lx(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function iD(e,t){d2(),pZ(e);var r=sa(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var s=iD(e,r);return r.type="array",ky(s)}var n=0;if(r.sheet&&(typeof r.sheet=="number"?n=r.sheet:n=e.SheetNames.indexOf(r.sheet),!e.SheetNames[n]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return sl(fee(e,r),r);case"slk":case"sylk":return sl(fO.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"htm":case"html":return sl(JO(e.Sheets[e.SheetNames[n]],r),r);case"txt":return Ste(lD(e.Sheets[e.SheetNames[n]],r),r);case"csv":return sl(q2(e.Sheets[e.SheetNames[n]],r),r,"\uFEFF");case"dif":return sl(xO.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"dbf":return jm(qj.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"prn":return sl(h0.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"rtf":return sl(jO.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"eth":return sl(mO.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"fods":return sl(rD(e,r),r);case"wk1":return jm(hd.sheet_to_wk1(e.Sheets[e.SheetNames[n]],r),r);case"wk3":return jm(hd.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),jm(YO(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),Nte(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return jte(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function kte(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function Cte(e,t,r){var s={};return s.type="file",s.file=t,kte(s),iD(e,s)}function Ete(e,t,r,s,n,i,l,o){var c=Ma(r),u=o.defval,d=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,f=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(f,"__rowNum__",{value:r,enumerable:!1})}catch{f.__rowNum__=r}else f.__rowNum__=r;if(!l||e[r])for(var x=t.s.c;x<=t.e.c;++x){var p=l?e[r][x]:e[s[x]+c];if(p===void 0||p.t===void 0){if(u===void 0)continue;i[x]!=null&&(f[i[x]]=u);continue}var g=p.v;switch(p.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(i[x]!=null){if(g==null)if(p.t=="e"&&g===null)f[i[x]]=null;else if(u!==void 0)f[i[x]]=u;else if(d&&g===null)f[i[x]]=null;else continue;else f[i[x]]=d&&(p.t!=="n"||p.t==="n"&&o.rawNumbers!==!1)?g:no(p,g,o);g!=null&&(h=!1)}}return{row:f,isempty:h}}function sg(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},s=0,n=1,i=[],l=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},d=u.range!=null?u.range:e["!ref"];switch(u.header===1?s=1:u.header==="A"?s=2:Array.isArray(u.header)?s=3:u.header==null&&(s=0),typeof d){case"string":c=Nr(d);break;case"number":c=Nr(e["!ref"]),c.s.r=d;break;default:c=d}s>0&&(n=0);var h=Ma(c.s.r),f=[],x=[],p=0,g=0,y=Array.isArray(e),v=c.s.r,j=0,b={};y&&!e[v]&&(e[v]=[]);var w=u.skipHidden&&e["!cols"]||[],k=u.skipHidden&&e["!rows"]||[];for(j=c.s.c;j<=c.e.c;++j)if(!(w[j]||{}).hidden)switch(f[j]=va(j),r=y?e[v][j]:e[f[j]+h],s){case 1:i[j]=j-c.s.c;break;case 2:i[j]=f[j];break;case 3:i[j]=u.header[j-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=l=no(r,null,u),g=b[l]||0,!g)b[l]=1;else{do o=l+"_"+g++;while(b[o]);b[l]=g,b[o]=1}i[j]=o}for(v=c.s.r+n;v<=c.e.r;++v)if(!(k[v]||{}).hidden){var N=Ete(e,c,v,f,s,i,y,u);(N.isempty===!1||(s===1?u.blankrows!==!1:u.blankrows))&&(x[p++]=N.row)}return x.length=p,x}var xE=/"/g;function Pte(e,t,r,s,n,i,l,o){for(var c=!0,u=[],d="",h=Ma(r),f=t.s.c;f<=t.e.c;++f)if(s[f]){var x=o.dense?(e[r]||[])[f]:e[s[f]+h];if(x==null)d="";else if(x.v!=null){c=!1,d=""+(o.rawNumbers&&x.t=="n"?x.v:no(x,null,o));for(var p=0,g=0;p!==d.length;++p)if((g=d.charCodeAt(p))===n||g===i||g===34||o.forceQuotes){d='"'+d.replace(xE,'""')+'"';break}d=="ID"&&(d='"ID"')}else x.f!=null&&!x.F?(c=!1,d="="+x.f,d.indexOf(",")>=0&&(d='"'+d.replace(xE,'""')+'"')):d="";u.push(d)}return o.blankrows===!1&&c?null:u.join(l)}function q2(e,t){var r=[],s=t??{};if(e==null||e["!ref"]==null)return"";var n=Nr(e["!ref"]),i=s.FS!==void 0?s.FS:",",l=i.charCodeAt(0),o=s.RS!==void 0?s.RS:`
`,c=o.charCodeAt(0),u=new RegExp((i=="|"?"\\|":i)+"+$"),d="",h=[];s.dense=Array.isArray(e);for(var f=s.skipHidden&&e["!cols"]||[],x=s.skipHidden&&e["!rows"]||[],p=n.s.c;p<=n.e.c;++p)(f[p]||{}).hidden||(h[p]=va(p));for(var g=0,y=n.s.r;y<=n.e.r;++y)(x[y]||{}).hidden||(d=Pte(e,n,y,h,l,c,i,s),d!=null&&(s.strip&&(d=d.replace(u,"")),(d||s.blankrows!==!1)&&r.push((g++?o:"")+d)));return delete s.dense,r.join("")}function lD(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=q2(e,t);return r}function Ate(e){var t="",r,s="";if(e==null||e["!ref"]==null)return[];var n=Nr(e["!ref"]),i="",l=[],o,c=[],u=Array.isArray(e);for(o=n.s.c;o<=n.e.c;++o)l[o]=va(o);for(var d=n.s.r;d<=n.e.r;++d)for(i=Ma(d),o=n.s.c;o<=n.e.c;++o)if(t=l[o]+i,r=u?(e[d]||[])[o]:e[t],s="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;s=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)s=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)s=""+r.v;else if(r.t=="b")s=r.v?"TRUE":"FALSE";else if(r.w!==void 0)s="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?s="'"+r.v:s=""+r.v}}c[c.length]=t+"="+s}return c}function oD(e,t,r){var s=r||{},n=+!s.skipHeader,i=e||{},l=0,o=0;if(i&&s.origin!=null)if(typeof s.origin=="number")l=s.origin;else{var c=typeof s.origin=="string"?ba(s.origin):s.origin;l=c.r,o=c.c}var u,d={s:{c:0,r:0},e:{c:o,r:l+t.length-1+n}};if(i["!ref"]){var h=Nr(i["!ref"]);d.e.c=Math.max(d.e.c,h.e.c),d.e.r=Math.max(d.e.r,h.e.r),l==-1&&(l=h.e.r+1,d.e.r=l+t.length-1+n)}else l==-1&&(l=0,d.e.r=t.length-1+n);var f=s.header||[],x=0;t.forEach(function(g,y){Oa(g).forEach(function(v){(x=f.indexOf(v))==-1&&(f[x=f.length]=v);var j=g[v],b="z",w="",k=Ht({c:o+x,r:l+y+n});u=Pf(i,k),j&&typeof j=="object"&&!(j instanceof Date)?i[k]=j:(typeof j=="number"?b="n":typeof j=="boolean"?b="b":typeof j=="string"?b="s":j instanceof Date?(b="d",s.cellDates||(b="n",j=rs(j)),w=s.dateNF||Wt[14]):j===null&&s.nullError&&(b="e",j=0),u?(u.t=b,u.v=j,delete u.w,delete u.R,w&&(u.z=w)):i[k]=u={t:b,v:j},w&&(u.z=w))})}),d.e.c=Math.max(d.e.c,o+f.length-1);var p=Ma(l);if(n)for(x=0;x<f.length;++x)i[va(x+o)+p]={t:"s",v:f[x]};return i["!ref"]=sr(d),i}function _te(e,t){return oD(null,e,t)}function Pf(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var s=ba(t);return e[s.r]||(e[s.r]=[]),e[s.r][s.c]||(e[s.r][s.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Pf(e,Ht(t)):Pf(e,Ht({r:t,c:r||0}))}function Tte(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function K2(){return{SheetNames:[],Sheets:{}}}function G2(e,t,r,s){var n=1;if(!r)for(;n<=65535&&e.SheetNames.indexOf(r="Sheet"+n)!=-1;++n,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(s&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);n=i&&+i[2]||0;var l=i&&i[1]||r;for(++n;n<=65535&&e.SheetNames.indexOf(r=l+n)!=-1;++n);}if(HO(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function Ite(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var s=Tte(e,t);switch(e.Workbook.Sheets[s]||(e.Workbook.Sheets[s]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[s].Hidden=r}function Ote(e,t){return e.z=t,e}function cD(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function Dte(e,t,r){return cD(e,"#"+t,r)}function Fte(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function Rte(e,t,r,s){for(var n=typeof t!="string"?t:Nr(t),i=typeof t=="string"?t:sr(t),l=n.s.r;l<=n.e.r;++l)for(var o=n.s.c;o<=n.e.c;++o){var c=Pf(e,l,o);c.t="n",c.F=i,delete c.v,l==n.s.r&&o==n.s.c&&(c.f=r,s&&(c.D=!0))}return e}var wm={encode_col:va,encode_row:Ma,encode_cell:Ht,encode_range:sr,decode_col:N2,decode_row:w2,split_cell:qV,decode_cell:ba,decode_range:Dn,format_cell:no,sheet_add_aoa:RI,sheet_add_json:oD,sheet_add_dom:ZO,aoa_to_sheet:F0,json_to_sheet:_te,table_to_sheet:eD,table_to_book:Uee,sheet_to_csv:q2,sheet_to_txt:lD,sheet_to_json:sg,sheet_to_html:JO,sheet_to_formulae:Ate,sheet_to_row_object_array:sg,sheet_get_cell:Pf,book_new:K2,book_append_sheet:G2,book_set_sheet_visibility:Ite,cell_set_number_format:Ote,cell_set_hyperlink:cD,cell_set_internal_link:Dte,cell_add_comment:Fte,sheet_set_array_formula:Rte,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function dD(e){var t,r,s="";if(typeof e=="string"||typeof e=="number")s+=e;else if(typeof e=="object")if(Array.isArray(e)){var n=e.length;for(t=0;t<n;t++)e[t]&&(r=dD(e[t]))&&(s&&(s+=" "),s+=r)}else for(r in e)e[r]&&(s&&(s+=" "),s+=r);return s}function Ar(){for(var e,t,r=0,s="",n=arguments.length;r<n;r++)(e=arguments[r])&&(t=dD(e))&&(s&&(s+=" "),s+=t);return s}var Mte=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function Q2(e){if(typeof e!="string")return!1;var t=Mte;return t.includes(e)}var Lte=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],$te=new Set(Lte);function uD(e){return typeof e!="string"?!1:$te.has(e)}function hD(e){return typeof e=="string"&&e.startsWith("data-")}function Xn(e){if(typeof e!="object"||e===null)return{};var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(uD(r)||hD(r))&&(t[r]=e[r]);return t}function Dd(e){if(e==null)return null;if(m.isValidElement(e)&&typeof e.props=="object"&&e.props!==null){var t=e.props;return Xn(t)}return typeof e=="object"&&!Array.isArray(e)?Xn(e):null}function fn(e){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(uD(r)||hD(r)||Q2(r))&&(t[r]=e[r]);return t}function Bte(e){return e==null?null:m.isValidElement(e)?fn(e.props):typeof e=="object"&&!Array.isArray(e)?fn(e):null}var zte=["children","width","height","viewBox","className","style","title","desc"];function Yj(){return Yj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Yj.apply(null,arguments)}function Ute(e,t){if(e==null)return{};var r,s,n=Wte(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Wte(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var fD=m.forwardRef((e,t)=>{var{children:r,width:s,height:n,viewBox:i,className:l,style:o,title:c,desc:u}=e,d=Ute(e,zte),h=i||{width:s,height:n,x:0,y:0},f=Ar("recharts-surface",l);return m.createElement("svg",Yj({},fn(d),{className:f,width:s,height:n,style:o,viewBox:"".concat(h.x," ").concat(h.y," ").concat(h.width," ").concat(h.height),ref:t}),m.createElement("title",null,c),m.createElement("desc",null,u),r)}),Vte=["children","className"];function Jj(){return Jj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Jj.apply(null,arguments)}function Hte(e,t){if(e==null)return{};var r,s,n=qte(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function qte(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var ws=m.forwardRef((e,t)=>{var{children:r,className:s}=e,n=Hte(e,Vte),i=Ar("recharts-layer",s);return m.createElement("g",Jj({className:i},fn(n),{ref:t}),r)}),Kte=m.createContext(null);function Xr(e){return function(){return e}}const xD=Math.cos,ng=Math.sin,Xi=Math.sqrt,ig=Math.PI,Dy=2*ig,Zj=Math.PI,ew=2*Zj,Mc=1e-6,Gte=ew-Mc;function mD(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function Qte(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return mD;const r=10**t;return function(s){this._+=s[0];for(let n=1,i=s.length;n<i;++n)this._+=Math.round(arguments[n]*r)/r+s[n]}}class Xte{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?mD:Qte(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,s,n){this._append`Q${+t},${+r},${this._x1=+s},${this._y1=+n}`}bezierCurveTo(t,r,s,n,i,l){this._append`C${+t},${+r},${+s},${+n},${this._x1=+i},${this._y1=+l}`}arcTo(t,r,s,n,i){if(t=+t,r=+r,s=+s,n=+n,i=+i,i<0)throw new Error(`negative radius: ${i}`);let l=this._x1,o=this._y1,c=s-t,u=n-r,d=l-t,h=o-r,f=d*d+h*h;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(f>Mc)if(!(Math.abs(h*c-u*d)>Mc)||!i)this._append`L${this._x1=t},${this._y1=r}`;else{let x=s-l,p=n-o,g=c*c+u*u,y=x*x+p*p,v=Math.sqrt(g),j=Math.sqrt(f),b=i*Math.tan((Zj-Math.acos((g+f-y)/(2*v*j)))/2),w=b/j,k=b/v;Math.abs(w-1)>Mc&&this._append`L${t+w*d},${r+w*h}`,this._append`A${i},${i},0,0,${+(h*x>d*p)},${this._x1=t+k*c},${this._y1=r+k*u}`}}arc(t,r,s,n,i,l){if(t=+t,r=+r,s=+s,l=!!l,s<0)throw new Error(`negative radius: ${s}`);let o=s*Math.cos(n),c=s*Math.sin(n),u=t+o,d=r+c,h=1^l,f=l?n-i:i-n;this._x1===null?this._append`M${u},${d}`:(Math.abs(this._x1-u)>Mc||Math.abs(this._y1-d)>Mc)&&this._append`L${u},${d}`,s&&(f<0&&(f=f%ew+ew),f>Gte?this._append`A${s},${s},0,1,${h},${t-o},${r-c}A${s},${s},0,1,${h},${this._x1=u},${this._y1=d}`:f>Mc&&this._append`A${s},${s},0,${+(f>=Zj)},${h},${this._x1=t+s*Math.cos(i)},${this._y1=r+s*Math.sin(i)}`)}rect(t,r,s,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${s=+s}v${+n}h${-s}Z`}toString(){return this._}}function X2(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const s=Math.floor(r);if(!(s>=0))throw new RangeError(`invalid digits: ${r}`);t=s}return e},()=>new Xte(t)}function Y2(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function pD(e){this._context=e}pD.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Fy(e){return new pD(e)}function gD(e){return e[0]}function yD(e){return e[1]}function vD(e,t){var r=Xr(!0),s=null,n=Fy,i=null,l=X2(o);e=typeof e=="function"?e:e===void 0?gD:Xr(e),t=typeof t=="function"?t:t===void 0?yD:Xr(t);function o(c){var u,d=(c=Y2(c)).length,h,f=!1,x;for(s==null&&(i=n(x=l())),u=0;u<=d;++u)!(u<d&&r(h=c[u],u,c))===f&&((f=!f)?i.lineStart():i.lineEnd()),f&&i.point(+e(h,u,c),+t(h,u,c));if(x)return i=null,x+""||null}return o.x=function(c){return arguments.length?(e=typeof c=="function"?c:Xr(+c),o):e},o.y=function(c){return arguments.length?(t=typeof c=="function"?c:Xr(+c),o):t},o.defined=function(c){return arguments.length?(r=typeof c=="function"?c:Xr(!!c),o):r},o.curve=function(c){return arguments.length?(n=c,s!=null&&(i=n(s)),o):n},o.context=function(c){return arguments.length?(c==null?s=i=null:i=n(s=c),o):s},o}function Nm(e,t,r){var s=null,n=Xr(!0),i=null,l=Fy,o=null,c=X2(u);e=typeof e=="function"?e:e===void 0?gD:Xr(+e),t=typeof t=="function"?t:Xr(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?yD:Xr(+r);function u(h){var f,x,p,g=(h=Y2(h)).length,y,v=!1,j,b=new Array(g),w=new Array(g);for(i==null&&(o=l(j=c())),f=0;f<=g;++f){if(!(f<g&&n(y=h[f],f,h))===v)if(v=!v)x=f,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),p=f-1;p>=x;--p)o.point(b[p],w[p]);o.lineEnd(),o.areaEnd()}v&&(b[f]=+e(y,f,h),w[f]=+t(y,f,h),o.point(s?+s(y,f,h):b[f],r?+r(y,f,h):w[f]))}if(j)return o=null,j+""||null}function d(){return vD().defined(n).curve(l).context(i)}return u.x=function(h){return arguments.length?(e=typeof h=="function"?h:Xr(+h),s=null,u):e},u.x0=function(h){return arguments.length?(e=typeof h=="function"?h:Xr(+h),u):e},u.x1=function(h){return arguments.length?(s=h==null?null:typeof h=="function"?h:Xr(+h),u):s},u.y=function(h){return arguments.length?(t=typeof h=="function"?h:Xr(+h),r=null,u):t},u.y0=function(h){return arguments.length?(t=typeof h=="function"?h:Xr(+h),u):t},u.y1=function(h){return arguments.length?(r=h==null?null:typeof h=="function"?h:Xr(+h),u):r},u.lineX0=u.lineY0=function(){return d().x(e).y(t)},u.lineY1=function(){return d().x(e).y(r)},u.lineX1=function(){return d().x(s).y(t)},u.defined=function(h){return arguments.length?(n=typeof h=="function"?h:Xr(!!h),u):n},u.curve=function(h){return arguments.length?(l=h,i!=null&&(o=l(i)),u):l},u.context=function(h){return arguments.length?(h==null?i=o=null:o=l(i=h),u):i},u}class bD{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function Yte(e){return new bD(e,!0)}function Jte(e){return new bD(e,!1)}const J2={draw(e,t){const r=Xi(t/ig);e.moveTo(r,0),e.arc(0,0,r,0,Dy)}},Zte={draw(e,t){const r=Xi(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},jD=Xi(1/3),ere=jD*2,tre={draw(e,t){const r=Xi(t/ere),s=r*jD;e.moveTo(0,-r),e.lineTo(s,0),e.lineTo(0,r),e.lineTo(-s,0),e.closePath()}},rre={draw(e,t){const r=Xi(t),s=-r/2;e.rect(s,s,r,r)}},are=.8908130915292852,wD=ng(ig/10)/ng(7*ig/10),sre=ng(Dy/10)*wD,nre=-xD(Dy/10)*wD,ire={draw(e,t){const r=Xi(t*are),s=sre*r,n=nre*r;e.moveTo(0,-r),e.lineTo(s,n);for(let i=1;i<5;++i){const l=Dy*i/5,o=xD(l),c=ng(l);e.lineTo(c*r,-o*r),e.lineTo(o*s-c*n,c*s+o*n)}e.closePath()}},zb=Xi(3),lre={draw(e,t){const r=-Xi(t/(zb*3));e.moveTo(0,r*2),e.lineTo(-zb*r,-r),e.lineTo(zb*r,-r),e.closePath()}},ti=-.5,ri=Xi(3)/2,tw=1/Xi(12),ore=(tw/2+1)*3,cre={draw(e,t){const r=Xi(t/ore),s=r/2,n=r*tw,i=s,l=r*tw+r,o=-i,c=l;e.moveTo(s,n),e.lineTo(i,l),e.lineTo(o,c),e.lineTo(ti*s-ri*n,ri*s+ti*n),e.lineTo(ti*i-ri*l,ri*i+ti*l),e.lineTo(ti*o-ri*c,ri*o+ti*c),e.lineTo(ti*s+ri*n,ti*n-ri*s),e.lineTo(ti*i+ri*l,ti*l-ri*i),e.lineTo(ti*o+ri*c,ti*c-ri*o),e.closePath()}};function dre(e,t){let r=null,s=X2(n);e=typeof e=="function"?e:Xr(e||J2),t=typeof t=="function"?t:Xr(t===void 0?64:+t);function n(){let i;if(r||(r=i=s()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),i)return r=null,i+""||null}return n.type=function(i){return arguments.length?(e=typeof i=="function"?i:Xr(i),n):e},n.size=function(i){return arguments.length?(t=typeof i=="function"?i:Xr(+i),n):t},n.context=function(i){return arguments.length?(r=i??null,n):r},n}function lg(){}function og(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function ND(e){this._context=e}ND.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:og(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:og(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function ure(e){return new ND(e)}function SD(e){this._context=e}SD.prototype={areaStart:lg,areaEnd:lg,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:og(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function hre(e){return new SD(e)}function kD(e){this._context=e}kD.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,s=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,s):this._context.moveTo(r,s);break;case 3:this._point=4;default:og(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function fre(e){return new kD(e)}function CD(e){this._context=e}CD.prototype={areaStart:lg,areaEnd:lg,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function xre(e){return new CD(e)}function mE(e){return e<0?-1:1}function pE(e,t,r){var s=e._x1-e._x0,n=t-e._x1,i=(e._y1-e._y0)/(s||n<0&&-0),l=(r-e._y1)/(n||s<0&&-0),o=(i*n+l*s)/(s+n);return(mE(i)+mE(l))*Math.min(Math.abs(i),Math.abs(l),.5*Math.abs(o))||0}function gE(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function Ub(e,t,r){var s=e._x0,n=e._y0,i=e._x1,l=e._y1,o=(i-s)/3;e._context.bezierCurveTo(s+o,n+o*t,i-o,l-o*r,i,l)}function cg(e){this._context=e}cg.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Ub(this,this._t0,gE(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Ub(this,gE(this,r=pE(this,e,t)),r);break;default:Ub(this,this._t0,r=pE(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function ED(e){this._context=new PD(e)}(ED.prototype=Object.create(cg.prototype)).point=function(e,t){cg.prototype.point.call(this,t,e)};function PD(e){this._context=e}PD.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,s,n,i){this._context.bezierCurveTo(t,e,s,r,i,n)}};function mre(e){return new cg(e)}function pre(e){return new ED(e)}function AD(e){this._context=e}AD.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var s=yE(e),n=yE(t),i=0,l=1;l<r;++i,++l)this._context.bezierCurveTo(s[0][i],n[0][i],s[1][i],n[1][i],e[l],t[l]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function yE(e){var t,r=e.length-1,s,n=new Array(r),i=new Array(r),l=new Array(r);for(n[0]=0,i[0]=2,l[0]=e[0]+2*e[1],t=1;t<r-1;++t)n[t]=1,i[t]=4,l[t]=4*e[t]+2*e[t+1];for(n[r-1]=2,i[r-1]=7,l[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)s=n[t]/i[t-1],i[t]-=s,l[t]-=s*l[t-1];for(n[r-1]=l[r-1]/i[r-1],t=r-2;t>=0;--t)n[t]=(l[t]-n[t+1])/i[t];for(i[r-1]=(e[r]+n[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-n[t+1];return[n,i]}function gre(e){return new AD(e)}function Ry(e,t){this._context=e,this._t=t}Ry.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function yre(e){return new Ry(e,.5)}function vre(e){return new Ry(e,0)}function bre(e){return new Ry(e,1)}function x0(e,t){if((l=e.length)>1)for(var r=1,s,n,i=e[t[0]],l,o=i.length;r<l;++r)for(n=i,i=e[t[r]],s=0;s<o;++s)i[s][1]+=i[s][0]=isNaN(n[s][1])?n[s][0]:n[s][1]}function rw(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function jre(e,t){return e[t]}function wre(e){const t=[];return t.key=e,t}function Nre(){var e=Xr([]),t=rw,r=x0,s=jre;function n(i){var l=Array.from(e.apply(this,arguments),wre),o,c=l.length,u=-1,d;for(const h of i)for(o=0,++u;o<c;++o)(l[o][u]=[0,+s(h,l[o].key,u,i)]).data=h;for(o=0,d=Y2(t(l));o<c;++o)l[d[o]].index=o;return r(l,d),l}return n.keys=function(i){return arguments.length?(e=typeof i=="function"?i:Xr(Array.from(i)),n):e},n.value=function(i){return arguments.length?(s=typeof i=="function"?i:Xr(+i),n):s},n.order=function(i){return arguments.length?(t=i==null?rw:typeof i=="function"?i:Xr(Array.from(i)),n):t},n.offset=function(i){return arguments.length?(r=i??x0,n):r},n}function Sre(e,t){if((s=e.length)>0){for(var r,s,n=0,i=e[0].length,l;n<i;++n){for(l=r=0;r<s;++r)l+=e[r][n][1]||0;if(l)for(r=0;r<s;++r)e[r][n][1]/=l}x0(e,t)}}function kre(e,t){if((n=e.length)>0){for(var r=0,s=e[t[0]],n,i=s.length;r<i;++r){for(var l=0,o=0;l<n;++l)o+=e[l][r][1]||0;s[r][1]+=s[r][0]=-o/2}x0(e,t)}}function Cre(e,t){if(!(!((l=e.length)>0)||!((i=(n=e[t[0]]).length)>0))){for(var r=0,s=1,n,i,l;s<i;++s){for(var o=0,c=0,u=0;o<l;++o){for(var d=e[t[o]],h=d[s][1]||0,f=d[s-1][1]||0,x=(h-f)/2,p=0;p<o;++p){var g=e[t[p]],y=g[s][1]||0,v=g[s-1][1]||0;x+=y-v}c+=h,u+=x*h}n[s-1][1]+=n[s-1][0]=r,c&&(r-=u/c)}n[s-1][1]+=n[s-1][0]=r,x0(e,t)}}var My={},_D={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==="__proto__"}e.isUnsafeProperty=t})(_D);var Z2={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}e.isDeepKey=t})(Z2);var Ly={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){var s;return typeof r=="string"||typeof r=="symbol"?r:Object.is((s=r==null?void 0:r.valueOf)==null?void 0:s.call(r),-0)?"-0":String(r)}e.toKey=t})(Ly);var $y={},TD={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(r==null)return"";if(typeof r=="string")return r;if(Array.isArray(r))return r.map(t).join(",");const s=String(r);return s==="0"&&Object.is(Number(r),-0)?"-0":s}e.toString=t})(TD);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=TD,r=Ly;function s(n){if(Array.isArray(n))return n.map(r.toKey);if(typeof n=="symbol")return[n];n=t.toString(n);const i=[],l=n.length;if(l===0)return i;let o=0,c="",u="",d=!1;for(n.charCodeAt(0)===46&&(i.push(""),o++);o<l;){const h=n[o];u?h==="\\"&&o+1<l?(o++,c+=n[o]):h===u?u="":c+=h:d?h==='"'||h==="'"?u=h:h==="]"?(d=!1,i.push(c),c=""):c+=h:h==="["?(d=!0,c&&(i.push(c),c="")):h==="."?c&&(i.push(c),c=""):c+=h,o++}return c&&i.push(c),i}e.toPath=s})($y);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=_D,r=Z2,s=Ly,n=$y;function i(o,c,u){if(o==null)return u;switch(typeof c){case"string":{if(t.isUnsafeProperty(c))return u;const d=o[c];return d===void 0?r.isDeepKey(c)?i(o,n.toPath(c),u):u:d}case"number":case"symbol":{typeof c=="number"&&(c=s.toKey(c));const d=o[c];return d===void 0?u:d}default:{if(Array.isArray(c))return l(o,c,u);if(Object.is(c==null?void 0:c.valueOf(),-0)?c="-0":c=String(c),t.isUnsafeProperty(c))return u;const d=o[c];return d===void 0?u:d}}}function l(o,c,u){if(c.length===0)return u;let d=o;for(let h=0;h<c.length;h++){if(d==null||t.isUnsafeProperty(c[h]))return u;d=d[c[h]]}return d===void 0?u:d}e.get=i})(My);var Ere=My.get;const Fd=xo(Ere);var vs=e=>e===0?0:e>0?1:-1,Ki=e=>typeof e=="number"&&e!=+e,io=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,Et=e=>(typeof e=="number"||e instanceof Number)&&!Ki(e),vl=e=>Et(e)||typeof e=="string",Pre=0,Af=e=>{var t=++Pre;return"".concat(e||"").concat(t)},Qs=function(t,r){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Et(t)&&typeof t!="string")return s;var i;if(io(t)){if(r==null)return s;var l=t.indexOf("%");i=r*parseFloat(t.slice(0,l))/100}else i=+t;return Ki(i)&&(i=s),n&&r!=null&&i>r&&(i=r),i},ID=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,r={},s=0;s<t;s++)if(!r[e[s]])r[e[s]]=!0;else return!0;return!1};function la(e,t,r){return Et(e)&&Et(t)?e+r*(t-e):t}function OD(e,t,r){if(!(!e||!e.length))return e.find(s=>s&&(typeof t=="function"?t(s):Fd(s,t))===r)}var ha=e=>e===null||typeof e>"u",mx=e=>ha(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1));function Are(e){return e!=null}function px(){}var _re=["type","size","sizeType"];function aw(){return aw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},aw.apply(null,arguments)}function vE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function bE(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vE(Object(r),!0).forEach(function(s){Tre(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vE(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Tre(e,t,r){return(t=Ire(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ire(e){var t=Ore(e,"string");return typeof t=="symbol"?t:t+""}function Ore(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Dre(e,t){if(e==null)return{};var r,s,n=Fre(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Fre(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var DD={symbolCircle:J2,symbolCross:Zte,symbolDiamond:tre,symbolSquare:rre,symbolStar:ire,symbolTriangle:lre,symbolWye:cre},Rre=Math.PI/180,Mre=e=>{var t="symbol".concat(mx(e));return DD[t]||J2},Lre=(e,t,r)=>{if(t==="area")return e;switch(r){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var s=18*Rre;return 1.25*e*e*(Math.tan(s)-Math.tan(s*2)*Math.tan(s)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},$re=(e,t)=>{DD["symbol".concat(mx(e))]=t},FD=e=>{var{type:t="circle",size:r=64,sizeType:s="area"}=e,n=Dre(e,_re),i=bE(bE({},n),{},{type:t,size:r,sizeType:s}),l="circle";typeof t=="string"&&(l=t);var o=()=>{var f=Mre(l),x=dre().type(f).size(Lre(r,s,l)),p=x();if(p!==null)return p},{className:c,cx:u,cy:d}=i,h=fn(i);return Et(u)&&Et(d)&&Et(r)?m.createElement("path",aw({},h,{className:Ar("recharts-symbols",c),transform:"translate(".concat(u,", ").concat(d,")"),d:o()})):null};FD.registerSymbol=$re;var RD=e=>"radius"in e&&"startAngle"in e&&"endAngle"in e,eS=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(m.isValidElement(e)&&(r=e.props),typeof r!="object"&&typeof r!="function")return null;var s={};return Object.keys(r).forEach(n=>{Q2(n)&&(s[n]=i=>r[n](r,i))}),s},Bre=(e,t,r)=>s=>(e(t,r,s),null),By=(e,t,r)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var s=null;return Object.keys(e).forEach(n=>{var i=e[n];Q2(n)&&typeof i=="function"&&(s||(s={}),s[n]=Bre(i,t,r))}),s};function jE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function zre(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?jE(Object(r),!0).forEach(function(s){Ure(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jE(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Ure(e,t,r){return(t=Wre(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Wre(e){var t=Vre(e,"string");return typeof t=="symbol"?t:t+""}function Vre(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ns(e,t){var r=zre({},e),s=t,n=Object.keys(t),i=n.reduce((l,o)=>(l[o]===void 0&&s[o]!==void 0&&(l[o]=s[o]),l),r);return i}var MD={},LD={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,s){const n=new Map;for(let i=0;i<r.length;i++){const l=r[i],o=s(l);n.has(o)||n.set(o,l)}return Array.from(n.values())}e.uniqBy=t})(LD);var tS={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r}e.identity=t})(tS);var $D={},zy={},BD={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Number.isSafeInteger(r)&&r>=0}e.isLength=t})(BD);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=BD;function r(s){return s!=null&&typeof s!="function"&&t.isLength(s.length)}e.isArrayLike=r})(zy);var zD={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="object"&&r!==null}e.isObjectLike=t})(zD);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=zy,r=zD;function s(n){return r.isObjectLike(n)&&t.isArrayLike(n)}e.isArrayLikeObject=s})($D);var UD={},WD={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=My;function r(s){return function(n){return t.get(n,s)}}e.property=r})(WD);var VD={},rS={},HD={},aS={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r!==null&&(typeof r=="object"||typeof r=="function")}e.isObject=t})(aS);var sS={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null||typeof r!="object"&&typeof r!="function"}e.isPrimitive=t})(sS);var nS={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,s){return r===s||Number.isNaN(r)&&Number.isNaN(s)}e.eq=t})(nS);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=aS,r=sS,s=nS;function n(d,h,f){return typeof f!="function"?n(d,h,()=>{}):i(d,h,function x(p,g,y,v,j,b){const w=f(p,g,y,v,j,b);return w!==void 0?!!w:i(p,g,x,b)},new Map)}function i(d,h,f,x){if(h===d)return!0;switch(typeof h){case"object":return l(d,h,f,x);case"function":return Object.keys(h).length>0?i(d,{...h},f,x):s.eq(d,h);default:return t.isObject(d)?typeof h=="string"?h==="":!0:s.eq(d,h)}}function l(d,h,f,x){if(h==null)return!0;if(Array.isArray(h))return c(d,h,f,x);if(h instanceof Map)return o(d,h,f,x);if(h instanceof Set)return u(d,h,f,x);const p=Object.keys(h);if(d==null)return p.length===0;if(p.length===0)return!0;if(x!=null&&x.has(h))return x.get(h)===d;x==null||x.set(h,d);try{for(let g=0;g<p.length;g++){const y=p[g];if(!r.isPrimitive(d)&&!(y in d)||h[y]===void 0&&d[y]!==void 0||h[y]===null&&d[y]!==null||!f(d[y],h[y],y,d,h,x))return!1}return!0}finally{x==null||x.delete(h)}}function o(d,h,f,x){if(h.size===0)return!0;if(!(d instanceof Map))return!1;for(const[p,g]of h.entries()){const y=d.get(p);if(f(y,g,p,d,h,x)===!1)return!1}return!0}function c(d,h,f,x){if(h.length===0)return!0;if(!Array.isArray(d))return!1;const p=new Set;for(let g=0;g<h.length;g++){const y=h[g];let v=!1;for(let j=0;j<d.length;j++){if(p.has(j))continue;const b=d[j];let w=!1;if(f(b,y,g,d,h,x)&&(w=!0),w){p.add(j),v=!0;break}}if(!v)return!1}return!0}function u(d,h,f,x){return h.size===0?!0:d instanceof Set?c([...d],[...h],f,x):!1}e.isMatchWith=n,e.isSetMatch=u})(HD);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=HD;function r(s,n){return t.isMatchWith(s,n,()=>{})}e.isMatch=r})(rS);var qD={},iS={},KD={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Object.getOwnPropertySymbols(r).filter(s=>Object.prototype.propertyIsEnumerable.call(r,s))}e.getSymbols=t})(KD);var lS={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}e.getTag=t})(lS);var oS={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t="[object RegExp]",r="[object String]",s="[object Number]",n="[object Boolean]",i="[object Arguments]",l="[object Symbol]",o="[object Date]",c="[object Map]",u="[object Set]",d="[object Array]",h="[object Function]",f="[object ArrayBuffer]",x="[object Object]",p="[object Error]",g="[object DataView]",y="[object Uint8Array]",v="[object Uint8ClampedArray]",j="[object Uint16Array]",b="[object Uint32Array]",w="[object BigUint64Array]",k="[object Int8Array]",N="[object Int16Array]",S="[object Int32Array]",_="[object BigInt64Array]",O="[object Float32Array]",E="[object Float64Array]";e.argumentsTag=i,e.arrayBufferTag=f,e.arrayTag=d,e.bigInt64ArrayTag=_,e.bigUint64ArrayTag=w,e.booleanTag=n,e.dataViewTag=g,e.dateTag=o,e.errorTag=p,e.float32ArrayTag=O,e.float64ArrayTag=E,e.functionTag=h,e.int16ArrayTag=N,e.int32ArrayTag=S,e.int8ArrayTag=k,e.mapTag=c,e.numberTag=s,e.objectTag=x,e.regexpTag=t,e.setTag=u,e.stringTag=r,e.symbolTag=l,e.uint16ArrayTag=j,e.uint32ArrayTag=b,e.uint8ArrayTag=y,e.uint8ClampedArrayTag=v})(oS);var GD={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}e.isTypedArray=t})(GD);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=KD,r=lS,s=oS,n=sS,i=GD;function l(d,h){return o(d,void 0,d,new Map,h)}function o(d,h,f,x=new Map,p=void 0){const g=p==null?void 0:p(d,h,f,x);if(g!==void 0)return g;if(n.isPrimitive(d))return d;if(x.has(d))return x.get(d);if(Array.isArray(d)){const y=new Array(d.length);x.set(d,y);for(let v=0;v<d.length;v++)y[v]=o(d[v],v,f,x,p);return Object.hasOwn(d,"index")&&(y.index=d.index),Object.hasOwn(d,"input")&&(y.input=d.input),y}if(d instanceof Date)return new Date(d.getTime());if(d instanceof RegExp){const y=new RegExp(d.source,d.flags);return y.lastIndex=d.lastIndex,y}if(d instanceof Map){const y=new Map;x.set(d,y);for(const[v,j]of d)y.set(v,o(j,v,f,x,p));return y}if(d instanceof Set){const y=new Set;x.set(d,y);for(const v of d)y.add(o(v,void 0,f,x,p));return y}if(typeof Buffer<"u"&&Buffer.isBuffer(d))return d.subarray();if(i.isTypedArray(d)){const y=new(Object.getPrototypeOf(d)).constructor(d.length);x.set(d,y);for(let v=0;v<d.length;v++)y[v]=o(d[v],v,f,x,p);return y}if(d instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&d instanceof SharedArrayBuffer)return d.slice(0);if(d instanceof DataView){const y=new DataView(d.buffer.slice(0),d.byteOffset,d.byteLength);return x.set(d,y),c(y,d,f,x,p),y}if(typeof File<"u"&&d instanceof File){const y=new File([d],d.name,{type:d.type});return x.set(d,y),c(y,d,f,x,p),y}if(typeof Blob<"u"&&d instanceof Blob){const y=new Blob([d],{type:d.type});return x.set(d,y),c(y,d,f,x,p),y}if(d instanceof Error){const y=new d.constructor;return x.set(d,y),y.message=d.message,y.name=d.name,y.stack=d.stack,y.cause=d.cause,c(y,d,f,x,p),y}if(d instanceof Boolean){const y=new Boolean(d.valueOf());return x.set(d,y),c(y,d,f,x,p),y}if(d instanceof Number){const y=new Number(d.valueOf());return x.set(d,y),c(y,d,f,x,p),y}if(d instanceof String){const y=new String(d.valueOf());return x.set(d,y),c(y,d,f,x,p),y}if(typeof d=="object"&&u(d)){const y=Object.create(Object.getPrototypeOf(d));return x.set(d,y),c(y,d,f,x,p),y}return d}function c(d,h,f=d,x,p){const g=[...Object.keys(h),...t.getSymbols(h)];for(let y=0;y<g.length;y++){const v=g[y],j=Object.getOwnPropertyDescriptor(d,v);(j==null||j.writable)&&(d[v]=o(h[v],v,f,x,p))}}function u(d){switch(r.getTag(d)){case s.argumentsTag:case s.arrayTag:case s.arrayBufferTag:case s.dataViewTag:case s.booleanTag:case s.dateTag:case s.float32ArrayTag:case s.float64ArrayTag:case s.int8ArrayTag:case s.int16ArrayTag:case s.int32ArrayTag:case s.mapTag:case s.numberTag:case s.objectTag:case s.regexpTag:case s.setTag:case s.stringTag:case s.symbolTag:case s.uint8ArrayTag:case s.uint8ClampedArrayTag:case s.uint16ArrayTag:case s.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=l,e.cloneDeepWithImpl=o,e.copyProperties=c})(iS);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=iS;function r(s){return t.cloneDeepWithImpl(s,void 0,s,new Map,void 0)}e.cloneDeep=r})(qD);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=rS,r=qD;function s(n){return n=r.cloneDeep(n),i=>t.isMatch(i,n)}e.matches=s})(VD);var QD={},XD={},YD={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=iS,r=oS;function s(n,i){return t.cloneDeepWith(n,(l,o,c,u)=>{const d=i==null?void 0:i(l,o,c,u);if(d!==void 0)return d;if(typeof n=="object")switch(Object.prototype.toString.call(n)){case r.numberTag:case r.stringTag:case r.booleanTag:{const h=new n.constructor(n==null?void 0:n.valueOf());return t.copyProperties(h,n),h}case r.argumentsTag:{const h={};return t.copyProperties(h,n),h.length=n.length,h[Symbol.iterator]=n[Symbol.iterator],h}default:return}})}e.cloneDeepWith=s})(YD);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=YD;function r(s){return t.cloneDeepWith(s)}e.cloneDeep=r})(XD);var JD={},cS={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=/^(?:0|[1-9]\d*)$/;function r(s,n=Number.MAX_SAFE_INTEGER){switch(typeof s){case"number":return Number.isInteger(s)&&s>=0&&s<n;case"symbol":return!1;case"string":return t.test(s)}}e.isIndex=r})(cS);var ZD={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=lS;function r(s){return s!==null&&typeof s=="object"&&t.getTag(s)==="[object Arguments]"}e.isArguments=r})(ZD);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Z2,r=cS,s=ZD,n=$y;function i(l,o){let c;if(Array.isArray(o)?c=o:typeof o=="string"&&t.isDeepKey(o)&&(l==null?void 0:l[o])==null?c=n.toPath(o):c=[o],c.length===0)return!1;let u=l;for(let d=0;d<c.length;d++){const h=c[d];if((u==null||!Object.hasOwn(u,h))&&!((Array.isArray(u)||s.isArguments(u))&&r.isIndex(h)&&h<u.length))return!1;u=u[h]}return!0}e.has=i})(JD);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=rS,r=Ly,s=XD,n=My,i=JD;function l(o,c){switch(typeof o){case"object":{Object.is(o==null?void 0:o.valueOf(),-0)&&(o="-0");break}case"number":{o=r.toKey(o);break}}return c=s.cloneDeep(c),function(u){const d=n.get(u,o);return d===void 0?i.has(u,o):c===void 0?d===void 0:t.isMatch(d,c)}}e.matchesProperty=l})(QD);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=tS,r=WD,s=VD,n=QD;function i(l){if(l==null)return t.identity;switch(typeof l){case"function":return l;case"object":return Array.isArray(l)&&l.length===2?n.matchesProperty(l[0],l[1]):s.matches(l);case"string":case"symbol":case"number":return r.property(l)}}e.iteratee=i})(UD);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=LD,r=tS,s=$D,n=UD;function i(l,o=r.identity){return s.isArrayLikeObject(l)?t.uniqBy(Array.from(l),n.iteratee(o)):[]}e.uniqBy=i})(MD);var Hre=MD.uniqBy;const wE=xo(Hre);function qre(e,t,r){return t===!0?wE(e,r):typeof t=="function"?wE(e,t):e}var eF={exports:{}},tF={},rF={exports:{}},aF={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var m0=m;function Kre(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Gre=typeof Object.is=="function"?Object.is:Kre,Qre=m0.useState,Xre=m0.useEffect,Yre=m0.useLayoutEffect,Jre=m0.useDebugValue;function Zre(e,t){var r=t(),s=Qre({inst:{value:r,getSnapshot:t}}),n=s[0].inst,i=s[1];return Yre(function(){n.value=r,n.getSnapshot=t,Wb(n)&&i({inst:n})},[e,r,t]),Xre(function(){return Wb(n)&&i({inst:n}),e(function(){Wb(n)&&i({inst:n})})},[e]),Jre(r),r}function Wb(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Gre(e,r)}catch{return!0}}function eae(e,t){return t()}var tae=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?eae:Zre;aF.useSyncExternalStore=m0.useSyncExternalStore!==void 0?m0.useSyncExternalStore:tae;rF.exports=aF;var rae=rF.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Uy=m,aae=rae;function sae(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var nae=typeof Object.is=="function"?Object.is:sae,iae=aae.useSyncExternalStore,lae=Uy.useRef,oae=Uy.useEffect,cae=Uy.useMemo,dae=Uy.useDebugValue;tF.useSyncExternalStoreWithSelector=function(e,t,r,s,n){var i=lae(null);if(i.current===null){var l={hasValue:!1,value:null};i.current=l}else l=i.current;i=cae(function(){function c(x){if(!u){if(u=!0,d=x,x=s(x),n!==void 0&&l.hasValue){var p=l.value;if(n(p,x))return h=p}return h=x}if(p=h,nae(d,x))return p;var g=s(x);return n!==void 0&&n(p,g)?(d=x,p):(d=x,h=g)}var u=!1,d,h,f=r===void 0?null:r;return[function(){return c(t())},f===null?void 0:function(){return c(f())}]},[t,r,s,n]);var o=iae(e,i[0],i[1]);return oae(function(){l.hasValue=!0,l.value=o},[o]),dae(o),o};eF.exports=tF;var uae=eF.exports,dS=m.createContext(null),hae=e=>e,fa=()=>{var e=m.useContext(dS);return e?e.store.dispatch:hae},np=()=>{},fae=()=>np,xae=(e,t)=>e===t;function St(e){var t=m.useContext(dS);return uae.useSyncExternalStoreWithSelector(t?t.subscription.addNestedSub:fae,t?t.store.getState:np,t?t.store.getState:np,t?e:np,xae)}function mae(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function pae(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function gae(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){const r=e.map(s=>typeof s=="function"?`function ${s.name||"unnamed"}()`:typeof s).join(", ");throw new TypeError(`${t}[${r}]`)}}var NE=e=>Array.isArray(e)?e:[e];function yae(e){const t=Array.isArray(e[0])?e[0]:e;return gae(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function vae(e,t){const r=[],{length:s}=e;for(let n=0;n<s;n++)r.push(e[n].apply(null,t));return r}var bae=class{constructor(e){this.value=e}deref(){return this.value}},jae=typeof WeakRef<"u"?WeakRef:bae,wae=0,SE=1;function Sm(){return{s:wae,v:void 0,o:null,p:null}}function sF(e,t={}){let r=Sm();const{resultEqualityCheck:s}=t;let n,i=0;function l(){var h;let o=r;const{length:c}=arguments;for(let f=0,x=c;f<x;f++){const p=arguments[f];if(typeof p=="function"||typeof p=="object"&&p!==null){let g=o.o;g===null&&(o.o=g=new WeakMap);const y=g.get(p);y===void 0?(o=Sm(),g.set(p,o)):o=y}else{let g=o.p;g===null&&(o.p=g=new Map);const y=g.get(p);y===void 0?(o=Sm(),g.set(p,o)):o=y}}const u=o;let d;if(o.s===SE)d=o.v;else if(d=e.apply(null,arguments),i++,s){const f=((h=n==null?void 0:n.deref)==null?void 0:h.call(n))??n;f!=null&&s(f,d)&&(d=f,i!==0&&i--),n=typeof d=="object"&&d!==null||typeof d=="function"?new jae(d):d}return u.s=SE,u.v=d,d}return l.clearCache=()=>{r=Sm(),l.resetResultsCount()},l.resultsCount=()=>i,l.resetResultsCount=()=>{i=0},l}function Nae(e,...t){const r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,s=(...n)=>{let i=0,l=0,o,c={},u=n.pop();typeof u=="object"&&(c=u,u=n.pop()),mae(u,`createSelector expects an output function after the inputs, but received: [${typeof u}]`);const d={...r,...c},{memoize:h,memoizeOptions:f=[],argsMemoize:x=sF,argsMemoizeOptions:p=[]}=d,g=NE(f),y=NE(p),v=yae(n),j=h(function(){return i++,u.apply(null,arguments)},...g),b=x(function(){l++;const k=vae(v,arguments);return o=j.apply(null,k),o},...y);return Object.assign(b,{resultFunc:u,memoizedResultFunc:j,dependencies:v,dependencyRecomputations:()=>l,resetDependencyRecomputations:()=>{l=0},lastResult:()=>o,recomputations:()=>i,resetRecomputations:()=>{i=0},memoize:h,argsMemoize:x})};return Object.assign(s,{withTypes:()=>s}),s}var Te=Nae(sF),Sae=Object.assign((e,t=Te)=>{pae(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const r=Object.keys(e),s=r.map(i=>e[i]);return t(s,(...i)=>i.reduce((l,o,c)=>(l[r[c]]=o,l),{}))},{withTypes:()=>Sae}),nF={},iF={},lF={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(s){return typeof s=="symbol"?1:s===null?2:s===void 0?3:s!==s?4:0}const r=(s,n,i)=>{if(s!==n){const l=t(s),o=t(n);if(l===o&&l===0){if(s<n)return i==="desc"?1:-1;if(s>n)return i==="desc"?-1:1}return i==="desc"?o-l:l-o}return 0};e.compareValues=r})(lF);var oF={},uS={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="symbol"||r instanceof Symbol}e.isSymbol=t})(uS);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=uS,r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/;function n(i,l){return Array.isArray(i)?!1:typeof i=="number"||typeof i=="boolean"||i==null||t.isSymbol(i)?!0:typeof i=="string"&&(s.test(i)||!r.test(i))||l!=null&&Object.hasOwn(l,i)}e.isKey=n})(oF);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=lF,r=oF,s=$y;function n(i,l,o,c){if(i==null)return[];o=c?void 0:o,Array.isArray(i)||(i=Object.values(i)),Array.isArray(l)||(l=l==null?[null]:[l]),l.length===0&&(l=[null]),Array.isArray(o)||(o=o==null?[]:[o]),o=o.map(x=>String(x));const u=(x,p)=>{let g=x;for(let y=0;y<p.length&&g!=null;++y)g=g[p[y]];return g},d=(x,p)=>p==null||x==null?p:typeof x=="object"&&"key"in x?Object.hasOwn(p,x.key)?p[x.key]:u(p,x.path):typeof x=="function"?x(p):Array.isArray(x)?u(p,x):typeof p=="object"?p[x]:p,h=l.map(x=>(Array.isArray(x)&&x.length===1&&(x=x[0]),x==null||typeof x=="function"||Array.isArray(x)||r.isKey(x)?x:{key:x,path:s.toPath(x)}));return i.map(x=>({original:x,criteria:h.map(p=>d(p,x))})).slice().sort((x,p)=>{for(let g=0;g<h.length;g++){const y=t.compareValues(x.criteria[g],p.criteria[g],o[g]);if(y!==0)return y}return 0}).map(x=>x.original)}e.orderBy=n})(iF);var cF={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,s=1){const n=[],i=Math.floor(s),l=(o,c)=>{for(let u=0;u<o.length;u++){const d=o[u];Array.isArray(d)&&c<i?l(d,c+1):n.push(d)}};return l(r,0),n}e.flatten=t})(cF);var hS={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=cS,r=zy,s=aS,n=nS;function i(l,o,c){return s.isObject(c)&&(typeof o=="number"&&r.isArrayLike(c)&&t.isIndex(o)&&o<c.length||typeof o=="string"&&o in c)?n.eq(c[o],l):!1}e.isIterateeCall=i})(hS);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=iF,r=cF,s=hS;function n(i,...l){const o=l.length;return o>1&&s.isIterateeCall(i,l[0],l[1])?l=[]:o>2&&s.isIterateeCall(l[0],l[1],l[2])&&(l=[l[0]]),t.orderBy(i,r.flatten(l),["asc"])}e.sortBy=n})(nF);var kae=nF.sortBy;const Wy=xo(kae);var dF=e=>e.legend.settings,Cae=e=>e.legend.size,Eae=e=>e.legend.payload;Te([Eae,dF],(e,t)=>{var{itemSorter:r}=t,s=e.flat(1);return r?Wy(s,r):s});var km=1;function Pae(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,r]=m.useState({height:0,left:0,top:0,width:0}),s=m.useCallback(n=>{if(n!=null){var i=n.getBoundingClientRect(),l={height:i.height,left:i.left,top:i.top,width:i.width};(Math.abs(l.height-t.height)>km||Math.abs(l.left-t.left)>km||Math.abs(l.top-t.top)>km||Math.abs(l.width-t.width)>km)&&r({height:l.height,left:l.left,top:l.top,width:l.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,s]}function Cs(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var Aae=typeof Symbol=="function"&&Symbol.observable||"@@observable",kE=Aae,Vb=()=>Math.random().toString(36).substring(7).split("").join("."),_ae={INIT:`@@redux/INIT${Vb()}`,REPLACE:`@@redux/REPLACE${Vb()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${Vb()}`},dg=_ae;function fS(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function uF(e,t,r){if(typeof e!="function")throw new Error(Cs(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(Cs(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(Cs(1));return r(uF)(e,t)}let s=e,n=t,i=new Map,l=i,o=0,c=!1;function u(){l===i&&(l=new Map,i.forEach((y,v)=>{l.set(v,y)}))}function d(){if(c)throw new Error(Cs(3));return n}function h(y){if(typeof y!="function")throw new Error(Cs(4));if(c)throw new Error(Cs(5));let v=!0;u();const j=o++;return l.set(j,y),function(){if(v){if(c)throw new Error(Cs(6));v=!1,u(),l.delete(j),i=null}}}function f(y){if(!fS(y))throw new Error(Cs(7));if(typeof y.type>"u")throw new Error(Cs(8));if(typeof y.type!="string")throw new Error(Cs(17));if(c)throw new Error(Cs(9));try{c=!0,n=s(n,y)}finally{c=!1}return(i=l).forEach(j=>{j()}),y}function x(y){if(typeof y!="function")throw new Error(Cs(10));s=y,f({type:dg.REPLACE})}function p(){const y=h;return{subscribe(v){if(typeof v!="object"||v===null)throw new Error(Cs(11));function j(){const w=v;w.next&&w.next(d())}return j(),{unsubscribe:y(j)}},[kE](){return this}}}return f({type:dg.INIT}),{dispatch:f,subscribe:h,getState:d,replaceReducer:x,[kE]:p}}function Tae(e){Object.keys(e).forEach(t=>{const r=e[t];if(typeof r(void 0,{type:dg.INIT})>"u")throw new Error(Cs(12));if(typeof r(void 0,{type:dg.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Cs(13))})}function hF(e){const t=Object.keys(e),r={};for(let i=0;i<t.length;i++){const l=t[i];typeof e[l]=="function"&&(r[l]=e[l])}const s=Object.keys(r);let n;try{Tae(r)}catch(i){n=i}return function(l={},o){if(n)throw n;let c=!1;const u={};for(let d=0;d<s.length;d++){const h=s[d],f=r[h],x=l[h],p=f(x,o);if(typeof p>"u")throw o&&o.type,new Error(Cs(14));u[h]=p,c=c||p!==x}return c=c||s.length!==Object.keys(l).length,c?u:l}}function ug(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...s)=>t(r(...s)))}function Iae(...e){return t=>(r,s)=>{const n=t(r,s);let i=()=>{throw new Error(Cs(15))};const l={getState:n.getState,dispatch:(c,...u)=>i(c,...u)},o=e.map(c=>c(l));return i=ug(...o)(n.dispatch),{...n,dispatch:i}}}function fF(e){return fS(e)&&"type"in e&&typeof e.type=="string"}var xF=Symbol.for("immer-nothing"),CE=Symbol.for("immer-draftable"),xn=Symbol.for("immer-state");function Fi(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Hn=Object,p0=Hn.getPrototypeOf,hg="constructor",Vy="prototype",sw="configurable",fg="enumerable",ip="writable",_f="value",lo=e=>!!e&&!!e[xn];function Gi(e){var t;return e?mF(e)||Hy(e)||!!e[CE]||!!((t=e[hg])!=null&&t[CE])||qy(e)||Ky(e):!1}var Oae=Hn[Vy][hg].toString(),EE=new WeakMap;function mF(e){if(!e||!xS(e))return!1;const t=p0(e);if(t===null||t===Hn[Vy])return!0;const r=Hn.hasOwnProperty.call(t,hg)&&t[hg];if(r===Object)return!0;if(!hu(r))return!1;let s=EE.get(r);return s===void 0&&(s=Function.toString.call(r),EE.set(r,s)),s===Oae}function gx(e,t,r=!0){yx(e)===0?(r?Reflect.ownKeys(e):Hn.keys(e)).forEach(n=>{t(n,e[n],e)}):e.forEach((s,n)=>t(n,s,e))}function yx(e){const t=e[xn];return t?t.type_:Hy(e)?1:qy(e)?2:Ky(e)?3:0}var PE=(e,t,r=yx(e))=>r===2?e.has(t):Hn[Vy].hasOwnProperty.call(e,t),nw=(e,t,r=yx(e))=>r===2?e.get(t):e[t],xg=(e,t,r,s=yx(e))=>{s===2?e.set(t,r):s===3?e.add(r):e[t]=r};function Dae(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}var Hy=Array.isArray,qy=e=>e instanceof Map,Ky=e=>e instanceof Set,xS=e=>typeof e=="object",hu=e=>typeof e=="function",Hb=e=>typeof e=="boolean",Ol=e=>e.copy_||e.base_,mS=e=>e.modified_?e.copy_:e.base_;function iw(e,t){if(qy(e))return new Map(e);if(Ky(e))return new Set(e);if(Hy(e))return Array[Vy].slice.call(e);const r=mF(e);if(t===!0||t==="class_only"&&!r){const s=Hn.getOwnPropertyDescriptors(e);delete s[xn];let n=Reflect.ownKeys(s);for(let i=0;i<n.length;i++){const l=n[i],o=s[l];o[ip]===!1&&(o[ip]=!0,o[sw]=!0),(o.get||o.set)&&(s[l]={[sw]:!0,[ip]:!0,[fg]:o[fg],[_f]:e[l]})}return Hn.create(p0(e),s)}else{const s=p0(e);if(s!==null&&r)return{...e};const n=Hn.create(s);return Hn.assign(n,e)}}function pS(e,t=!1){return Gy(e)||lo(e)||!Gi(e)||(yx(e)>1&&Hn.defineProperties(e,{set:Cm,add:Cm,clear:Cm,delete:Cm}),Hn.freeze(e),t&&gx(e,(r,s)=>{pS(s,!0)},!1)),e}function Fae(){Fi(2)}var Cm={[_f]:Fae};function Gy(e){return e===null||!xS(e)?!0:Hn.isFrozen(e)}var mg="MapSet",lw="Patches",pF={};function g0(e){const t=pF[e];return t||Fi(0,e),t}var Rae=e=>!!pF[e],Tf,gF=()=>Tf,Mae=(e,t)=>({drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0,handledSet_:new Set,processedForPatches_:new Set,mapSetPlugin_:Rae(mg)?g0(mg):void 0});function AE(e,t){t&&(e.patchPlugin_=g0(lw),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function ow(e){cw(e),e.drafts_.forEach(Lae),e.drafts_=null}function cw(e){e===Tf&&(Tf=e.parent_)}var _E=e=>Tf=Mae(Tf,e);function Lae(e){const t=e[xn];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function TE(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];if(e!==void 0&&e!==r){r[xn].modified_&&(ow(t),Fi(4)),Gi(e)&&(e=IE(t,e));const{patchPlugin_:n}=t;n&&n.generateReplacementPatches_(r[xn].base_,e,t)}else e=IE(t,r);return $ae(t,e,!0),ow(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==xF?e:void 0}function IE(e,t){if(Gy(t))return t;const r=t[xn];if(!r)return gS(t,e.handledSet_,e);if(!Qy(r,e))return t;if(!r.modified_)return r.base_;if(!r.finalized_){const{callbacks_:s}=r;if(s)for(;s.length>0;)s.pop()(e);bF(r,e)}return r.copy_}function $ae(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&pS(t,r)}function yF(e){e.finalized_=!0,e.scope_.unfinalizedDrafts_--}var Qy=(e,t)=>e.scope_===t,Bae=[];function vF(e,t,r,s){const n=Ol(e),i=e.type_;if(s!==void 0&&nw(n,s,i)===t){xg(n,s,r,i);return}if(!e.draftLocations_){const o=e.draftLocations_=new Map;gx(n,(c,u)=>{if(lo(u)){const d=o.get(u)||[];d.push(c),o.set(u,d)}})}const l=e.draftLocations_.get(t)??Bae;for(const o of l)xg(n,o,r,i)}function zae(e,t,r){e.callbacks_.push(function(n){var o;const i=t;if(!i||!Qy(i,n))return;(o=n.mapSetPlugin_)==null||o.fixSetContents(i);const l=mS(i);vF(e,i.draft_??i,l,r),bF(i,n)})}function bF(e,t){var s;if(e.modified_&&!e.finalized_&&(e.type_===3||(((s=e.assigned_)==null?void 0:s.size)??0)>0)){const{patchPlugin_:n}=t;if(n){const i=n.getPath(e);i&&n.generatePatches_(e,i,t)}yF(e)}}function Uae(e,t,r){const{scope_:s}=e;if(lo(r)){const n=r[xn];Qy(n,s)&&n.callbacks_.push(function(){lp(e);const l=mS(n);vF(e,r,l,t)})}else Gi(r)&&e.callbacks_.push(function(){const i=Ol(e);nw(i,t,e.type_)===r&&s.drafts_.length>1&&(e.assigned_.get(t)??!1)===!0&&e.copy_&&gS(nw(e.copy_,t,e.type_),s.handledSet_,s)})}function gS(e,t,r){return!r.immer_.autoFreeze_&&r.unfinalizedDrafts_<1||lo(e)||t.has(e)||!Gi(e)||Gy(e)||(t.add(e),gx(e,(s,n)=>{if(lo(n)){const i=n[xn];if(Qy(i,r)){const l=mS(i);xg(e,s,l,e.type_),yF(i)}}else Gi(n)&&gS(n,t,r)})),e}function Wae(e,t){const r=Hy(e),s={type_:r?1:0,scope_:t?t.scope_:gF(),modified_:!1,finalized_:!1,assigned_:void 0,parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1,callbacks_:void 0};let n=s,i=yS;r&&(n=[s],i=If);const{revoke:l,proxy:o}=Proxy.revocable(n,i);return s.draft_=o,s.revoke_=l,[o,s]}var yS={get(e,t){if(t===xn)return e;const r=Ol(e);if(!PE(r,t,e.type_))return Vae(e,r,t);const s=r[t];if(e.finalized_||!Gi(s))return s;if(s===qb(e.base_,t)){lp(e);const n=e.type_===1?+t:t,i=uw(e.scope_,s,e,n);return e.copy_[n]=i}return s},has(e,t){return t in Ol(e)},ownKeys(e){return Reflect.ownKeys(Ol(e))},set(e,t,r){const s=jF(Ol(e),t);if(s!=null&&s.set)return s.set.call(e.draft_,r),!0;if(!e.modified_){const n=qb(Ol(e),t),i=n==null?void 0:n[xn];if(i&&i.base_===r)return e.copy_[t]=r,e.assigned_.set(t,!1),!0;if(Dae(r,n)&&(r!==void 0||PE(e.base_,t,e.type_)))return!0;lp(e),dw(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_.set(t,!0),Uae(e,t,r)),!0},deleteProperty(e,t){return lp(e),qb(e.base_,t)!==void 0||t in e.base_?(e.assigned_.set(t,!1),dw(e)):e.assigned_.delete(t),e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=Ol(e),s=Reflect.getOwnPropertyDescriptor(r,t);return s&&{[ip]:!0,[sw]:e.type_!==1||t!=="length",[fg]:s[fg],[_f]:r[t]}},defineProperty(){Fi(11)},getPrototypeOf(e){return p0(e.base_)},setPrototypeOf(){Fi(12)}},If={};gx(yS,(e,t)=>{If[e]=function(){const r=arguments;return r[0]=r[0][0],t.apply(this,r)}});If.deleteProperty=function(e,t){return If.set.call(this,e,t,void 0)};If.set=function(e,t,r){return yS.set.call(this,e[0],t,r,e[0])};function qb(e,t){const r=e[xn];return(r?Ol(r):e)[t]}function Vae(e,t,r){var n;const s=jF(t,r);return s?_f in s?s[_f]:(n=s.get)==null?void 0:n.call(e.draft_):void 0}function jF(e,t){if(!(t in e))return;let r=p0(e);for(;r;){const s=Object.getOwnPropertyDescriptor(r,t);if(s)return s;r=p0(r)}}function dw(e){e.modified_||(e.modified_=!0,e.parent_&&dw(e.parent_))}function lp(e){e.copy_||(e.assigned_=new Map,e.copy_=iw(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var Hae=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!1,this.produce=(r,s,n)=>{if(hu(r)&&!hu(s)){const l=s;s=r;const o=this;return function(u=l,...d){return o.produce(u,h=>s.call(this,h,...d))}}hu(s)||Fi(6),n!==void 0&&!hu(n)&&Fi(7);let i;if(Gi(r)){const l=_E(this),o=uw(l,r,void 0);let c=!0;try{i=s(o),c=!1}finally{c?ow(l):cw(l)}return AE(l,n),TE(i,l)}else if(!r||!xS(r)){if(i=s(r),i===void 0&&(i=r),i===xF&&(i=void 0),this.autoFreeze_&&pS(i,!0),n){const l=[],o=[];g0(lw).generateReplacementPatches_(r,i,{patches_:l,inversePatches_:o}),n(l,o)}return i}else Fi(1,r)},this.produceWithPatches=(r,s)=>{if(hu(r))return(o,...c)=>this.produceWithPatches(o,u=>r(u,...c));let n,i;return[this.produce(r,s,(o,c)=>{n=o,i=c}),n,i]},Hb(t==null?void 0:t.autoFreeze)&&this.setAutoFreeze(t.autoFreeze),Hb(t==null?void 0:t.useStrictShallowCopy)&&this.setUseStrictShallowCopy(t.useStrictShallowCopy),Hb(t==null?void 0:t.useStrictIteration)&&this.setUseStrictIteration(t.useStrictIteration)}createDraft(t){Gi(t)||Fi(8),lo(t)&&(t=Vi(t));const r=_E(this),s=uw(r,t,void 0);return s[xn].isManual_=!0,cw(r),s}finishDraft(t,r){const s=t&&t[xn];(!s||!s.isManual_)&&Fi(9);const{scope_:n}=s;return AE(n,r),TE(void 0,n)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}setUseStrictIteration(t){this.useStrictIteration_=t}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(t,r){let s;for(s=r.length-1;s>=0;s--){const i=r[s];if(i.path.length===0&&i.op==="replace"){t=i.value;break}}s>-1&&(r=r.slice(s+1));const n=g0(lw).applyPatches_;return lo(t)?n(t,r):this.produce(t,i=>n(i,r))}};function uw(e,t,r,s){const[n,i]=qy(t)?g0(mg).proxyMap_(t,r):Ky(t)?g0(mg).proxySet_(t,r):Wae(t,r);return((r==null?void 0:r.scope_)??gF()).drafts_.push(n),i.callbacks_=(r==null?void 0:r.callbacks_)??[],i.key_=s,r&&s!==void 0?zae(r,i,s):i.callbacks_.push(function(c){var d;(d=c.mapSetPlugin_)==null||d.fixSetContents(i);const{patchPlugin_:u}=c;i.modified_&&u&&u.generatePatches_(i,[],c)}),n}function Vi(e){return lo(e)||Fi(10,e),wF(e)}function wF(e){if(!Gi(e)||Gy(e))return e;const t=e[xn];let r,s=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=iw(e,t.scope_.immer_.useStrictShallowCopy_),s=t.scope_.immer_.shouldUseStrictIteration()}else r=iw(e,!0);return gx(r,(n,i)=>{xg(r,n,wF(i))},s),t&&(t.finalized_=!1),r}var qae=new Hae,NF=qae.produce;function SF(e){return({dispatch:r,getState:s})=>n=>i=>typeof i=="function"?i(r,s,e):n(i)}var Kae=SF(),Gae=SF,Qae=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?ug:ug.apply(null,arguments)};function bi(e,t){function r(...s){if(t){let n=t(...s);if(!n)throw new Error(Kn(0));return{type:e,payload:n.payload,..."meta"in n&&{meta:n.meta},..."error"in n&&{error:n.error}}}return{type:e,payload:s[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=s=>fF(s)&&s.type===e,r}var kF=class Nh extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,Nh.prototype)}static get[Symbol.species](){return Nh}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new Nh(...t[0].concat(this)):new Nh(...t.concat(this))}};function OE(e){return Gi(e)?NF(e,()=>{}):e}function Em(e,t,r){return e.has(t)?e.get(t):e.set(t,r(t)).get(t)}function Xae(e){return typeof e=="boolean"}var Yae=()=>function(t){const{thunk:r=!0,immutableCheck:s=!0,serializableCheck:n=!0,actionCreatorCheck:i=!0}=t??{};let l=new kF;return r&&(Xae(r)?l.push(Kae):l.push(Gae(r.extraArgument))),l},CF="RTK_autoBatch",ia=()=>e=>({payload:e,meta:{[CF]:!0}}),DE=e=>t=>{setTimeout(t,e)},EF=(e={type:"raf"})=>t=>(...r)=>{const s=t(...r);let n=!0,i=!1,l=!1;const o=new Set,c=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:DE(10):e.type==="callback"?e.queueNotification:DE(e.timeout),u=()=>{l=!1,i&&(i=!1,o.forEach(d=>d()))};return Object.assign({},s,{subscribe(d){const h=()=>n&&d(),f=s.subscribe(h);return o.add(d),()=>{f(),o.delete(d)}},dispatch(d){var h;try{return n=!((h=d==null?void 0:d.meta)!=null&&h[CF]),i=!n,i&&(l||(l=!0,c(u))),s.dispatch(d)}finally{n=!0}}})},Jae=e=>function(r){const{autoBatch:s=!0}=r??{};let n=new kF(e);return s&&n.push(EF(typeof s=="object"?s:void 0)),n};function Zae(e){const t=Yae(),{reducer:r=void 0,middleware:s,devTools:n=!0,preloadedState:i=void 0,enhancers:l=void 0}=e||{};let o;if(typeof r=="function")o=r;else if(fS(r))o=hF(r);else throw new Error(Kn(1));let c;typeof s=="function"?c=s(t):c=t();let u=ug;n&&(u=Qae({trace:!1,...typeof n=="object"&&n}));const d=Iae(...c),h=Jae(d);let f=typeof l=="function"?l(h):h();const x=u(...f);return uF(o,i,x)}function PF(e){const t={},r=[];let s;const n={addCase(i,l){const o=typeof i=="string"?i:i.type;if(!o)throw new Error(Kn(28));if(o in t)throw new Error(Kn(29));return t[o]=l,n},addAsyncThunk(i,l){return l.pending&&(t[i.pending.type]=l.pending),l.rejected&&(t[i.rejected.type]=l.rejected),l.fulfilled&&(t[i.fulfilled.type]=l.fulfilled),l.settled&&r.push({matcher:i.settled,reducer:l.settled}),n},addMatcher(i,l){return r.push({matcher:i,reducer:l}),n},addDefaultCase(i){return s=i,n}};return e(n),[t,r,s]}function ese(e){return typeof e=="function"}function tse(e,t){let[r,s,n]=PF(t),i;if(ese(e))i=()=>OE(e());else{const o=OE(e);i=()=>o}function l(o=i(),c){let u=[r[c.type],...s.filter(({matcher:d})=>d(c)).map(({reducer:d})=>d)];return u.filter(d=>!!d).length===0&&(u=[n]),u.reduce((d,h)=>{if(h)if(lo(d)){const x=h(d,c);return x===void 0?d:x}else{if(Gi(d))return NF(d,f=>h(f,c));{const f=h(d,c);if(f===void 0){if(d===null)return d;throw Error("A case reducer on a non-draftable value must not return undefined")}return f}}return d},o)}return l.getInitialState=i,l}var rse="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",ase=(e=21)=>{let t="",r=e;for(;r--;)t+=rse[Math.random()*64|0];return t},sse=Symbol.for("rtk-slice-createasyncthunk");function nse(e,t){return`${e}/${t}`}function ise({creators:e}={}){var r;const t=(r=e==null?void 0:e.asyncThunk)==null?void 0:r[sse];return function(n){const{name:i,reducerPath:l=i}=n;if(!i)throw new Error(Kn(11));const o=(typeof n.reducers=="function"?n.reducers(ose()):n.reducers)||{},c=Object.keys(o),u={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},d={addCase(w,k){const N=typeof w=="string"?w:w.type;if(!N)throw new Error(Kn(12));if(N in u.sliceCaseReducersByType)throw new Error(Kn(13));return u.sliceCaseReducersByType[N]=k,d},addMatcher(w,k){return u.sliceMatchers.push({matcher:w,reducer:k}),d},exposeAction(w,k){return u.actionCreators[w]=k,d},exposeCaseReducer(w,k){return u.sliceCaseReducersByName[w]=k,d}};c.forEach(w=>{const k=o[w],N={reducerName:w,type:nse(i,w),createNotation:typeof n.reducers=="function"};dse(k)?hse(N,k,d,t):cse(N,k,d)});function h(){const[w={},k=[],N=void 0]=typeof n.extraReducers=="function"?PF(n.extraReducers):[n.extraReducers],S={...w,...u.sliceCaseReducersByType};return tse(n.initialState,_=>{for(let O in S)_.addCase(O,S[O]);for(let O of u.sliceMatchers)_.addMatcher(O.matcher,O.reducer);for(let O of k)_.addMatcher(O.matcher,O.reducer);N&&_.addDefaultCase(N)})}const f=w=>w,x=new Map,p=new WeakMap;let g;function y(w,k){return g||(g=h()),g(w,k)}function v(){return g||(g=h()),g.getInitialState()}function j(w,k=!1){function N(_){let O=_[w];return typeof O>"u"&&k&&(O=Em(p,N,v)),O}function S(_=f){const O=Em(x,k,()=>new WeakMap);return Em(O,_,()=>{const E={};for(const[R,C]of Object.entries(n.selectors??{}))E[R]=lse(C,_,()=>Em(p,_,v),k);return E})}return{reducerPath:w,getSelectors:S,get selectors(){return S(N)},selectSlice:N}}const b={name:i,reducer:y,actions:u.actionCreators,caseReducers:u.sliceCaseReducersByName,getInitialState:v,...j(l),injectInto(w,{reducerPath:k,...N}={}){const S=k??l;return w.inject({reducerPath:S,reducer:y},N),{...b,...j(S,!0)}}};return b}}function lse(e,t,r,s){function n(i,...l){let o=t(i);return typeof o>"u"&&s&&(o=r()),e(o,...l)}return n.unwrapped=e,n}var Fn=ise();function ose(){function e(t,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...r}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...r){return t(...r)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:r}},asyncThunk:e}}function cse({type:e,reducerName:t,createNotation:r},s,n){let i,l;if("reducer"in s){if(r&&!use(s))throw new Error(Kn(17));i=s.reducer,l=s.prepare}else i=s;n.addCase(e,i).exposeCaseReducer(t,i).exposeAction(t,l?bi(e,l):bi(e))}function dse(e){return e._reducerDefinitionType==="asyncThunk"}function use(e){return e._reducerDefinitionType==="reducerWithPrepare"}function hse({type:e,reducerName:t},r,s,n){if(!n)throw new Error(Kn(18));const{payloadCreator:i,fulfilled:l,pending:o,rejected:c,settled:u,options:d}=r,h=n(e,i,d);s.exposeAction(t,h),l&&s.addCase(h.fulfilled,l),o&&s.addCase(h.pending,o),c&&s.addCase(h.rejected,c),u&&s.addMatcher(h.settled,u),s.exposeCaseReducer(t,{fulfilled:l||Pm,pending:o||Pm,rejected:c||Pm,settled:u||Pm})}function Pm(){}var fse="task",AF="listener",_F="completed",vS="cancelled",xse=`task-${vS}`,mse=`task-${_F}`,hw=`${AF}-${vS}`,pse=`${AF}-${_F}`,Xy=class{constructor(e){qv(this,"name","TaskAbortError");qv(this,"message");this.code=e,this.message=`${fse} ${vS} (reason: ${e})`}},bS=(e,t)=>{if(typeof e!="function")throw new TypeError(Kn(32))},pg=()=>{},TF=(e,t=pg)=>(e.catch(t),e),IF=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),xd=e=>{if(e.aborted)throw new Xy(e.reason)};function OF(e,t){let r=pg;return new Promise((s,n)=>{const i=()=>n(new Xy(e.reason));if(e.aborted){i();return}r=IF(e,i),t.finally(()=>r()).then(s,n)}).finally(()=>{r=pg})}var gse=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(r){return{status:r instanceof Xy?"cancelled":"rejected",error:r}}finally{t==null||t()}},gg=e=>t=>TF(OF(e,t).then(r=>(xd(e),r))),DF=e=>{const t=gg(e);return r=>t(new Promise(s=>setTimeout(s,r)))},{assign:$u}=Object,FE={},Yy="listenerMiddleware",yse=(e,t)=>{const r=s=>IF(e,()=>s.abort(e.reason));return(s,n)=>{bS(s);const i=new AbortController;r(i);const l=gse(async()=>{xd(e),xd(i.signal);const o=await s({pause:gg(i.signal),delay:DF(i.signal),signal:i.signal});return xd(i.signal),o},()=>i.abort(mse));return n!=null&&n.autoJoin&&t.push(l.catch(pg)),{result:gg(e)(l),cancel(){i.abort(xse)}}}},vse=(e,t)=>{const r=async(s,n)=>{xd(t);let i=()=>{};const o=[new Promise((c,u)=>{let d=e({predicate:s,effect:(h,f)=>{f.unsubscribe(),c([h,f.getState(),f.getOriginalState()])}});i=()=>{d(),u()}})];n!=null&&o.push(new Promise(c=>setTimeout(c,n,null)));try{const c=await OF(t,Promise.race(o));return xd(t),c}finally{i()}};return(s,n)=>TF(r(s,n))},FF=e=>{let{type:t,actionCreator:r,matcher:s,predicate:n,effect:i}=e;if(t)n=bi(t).match;else if(r)t=r.type,n=r.match;else if(s)n=s;else if(!n)throw new Error(Kn(21));return bS(i),{predicate:n,type:t,effect:i}},RF=$u(e=>{const{type:t,predicate:r,effect:s}=FF(e);return{id:ase(),effect:s,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(Kn(22))}}},{withTypes:()=>RF}),RE=(e,t)=>{const{type:r,effect:s,predicate:n}=FF(t);return Array.from(e.values()).find(i=>(typeof r=="string"?i.type===r:i.predicate===n)&&i.effect===s)},fw=e=>{e.pending.forEach(t=>{t.abort(hw)})},bse=(e,t)=>()=>{for(const r of t.keys())fw(r);e.clear()},ME=(e,t,r)=>{try{e(t,r)}catch(s){setTimeout(()=>{throw s},0)}},MF=$u(bi(`${Yy}/add`),{withTypes:()=>MF}),jse=bi(`${Yy}/removeAll`),LF=$u(bi(`${Yy}/remove`),{withTypes:()=>LF}),wse=(...e)=>{console.error(`${Yy}/error`,...e)},vx=(e={})=>{const t=new Map,r=new Map,s=x=>{const p=r.get(x)??0;r.set(x,p+1)},n=x=>{const p=r.get(x)??1;p===1?r.delete(x):r.set(x,p-1)},{extra:i,onError:l=wse}=e;bS(l);const o=x=>(x.unsubscribe=()=>t.delete(x.id),t.set(x.id,x),p=>{x.unsubscribe(),p!=null&&p.cancelActive&&fw(x)}),c=x=>{const p=RE(t,x)??RF(x);return o(p)};$u(c,{withTypes:()=>c});const u=x=>{const p=RE(t,x);return p&&(p.unsubscribe(),x.cancelActive&&fw(p)),!!p};$u(u,{withTypes:()=>u});const d=async(x,p,g,y)=>{const v=new AbortController,j=vse(c,v.signal),b=[];try{x.pending.add(v),s(x),await Promise.resolve(x.effect(p,$u({},g,{getOriginalState:y,condition:(w,k)=>j(w,k).then(Boolean),take:j,delay:DF(v.signal),pause:gg(v.signal),extra:i,signal:v.signal,fork:yse(v.signal,b),unsubscribe:x.unsubscribe,subscribe:()=>{t.set(x.id,x)},cancelActiveListeners:()=>{x.pending.forEach((w,k,N)=>{w!==v&&(w.abort(hw),N.delete(w))})},cancel:()=>{v.abort(hw),x.pending.delete(v)},throwIfCancelled:()=>{xd(v.signal)}})))}catch(w){w instanceof Xy||ME(l,w,{raisedBy:"effect"})}finally{await Promise.all(b),v.abort(pse),n(x),x.pending.delete(v)}},h=bse(t,r);return{middleware:x=>p=>g=>{if(!fF(g))return p(g);if(MF.match(g))return c(g.payload);if(jse.match(g)){h();return}if(LF.match(g))return u(g.payload);let y=x.getState();const v=()=>{if(y===FE)throw new Error(Kn(23));return y};let j;try{if(j=p(g),t.size>0){const b=x.getState(),w=Array.from(t.values());for(const k of w){let N=!1;try{N=k.predicate(g,b,y)}catch(S){N=!1,ME(l,S,{raisedBy:"predicate"})}N&&d(k,g,x,v)}}}finally{y=FE}return j},startListening:c,stopListening:u,clearListeners:h}};function Kn(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var Nse={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},$F=Fn({name:"chartLayout",initialState:Nse,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){var r,s,n,i;e.margin.top=(r=t.payload.top)!==null&&r!==void 0?r:0,e.margin.right=(s=t.payload.right)!==null&&s!==void 0?s:0,e.margin.bottom=(n=t.payload.bottom)!==null&&n!==void 0?n:0,e.margin.left=(i=t.payload.left)!==null&&i!==void 0?i:0},setScale(e,t){e.scale=t.payload}}}),{setMargin:Sse,setLayout:kse,setChartSize:Cse,setScale:Ese}=$F.actions,Pse=$F.reducer;function BF(e,t,r){return Array.isArray(e)&&e&&t+r!==0?e.slice(t,r+1):e}function LE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function Eu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?LE(Object(r),!0).forEach(function(s){Ase(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):LE(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Ase(e,t,r){return(t=_se(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _se(e){var t=Tse(e,"string");return typeof t=="symbol"?t:t+""}function Tse(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Kr(e,t,r){return ha(e)||ha(t)?r:vl(t)?Fd(e,t,r):typeof t=="function"?t(e):r}var Ise=(e,t,r)=>{if(t&&r){var{width:s,height:n}=r,{align:i,verticalAlign:l,layout:o}=t;if((o==="vertical"||o==="horizontal"&&l==="middle")&&i!=="center"&&Et(e[i]))return Eu(Eu({},e),{},{[i]:e[i]+(s||0)});if((o==="horizontal"||o==="vertical"&&i==="center")&&l!=="middle"&&Et(e[l]))return Eu(Eu({},e),{},{[l]:e[l]+(n||0)})}return e},Ac=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",zF=(e,t,r,s)=>{if(s)return e.map(o=>o.coordinate);var n,i,l=e.map(o=>(o.coordinate===t&&(n=!0),o.coordinate===r&&(i=!0),o.coordinate));return n||l.push(t),i||l.push(r),l},UF=(e,t,r)=>{if(!e)return null;var{duplicateDomain:s,type:n,range:i,scale:l,realScaleType:o,isCategorical:c,categoricalDomain:u,tickCount:d,ticks:h,niceTicks:f,axisType:x}=e;if(!l)return null;var p=o==="scaleBand"&&l.bandwidth?l.bandwidth()/2:2,g=n==="category"&&l.bandwidth?l.bandwidth()/p:0;if(g=x==="angleAxis"&&i&&i.length>=2?vs(i[0]-i[1])*2*g:g,h||f){var y=(h||f||[]).map((v,j)=>{var b=s?s.indexOf(v):v;return{coordinate:l(b)+g,value:v,offset:g,index:j}});return y.filter(v=>!Ki(v.coordinate))}return c&&u?u.map((v,j)=>({coordinate:l(v)+g,value:v,index:j,offset:g})):l.ticks&&d!=null?l.ticks(d).map((v,j)=>({coordinate:l(v)+g,value:v,offset:g,index:j})):l.domain().map((v,j)=>({coordinate:l(v)+g,value:s?s[v]:v,index:j,offset:g}))},$E=1e-4,Ose=e=>{var t=e.domain();if(!(!t||t.length<=2)){var r=t.length,s=e.range(),n=Math.min(s[0],s[1])-$E,i=Math.max(s[0],s[1])+$E,l=e(t[0]),o=e(t[r-1]);(l<n||l>i||o<n||o>i)&&e.domain([t[0],t[r-1]])}},Dse=(e,t)=>{if(!t||t.length!==2||!Et(t[0])||!Et(t[1]))return e;var r=Math.min(t[0],t[1]),s=Math.max(t[0],t[1]),n=[e[0],e[1]];return(!Et(e[0])||e[0]<r)&&(n[0]=r),(!Et(e[1])||e[1]>s)&&(n[1]=s),n[0]>s&&(n[0]=s),n[1]<r&&(n[1]=r),n},Fse=e=>{var t=e.length;if(!(t<=0))for(var r=0,s=e[0].length;r<s;++r)for(var n=0,i=0,l=0;l<t;++l){var o=Ki(e[l][r][1])?e[l][r][0]:e[l][r][1];o>=0?(e[l][r][0]=n,e[l][r][1]=n+o,n=e[l][r][1]):(e[l][r][0]=i,e[l][r][1]=i+o,i=e[l][r][1])}},Rse=e=>{var t=e.length;if(!(t<=0))for(var r=0,s=e[0].length;r<s;++r)for(var n=0,i=0;i<t;++i){var l=Ki(e[i][r][1])?e[i][r][0]:e[i][r][1];l>=0?(e[i][r][0]=n,e[i][r][1]=n+l,n=e[i][r][1]):(e[i][r][0]=0,e[i][r][1]=0)}},Mse={sign:Fse,expand:Sre,none:x0,silhouette:kre,wiggle:Cre,positive:Rse},Lse=(e,t,r)=>{var s=Mse[r],n=Nre().keys(t).value((i,l)=>Number(Kr(i,l,0))).order(rw).offset(s);return n(e)};function $se(e){return e==null?void 0:String(e)}function BE(e){var{axis:t,ticks:r,bandSize:s,entry:n,index:i,dataKey:l}=e;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!ha(n[t.dataKey])){var o=OD(r,"value",n[t.dataKey]);if(o)return o.coordinate+s/2}return r[i]?r[i].coordinate+s/2:null}var c=Kr(n,ha(l)?t.dataKey:l);return ha(c)?null:t.scale(c)}var zE=e=>{var{axis:t,ticks:r,offset:s,bandSize:n,entry:i,index:l}=e;if(t.type==="category")return r[l]?r[l].coordinate+s:null;var o=Kr(i,t.dataKey,t.scale.domain()[l]);return ha(o)?null:t.scale(o)-n/2+s},Bse=e=>{var{numericAxis:t}=e,r=t.scale.domain();if(t.type==="number"){var s=Math.min(r[0],r[1]),n=Math.max(r[0],r[1]);return s<=0&&n>=0?0:n<0?n:s}return r[0]},zse=e=>{var t=e.flat(2).filter(Et);return[Math.min(...t),Math.max(...t)]},Use=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],Wse=(e,t,r)=>{if(e!=null)return Use(Object.keys(e).reduce((s,n)=>{var i=e[n],{stackedData:l}=i,o=l.reduce((c,u)=>{var d=BF(u,t,r),h=zse(d);return[Math.min(c[0],h[0]),Math.max(c[1],h[1])]},[1/0,-1/0]);return[Math.min(o[0],s[0]),Math.max(o[1],s[1])]},[1/0,-1/0]))},UE=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,WE=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,y0=(e,t,r)=>{if(e&&e.scale&&e.scale.bandwidth){var s=e.scale.bandwidth();if(!r||s>0)return s}if(e&&t&&t.length>=2){for(var n=Wy(t,d=>d.coordinate),i=1/0,l=1,o=n.length;l<o;l++){var c=n[l],u=n[l-1];i=Math.min((c.coordinate||0)-(u.coordinate||0),i)}return i===1/0?0:i}return r?void 0:0};function VE(e){var{tooltipEntrySettings:t,dataKey:r,payload:s,value:n,name:i}=e;return Eu(Eu({},t),{},{dataKey:r,payload:s,value:n,name:i})}function M0(e,t){if(e)return String(e);if(typeof t=="string")return t}var Vse=(e,t)=>{if(t==="horizontal")return e.chartX;if(t==="vertical")return e.chartY},Hse=(e,t)=>t==="centric"?e.angle:e.radius,bo=e=>e.layout.width,jo=e=>e.layout.height,qse=e=>e.layout.scale,WF=e=>e.layout.margin,Jy=Te(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),Zy=Te(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),VF="data-recharts-item-index",HF="data-recharts-item-data-key",bx=60;function HE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function Am(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?HE(Object(r),!0).forEach(function(s){Kse(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):HE(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Kse(e,t,r){return(t=Gse(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Gse(e){var t=Qse(e,"string");return typeof t=="symbol"?t:t+""}function Qse(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Xse=e=>e.brush.height;function Yse(e){var t=Zy(e);return t.reduce((r,s)=>{if(s.orientation==="left"&&!s.mirror&&!s.hide){var n=typeof s.width=="number"?s.width:bx;return r+n}return r},0)}function Jse(e){var t=Zy(e);return t.reduce((r,s)=>{if(s.orientation==="right"&&!s.mirror&&!s.hide){var n=typeof s.width=="number"?s.width:bx;return r+n}return r},0)}function Zse(e){var t=Jy(e);return t.reduce((r,s)=>s.orientation==="top"&&!s.mirror&&!s.hide?r+s.height:r,0)}function ene(e){var t=Jy(e);return t.reduce((r,s)=>s.orientation==="bottom"&&!s.mirror&&!s.hide?r+s.height:r,0)}var as=Te([bo,jo,WF,Xse,Yse,Jse,Zse,ene,dF,Cae],(e,t,r,s,n,i,l,o,c,u)=>{var d={left:(r.left||0)+n,right:(r.right||0)+i},h={top:(r.top||0)+l,bottom:(r.bottom||0)+o},f=Am(Am({},h),d),x=f.bottom;f.bottom+=s,f=Ise(f,c,u);var p=e-f.left-f.right,g=t-f.top-f.bottom;return Am(Am({brushBottom:x},f),{},{width:Math.max(p,0),height:Math.max(g,0)})}),tne=Te(as,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),jS=Te(bo,jo,(e,t)=>({x:0,y:0,width:e,height:t})),rne=m.createContext(null),Zs=()=>m.useContext(rne)!=null,ev=e=>e.brush,tv=Te([ev,as,WF],(e,t,r)=>({height:e.height,x:Et(e.x)?e.x:t.left,y:Et(e.y)?e.y:t.top+t.height+t.brushBottom-((r==null?void 0:r.bottom)||0),width:Et(e.width)?e.width:t.width})),qF={},KF={},GF={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,s,{signal:n,edges:i}={}){let l,o=null;const c=i!=null&&i.includes("leading"),u=i==null||i.includes("trailing"),d=()=>{o!==null&&(r.apply(l,o),l=void 0,o=null)},h=()=>{u&&d(),g()};let f=null;const x=()=>{f!=null&&clearTimeout(f),f=setTimeout(()=>{f=null,h()},s)},p=()=>{f!==null&&(clearTimeout(f),f=null)},g=()=>{p(),l=void 0,o=null},y=()=>{d()},v=function(...j){if(n!=null&&n.aborted)return;l=this,o=j;const b=f==null;x(),c&&b&&d()};return v.schedule=x,v.cancel=g,v.flush=y,n==null||n.addEventListener("abort",g,{once:!0}),v}e.debounce=t})(GF);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=GF;function r(s,n=0,i={}){typeof i!="object"&&(i={});const{leading:l=!1,trailing:o=!0,maxWait:c}=i,u=Array(2);l&&(u[0]="leading"),o&&(u[1]="trailing");let d,h=null;const f=t.debounce(function(...g){d=s.apply(this,g),h=null},n,{edges:u}),x=function(...g){return c!=null&&(h===null&&(h=Date.now()),Date.now()-h>=c)?(d=s.apply(this,g),h=Date.now(),f.cancel(),f.schedule(),d):(f.apply(this,g),d)},p=()=>(f.flush(),d);return x.cancel=f.cancel,x.flush=p,x}e.debounce=r})(KF);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=KF;function r(s,n=0,i={}){const{leading:l=!0,trailing:o=!0}=i;return t.debounce(s,n,{leading:l,maxWait:n,trailing:o})}e.throttle=r})(qF);var ane=qF.throttle;const sne=xo(ane);var yg=function(t,r){for(var s=arguments.length,n=new Array(s>2?s-2:0),i=2;i<s;i++)n[i-2]=arguments[i];if(typeof console<"u"&&console.warn&&(r===void 0&&console.warn("LogUtils requires an error message argument"),!t))if(r===void 0)console.warn("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var l=0;console.warn(r.replace(/%s/g,()=>n[l++]))}},QF=(e,t,r)=>{var{width:s="100%",height:n="100%",aspect:i,maxHeight:l}=r,o=io(s)?e:Number(s),c=io(n)?t:Number(n);return i&&i>0&&(o?c=o/i:c&&(o=c*i),l&&c!=null&&c>l&&(c=l)),{calculatedWidth:o,calculatedHeight:c}},nne={width:0,height:0,overflow:"visible"},ine={width:0,overflowX:"visible"},lne={height:0,overflowY:"visible"},one={},cne=e=>{var{width:t,height:r}=e,s=io(t),n=io(r);return s&&n?nne:s?ine:n?lne:one};function dne(e){var{width:t,height:r,aspect:s}=e,n=t,i=r;return n===void 0&&i===void 0?(n="100%",i="100%"):n===void 0?n=s&&s>0?void 0:"100%":i===void 0&&(i=s&&s>0?void 0:"100%"),{width:n,height:i}}function $a(e){return Number.isFinite(e)}function bl(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function xw(){return xw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},xw.apply(null,arguments)}function qE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function KE(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?qE(Object(r),!0).forEach(function(s){une(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qE(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function une(e,t,r){return(t=hne(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hne(e){var t=fne(e,"string");return typeof t=="symbol"?t:t+""}function fne(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var XF=m.createContext({width:-1,height:-1});function xne(e){return bl(e.width)&&bl(e.height)}function YF(e){var{children:t,width:r,height:s}=e,n=m.useMemo(()=>({width:r,height:s}),[r,s]);return xne(n)?m.createElement(XF.Provider,{value:n},t):null}var wS=()=>m.useContext(XF),mne=m.forwardRef((e,t)=>{var{aspect:r,initialDimension:s={width:-1,height:-1},width:n,height:i,minWidth:l=0,minHeight:o,maxHeight:c,children:u,debounce:d=0,id:h,className:f,onResize:x,style:p={}}=e,g=m.useRef(null),y=m.useRef();y.current=x,m.useImperativeHandle(t,()=>g.current);var[v,j]=m.useState({containerWidth:s.width,containerHeight:s.height}),b=m.useCallback((_,O)=>{j(E=>{var R=Math.round(_),C=Math.round(O);return E.containerWidth===R&&E.containerHeight===C?E:{containerWidth:R,containerHeight:C}})},[]);m.useEffect(()=>{if(g.current==null||typeof ResizeObserver>"u")return px;var _=C=>{var I,{width:ne,height:W}=C[0].contentRect;b(ne,W),(I=y.current)===null||I===void 0||I.call(y,ne,W)};d>0&&(_=sne(_,d,{trailing:!0,leading:!1}));var O=new ResizeObserver(_),{width:E,height:R}=g.current.getBoundingClientRect();return b(E,R),O.observe(g.current),()=>{O.disconnect()}},[b,d]);var{containerWidth:w,containerHeight:k}=v;yg(!r||r>0,"The aspect(%s) must be greater than zero.",r);var{calculatedWidth:N,calculatedHeight:S}=QF(w,k,{width:n,height:i,aspect:r,maxHeight:c});return yg(N!=null&&N>0||S!=null&&S>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,N,S,n,i,l,o,r),m.createElement("div",{id:h?"".concat(h):void 0,className:Ar("recharts-responsive-container",f),style:KE(KE({},p),{},{width:n,height:i,minWidth:l,minHeight:o,maxHeight:c}),ref:g},m.createElement("div",{style:cne({width:n,height:i})},m.createElement(YF,{width:N,height:S},u)))}),md=m.forwardRef((e,t)=>{var r=wS();if(bl(r.width)&&bl(r.height))return e.children;var{width:s,height:n}=dne({width:e.width,height:e.height,aspect:e.aspect}),{calculatedWidth:i,calculatedHeight:l}=QF(void 0,void 0,{width:s,height:n,aspect:e.aspect,maxHeight:e.maxHeight});return Et(i)&&Et(l)?m.createElement(YF,{width:i,height:l},e.children):m.createElement(mne,xw({},e,{width:s,height:n,ref:t}))});function JF(e){if(e)return{x:e.x,y:e.y,upperWidth:"upperWidth"in e?e.upperWidth:e.width,lowerWidth:"lowerWidth"in e?e.lowerWidth:e.width,width:e.width,height:e.height}}var rv=()=>{var e,t=Zs(),r=St(tne),s=St(tv),n=(e=St(ev))===null||e===void 0?void 0:e.padding;return!t||!s||!n?r:{width:s.width-n.left-n.right,height:s.height-n.top-n.bottom,x:n.left,y:n.top}},pne={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},ZF=()=>{var e;return(e=St(as))!==null&&e!==void 0?e:pne},eR=()=>St(bo),tR=()=>St(jo),vr=e=>e.layout.layoutType,jx=()=>St(vr),gne=()=>{var e=jx();return e!==void 0},av=e=>{var t=fa(),r=Zs(),{width:s,height:n}=e,i=wS(),l=s,o=n;return i&&(l=i.width>0?i.width:s,o=i.height>0?i.height:n),m.useEffect(()=>{!r&&bl(l)&&bl(o)&&t(Cse({width:l,height:o}))},[t,r,l,o]),null},rR=Symbol.for("immer-nothing"),GE=Symbol.for("immer-draftable"),Yn=Symbol.for("immer-state");function Ri(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Of=Object.getPrototypeOf;function v0(e){return!!e&&!!e[Yn]}function Rd(e){var t;return e?aR(e)||Array.isArray(e)||!!e[GE]||!!((t=e.constructor)!=null&&t[GE])||wx(e)||nv(e):!1}var yne=Object.prototype.constructor.toString(),QE=new WeakMap;function aR(e){if(!e||typeof e!="object")return!1;const t=Object.getPrototypeOf(e);if(t===null||t===Object.prototype)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;if(r===Object)return!0;if(typeof r!="function")return!1;let s=QE.get(r);return s===void 0&&(s=Function.toString.call(r),QE.set(r,s)),s===yne}function vg(e,t,r=!0){sv(e)===0?(r?Reflect.ownKeys(e):Object.keys(e)).forEach(n=>{t(n,e[n],e)}):e.forEach((s,n)=>t(n,s,e))}function sv(e){const t=e[Yn];return t?t.type_:Array.isArray(e)?1:wx(e)?2:nv(e)?3:0}function mw(e,t){return sv(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function sR(e,t,r){const s=sv(e);s===2?e.set(t,r):s===3?e.add(r):e[t]=r}function vne(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function wx(e){return e instanceof Map}function nv(e){return e instanceof Set}function Lc(e){return e.copy_||e.base_}function pw(e,t){if(wx(e))return new Map(e);if(nv(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=aR(e);if(t===!0||t==="class_only"&&!r){const s=Object.getOwnPropertyDescriptors(e);delete s[Yn];let n=Reflect.ownKeys(s);for(let i=0;i<n.length;i++){const l=n[i],o=s[l];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(s[l]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[l]})}return Object.create(Of(e),s)}else{const s=Of(e);if(s!==null&&r)return{...e};const n=Object.create(s);return Object.assign(n,e)}}function NS(e,t=!1){return iv(e)||v0(e)||!Rd(e)||(sv(e)>1&&Object.defineProperties(e,{set:_m,add:_m,clear:_m,delete:_m}),Object.freeze(e),t&&Object.values(e).forEach(r=>NS(r,!0))),e}function bne(){Ri(2)}var _m={value:bne};function iv(e){return e===null||typeof e!="object"?!0:Object.isFrozen(e)}var jne={};function Md(e){const t=jne[e];return t||Ri(0,e),t}var Df;function nR(){return Df}function wne(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function XE(e,t){t&&(Md("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function gw(e){yw(e),e.drafts_.forEach(Nne),e.drafts_=null}function yw(e){e===Df&&(Df=e.parent_)}function YE(e){return Df=wne(Df,e)}function Nne(e){const t=e[Yn];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function JE(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[Yn].modified_&&(gw(t),Ri(4)),Rd(e)&&(e=bg(t,e),t.parent_||jg(t,e)),t.patches_&&Md("Patches").generateReplacementPatches_(r[Yn].base_,e,t.patches_,t.inversePatches_)):e=bg(t,r,[]),gw(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==rR?e:void 0}function bg(e,t,r){if(iv(t))return t;const s=e.immer_.shouldUseStrictIteration(),n=t[Yn];if(!n)return vg(t,(i,l)=>ZE(e,n,t,i,l,r),s),t;if(n.scope_!==e)return t;if(!n.modified_)return jg(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const i=n.copy_;let l=i,o=!1;n.type_===3&&(l=new Set(i),i.clear(),o=!0),vg(l,(c,u)=>ZE(e,n,i,c,u,r,o),s),jg(e,i,!1),r&&e.patches_&&Md("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function ZE(e,t,r,s,n,i,l){if(n==null||typeof n!="object"&&!l)return;const o=iv(n);if(!(o&&!l)){if(v0(n)){const c=i&&t&&t.type_!==3&&!mw(t.assigned_,s)?i.concat(s):void 0,u=bg(e,n,c);if(sR(r,s,u),v0(u))e.canAutoFreeze_=!1;else return}else l&&r.add(n);if(Rd(n)&&!o){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1||t&&t.base_&&t.base_[s]===n&&o)return;bg(e,n),(!t||!t.scope_.parent_)&&typeof s!="symbol"&&(wx(r)?r.has(s):Object.prototype.propertyIsEnumerable.call(r,s))&&jg(e,n)}}}function jg(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&NS(t,r)}function Sne(e,t){const r=Array.isArray(e),s={type_:r?1:0,scope_:t?t.scope_:nR(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let n=s,i=SS;r&&(n=[s],i=Ff);const{revoke:l,proxy:o}=Proxy.revocable(n,i);return s.draft_=o,s.revoke_=l,o}var SS={get(e,t){if(t===Yn)return e;const r=Lc(e);if(!mw(r,t))return kne(e,r,t);const s=r[t];return e.finalized_||!Rd(s)?s:s===Kb(e.base_,t)?(Gb(e),e.copy_[t]=bw(s,e)):s},has(e,t){return t in Lc(e)},ownKeys(e){return Reflect.ownKeys(Lc(e))},set(e,t,r){const s=iR(Lc(e),t);if(s!=null&&s.set)return s.set.call(e.draft_,r),!0;if(!e.modified_){const n=Kb(Lc(e),t),i=n==null?void 0:n[Yn];if(i&&i.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(vne(r,n)&&(r!==void 0||mw(e.base_,t)))return!0;Gb(e),vw(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return Kb(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,Gb(e),vw(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=Lc(e),s=Reflect.getOwnPropertyDescriptor(r,t);return s&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:s.enumerable,value:r[t]}},defineProperty(){Ri(11)},getPrototypeOf(e){return Of(e.base_)},setPrototypeOf(){Ri(12)}},Ff={};vg(SS,(e,t)=>{Ff[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});Ff.deleteProperty=function(e,t){return Ff.set.call(this,e,t,void 0)};Ff.set=function(e,t,r){return SS.set.call(this,e[0],t,r,e[0])};function Kb(e,t){const r=e[Yn];return(r?Lc(r):e)[t]}function kne(e,t,r){var n;const s=iR(t,r);return s?"value"in s?s.value:(n=s.get)==null?void 0:n.call(e.draft_):void 0}function iR(e,t){if(!(t in e))return;let r=Of(e);for(;r;){const s=Object.getOwnPropertyDescriptor(r,t);if(s)return s;r=Of(r)}}function vw(e){e.modified_||(e.modified_=!0,e.parent_&&vw(e.parent_))}function Gb(e){e.copy_||(e.copy_=pw(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var Cne=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(t,r,s)=>{if(typeof t=="function"&&typeof r!="function"){const i=r;r=t;const l=this;return function(c=i,...u){return l.produce(c,d=>r.call(this,d,...u))}}typeof r!="function"&&Ri(6),s!==void 0&&typeof s!="function"&&Ri(7);let n;if(Rd(t)){const i=YE(this),l=bw(t,void 0);let o=!0;try{n=r(l),o=!1}finally{o?gw(i):yw(i)}return XE(i,s),JE(n,i)}else if(!t||typeof t!="object"){if(n=r(t),n===void 0&&(n=t),n===rR&&(n=void 0),this.autoFreeze_&&NS(n,!0),s){const i=[],l=[];Md("Patches").generateReplacementPatches_(t,n,i,l),s(i,l)}return n}else Ri(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(l,...o)=>this.produceWithPatches(l,c=>t(c,...o));let s,n;return[this.produce(t,r,(l,o)=>{s=l,n=o}),s,n]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),typeof(e==null?void 0:e.useStrictIteration)=="boolean"&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){Rd(e)||Ri(8),v0(e)&&(e=Ene(e));const t=YE(this),r=bw(e,void 0);return r[Yn].isManual_=!0,yw(t),r}finishDraft(e,t){const r=e&&e[Yn];(!r||!r.isManual_)&&Ri(9);const{scope_:s}=r;return XE(s,t),JE(void 0,s)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const n=t[r];if(n.path.length===0&&n.op==="replace"){e=n.value;break}}r>-1&&(t=t.slice(r+1));const s=Md("Patches").applyPatches_;return v0(e)?s(e,t):this.produce(e,n=>s(n,t))}};function bw(e,t){const r=wx(e)?Md("MapSet").proxyMap_(e,t):nv(e)?Md("MapSet").proxySet_(e,t):Sne(e,t);return(t?t.scope_:nR()).drafts_.push(r),r}function Ene(e){return v0(e)||Ri(10,e),lR(e)}function lR(e){if(!Rd(e)||iv(e))return e;const t=e[Yn];let r,s=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=pw(e,t.scope_.immer_.useStrictShallowCopy_),s=t.scope_.immer_.shouldUseStrictIteration()}else r=pw(e,!0);return vg(r,(n,i)=>{sR(r,n,lR(i))},s),t&&(t.finalized_=!1),r}var Pne=new Cne;Pne.produce;var Ane={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},oR=Fn({name:"legend",initialState:Ane,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload:{reducer(e,t){e.payload.push(t.payload)},prepare:ia()},replaceLegendPayload:{reducer(e,t){var{prev:r,next:s}=t.payload,n=Vi(e).payload.indexOf(r);n>-1&&(e.payload[n]=s)},prepare:ia()},removeLegendPayload:{reducer(e,t){var r=Vi(e).payload.indexOf(t.payload);r>-1&&e.payload.splice(r,1)},prepare:ia()}}}),{setLegendSize:fbe,setLegendSettings:xbe,addLegendPayload:cR,replaceLegendPayload:dR,removeLegendPayload:uR}=oR.actions,_ne=oR.reducer;function jw(){return jw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},jw.apply(null,arguments)}function eP(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function Qb(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eP(Object(r),!0).forEach(function(s){Tne(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eP(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Tne(e,t,r){return(t=Ine(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ine(e){var t=One(e,"string");return typeof t=="symbol"?t:t+""}function One(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Dne(e){return Array.isArray(e)&&vl(e[0])&&vl(e[1])?e.join(" ~ "):e}var Fne=e=>{var{separator:t=" : ",contentStyle:r={},itemStyle:s={},labelStyle:n={},payload:i,formatter:l,itemSorter:o,wrapperClassName:c,labelClassName:u,label:d,labelFormatter:h,accessibilityLayer:f=!1}=e,x=()=>{if(i&&i.length){var k={padding:0,margin:0},N=(o?Wy(i,o):i).map((S,_)=>{if(S.type==="none")return null;var O=S.formatter||l||Dne,{value:E,name:R}=S,C=E,I=R;if(O){var ne=O(E,R,S,_,i);if(Array.isArray(ne))[C,I]=ne;else if(ne!=null)C=ne;else return null}var W=Qb({display:"block",paddingTop:4,paddingBottom:4,color:S.color||"#000"},s);return m.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(_),style:W},vl(I)?m.createElement("span",{className:"recharts-tooltip-item-name"},I):null,vl(I)?m.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,m.createElement("span",{className:"recharts-tooltip-item-value"},C),m.createElement("span",{className:"recharts-tooltip-item-unit"},S.unit||""))});return m.createElement("ul",{className:"recharts-tooltip-item-list",style:k},N)}return null},p=Qb({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),g=Qb({margin:0},n),y=!ha(d),v=y?d:"",j=Ar("recharts-default-tooltip",c),b=Ar("recharts-tooltip-label",u);y&&h&&i!==void 0&&i!==null&&(v=h(d,i));var w=f?{role:"status","aria-live":"assertive"}:{};return m.createElement("div",jw({className:j,style:p},w),m.createElement("p",{className:b,style:g},m.isValidElement(v)?v:"".concat(v)),x())},ih="recharts-tooltip-wrapper",Rne={visibility:"hidden"};function Mne(e){var{coordinate:t,translateX:r,translateY:s}=e;return Ar(ih,{["".concat(ih,"-right")]:Et(r)&&t&&Et(t.x)&&r>=t.x,["".concat(ih,"-left")]:Et(r)&&t&&Et(t.x)&&r<t.x,["".concat(ih,"-bottom")]:Et(s)&&t&&Et(t.y)&&s>=t.y,["".concat(ih,"-top")]:Et(s)&&t&&Et(t.y)&&s<t.y})}function tP(e){var{allowEscapeViewBox:t,coordinate:r,key:s,offsetTopLeft:n,position:i,reverseDirection:l,tooltipDimension:o,viewBox:c,viewBoxDimension:u}=e;if(i&&Et(i[s]))return i[s];var d=r[s]-o-(n>0?n:0),h=r[s]+n;if(t[s])return l[s]?d:h;var f=c[s];if(f==null)return 0;if(l[s]){var x=d,p=f;return x<p?Math.max(h,f):Math.max(d,f)}if(u==null)return 0;var g=h+o,y=f+u;return g>y?Math.max(d,f):Math.max(h,f)}function Lne(e){var{translateX:t,translateY:r,useTranslate3d:s}=e;return{transform:s?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function $ne(e){var{allowEscapeViewBox:t,coordinate:r,offsetTopLeft:s,position:n,reverseDirection:i,tooltipBox:l,useTranslate3d:o,viewBox:c}=e,u,d,h;return l.height>0&&l.width>0&&r?(d=tP({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:s,position:n,reverseDirection:i,tooltipDimension:l.width,viewBox:c,viewBoxDimension:c.width}),h=tP({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:s,position:n,reverseDirection:i,tooltipDimension:l.height,viewBox:c,viewBoxDimension:c.height}),u=Lne({translateX:d,translateY:h,useTranslate3d:o})):u=Rne,{cssProperties:u,cssClasses:Mne({translateX:d,translateY:h,coordinate:r})}}function rP(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function Tm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rP(Object(r),!0).forEach(function(s){ww(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rP(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function ww(e,t,r){return(t=Bne(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Bne(e){var t=zne(e,"string");return typeof t=="symbol"?t:t+""}function zne(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class Une extends m.PureComponent{constructor(){super(...arguments),ww(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),ww(this,"handleKeyDown",t=>{if(t.key==="Escape"){var r,s,n,i;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(s=this.props.coordinate)===null||s===void 0?void 0:s.x)!==null&&r!==void 0?r:0,y:(n=(i=this.props.coordinate)===null||i===void 0?void 0:i.y)!==null&&n!==void 0?n:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,r;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:r,animationDuration:s,animationEasing:n,children:i,coordinate:l,hasPayload:o,isAnimationActive:c,offset:u,position:d,reverseDirection:h,useTranslate3d:f,viewBox:x,wrapperStyle:p,lastBoundingBox:g,innerRef:y,hasPortalFromProps:v}=this.props,{cssClasses:j,cssProperties:b}=$ne({allowEscapeViewBox:r,coordinate:l,offsetTopLeft:u,position:d,reverseDirection:h,tooltipBox:{height:g.height,width:g.width},useTranslate3d:f,viewBox:x}),w=v?{}:Tm(Tm({transition:c&&t?"transform ".concat(s,"ms ").concat(n):void 0},b),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&o?"visible":"hidden",position:"absolute",top:0,left:0}),k=Tm(Tm({},w),{},{visibility:!this.state.dismissed&&t&&o?"visible":"hidden"},p);return m.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:j,style:k,ref:y},i)}}var hR=()=>{var e;return(e=St(t=>t.rootProps.accessibilityLayer))!==null&&e!==void 0?e:!0};function Nw(){return Nw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Nw.apply(null,arguments)}function aP(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function sP(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aP(Object(r),!0).forEach(function(s){Wne(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aP(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Wne(e,t,r){return(t=Vne(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Vne(e){var t=Hne(e,"string");return typeof t=="symbol"?t:t+""}function Hne(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var nP={curveBasisClosed:hre,curveBasisOpen:fre,curveBasis:ure,curveBumpX:Yte,curveBumpY:Jte,curveLinearClosed:xre,curveLinear:Fy,curveMonotoneX:mre,curveMonotoneY:pre,curveNatural:gre,curveStep:yre,curveStepAfter:bre,curveStepBefore:vre},wg=e=>$a(e.x)&&$a(e.y),iP=e=>e.base!=null&&wg(e.base)&&wg(e),lh=e=>e.x,oh=e=>e.y,qne=(e,t)=>{if(typeof e=="function")return e;var r="curve".concat(mx(e));return(r==="curveMonotone"||r==="curveBump")&&t?nP["".concat(r).concat(t==="vertical"?"Y":"X")]:nP[r]||Fy},Kne=e=>{var{type:t="linear",points:r=[],baseLine:s,layout:n,connectNulls:i=!1}=e,l=qne(t,n),o=i?r.filter(wg):r,c;if(Array.isArray(s)){var u=r.map((x,p)=>sP(sP({},x),{},{base:s[p]}));n==="vertical"?c=Nm().y(oh).x1(lh).x0(x=>x.base.x):c=Nm().x(lh).y1(oh).y0(x=>x.base.y);var d=c.defined(iP).curve(l),h=i?u.filter(iP):u;return d(h)}n==="vertical"&&Et(s)?c=Nm().y(oh).x1(lh).x0(s):Et(s)?c=Nm().x(lh).y1(oh).y0(s):c=vD().x(lh).y(oh);var f=c.defined(wg).curve(l);return f(o)},kS=e=>{var{className:t,points:r,path:s,pathRef:n}=e;if((!r||!r.length)&&!s)return null;var i=r&&r.length?Kne(e):s;return m.createElement("path",Nw({},Xn(e),eS(e),{className:Ar("recharts-curve",t),d:i===null?void 0:i,ref:n}))},Gne=["x","y","top","left","width","height","className"];function Sw(){return Sw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Sw.apply(null,arguments)}function lP(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function Qne(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?lP(Object(r),!0).forEach(function(s){Xne(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lP(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Xne(e,t,r){return(t=Yne(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Yne(e){var t=Jne(e,"string");return typeof t=="symbol"?t:t+""}function Jne(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Zne(e,t){if(e==null)return{};var r,s,n=eie(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function eie(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var tie=(e,t,r,s,n,i)=>"M".concat(e,",").concat(n,"v").concat(s,"M").concat(i,",").concat(t,"h").concat(r),rie=e=>{var{x:t=0,y:r=0,top:s=0,left:n=0,width:i=0,height:l=0,className:o}=e,c=Zne(e,Gne),u=Qne({x:t,y:r,top:s,left:n,width:i,height:l},c);return!Et(t)||!Et(r)||!Et(i)||!Et(l)||!Et(s)||!Et(n)?null:m.createElement("path",Sw({},fn(u),{className:Ar("recharts-cross",o),d:tie(t,r,i,l,s,n)}))};function aie(e,t,r,s){var n=s/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-n:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-n,width:e==="horizontal"?s:r.width-1,height:e==="horizontal"?r.height-1:s}}function oP(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function cP(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?oP(Object(r),!0).forEach(function(s){sie(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oP(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function sie(e,t,r){return(t=nie(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nie(e){var t=iie(e,"string");return typeof t=="symbol"?t:t+""}function iie(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lie=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),fR=(e,t,r)=>e.map(s=>"".concat(lie(s)," ").concat(t,"ms ").concat(r)).join(","),oie=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((r,s)=>r.filter(n=>s.includes(n))),Rf=(e,t)=>Object.keys(t).reduce((r,s)=>cP(cP({},r),{},{[s]:e(s,t[s])}),{});function dP(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function Ja(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dP(Object(r),!0).forEach(function(s){cie(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dP(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function cie(e,t,r){return(t=die(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function die(e){var t=uie(e,"string");return typeof t=="symbol"?t:t+""}function uie(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ng=(e,t,r)=>e+(t-e)*r,kw=e=>{var{from:t,to:r}=e;return t!==r},xR=(e,t,r)=>{var s=Rf((n,i)=>{if(kw(i)){var[l,o]=e(i.from,i.to,i.velocity);return Ja(Ja({},i),{},{from:l,velocity:o})}return i},t);return r<1?Rf((n,i)=>kw(i)?Ja(Ja({},i),{},{velocity:Ng(i.velocity,s[n].velocity,r),from:Ng(i.from,s[n].from,r)}):i,t):xR(e,s,r-1)};function hie(e,t,r,s,n,i){var l,o=s.reduce((f,x)=>Ja(Ja({},f),{},{[x]:{from:e[x],velocity:0,to:t[x]}}),{}),c=()=>Rf((f,x)=>x.from,o),u=()=>!Object.values(o).filter(kw).length,d=null,h=f=>{l||(l=f);var x=f-l,p=x/r.dt;o=xR(r,o,p),n(Ja(Ja(Ja({},e),t),c())),l=f,u()||(d=i.setTimeout(h))};return()=>(d=i.setTimeout(h),()=>{var f;(f=d)===null||f===void 0||f()})}function fie(e,t,r,s,n,i,l){var o=null,c=n.reduce((h,f)=>Ja(Ja({},h),{},{[f]:[e[f],t[f]]}),{}),u,d=h=>{u||(u=h);var f=(h-u)/s,x=Rf((g,y)=>Ng(...y,r(f)),c);if(i(Ja(Ja(Ja({},e),t),x)),f<1)o=l.setTimeout(d);else{var p=Rf((g,y)=>Ng(...y,r(1)),c);i(Ja(Ja(Ja({},e),t),p))}};return()=>(o=l.setTimeout(d),()=>{var h;(h=o)===null||h===void 0||h()})}const xie=(e,t,r,s,n,i)=>{var l=oie(e,t);return r==null?()=>(n(Ja(Ja({},e),t)),()=>{}):r.isStepper===!0?hie(e,t,r,l,n,i):fie(e,t,r,s,l,n,i)};var Sg=1e-4,mR=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],pR=(e,t)=>e.map((r,s)=>r*t**s).reduce((r,s)=>r+s),uP=(e,t)=>r=>{var s=mR(e,t);return pR(s,r)},mie=(e,t)=>r=>{var s=mR(e,t),n=[...s.map((i,l)=>i*l).slice(1),0];return pR(n,r)},pie=function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];if(r.length===1)switch(r[0]){case"linear":return[0,0,1,1];case"ease":return[.25,.1,.25,1];case"ease-in":return[.42,0,1,1];case"ease-out":return[.42,0,.58,1];case"ease-in-out":return[0,0,.58,1];default:{var n,i=r[0].split("(");if(i[0]==="cubic-bezier"&&((n=i[1])===null||n===void 0?void 0:n.split(")")[0].split(",").length)===4){var l=i[1].split(")")[0].split(",").map(o=>parseFloat(o));return[l[0],l[1],l[2],l[3]]}}}return r.length===4?r:[0,0,1,1]},gie=(e,t,r,s)=>{var n=uP(e,r),i=uP(t,s),l=mie(e,r),o=u=>u>1?1:u<0?0:u,c=u=>{for(var d=u>1?1:u,h=d,f=0;f<8;++f){var x=n(h)-d,p=l(h);if(Math.abs(x-d)<Sg||p<Sg)return i(h);h=o(h-x/p)}return i(h)};return c.isStepper=!1,c},hP=function(){return gie(...pie(...arguments))},yie=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:s=8,dt:n=17}=t,i=(l,o,c)=>{var u=-(l-o)*r,d=c*s,h=c+(u-d)*n/1e3,f=c*n/1e3+l;return Math.abs(f-o)<Sg&&Math.abs(h)<Sg?[o,0]:[f,h]};return i.isStepper=!0,i.dt=n,i},vie=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return hP(e);case"spring":return yie();default:if(e.split("(")[0]==="cubic-bezier")return hP(e)}return typeof e=="function"?e:null};function bie(e){var t,r=()=>null,s=!1,n=null,i=l=>{if(!s){if(Array.isArray(l)){if(!l.length)return;var o=l,[c,...u]=o;if(typeof c=="number"){n=e.setTimeout(i.bind(null,u),c);return}i(c),n=e.setTimeout(i.bind(null,u));return}typeof l=="string"&&(t=l,r(t)),typeof l=="object"&&(t=l,r(t)),typeof l=="function"&&l()}};return{stop:()=>{s=!0},start:l=>{s=!1,n&&(n(),n=null),i(l)},subscribe:l=>(r=l,()=>{r=()=>null}),getTimeoutController:()=>e}}class jie{setTimeout(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=performance.now(),n=null,i=l=>{l-s>=r?t(l):typeof requestAnimationFrame=="function"&&(n=requestAnimationFrame(i))};return n=requestAnimationFrame(i),()=>{n!=null&&cancelAnimationFrame(n)}}}function wie(){return bie(new jie)}var Nie=m.createContext(wie);function Sie(e,t){var r=m.useContext(Nie);return m.useMemo(()=>t??r(e),[e,t,r])}var kie=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),Nx={devToolsEnabled:!1,isSsr:kie()},Cie={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},fP={t:0},Xb={t:1};function Sx(e){var t=Ns(e,Cie),{isActive:r,canBegin:s,duration:n,easing:i,begin:l,onAnimationEnd:o,onAnimationStart:c,children:u}=t,d=r==="auto"?!Nx.isSsr:r,h=Sie(t.animationId,t.animationManager),[f,x]=m.useState(d?fP:Xb),p=m.useRef(null);return m.useEffect(()=>{d||x(Xb)},[d]),m.useEffect(()=>{if(!d||!s)return px;var g=xie(fP,Xb,vie(i),n,x,h.getTimeoutController()),y=()=>{p.current=g()};return h.start([c,l,y,n,o]),()=>{h.stop(),p.current&&p.current(),o()}},[d,s,n,i,l,c,o,h]),u(f.t)}function kx(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=m.useRef(Af(t)),s=m.useRef(e);return s.current!==e&&(r.current=Af(t),s.current=e),r.current}var Eie=["radius"],Pie=["radius"];function xP(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function mP(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xP(Object(r),!0).forEach(function(s){Aie(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xP(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Aie(e,t,r){return(t=_ie(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _ie(e){var t=Tie(e,"string");return typeof t=="symbol"?t:t+""}function Tie(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kg(){return kg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},kg.apply(null,arguments)}function pP(e,t){if(e==null)return{};var r,s,n=Iie(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Iie(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var gP=(e,t,r,s,n)=>{var i=Math.min(Math.abs(r)/2,Math.abs(s)/2),l=s>=0?1:-1,o=r>=0?1:-1,c=s>=0&&r>=0||s<0&&r<0?1:0,u;if(i>0&&n instanceof Array){for(var d=[0,0,0,0],h=0,f=4;h<f;h++)d[h]=n[h]>i?i:n[h];u="M".concat(e,",").concat(t+l*d[0]),d[0]>0&&(u+="A ".concat(d[0],",").concat(d[0],",0,0,").concat(c,",").concat(e+o*d[0],",").concat(t)),u+="L ".concat(e+r-o*d[1],",").concat(t),d[1]>0&&(u+="A ".concat(d[1],",").concat(d[1],",0,0,").concat(c,`,
        `).concat(e+r,",").concat(t+l*d[1])),u+="L ".concat(e+r,",").concat(t+s-l*d[2]),d[2]>0&&(u+="A ".concat(d[2],",").concat(d[2],",0,0,").concat(c,`,
        `).concat(e+r-o*d[2],",").concat(t+s)),u+="L ".concat(e+o*d[3],",").concat(t+s),d[3]>0&&(u+="A ".concat(d[3],",").concat(d[3],",0,0,").concat(c,`,
        `).concat(e,",").concat(t+s-l*d[3])),u+="Z"}else if(i>0&&n===+n&&n>0){var x=Math.min(i,n);u="M ".concat(e,",").concat(t+l*x,`
            A `).concat(x,",").concat(x,",0,0,").concat(c,",").concat(e+o*x,",").concat(t,`
            L `).concat(e+r-o*x,",").concat(t,`
            A `).concat(x,",").concat(x,",0,0,").concat(c,",").concat(e+r,",").concat(t+l*x,`
            L `).concat(e+r,",").concat(t+s-l*x,`
            A `).concat(x,",").concat(x,",0,0,").concat(c,",").concat(e+r-o*x,",").concat(t+s,`
            L `).concat(e+o*x,",").concat(t+s,`
            A `).concat(x,",").concat(x,",0,0,").concat(c,",").concat(e,",").concat(t+s-l*x," Z")}else u="M ".concat(e,",").concat(t," h ").concat(r," v ").concat(s," h ").concat(-r," Z");return u},yP={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},gR=e=>{var t=Ns(e,yP),r=m.useRef(null),[s,n]=m.useState(-1);m.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var H=r.current.getTotalLength();H&&n(H)}catch{}},[]);var{x:i,y:l,width:o,height:c,radius:u,className:d}=t,{animationEasing:h,animationDuration:f,animationBegin:x,isAnimationActive:p,isUpdateAnimationActive:g}=t,y=m.useRef(o),v=m.useRef(c),j=m.useRef(i),b=m.useRef(l),w=m.useMemo(()=>({x:i,y:l,width:o,height:c,radius:u}),[i,l,o,c,u]),k=kx(w,"rectangle-");if(i!==+i||l!==+l||o!==+o||c!==+c||o===0||c===0)return null;var N=Ar("recharts-rectangle",d);if(!g){var S=fn(t),{radius:_}=S,O=pP(S,Eie);return m.createElement("path",kg({},O,{radius:typeof u=="number"?u:void 0,className:N,d:gP(i,l,o,c,u)}))}var E=y.current,R=v.current,C=j.current,I=b.current,ne="0px ".concat(s===-1?1:s,"px"),W="".concat(s,"px 0px"),Q=fR(["strokeDasharray"],f,typeof h=="string"?h:yP.animationEasing);return m.createElement(Sx,{animationId:k,key:k,canBegin:s>0,duration:f,easing:h,isActive:g,begin:x},H=>{var K=la(E,o,H),q=la(R,c,H),ge=la(C,i,H),G=la(I,l,H);r.current&&(y.current=K,v.current=q,j.current=ge,b.current=G);var B;p?H>0?B={transition:Q,strokeDasharray:W}:B={strokeDasharray:ne}:B={strokeDasharray:W};var se=fn(t),{radius:L}=se,Z=pP(se,Pie);return m.createElement("path",kg({},Z,{radius:typeof u=="number"?u:void 0,className:N,d:gP(ge,G,K,q,u),ref:r,style:mP(mP({},B),t.style)}))})};function vP(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function bP(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vP(Object(r),!0).forEach(function(s){Oie(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vP(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Oie(e,t,r){return(t=Die(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Die(e){var t=Fie(e,"string");return typeof t=="symbol"?t:t+""}function Fie(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Cg=Math.PI/180,Rie=e=>e*180/Math.PI,Ga=(e,t,r,s)=>({x:e+Math.cos(-Cg*s)*r,y:t+Math.sin(-Cg*s)*r}),yR=function(t,r){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(s.left||0)-(s.right||0)),Math.abs(r-(s.top||0)-(s.bottom||0)))/2},Mie=(e,t)=>{var{x:r,y:s}=e,{x:n,y:i}=t;return Math.sqrt((r-n)**2+(s-i)**2)},Lie=(e,t)=>{var{x:r,y:s}=e,{cx:n,cy:i}=t,l=Mie({x:r,y:s},{x:n,y:i});if(l<=0)return{radius:l,angle:0};var o=(r-n)/l,c=Math.acos(o);return s>i&&(c=2*Math.PI-c),{radius:l,angle:Rie(c),angleInRadian:c}},$ie=e=>{var{startAngle:t,endAngle:r}=e,s=Math.floor(t/360),n=Math.floor(r/360),i=Math.min(s,n);return{startAngle:t-i*360,endAngle:r-i*360}},Bie=(e,t)=>{var{startAngle:r,endAngle:s}=t,n=Math.floor(r/360),i=Math.floor(s/360),l=Math.min(n,i);return e+l*360},zie=(e,t)=>{var{chartX:r,chartY:s}=e,{radius:n,angle:i}=Lie({x:r,y:s},t),{innerRadius:l,outerRadius:o}=t;if(n<l||n>o||n===0)return null;var{startAngle:c,endAngle:u}=$ie(t),d=i,h;if(c<=u){for(;d>u;)d-=360;for(;d<c;)d+=360;h=d>=c&&d<=u}else{for(;d>c;)d-=360;for(;d<u;)d+=360;h=d>=u&&d<=c}return h?bP(bP({},t),{},{radius:n,angle:Bie(d,t)}):null};function vR(e){var{cx:t,cy:r,radius:s,startAngle:n,endAngle:i}=e,l=Ga(t,r,s,n),o=Ga(t,r,s,i);return{points:[l,o],cx:t,cy:r,radius:s,startAngle:n,endAngle:i}}function Cw(){return Cw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Cw.apply(null,arguments)}var Uie=(e,t)=>{var r=vs(t-e),s=Math.min(Math.abs(t-e),359.999);return r*s},Im=e=>{var{cx:t,cy:r,radius:s,angle:n,sign:i,isExternal:l,cornerRadius:o,cornerIsExternal:c}=e,u=o*(l?1:-1)+s,d=Math.asin(o/u)/Cg,h=c?n:n+i*d,f=Ga(t,r,u,h),x=Ga(t,r,s,h),p=c?n-i*d:n,g=Ga(t,r,u*Math.cos(d*Cg),p);return{center:f,circleTangency:x,lineTangency:g,theta:d}},bR=e=>{var{cx:t,cy:r,innerRadius:s,outerRadius:n,startAngle:i,endAngle:l}=e,o=Uie(i,l),c=i+o,u=Ga(t,r,n,i),d=Ga(t,r,n,c),h="M ".concat(u.x,",").concat(u.y,`
    A `).concat(n,",").concat(n,`,0,
    `).concat(+(Math.abs(o)>180),",").concat(+(i>c),`,
    `).concat(d.x,",").concat(d.y,`
  `);if(s>0){var f=Ga(t,r,s,i),x=Ga(t,r,s,c);h+="L ".concat(x.x,",").concat(x.y,`
            A `).concat(s,",").concat(s,`,0,
            `).concat(+(Math.abs(o)>180),",").concat(+(i<=c),`,
            `).concat(f.x,",").concat(f.y," Z")}else h+="L ".concat(t,",").concat(r," Z");return h},Wie=e=>{var{cx:t,cy:r,innerRadius:s,outerRadius:n,cornerRadius:i,forceCornerRadius:l,cornerIsExternal:o,startAngle:c,endAngle:u}=e,d=vs(u-c),{circleTangency:h,lineTangency:f,theta:x}=Im({cx:t,cy:r,radius:n,angle:c,sign:d,cornerRadius:i,cornerIsExternal:o}),{circleTangency:p,lineTangency:g,theta:y}=Im({cx:t,cy:r,radius:n,angle:u,sign:-d,cornerRadius:i,cornerIsExternal:o}),v=o?Math.abs(c-u):Math.abs(c-u)-x-y;if(v<0)return l?"M ".concat(f.x,",").concat(f.y,`
        a`).concat(i,",").concat(i,",0,0,1,").concat(i*2,`,0
        a`).concat(i,",").concat(i,",0,0,1,").concat(-i*2,`,0
      `):bR({cx:t,cy:r,innerRadius:s,outerRadius:n,startAngle:c,endAngle:u});var j="M ".concat(f.x,",").concat(f.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(d<0),",").concat(h.x,",").concat(h.y,`
    A`).concat(n,",").concat(n,",0,").concat(+(v>180),",").concat(+(d<0),",").concat(p.x,",").concat(p.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(d<0),",").concat(g.x,",").concat(g.y,`
  `);if(s>0){var{circleTangency:b,lineTangency:w,theta:k}=Im({cx:t,cy:r,radius:s,angle:c,sign:d,isExternal:!0,cornerRadius:i,cornerIsExternal:o}),{circleTangency:N,lineTangency:S,theta:_}=Im({cx:t,cy:r,radius:s,angle:u,sign:-d,isExternal:!0,cornerRadius:i,cornerIsExternal:o}),O=o?Math.abs(c-u):Math.abs(c-u)-k-_;if(O<0&&i===0)return"".concat(j,"L").concat(t,",").concat(r,"Z");j+="L".concat(S.x,",").concat(S.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(d<0),",").concat(N.x,",").concat(N.y,`
      A`).concat(s,",").concat(s,",0,").concat(+(O>180),",").concat(+(d>0),",").concat(b.x,",").concat(b.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(d<0),",").concat(w.x,",").concat(w.y,"Z")}else j+="L".concat(t,",").concat(r,"Z");return j},Vie={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},jR=e=>{var t=Ns(e,Vie),{cx:r,cy:s,innerRadius:n,outerRadius:i,cornerRadius:l,forceCornerRadius:o,cornerIsExternal:c,startAngle:u,endAngle:d,className:h}=t;if(i<n||u===d)return null;var f=Ar("recharts-sector",h),x=i-n,p=Qs(l,x,0,!0),g;return p>0&&Math.abs(u-d)<360?g=Wie({cx:r,cy:s,innerRadius:n,outerRadius:i,cornerRadius:Math.min(p,x/2),forceCornerRadius:o,cornerIsExternal:c,startAngle:u,endAngle:d}):g=bR({cx:r,cy:s,innerRadius:n,outerRadius:i,startAngle:u,endAngle:d}),m.createElement("path",Cw({},fn(t),{className:f,d:g}))};function Hie(e,t,r){if(e==="horizontal")return[{x:t.x,y:r.top},{x:t.x,y:r.top+r.height}];if(e==="vertical")return[{x:r.left,y:t.y},{x:r.left+r.width,y:t.y}];if(RD(t)){if(e==="centric"){var{cx:s,cy:n,innerRadius:i,outerRadius:l,angle:o}=t,c=Ga(s,n,i,o),u=Ga(s,n,l,o);return[{x:c.x,y:c.y},{x:u.x,y:u.y}]}return vR(t)}}var wR={},NR={},SR={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=uS;function r(s){return t.isSymbol(s)?NaN:Number(s)}e.toNumber=r})(SR);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=SR;function r(s){return s?(s=t.toNumber(s),s===1/0||s===-1/0?(s<0?-1:1)*Number.MAX_VALUE:s===s?s:0):s===0?s:0}e.toFinite=r})(NR);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=hS,r=NR;function s(n,i,l){l&&typeof l!="number"&&t.isIterateeCall(n,i,l)&&(i=l=void 0),n=r.toFinite(n),i===void 0?(i=n,n=0):i=r.toFinite(i),l=l===void 0?n<i?1:-1:r.toFinite(l);const o=Math.max(Math.ceil((i-n)/(l||1)),0),c=new Array(o);for(let u=0;u<o;u++)c[u]=n,n+=l;return c}e.range=s})(wR);var qie=wR.range;const kR=xo(qie);function uc(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Kie(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function CS(e){let t,r,s;e.length!==2?(t=uc,r=(o,c)=>uc(e(o),c),s=(o,c)=>e(o)-c):(t=e===uc||e===Kie?e:Gie,r=e,s=e);function n(o,c,u=0,d=o.length){if(u<d){if(t(c,c)!==0)return d;do{const h=u+d>>>1;r(o[h],c)<0?u=h+1:d=h}while(u<d)}return u}function i(o,c,u=0,d=o.length){if(u<d){if(t(c,c)!==0)return d;do{const h=u+d>>>1;r(o[h],c)<=0?u=h+1:d=h}while(u<d)}return u}function l(o,c,u=0,d=o.length){const h=n(o,c,u,d-1);return h>u&&s(o[h-1],c)>-s(o[h],c)?h-1:h}return{left:n,center:l,right:i}}function Gie(){return 0}function CR(e){return e===null?NaN:+e}function*Qie(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const Xie=CS(uc),Cx=Xie.right;CS(CR).center;class jP extends Map{constructor(t,r=Zie){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[s,n]of t)this.set(s,n)}get(t){return super.get(wP(this,t))}has(t){return super.has(wP(this,t))}set(t,r){return super.set(Yie(this,t),r)}delete(t){return super.delete(Jie(this,t))}}function wP({_intern:e,_key:t},r){const s=t(r);return e.has(s)?e.get(s):r}function Yie({_intern:e,_key:t},r){const s=t(r);return e.has(s)?e.get(s):(e.set(s,r),r)}function Jie({_intern:e,_key:t},r){const s=t(r);return e.has(s)&&(r=e.get(s),e.delete(s)),r}function Zie(e){return e!==null&&typeof e=="object"?e.valueOf():e}function ele(e=uc){if(e===uc)return ER;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const s=e(t,r);return s||s===0?s:(e(r,r)===0)-(e(t,t)===0)}}function ER(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const tle=Math.sqrt(50),rle=Math.sqrt(10),ale=Math.sqrt(2);function Eg(e,t,r){const s=(t-e)/Math.max(0,r),n=Math.floor(Math.log10(s)),i=s/Math.pow(10,n),l=i>=tle?10:i>=rle?5:i>=ale?2:1;let o,c,u;return n<0?(u=Math.pow(10,-n)/l,o=Math.round(e*u),c=Math.round(t*u),o/u<e&&++o,c/u>t&&--c,u=-u):(u=Math.pow(10,n)*l,o=Math.round(e/u),c=Math.round(t/u),o*u<e&&++o,c*u>t&&--c),c<o&&.5<=r&&r<2?Eg(e,t,r*2):[o,c,u]}function Ew(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const s=t<e,[n,i,l]=s?Eg(t,e,r):Eg(e,t,r);if(!(i>=n))return[];const o=i-n+1,c=new Array(o);if(s)if(l<0)for(let u=0;u<o;++u)c[u]=(i-u)/-l;else for(let u=0;u<o;++u)c[u]=(i-u)*l;else if(l<0)for(let u=0;u<o;++u)c[u]=(n+u)/-l;else for(let u=0;u<o;++u)c[u]=(n+u)*l;return c}function Pw(e,t,r){return t=+t,e=+e,r=+r,Eg(e,t,r)[2]}function Aw(e,t,r){t=+t,e=+e,r=+r;const s=t<e,n=s?Pw(t,e,r):Pw(e,t,r);return(s?-1:1)*(n<0?1/-n:n)}function NP(e,t){let r;for(const s of e)s!=null&&(r<s||r===void 0&&s>=s)&&(r=s);return r}function SP(e,t){let r;for(const s of e)s!=null&&(r>s||r===void 0&&s>=s)&&(r=s);return r}function PR(e,t,r=0,s=1/0,n){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),s=Math.floor(Math.min(e.length-1,s)),!(r<=t&&t<=s))return e;for(n=n===void 0?ER:ele(n);s>r;){if(s-r>600){const c=s-r+1,u=t-r+1,d=Math.log(c),h=.5*Math.exp(2*d/3),f=.5*Math.sqrt(d*h*(c-h)/c)*(u-c/2<0?-1:1),x=Math.max(r,Math.floor(t-u*h/c+f)),p=Math.min(s,Math.floor(t+(c-u)*h/c+f));PR(e,t,x,p,n)}const i=e[t];let l=r,o=s;for(ch(e,r,t),n(e[s],i)>0&&ch(e,r,s);l<o;){for(ch(e,l,o),++l,--o;n(e[l],i)<0;)++l;for(;n(e[o],i)>0;)--o}n(e[r],i)===0?ch(e,r,o):(++o,ch(e,o,s)),o<=t&&(r=o+1),t<=o&&(s=o-1)}return e}function ch(e,t,r){const s=e[t];e[t]=e[r],e[r]=s}function sle(e,t,r){if(e=Float64Array.from(Qie(e)),!(!(s=e.length)||isNaN(t=+t))){if(t<=0||s<2)return SP(e);if(t>=1)return NP(e);var s,n=(s-1)*t,i=Math.floor(n),l=NP(PR(e,i).subarray(0,i+1)),o=SP(e.subarray(i+1));return l+(o-l)*(n-i)}}function nle(e,t,r=CR){if(!(!(s=e.length)||isNaN(t=+t))){if(t<=0||s<2)return+r(e[0],0,e);if(t>=1)return+r(e[s-1],s-1,e);var s,n=(s-1)*t,i=Math.floor(n),l=+r(e[i],i,e),o=+r(e[i+1],i+1,e);return l+(o-l)*(n-i)}}function ile(e,t,r){e=+e,t=+t,r=(n=arguments.length)<2?(t=e,e=0,1):n<3?1:+r;for(var s=-1,n=Math.max(0,Math.ceil((t-e)/r))|0,i=new Array(n);++s<n;)i[s]=e+s*r;return i}function Ni(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function wo(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const _w=Symbol("implicit");function ES(){var e=new jP,t=[],r=[],s=_w;function n(i){let l=e.get(i);if(l===void 0){if(s!==_w)return s;e.set(i,l=t.push(i)-1)}return r[l%r.length]}return n.domain=function(i){if(!arguments.length)return t.slice();t=[],e=new jP;for(const l of i)e.has(l)||e.set(l,t.push(l)-1);return n},n.range=function(i){return arguments.length?(r=Array.from(i),n):r.slice()},n.unknown=function(i){return arguments.length?(s=i,n):s},n.copy=function(){return ES(t,r).unknown(s)},Ni.apply(n,arguments),n}function PS(){var e=ES().unknown(void 0),t=e.domain,r=e.range,s=0,n=1,i,l,o=!1,c=0,u=0,d=.5;delete e.unknown;function h(){var f=t().length,x=n<s,p=x?n:s,g=x?s:n;i=(g-p)/Math.max(1,f-c+u*2),o&&(i=Math.floor(i)),p+=(g-p-i*(f-c))*d,l=i*(1-c),o&&(p=Math.round(p),l=Math.round(l));var y=ile(f).map(function(v){return p+i*v});return r(x?y.reverse():y)}return e.domain=function(f){return arguments.length?(t(f),h()):t()},e.range=function(f){return arguments.length?([s,n]=f,s=+s,n=+n,h()):[s,n]},e.rangeRound=function(f){return[s,n]=f,s=+s,n=+n,o=!0,h()},e.bandwidth=function(){return l},e.step=function(){return i},e.round=function(f){return arguments.length?(o=!!f,h()):o},e.padding=function(f){return arguments.length?(c=Math.min(1,u=+f),h()):c},e.paddingInner=function(f){return arguments.length?(c=Math.min(1,f),h()):c},e.paddingOuter=function(f){return arguments.length?(u=+f,h()):u},e.align=function(f){return arguments.length?(d=Math.max(0,Math.min(1,f)),h()):d},e.copy=function(){return PS(t(),[s,n]).round(o).paddingInner(c).paddingOuter(u).align(d)},Ni.apply(h(),arguments)}function AR(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return AR(t())},e}function lle(){return AR(PS.apply(null,arguments).paddingInner(1))}function AS(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function _R(e,t){var r=Object.create(e.prototype);for(var s in t)r[s]=t[s];return r}function Ex(){}var Mf=.7,Pg=1/Mf,Bu="\\s*([+-]?\\d+)\\s*",Lf="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",yl="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ole=/^#([0-9a-f]{3,8})$/,cle=new RegExp(`^rgb\\(${Bu},${Bu},${Bu}\\)$`),dle=new RegExp(`^rgb\\(${yl},${yl},${yl}\\)$`),ule=new RegExp(`^rgba\\(${Bu},${Bu},${Bu},${Lf}\\)$`),hle=new RegExp(`^rgba\\(${yl},${yl},${yl},${Lf}\\)$`),fle=new RegExp(`^hsl\\(${Lf},${yl},${yl}\\)$`),xle=new RegExp(`^hsla\\(${Lf},${yl},${yl},${Lf}\\)$`),kP={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};AS(Ex,$f,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:CP,formatHex:CP,formatHex8:mle,formatHsl:ple,formatRgb:EP,toString:EP});function CP(){return this.rgb().formatHex()}function mle(){return this.rgb().formatHex8()}function ple(){return TR(this).formatHsl()}function EP(){return this.rgb().formatRgb()}function $f(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=ole.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?PP(t):r===3?new Cn(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?Om(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?Om(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=cle.exec(e))?new Cn(t[1],t[2],t[3],1):(t=dle.exec(e))?new Cn(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=ule.exec(e))?Om(t[1],t[2],t[3],t[4]):(t=hle.exec(e))?Om(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=fle.exec(e))?TP(t[1],t[2]/100,t[3]/100,1):(t=xle.exec(e))?TP(t[1],t[2]/100,t[3]/100,t[4]):kP.hasOwnProperty(e)?PP(kP[e]):e==="transparent"?new Cn(NaN,NaN,NaN,0):null}function PP(e){return new Cn(e>>16&255,e>>8&255,e&255,1)}function Om(e,t,r,s){return s<=0&&(e=t=r=NaN),new Cn(e,t,r,s)}function gle(e){return e instanceof Ex||(e=$f(e)),e?(e=e.rgb(),new Cn(e.r,e.g,e.b,e.opacity)):new Cn}function Tw(e,t,r,s){return arguments.length===1?gle(e):new Cn(e,t,r,s??1)}function Cn(e,t,r,s){this.r=+e,this.g=+t,this.b=+r,this.opacity=+s}AS(Cn,Tw,_R(Ex,{brighter(e){return e=e==null?Pg:Math.pow(Pg,e),new Cn(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Mf:Math.pow(Mf,e),new Cn(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Cn(pd(this.r),pd(this.g),pd(this.b),Ag(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:AP,formatHex:AP,formatHex8:yle,formatRgb:_P,toString:_P}));function AP(){return`#${Qc(this.r)}${Qc(this.g)}${Qc(this.b)}`}function yle(){return`#${Qc(this.r)}${Qc(this.g)}${Qc(this.b)}${Qc((isNaN(this.opacity)?1:this.opacity)*255)}`}function _P(){const e=Ag(this.opacity);return`${e===1?"rgb(":"rgba("}${pd(this.r)}, ${pd(this.g)}, ${pd(this.b)}${e===1?")":`, ${e})`}`}function Ag(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function pd(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Qc(e){return e=pd(e),(e<16?"0":"")+e.toString(16)}function TP(e,t,r,s){return s<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Mi(e,t,r,s)}function TR(e){if(e instanceof Mi)return new Mi(e.h,e.s,e.l,e.opacity);if(e instanceof Ex||(e=$f(e)),!e)return new Mi;if(e instanceof Mi)return e;e=e.rgb();var t=e.r/255,r=e.g/255,s=e.b/255,n=Math.min(t,r,s),i=Math.max(t,r,s),l=NaN,o=i-n,c=(i+n)/2;return o?(t===i?l=(r-s)/o+(r<s)*6:r===i?l=(s-t)/o+2:l=(t-r)/o+4,o/=c<.5?i+n:2-i-n,l*=60):o=c>0&&c<1?0:l,new Mi(l,o,c,e.opacity)}function vle(e,t,r,s){return arguments.length===1?TR(e):new Mi(e,t,r,s??1)}function Mi(e,t,r,s){this.h=+e,this.s=+t,this.l=+r,this.opacity=+s}AS(Mi,vle,_R(Ex,{brighter(e){return e=e==null?Pg:Math.pow(Pg,e),new Mi(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Mf:Math.pow(Mf,e),new Mi(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,s=r+(r<.5?r:1-r)*t,n=2*r-s;return new Cn(Yb(e>=240?e-240:e+120,n,s),Yb(e,n,s),Yb(e<120?e+240:e-120,n,s),this.opacity)},clamp(){return new Mi(IP(this.h),Dm(this.s),Dm(this.l),Ag(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Ag(this.opacity);return`${e===1?"hsl(":"hsla("}${IP(this.h)}, ${Dm(this.s)*100}%, ${Dm(this.l)*100}%${e===1?")":`, ${e})`}`}}));function IP(e){return e=(e||0)%360,e<0?e+360:e}function Dm(e){return Math.max(0,Math.min(1,e||0))}function Yb(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const _S=e=>()=>e;function ble(e,t){return function(r){return e+r*t}}function jle(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(s){return Math.pow(e+s*t,r)}}function wle(e){return(e=+e)==1?IR:function(t,r){return r-t?jle(t,r,e):_S(isNaN(t)?r:t)}}function IR(e,t){var r=t-e;return r?ble(e,r):_S(isNaN(e)?t:e)}const OP=function e(t){var r=wle(t);function s(n,i){var l=r((n=Tw(n)).r,(i=Tw(i)).r),o=r(n.g,i.g),c=r(n.b,i.b),u=IR(n.opacity,i.opacity);return function(d){return n.r=l(d),n.g=o(d),n.b=c(d),n.opacity=u(d),n+""}}return s.gamma=e,s}(1);function Nle(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,s=t.slice(),n;return function(i){for(n=0;n<r;++n)s[n]=e[n]*(1-i)+t[n]*i;return s}}function Sle(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function kle(e,t){var r=t?t.length:0,s=e?Math.min(r,e.length):0,n=new Array(s),i=new Array(r),l;for(l=0;l<s;++l)n[l]=L0(e[l],t[l]);for(;l<r;++l)i[l]=t[l];return function(o){for(l=0;l<s;++l)i[l]=n[l](o);return i}}function Cle(e,t){var r=new Date;return e=+e,t=+t,function(s){return r.setTime(e*(1-s)+t*s),r}}function _g(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function Ele(e,t){var r={},s={},n;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(n in t)n in e?r[n]=L0(e[n],t[n]):s[n]=t[n];return function(i){for(n in r)s[n]=r[n](i);return s}}var Iw=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Jb=new RegExp(Iw.source,"g");function Ple(e){return function(){return e}}function Ale(e){return function(t){return e(t)+""}}function _le(e,t){var r=Iw.lastIndex=Jb.lastIndex=0,s,n,i,l=-1,o=[],c=[];for(e=e+"",t=t+"";(s=Iw.exec(e))&&(n=Jb.exec(t));)(i=n.index)>r&&(i=t.slice(r,i),o[l]?o[l]+=i:o[++l]=i),(s=s[0])===(n=n[0])?o[l]?o[l]+=n:o[++l]=n:(o[++l]=null,c.push({i:l,x:_g(s,n)})),r=Jb.lastIndex;return r<t.length&&(i=t.slice(r),o[l]?o[l]+=i:o[++l]=i),o.length<2?c[0]?Ale(c[0].x):Ple(t):(t=c.length,function(u){for(var d=0,h;d<t;++d)o[(h=c[d]).i]=h.x(u);return o.join("")})}function L0(e,t){var r=typeof t,s;return t==null||r==="boolean"?_S(t):(r==="number"?_g:r==="string"?(s=$f(t))?(t=s,OP):_le:t instanceof $f?OP:t instanceof Date?Cle:Sle(t)?Nle:Array.isArray(t)?kle:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?Ele:_g)(e,t)}function TS(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function Tle(e,t){t===void 0&&(t=e,e=L0);for(var r=0,s=t.length-1,n=t[0],i=new Array(s<0?0:s);r<s;)i[r]=e(n,n=t[++r]);return function(l){var o=Math.max(0,Math.min(s-1,Math.floor(l*=s)));return i[o](l-o)}}function Ile(e){return function(){return e}}function Tg(e){return+e}var DP=[0,1];function cn(e){return e}function Ow(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:Ile(isNaN(t)?NaN:.5)}function Ole(e,t){var r;return e>t&&(r=e,e=t,t=r),function(s){return Math.max(e,Math.min(t,s))}}function Dle(e,t,r){var s=e[0],n=e[1],i=t[0],l=t[1];return n<s?(s=Ow(n,s),i=r(l,i)):(s=Ow(s,n),i=r(i,l)),function(o){return i(s(o))}}function Fle(e,t,r){var s=Math.min(e.length,t.length)-1,n=new Array(s),i=new Array(s),l=-1;for(e[s]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++l<s;)n[l]=Ow(e[l],e[l+1]),i[l]=r(t[l],t[l+1]);return function(o){var c=Cx(e,o,1,s)-1;return i[c](n[c](o))}}function Px(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function lv(){var e=DP,t=DP,r=L0,s,n,i,l=cn,o,c,u;function d(){var f=Math.min(e.length,t.length);return l!==cn&&(l=Ole(e[0],e[f-1])),o=f>2?Fle:Dle,c=u=null,h}function h(f){return f==null||isNaN(f=+f)?i:(c||(c=o(e.map(s),t,r)))(s(l(f)))}return h.invert=function(f){return l(n((u||(u=o(t,e.map(s),_g)))(f)))},h.domain=function(f){return arguments.length?(e=Array.from(f,Tg),d()):e.slice()},h.range=function(f){return arguments.length?(t=Array.from(f),d()):t.slice()},h.rangeRound=function(f){return t=Array.from(f),r=TS,d()},h.clamp=function(f){return arguments.length?(l=f?!0:cn,d()):l!==cn},h.interpolate=function(f){return arguments.length?(r=f,d()):r},h.unknown=function(f){return arguments.length?(i=f,h):i},function(f,x){return s=f,n=x,d()}}function IS(){return lv()(cn,cn)}function Rle(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Ig(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,s=e.slice(0,r);return[s.length>1?s[0]+s.slice(2):s,+e.slice(r+1)]}function b0(e){return e=Ig(Math.abs(e)),e?e[1]:NaN}function Mle(e,t){return function(r,s){for(var n=r.length,i=[],l=0,o=e[0],c=0;n>0&&o>0&&(c+o+1>s&&(o=Math.max(1,s-c)),i.push(r.substring(n-=o,n+o)),!((c+=o+1)>s));)o=e[l=(l+1)%e.length];return i.reverse().join(t)}}function Lle(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var $le=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Bf(e){if(!(t=$le.exec(e)))throw new Error("invalid format: "+e);var t;return new OS({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Bf.prototype=OS.prototype;function OS(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}OS.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Ble(e){e:for(var t=e.length,r=1,s=-1,n;r<t;++r)switch(e[r]){case".":s=n=r;break;case"0":s===0&&(s=r),n=r;break;default:if(!+e[r])break e;s>0&&(s=0);break}return s>0?e.slice(0,s)+e.slice(n+1):e}var OR;function zle(e,t){var r=Ig(e,t);if(!r)return e+"";var s=r[0],n=r[1],i=n-(OR=Math.max(-8,Math.min(8,Math.floor(n/3)))*3)+1,l=s.length;return i===l?s:i>l?s+new Array(i-l+1).join("0"):i>0?s.slice(0,i)+"."+s.slice(i):"0."+new Array(1-i).join("0")+Ig(e,Math.max(0,t+i-1))[0]}function FP(e,t){var r=Ig(e,t);if(!r)return e+"";var s=r[0],n=r[1];return n<0?"0."+new Array(-n).join("0")+s:s.length>n+1?s.slice(0,n+1)+"."+s.slice(n+1):s+new Array(n-s.length+2).join("0")}const RP={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:Rle,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>FP(e*100,t),r:FP,s:zle,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function MP(e){return e}var LP=Array.prototype.map,$P=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function Ule(e){var t=e.grouping===void 0||e.thousands===void 0?MP:Mle(LP.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",s=e.currency===void 0?"":e.currency[1]+"",n=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?MP:Lle(LP.call(e.numerals,String)),l=e.percent===void 0?"%":e.percent+"",o=e.minus===void 0?"":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function u(h){h=Bf(h);var f=h.fill,x=h.align,p=h.sign,g=h.symbol,y=h.zero,v=h.width,j=h.comma,b=h.precision,w=h.trim,k=h.type;k==="n"?(j=!0,k="g"):RP[k]||(b===void 0&&(b=12),w=!0,k="g"),(y||f==="0"&&x==="=")&&(y=!0,f="0",x="=");var N=g==="$"?r:g==="#"&&/[boxX]/.test(k)?"0"+k.toLowerCase():"",S=g==="$"?s:/[%p]/.test(k)?l:"",_=RP[k],O=/[defgprs%]/.test(k);b=b===void 0?6:/[gprs]/.test(k)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function E(R){var C=N,I=S,ne,W,Q;if(k==="c")I=_(R)+I,R="";else{R=+R;var H=R<0||1/R<0;if(R=isNaN(R)?c:_(Math.abs(R),b),w&&(R=Ble(R)),H&&+R==0&&p!=="+"&&(H=!1),C=(H?p==="("?p:o:p==="-"||p==="("?"":p)+C,I=(k==="s"?$P[8+OR/3]:"")+I+(H&&p==="("?")":""),O){for(ne=-1,W=R.length;++ne<W;)if(Q=R.charCodeAt(ne),48>Q||Q>57){I=(Q===46?n+R.slice(ne+1):R.slice(ne))+I,R=R.slice(0,ne);break}}}j&&!y&&(R=t(R,1/0));var K=C.length+R.length+I.length,q=K<v?new Array(v-K+1).join(f):"";switch(j&&y&&(R=t(q+R,q.length?v-I.length:1/0),q=""),x){case"<":R=C+R+I+q;break;case"=":R=C+q+R+I;break;case"^":R=q.slice(0,K=q.length>>1)+C+R+I+q.slice(K);break;default:R=q+C+R+I;break}return i(R)}return E.toString=function(){return h+""},E}function d(h,f){var x=u((h=Bf(h),h.type="f",h)),p=Math.max(-8,Math.min(8,Math.floor(b0(f)/3)))*3,g=Math.pow(10,-p),y=$P[8+p/3];return function(v){return x(g*v)+y}}return{format:u,formatPrefix:d}}var Fm,DS,DR;Wle({thousands:",",grouping:[3],currency:["$",""]});function Wle(e){return Fm=Ule(e),DS=Fm.format,DR=Fm.formatPrefix,Fm}function Vle(e){return Math.max(0,-b0(Math.abs(e)))}function Hle(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(b0(t)/3)))*3-b0(Math.abs(e)))}function qle(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,b0(t)-b0(e))+1}function FR(e,t,r,s){var n=Aw(e,t,r),i;switch(s=Bf(s??",f"),s.type){case"s":{var l=Math.max(Math.abs(e),Math.abs(t));return s.precision==null&&!isNaN(i=Hle(n,l))&&(s.precision=i),DR(s,l)}case"":case"e":case"g":case"p":case"r":{s.precision==null&&!isNaN(i=qle(n,Math.max(Math.abs(e),Math.abs(t))))&&(s.precision=i-(s.type==="e"));break}case"f":case"%":{s.precision==null&&!isNaN(i=Vle(n))&&(s.precision=i-(s.type==="%")*2);break}}return DS(s)}function _c(e){var t=e.domain;return e.ticks=function(r){var s=t();return Ew(s[0],s[s.length-1],r??10)},e.tickFormat=function(r,s){var n=t();return FR(n[0],n[n.length-1],r??10,s)},e.nice=function(r){r==null&&(r=10);var s=t(),n=0,i=s.length-1,l=s[n],o=s[i],c,u,d=10;for(o<l&&(u=l,l=o,o=u,u=n,n=i,i=u);d-- >0;){if(u=Pw(l,o,r),u===c)return s[n]=l,s[i]=o,t(s);if(u>0)l=Math.floor(l/u)*u,o=Math.ceil(o/u)*u;else if(u<0)l=Math.ceil(l*u)/u,o=Math.floor(o*u)/u;else break;c=u}return e},e}function RR(){var e=IS();return e.copy=function(){return Px(e,RR())},Ni.apply(e,arguments),_c(e)}function MR(e){var t;function r(s){return s==null||isNaN(s=+s)?t:s}return r.invert=r,r.domain=r.range=function(s){return arguments.length?(e=Array.from(s,Tg),r):e.slice()},r.unknown=function(s){return arguments.length?(t=s,r):t},r.copy=function(){return MR(e).unknown(t)},e=arguments.length?Array.from(e,Tg):[0,1],_c(r)}function LR(e,t){e=e.slice();var r=0,s=e.length-1,n=e[r],i=e[s],l;return i<n&&(l=r,r=s,s=l,l=n,n=i,i=l),e[r]=t.floor(n),e[s]=t.ceil(i),e}function BP(e){return Math.log(e)}function zP(e){return Math.exp(e)}function Kle(e){return-Math.log(-e)}function Gle(e){return-Math.exp(-e)}function Qle(e){return isFinite(e)?+("1e"+e):e<0?0:e}function Xle(e){return e===10?Qle:e===Math.E?Math.exp:t=>Math.pow(e,t)}function Yle(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function UP(e){return(t,r)=>-e(-t,r)}function FS(e){const t=e(BP,zP),r=t.domain;let s=10,n,i;function l(){return n=Yle(s),i=Xle(s),r()[0]<0?(n=UP(n),i=UP(i),e(Kle,Gle)):e(BP,zP),t}return t.base=function(o){return arguments.length?(s=+o,l()):s},t.domain=function(o){return arguments.length?(r(o),l()):r()},t.ticks=o=>{const c=r();let u=c[0],d=c[c.length-1];const h=d<u;h&&([u,d]=[d,u]);let f=n(u),x=n(d),p,g;const y=o==null?10:+o;let v=[];if(!(s%1)&&x-f<y){if(f=Math.floor(f),x=Math.ceil(x),u>0){for(;f<=x;++f)for(p=1;p<s;++p)if(g=f<0?p/i(-f):p*i(f),!(g<u)){if(g>d)break;v.push(g)}}else for(;f<=x;++f)for(p=s-1;p>=1;--p)if(g=f>0?p/i(-f):p*i(f),!(g<u)){if(g>d)break;v.push(g)}v.length*2<y&&(v=Ew(u,d,y))}else v=Ew(f,x,Math.min(x-f,y)).map(i);return h?v.reverse():v},t.tickFormat=(o,c)=>{if(o==null&&(o=10),c==null&&(c=s===10?"s":","),typeof c!="function"&&(!(s%1)&&(c=Bf(c)).precision==null&&(c.trim=!0),c=DS(c)),o===1/0)return c;const u=Math.max(1,s*o/t.ticks().length);return d=>{let h=d/i(Math.round(n(d)));return h*s<s-.5&&(h*=s),h<=u?c(d):""}},t.nice=()=>r(LR(r(),{floor:o=>i(Math.floor(n(o))),ceil:o=>i(Math.ceil(n(o)))})),t}function $R(){const e=FS(lv()).domain([1,10]);return e.copy=()=>Px(e,$R()).base(e.base()),Ni.apply(e,arguments),e}function WP(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function VP(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function RS(e){var t=1,r=e(WP(t),VP(t));return r.constant=function(s){return arguments.length?e(WP(t=+s),VP(t)):t},_c(r)}function BR(){var e=RS(lv());return e.copy=function(){return Px(e,BR()).constant(e.constant())},Ni.apply(e,arguments)}function HP(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function Jle(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function Zle(e){return e<0?-e*e:e*e}function MS(e){var t=e(cn,cn),r=1;function s(){return r===1?e(cn,cn):r===.5?e(Jle,Zle):e(HP(r),HP(1/r))}return t.exponent=function(n){return arguments.length?(r=+n,s()):r},_c(t)}function LS(){var e=MS(lv());return e.copy=function(){return Px(e,LS()).exponent(e.exponent())},Ni.apply(e,arguments),e}function eoe(){return LS.apply(null,arguments).exponent(.5)}function qP(e){return Math.sign(e)*e*e}function toe(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function zR(){var e=IS(),t=[0,1],r=!1,s;function n(i){var l=toe(e(i));return isNaN(l)?s:r?Math.round(l):l}return n.invert=function(i){return e.invert(qP(i))},n.domain=function(i){return arguments.length?(e.domain(i),n):e.domain()},n.range=function(i){return arguments.length?(e.range((t=Array.from(i,Tg)).map(qP)),n):t.slice()},n.rangeRound=function(i){return n.range(i).round(!0)},n.round=function(i){return arguments.length?(r=!!i,n):r},n.clamp=function(i){return arguments.length?(e.clamp(i),n):e.clamp()},n.unknown=function(i){return arguments.length?(s=i,n):s},n.copy=function(){return zR(e.domain(),t).round(r).clamp(e.clamp()).unknown(s)},Ni.apply(n,arguments),_c(n)}function UR(){var e=[],t=[],r=[],s;function n(){var l=0,o=Math.max(1,t.length);for(r=new Array(o-1);++l<o;)r[l-1]=nle(e,l/o);return i}function i(l){return l==null||isNaN(l=+l)?s:t[Cx(r,l)]}return i.invertExtent=function(l){var o=t.indexOf(l);return o<0?[NaN,NaN]:[o>0?r[o-1]:e[0],o<r.length?r[o]:e[e.length-1]]},i.domain=function(l){if(!arguments.length)return e.slice();e=[];for(let o of l)o!=null&&!isNaN(o=+o)&&e.push(o);return e.sort(uc),n()},i.range=function(l){return arguments.length?(t=Array.from(l),n()):t.slice()},i.unknown=function(l){return arguments.length?(s=l,i):s},i.quantiles=function(){return r.slice()},i.copy=function(){return UR().domain(e).range(t).unknown(s)},Ni.apply(i,arguments)}function WR(){var e=0,t=1,r=1,s=[.5],n=[0,1],i;function l(c){return c!=null&&c<=c?n[Cx(s,c,0,r)]:i}function o(){var c=-1;for(s=new Array(r);++c<r;)s[c]=((c+1)*t-(c-r)*e)/(r+1);return l}return l.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,o()):[e,t]},l.range=function(c){return arguments.length?(r=(n=Array.from(c)).length-1,o()):n.slice()},l.invertExtent=function(c){var u=n.indexOf(c);return u<0?[NaN,NaN]:u<1?[e,s[0]]:u>=r?[s[r-1],t]:[s[u-1],s[u]]},l.unknown=function(c){return arguments.length&&(i=c),l},l.thresholds=function(){return s.slice()},l.copy=function(){return WR().domain([e,t]).range(n).unknown(i)},Ni.apply(_c(l),arguments)}function VR(){var e=[.5],t=[0,1],r,s=1;function n(i){return i!=null&&i<=i?t[Cx(e,i,0,s)]:r}return n.domain=function(i){return arguments.length?(e=Array.from(i),s=Math.min(e.length,t.length-1),n):e.slice()},n.range=function(i){return arguments.length?(t=Array.from(i),s=Math.min(e.length,t.length-1),n):t.slice()},n.invertExtent=function(i){var l=t.indexOf(i);return[e[l-1],e[l]]},n.unknown=function(i){return arguments.length?(r=i,n):r},n.copy=function(){return VR().domain(e).range(t).unknown(r)},Ni.apply(n,arguments)}const Zb=new Date,e1=new Date;function ss(e,t,r,s){function n(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return n.floor=i=>(e(i=new Date(+i)),i),n.ceil=i=>(e(i=new Date(i-1)),t(i,1),e(i),i),n.round=i=>{const l=n(i),o=n.ceil(i);return i-l<o-i?l:o},n.offset=(i,l)=>(t(i=new Date(+i),l==null?1:Math.floor(l)),i),n.range=(i,l,o)=>{const c=[];if(i=n.ceil(i),o=o==null?1:Math.floor(o),!(i<l)||!(o>0))return c;let u;do c.push(u=new Date(+i)),t(i,o),e(i);while(u<i&&i<l);return c},n.filter=i=>ss(l=>{if(l>=l)for(;e(l),!i(l);)l.setTime(l-1)},(l,o)=>{if(l>=l)if(o<0)for(;++o<=0;)for(;t(l,-1),!i(l););else for(;--o>=0;)for(;t(l,1),!i(l););}),r&&(n.count=(i,l)=>(Zb.setTime(+i),e1.setTime(+l),e(Zb),e(e1),Math.floor(r(Zb,e1))),n.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?n.filter(s?l=>s(l)%i===0:l=>n.count(0,l)%i===0):n)),n}const Og=ss(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Og.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?ss(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):Og);Og.range;const Wl=1e3,xi=Wl*60,Vl=xi*60,oo=Vl*24,$S=oo*7,KP=oo*30,t1=oo*365,Xc=ss(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Wl)},(e,t)=>(t-e)/Wl,e=>e.getUTCSeconds());Xc.range;const BS=ss(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Wl)},(e,t)=>{e.setTime(+e+t*xi)},(e,t)=>(t-e)/xi,e=>e.getMinutes());BS.range;const zS=ss(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*xi)},(e,t)=>(t-e)/xi,e=>e.getUTCMinutes());zS.range;const US=ss(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Wl-e.getMinutes()*xi)},(e,t)=>{e.setTime(+e+t*Vl)},(e,t)=>(t-e)/Vl,e=>e.getHours());US.range;const WS=ss(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Vl)},(e,t)=>(t-e)/Vl,e=>e.getUTCHours());WS.range;const Ax=ss(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*xi)/oo,e=>e.getDate()-1);Ax.range;const ov=ss(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/oo,e=>e.getUTCDate()-1);ov.range;const HR=ss(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/oo,e=>Math.floor(e/oo));HR.range;function Jd(e){return ss(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*xi)/$S)}const cv=Jd(0),Dg=Jd(1),roe=Jd(2),aoe=Jd(3),j0=Jd(4),soe=Jd(5),noe=Jd(6);cv.range;Dg.range;roe.range;aoe.range;j0.range;soe.range;noe.range;function Zd(e){return ss(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/$S)}const dv=Zd(0),Fg=Zd(1),ioe=Zd(2),loe=Zd(3),w0=Zd(4),ooe=Zd(5),coe=Zd(6);dv.range;Fg.range;ioe.range;loe.range;w0.range;ooe.range;coe.range;const VS=ss(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());VS.range;const HS=ss(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());HS.range;const co=ss(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());co.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:ss(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});co.range;const uo=ss(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());uo.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:ss(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});uo.range;function qR(e,t,r,s,n,i){const l=[[Xc,1,Wl],[Xc,5,5*Wl],[Xc,15,15*Wl],[Xc,30,30*Wl],[i,1,xi],[i,5,5*xi],[i,15,15*xi],[i,30,30*xi],[n,1,Vl],[n,3,3*Vl],[n,6,6*Vl],[n,12,12*Vl],[s,1,oo],[s,2,2*oo],[r,1,$S],[t,1,KP],[t,3,3*KP],[e,1,t1]];function o(u,d,h){const f=d<u;f&&([u,d]=[d,u]);const x=h&&typeof h.range=="function"?h:c(u,d,h),p=x?x.range(u,+d+1):[];return f?p.reverse():p}function c(u,d,h){const f=Math.abs(d-u)/h,x=CS(([,,y])=>y).right(l,f);if(x===l.length)return e.every(Aw(u/t1,d/t1,h));if(x===0)return Og.every(Math.max(Aw(u,d,h),1));const[p,g]=l[f/l[x-1][2]<l[x][2]/f?x-1:x];return p.every(g)}return[o,c]}const[doe,uoe]=qR(uo,HS,dv,HR,WS,zS),[hoe,foe]=qR(co,VS,cv,Ax,US,BS);function r1(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function a1(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function dh(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function xoe(e){var t=e.dateTime,r=e.date,s=e.time,n=e.periods,i=e.days,l=e.shortDays,o=e.months,c=e.shortMonths,u=uh(n),d=hh(n),h=uh(i),f=hh(i),x=uh(l),p=hh(l),g=uh(o),y=hh(o),v=uh(c),j=hh(c),b={a:H,A:K,b:q,B:ge,c:null,d:ZP,e:ZP,f:Moe,g:Koe,G:Qoe,H:Doe,I:Foe,j:Roe,L:KR,m:Loe,M:$oe,p:G,q:B,Q:rA,s:aA,S:Boe,u:zoe,U:Uoe,V:Woe,w:Voe,W:Hoe,x:null,X:null,y:qoe,Y:Goe,Z:Xoe,"%":tA},w={a:se,A:L,b:Z,B:F,c:null,d:eA,e:eA,f:ece,g:dce,G:hce,H:Yoe,I:Joe,j:Zoe,L:QR,m:tce,M:rce,p:he,q:ye,Q:rA,s:aA,S:ace,u:sce,U:nce,V:ice,w:lce,W:oce,x:null,X:null,y:cce,Y:uce,Z:fce,"%":tA},k={a:E,A:R,b:C,B:I,c:ne,d:YP,e:YP,f:_oe,g:XP,G:QP,H:JP,I:JP,j:Coe,L:Aoe,m:koe,M:Eoe,p:O,q:Soe,Q:Ioe,s:Ooe,S:Poe,u:voe,U:boe,V:joe,w:yoe,W:woe,x:W,X:Q,y:XP,Y:QP,Z:Noe,"%":Toe};b.x=N(r,b),b.X=N(s,b),b.c=N(t,b),w.x=N(r,w),w.X=N(s,w),w.c=N(t,w);function N(z,A){return function(de){var D=[],ze=-1,Fe=0,ct=z.length,$e,We,Bt;for(de instanceof Date||(de=new Date(+de));++ze<ct;)z.charCodeAt(ze)===37&&(D.push(z.slice(Fe,ze)),(We=GP[$e=z.charAt(++ze)])!=null?$e=z.charAt(++ze):We=$e==="e"?" ":"0",(Bt=A[$e])&&($e=Bt(de,We)),D.push($e),Fe=ze+1);return D.push(z.slice(Fe,ze)),D.join("")}}function S(z,A){return function(de){var D=dh(1900,void 0,1),ze=_(D,z,de+="",0),Fe,ct;if(ze!=de.length)return null;if("Q"in D)return new Date(D.Q);if("s"in D)return new Date(D.s*1e3+("L"in D?D.L:0));if(A&&!("Z"in D)&&(D.Z=0),"p"in D&&(D.H=D.H%12+D.p*12),D.m===void 0&&(D.m="q"in D?D.q:0),"V"in D){if(D.V<1||D.V>53)return null;"w"in D||(D.w=1),"Z"in D?(Fe=a1(dh(D.y,0,1)),ct=Fe.getUTCDay(),Fe=ct>4||ct===0?Fg.ceil(Fe):Fg(Fe),Fe=ov.offset(Fe,(D.V-1)*7),D.y=Fe.getUTCFullYear(),D.m=Fe.getUTCMonth(),D.d=Fe.getUTCDate()+(D.w+6)%7):(Fe=r1(dh(D.y,0,1)),ct=Fe.getDay(),Fe=ct>4||ct===0?Dg.ceil(Fe):Dg(Fe),Fe=Ax.offset(Fe,(D.V-1)*7),D.y=Fe.getFullYear(),D.m=Fe.getMonth(),D.d=Fe.getDate()+(D.w+6)%7)}else("W"in D||"U"in D)&&("w"in D||(D.w="u"in D?D.u%7:"W"in D?1:0),ct="Z"in D?a1(dh(D.y,0,1)).getUTCDay():r1(dh(D.y,0,1)).getDay(),D.m=0,D.d="W"in D?(D.w+6)%7+D.W*7-(ct+5)%7:D.w+D.U*7-(ct+6)%7);return"Z"in D?(D.H+=D.Z/100|0,D.M+=D.Z%100,a1(D)):r1(D)}}function _(z,A,de,D){for(var ze=0,Fe=A.length,ct=de.length,$e,We;ze<Fe;){if(D>=ct)return-1;if($e=A.charCodeAt(ze++),$e===37){if($e=A.charAt(ze++),We=k[$e in GP?A.charAt(ze++):$e],!We||(D=We(z,de,D))<0)return-1}else if($e!=de.charCodeAt(D++))return-1}return D}function O(z,A,de){var D=u.exec(A.slice(de));return D?(z.p=d.get(D[0].toLowerCase()),de+D[0].length):-1}function E(z,A,de){var D=x.exec(A.slice(de));return D?(z.w=p.get(D[0].toLowerCase()),de+D[0].length):-1}function R(z,A,de){var D=h.exec(A.slice(de));return D?(z.w=f.get(D[0].toLowerCase()),de+D[0].length):-1}function C(z,A,de){var D=v.exec(A.slice(de));return D?(z.m=j.get(D[0].toLowerCase()),de+D[0].length):-1}function I(z,A,de){var D=g.exec(A.slice(de));return D?(z.m=y.get(D[0].toLowerCase()),de+D[0].length):-1}function ne(z,A,de){return _(z,t,A,de)}function W(z,A,de){return _(z,r,A,de)}function Q(z,A,de){return _(z,s,A,de)}function H(z){return l[z.getDay()]}function K(z){return i[z.getDay()]}function q(z){return c[z.getMonth()]}function ge(z){return o[z.getMonth()]}function G(z){return n[+(z.getHours()>=12)]}function B(z){return 1+~~(z.getMonth()/3)}function se(z){return l[z.getUTCDay()]}function L(z){return i[z.getUTCDay()]}function Z(z){return c[z.getUTCMonth()]}function F(z){return o[z.getUTCMonth()]}function he(z){return n[+(z.getUTCHours()>=12)]}function ye(z){return 1+~~(z.getUTCMonth()/3)}return{format:function(z){var A=N(z+="",b);return A.toString=function(){return z},A},parse:function(z){var A=S(z+="",!1);return A.toString=function(){return z},A},utcFormat:function(z){var A=N(z+="",w);return A.toString=function(){return z},A},utcParse:function(z){var A=S(z+="",!0);return A.toString=function(){return z},A}}}var GP={"-":"",_:" ",0:"0"},Ss=/^\s*\d+/,moe=/^%/,poe=/[\\^$*+?|[\]().{}]/g;function Cr(e,t,r){var s=e<0?"-":"",n=(s?-e:e)+"",i=n.length;return s+(i<r?new Array(r-i+1).join(t)+n:n)}function goe(e){return e.replace(poe,"\\$&")}function uh(e){return new RegExp("^(?:"+e.map(goe).join("|")+")","i")}function hh(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function yoe(e,t,r){var s=Ss.exec(t.slice(r,r+1));return s?(e.w=+s[0],r+s[0].length):-1}function voe(e,t,r){var s=Ss.exec(t.slice(r,r+1));return s?(e.u=+s[0],r+s[0].length):-1}function boe(e,t,r){var s=Ss.exec(t.slice(r,r+2));return s?(e.U=+s[0],r+s[0].length):-1}function joe(e,t,r){var s=Ss.exec(t.slice(r,r+2));return s?(e.V=+s[0],r+s[0].length):-1}function woe(e,t,r){var s=Ss.exec(t.slice(r,r+2));return s?(e.W=+s[0],r+s[0].length):-1}function QP(e,t,r){var s=Ss.exec(t.slice(r,r+4));return s?(e.y=+s[0],r+s[0].length):-1}function XP(e,t,r){var s=Ss.exec(t.slice(r,r+2));return s?(e.y=+s[0]+(+s[0]>68?1900:2e3),r+s[0].length):-1}function Noe(e,t,r){var s=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return s?(e.Z=s[1]?0:-(s[2]+(s[3]||"00")),r+s[0].length):-1}function Soe(e,t,r){var s=Ss.exec(t.slice(r,r+1));return s?(e.q=s[0]*3-3,r+s[0].length):-1}function koe(e,t,r){var s=Ss.exec(t.slice(r,r+2));return s?(e.m=s[0]-1,r+s[0].length):-1}function YP(e,t,r){var s=Ss.exec(t.slice(r,r+2));return s?(e.d=+s[0],r+s[0].length):-1}function Coe(e,t,r){var s=Ss.exec(t.slice(r,r+3));return s?(e.m=0,e.d=+s[0],r+s[0].length):-1}function JP(e,t,r){var s=Ss.exec(t.slice(r,r+2));return s?(e.H=+s[0],r+s[0].length):-1}function Eoe(e,t,r){var s=Ss.exec(t.slice(r,r+2));return s?(e.M=+s[0],r+s[0].length):-1}function Poe(e,t,r){var s=Ss.exec(t.slice(r,r+2));return s?(e.S=+s[0],r+s[0].length):-1}function Aoe(e,t,r){var s=Ss.exec(t.slice(r,r+3));return s?(e.L=+s[0],r+s[0].length):-1}function _oe(e,t,r){var s=Ss.exec(t.slice(r,r+6));return s?(e.L=Math.floor(s[0]/1e3),r+s[0].length):-1}function Toe(e,t,r){var s=moe.exec(t.slice(r,r+1));return s?r+s[0].length:-1}function Ioe(e,t,r){var s=Ss.exec(t.slice(r));return s?(e.Q=+s[0],r+s[0].length):-1}function Ooe(e,t,r){var s=Ss.exec(t.slice(r));return s?(e.s=+s[0],r+s[0].length):-1}function ZP(e,t){return Cr(e.getDate(),t,2)}function Doe(e,t){return Cr(e.getHours(),t,2)}function Foe(e,t){return Cr(e.getHours()%12||12,t,2)}function Roe(e,t){return Cr(1+Ax.count(co(e),e),t,3)}function KR(e,t){return Cr(e.getMilliseconds(),t,3)}function Moe(e,t){return KR(e,t)+"000"}function Loe(e,t){return Cr(e.getMonth()+1,t,2)}function $oe(e,t){return Cr(e.getMinutes(),t,2)}function Boe(e,t){return Cr(e.getSeconds(),t,2)}function zoe(e){var t=e.getDay();return t===0?7:t}function Uoe(e,t){return Cr(cv.count(co(e)-1,e),t,2)}function GR(e){var t=e.getDay();return t>=4||t===0?j0(e):j0.ceil(e)}function Woe(e,t){return e=GR(e),Cr(j0.count(co(e),e)+(co(e).getDay()===4),t,2)}function Voe(e){return e.getDay()}function Hoe(e,t){return Cr(Dg.count(co(e)-1,e),t,2)}function qoe(e,t){return Cr(e.getFullYear()%100,t,2)}function Koe(e,t){return e=GR(e),Cr(e.getFullYear()%100,t,2)}function Goe(e,t){return Cr(e.getFullYear()%1e4,t,4)}function Qoe(e,t){var r=e.getDay();return e=r>=4||r===0?j0(e):j0.ceil(e),Cr(e.getFullYear()%1e4,t,4)}function Xoe(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Cr(t/60|0,"0",2)+Cr(t%60,"0",2)}function eA(e,t){return Cr(e.getUTCDate(),t,2)}function Yoe(e,t){return Cr(e.getUTCHours(),t,2)}function Joe(e,t){return Cr(e.getUTCHours()%12||12,t,2)}function Zoe(e,t){return Cr(1+ov.count(uo(e),e),t,3)}function QR(e,t){return Cr(e.getUTCMilliseconds(),t,3)}function ece(e,t){return QR(e,t)+"000"}function tce(e,t){return Cr(e.getUTCMonth()+1,t,2)}function rce(e,t){return Cr(e.getUTCMinutes(),t,2)}function ace(e,t){return Cr(e.getUTCSeconds(),t,2)}function sce(e){var t=e.getUTCDay();return t===0?7:t}function nce(e,t){return Cr(dv.count(uo(e)-1,e),t,2)}function XR(e){var t=e.getUTCDay();return t>=4||t===0?w0(e):w0.ceil(e)}function ice(e,t){return e=XR(e),Cr(w0.count(uo(e),e)+(uo(e).getUTCDay()===4),t,2)}function lce(e){return e.getUTCDay()}function oce(e,t){return Cr(Fg.count(uo(e)-1,e),t,2)}function cce(e,t){return Cr(e.getUTCFullYear()%100,t,2)}function dce(e,t){return e=XR(e),Cr(e.getUTCFullYear()%100,t,2)}function uce(e,t){return Cr(e.getUTCFullYear()%1e4,t,4)}function hce(e,t){var r=e.getUTCDay();return e=r>=4||r===0?w0(e):w0.ceil(e),Cr(e.getUTCFullYear()%1e4,t,4)}function fce(){return"+0000"}function tA(){return"%"}function rA(e){return+e}function aA(e){return Math.floor(+e/1e3)}var ou,YR,JR;xce({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function xce(e){return ou=xoe(e),YR=ou.format,ou.parse,JR=ou.utcFormat,ou.utcParse,ou}function mce(e){return new Date(e)}function pce(e){return e instanceof Date?+e:+new Date(+e)}function qS(e,t,r,s,n,i,l,o,c,u){var d=IS(),h=d.invert,f=d.domain,x=u(".%L"),p=u(":%S"),g=u("%I:%M"),y=u("%I %p"),v=u("%a %d"),j=u("%b %d"),b=u("%B"),w=u("%Y");function k(N){return(c(N)<N?x:o(N)<N?p:l(N)<N?g:i(N)<N?y:s(N)<N?n(N)<N?v:j:r(N)<N?b:w)(N)}return d.invert=function(N){return new Date(h(N))},d.domain=function(N){return arguments.length?f(Array.from(N,pce)):f().map(mce)},d.ticks=function(N){var S=f();return e(S[0],S[S.length-1],N??10)},d.tickFormat=function(N,S){return S==null?k:u(S)},d.nice=function(N){var S=f();return(!N||typeof N.range!="function")&&(N=t(S[0],S[S.length-1],N??10)),N?f(LR(S,N)):d},d.copy=function(){return Px(d,qS(e,t,r,s,n,i,l,o,c,u))},d}function gce(){return Ni.apply(qS(hoe,foe,co,VS,cv,Ax,US,BS,Xc,YR).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function yce(){return Ni.apply(qS(doe,uoe,uo,HS,dv,ov,WS,zS,Xc,JR).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function uv(){var e=0,t=1,r,s,n,i,l=cn,o=!1,c;function u(h){return h==null||isNaN(h=+h)?c:l(n===0?.5:(h=(i(h)-r)*n,o?Math.max(0,Math.min(1,h)):h))}u.domain=function(h){return arguments.length?([e,t]=h,r=i(e=+e),s=i(t=+t),n=r===s?0:1/(s-r),u):[e,t]},u.clamp=function(h){return arguments.length?(o=!!h,u):o},u.interpolator=function(h){return arguments.length?(l=h,u):l};function d(h){return function(f){var x,p;return arguments.length?([x,p]=f,l=h(x,p),u):[l(0),l(1)]}}return u.range=d(L0),u.rangeRound=d(TS),u.unknown=function(h){return arguments.length?(c=h,u):c},function(h){return i=h,r=h(e),s=h(t),n=r===s?0:1/(s-r),u}}function Tc(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function ZR(){var e=_c(uv()(cn));return e.copy=function(){return Tc(e,ZR())},wo.apply(e,arguments)}function e8(){var e=FS(uv()).domain([1,10]);return e.copy=function(){return Tc(e,e8()).base(e.base())},wo.apply(e,arguments)}function t8(){var e=RS(uv());return e.copy=function(){return Tc(e,t8()).constant(e.constant())},wo.apply(e,arguments)}function KS(){var e=MS(uv());return e.copy=function(){return Tc(e,KS()).exponent(e.exponent())},wo.apply(e,arguments)}function vce(){return KS.apply(null,arguments).exponent(.5)}function r8(){var e=[],t=cn;function r(s){if(s!=null&&!isNaN(s=+s))return t((Cx(e,s,1)-1)/(e.length-1))}return r.domain=function(s){if(!arguments.length)return e.slice();e=[];for(let n of s)n!=null&&!isNaN(n=+n)&&e.push(n);return e.sort(uc),r},r.interpolator=function(s){return arguments.length?(t=s,r):t},r.range=function(){return e.map((s,n)=>t(n/(e.length-1)))},r.quantiles=function(s){return Array.from({length:s+1},(n,i)=>sle(e,i/s))},r.copy=function(){return r8(t).domain(e)},wo.apply(r,arguments)}function hv(){var e=0,t=.5,r=1,s=1,n,i,l,o,c,u=cn,d,h=!1,f;function x(g){return isNaN(g=+g)?f:(g=.5+((g=+d(g))-i)*(s*g<s*i?o:c),u(h?Math.max(0,Math.min(1,g)):g))}x.domain=function(g){return arguments.length?([e,t,r]=g,n=d(e=+e),i=d(t=+t),l=d(r=+r),o=n===i?0:.5/(i-n),c=i===l?0:.5/(l-i),s=i<n?-1:1,x):[e,t,r]},x.clamp=function(g){return arguments.length?(h=!!g,x):h},x.interpolator=function(g){return arguments.length?(u=g,x):u};function p(g){return function(y){var v,j,b;return arguments.length?([v,j,b]=y,u=Tle(g,[v,j,b]),x):[u(0),u(.5),u(1)]}}return x.range=p(L0),x.rangeRound=p(TS),x.unknown=function(g){return arguments.length?(f=g,x):f},function(g){return d=g,n=g(e),i=g(t),l=g(r),o=n===i?0:.5/(i-n),c=i===l?0:.5/(l-i),s=i<n?-1:1,x}}function a8(){var e=_c(hv()(cn));return e.copy=function(){return Tc(e,a8())},wo.apply(e,arguments)}function s8(){var e=FS(hv()).domain([.1,1,10]);return e.copy=function(){return Tc(e,s8()).base(e.base())},wo.apply(e,arguments)}function n8(){var e=RS(hv());return e.copy=function(){return Tc(e,n8()).constant(e.constant())},wo.apply(e,arguments)}function GS(){var e=MS(hv());return e.copy=function(){return Tc(e,GS()).exponent(e.exponent())},wo.apply(e,arguments)}function bce(){return GS.apply(null,arguments).exponent(.5)}const Sh=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:PS,scaleDiverging:a8,scaleDivergingLog:s8,scaleDivergingPow:GS,scaleDivergingSqrt:bce,scaleDivergingSymlog:n8,scaleIdentity:MR,scaleImplicit:_w,scaleLinear:RR,scaleLog:$R,scaleOrdinal:ES,scalePoint:lle,scalePow:LS,scaleQuantile:UR,scaleQuantize:WR,scaleRadial:zR,scaleSequential:ZR,scaleSequentialLog:e8,scaleSequentialPow:KS,scaleSequentialQuantile:r8,scaleSequentialSqrt:vce,scaleSequentialSymlog:t8,scaleSqrt:eoe,scaleSymlog:BR,scaleThreshold:VR,scaleTime:gce,scaleUtc:yce,tickFormat:FR},Symbol.toStringTag,{value:"Module"}));var Ic=e=>e.chartData,QS=Te([Ic],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),fv=(e,t,r,s)=>s?QS(e):Ic(e);function yc(e){if(Array.isArray(e)&&e.length===2){var[t,r]=e;if($a(t)&&$a(r))return!0}return!1}function sA(e,t,r){return r?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function i8(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[r,s]=e,n,i;if($a(r))n=r;else if(typeof r=="function")return;if($a(s))i=s;else if(typeof s=="function")return;var l=[n,i];if(yc(l))return l}}function jce(e,t,r){if(!(!r&&t==null)){if(typeof e=="function"&&t!=null)try{var s=e(t,r);if(yc(s))return sA(s,t,r)}catch{}if(Array.isArray(e)&&e.length===2){var[n,i]=e,l,o;if(n==="auto")t!=null&&(l=Math.min(...t));else if(Et(n))l=n;else if(typeof n=="function")try{t!=null&&(l=n(t==null?void 0:t[0]))}catch{}else if(typeof n=="string"&&UE.test(n)){var c=UE.exec(n);if(c==null||t==null)l=void 0;else{var u=+c[1];l=t[0]-u}}else l=t==null?void 0:t[0];if(i==="auto")t!=null&&(o=Math.max(...t));else if(Et(i))o=i;else if(typeof i=="function")try{t!=null&&(o=i(t==null?void 0:t[1]))}catch{}else if(typeof i=="string"&&WE.test(i)){var d=WE.exec(i);if(d==null||t==null)o=void 0;else{var h=+d[1];o=t[1]+h}}else o=t==null?void 0:t[1];var f=[l,o];if(yc(f))return t==null?f:sA(f,t,r)}}}var $0=1e9,wce={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},YS,ca=!0,ji="[DecimalError] ",gd=ji+"Invalid argument: ",XS=ji+"Exponent out of range: ",B0=Math.floor,$c=Math.pow,Nce=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Wn,xs=1e7,ea=7,l8=9007199254740991,Rg=B0(l8/ea),wt={};wt.absoluteValue=wt.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};wt.comparedTo=wt.cmp=function(e){var t,r,s,n,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(s=i.d.length,n=e.d.length,t=0,r=s<n?s:n;t<r;++t)if(i.d[t]!==e.d[t])return i.d[t]>e.d[t]^i.s<0?1:-1;return s===n?0:s>n^i.s<0?1:-1};wt.decimalPlaces=wt.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*ea;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};wt.dividedBy=wt.div=function(e){return Ql(this,new this.constructor(e))};wt.dividedToIntegerBy=wt.idiv=function(e){var t=this,r=t.constructor;return Gr(Ql(t,new r(e),0,1),r.precision)};wt.equals=wt.eq=function(e){return!this.cmp(e)};wt.exponent=function(){return Xa(this)};wt.greaterThan=wt.gt=function(e){return this.cmp(e)>0};wt.greaterThanOrEqualTo=wt.gte=function(e){return this.cmp(e)>=0};wt.isInteger=wt.isint=function(){return this.e>this.d.length-2};wt.isNegative=wt.isneg=function(){return this.s<0};wt.isPositive=wt.ispos=function(){return this.s>0};wt.isZero=function(){return this.s===0};wt.lessThan=wt.lt=function(e){return this.cmp(e)<0};wt.lessThanOrEqualTo=wt.lte=function(e){return this.cmp(e)<1};wt.logarithm=wt.log=function(e){var t,r=this,s=r.constructor,n=s.precision,i=n+5;if(e===void 0)e=new s(10);else if(e=new s(e),e.s<1||e.eq(Wn))throw Error(ji+"NaN");if(r.s<1)throw Error(ji+(r.s?"NaN":"-Infinity"));return r.eq(Wn)?new s(0):(ca=!1,t=Ql(zf(r,i),zf(e,i),i),ca=!0,Gr(t,n))};wt.minus=wt.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?d8(t,e):o8(t,(e.s=-e.s,e))};wt.modulo=wt.mod=function(e){var t,r=this,s=r.constructor,n=s.precision;if(e=new s(e),!e.s)throw Error(ji+"NaN");return r.s?(ca=!1,t=Ql(r,e,0,1).times(e),ca=!0,r.minus(t)):Gr(new s(r),n)};wt.naturalExponential=wt.exp=function(){return c8(this)};wt.naturalLogarithm=wt.ln=function(){return zf(this)};wt.negated=wt.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};wt.plus=wt.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?o8(t,e):d8(t,(e.s=-e.s,e))};wt.precision=wt.sd=function(e){var t,r,s,n=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(gd+e);if(t=Xa(n)+1,s=n.d.length-1,r=s*ea+1,s=n.d[s],s){for(;s%10==0;s/=10)r--;for(s=n.d[0];s>=10;s/=10)r++}return e&&t>r?t:r};wt.squareRoot=wt.sqrt=function(){var e,t,r,s,n,i,l,o=this,c=o.constructor;if(o.s<1){if(!o.s)return new c(0);throw Error(ji+"NaN")}for(e=Xa(o),ca=!1,n=Math.sqrt(+o),n==0||n==1/0?(t=xl(o.d),(t.length+e)%2==0&&(t+="0"),n=Math.sqrt(t),e=B0((e+1)/2)-(e<0||e%2),n==1/0?t="5e"+e:(t=n.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),s=new c(t)):s=new c(n.toString()),r=c.precision,n=l=r+3;;)if(i=s,s=i.plus(Ql(o,i,l+2)).times(.5),xl(i.d).slice(0,l)===(t=xl(s.d)).slice(0,l)){if(t=t.slice(l-3,l+1),n==l&&t=="4999"){if(Gr(i,r+1,0),i.times(i).eq(o)){s=i;break}}else if(t!="9999")break;l+=4}return ca=!0,Gr(s,r)};wt.times=wt.mul=function(e){var t,r,s,n,i,l,o,c,u,d=this,h=d.constructor,f=d.d,x=(e=new h(e)).d;if(!d.s||!e.s)return new h(0);for(e.s*=d.s,r=d.e+e.e,c=f.length,u=x.length,c<u&&(i=f,f=x,x=i,l=c,c=u,u=l),i=[],l=c+u,s=l;s--;)i.push(0);for(s=u;--s>=0;){for(t=0,n=c+s;n>s;)o=i[n]+x[s]*f[n-s-1]+t,i[n--]=o%xs|0,t=o/xs|0;i[n]=(i[n]+t)%xs|0}for(;!i[--l];)i.pop();return t?++r:i.shift(),e.d=i,e.e=r,ca?Gr(e,h.precision):e};wt.toDecimalPlaces=wt.todp=function(e,t){var r=this,s=r.constructor;return r=new s(r),e===void 0?r:(jl(e,0,$0),t===void 0?t=s.rounding:jl(t,0,8),Gr(r,e+Xa(r)+1,t))};wt.toExponential=function(e,t){var r,s=this,n=s.constructor;return e===void 0?r=Ld(s,!0):(jl(e,0,$0),t===void 0?t=n.rounding:jl(t,0,8),s=Gr(new n(s),e+1,t),r=Ld(s,!0,e+1)),r};wt.toFixed=function(e,t){var r,s,n=this,i=n.constructor;return e===void 0?Ld(n):(jl(e,0,$0),t===void 0?t=i.rounding:jl(t,0,8),s=Gr(new i(n),e+Xa(n)+1,t),r=Ld(s.abs(),!1,e+Xa(s)+1),n.isneg()&&!n.isZero()?"-"+r:r)};wt.toInteger=wt.toint=function(){var e=this,t=e.constructor;return Gr(new t(e),Xa(e)+1,t.rounding)};wt.toNumber=function(){return+this};wt.toPower=wt.pow=function(e){var t,r,s,n,i,l,o=this,c=o.constructor,u=12,d=+(e=new c(e));if(!e.s)return new c(Wn);if(o=new c(o),!o.s){if(e.s<1)throw Error(ji+"Infinity");return o}if(o.eq(Wn))return o;if(s=c.precision,e.eq(Wn))return Gr(o,s);if(t=e.e,r=e.d.length-1,l=t>=r,i=o.s,l){if((r=d<0?-d:d)<=l8){for(n=new c(Wn),t=Math.ceil(s/ea+4),ca=!1;r%2&&(n=n.times(o),iA(n.d,t)),r=B0(r/2),r!==0;)o=o.times(o),iA(o.d,t);return ca=!0,e.s<0?new c(Wn).div(n):Gr(n,s)}}else if(i<0)throw Error(ji+"NaN");return i=i<0&&e.d[Math.max(t,r)]&1?-1:1,o.s=1,ca=!1,n=e.times(zf(o,s+u)),ca=!0,n=c8(n),n.s=i,n};wt.toPrecision=function(e,t){var r,s,n=this,i=n.constructor;return e===void 0?(r=Xa(n),s=Ld(n,r<=i.toExpNeg||r>=i.toExpPos)):(jl(e,1,$0),t===void 0?t=i.rounding:jl(t,0,8),n=Gr(new i(n),e,t),r=Xa(n),s=Ld(n,e<=r||r<=i.toExpNeg,e)),s};wt.toSignificantDigits=wt.tosd=function(e,t){var r=this,s=r.constructor;return e===void 0?(e=s.precision,t=s.rounding):(jl(e,1,$0),t===void 0?t=s.rounding:jl(t,0,8)),Gr(new s(r),e,t)};wt.toString=wt.valueOf=wt.val=wt.toJSON=wt[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Xa(e),r=e.constructor;return Ld(e,t<=r.toExpNeg||t>=r.toExpPos)};function o8(e,t){var r,s,n,i,l,o,c,u,d=e.constructor,h=d.precision;if(!e.s||!t.s)return t.s||(t=new d(e)),ca?Gr(t,h):t;if(c=e.d,u=t.d,l=e.e,n=t.e,c=c.slice(),i=l-n,i){for(i<0?(s=c,i=-i,o=u.length):(s=u,n=l,o=c.length),l=Math.ceil(h/ea),o=l>o?l+1:o+1,i>o&&(i=o,s.length=1),s.reverse();i--;)s.push(0);s.reverse()}for(o=c.length,i=u.length,o-i<0&&(i=o,s=u,u=c,c=s),r=0;i;)r=(c[--i]=c[i]+u[i]+r)/xs|0,c[i]%=xs;for(r&&(c.unshift(r),++n),o=c.length;c[--o]==0;)c.pop();return t.d=c,t.e=n,ca?Gr(t,h):t}function jl(e,t,r){if(e!==~~e||e<t||e>r)throw Error(gd+e)}function xl(e){var t,r,s,n=e.length-1,i="",l=e[0];if(n>0){for(i+=l,t=1;t<n;t++)s=e[t]+"",r=ea-s.length,r&&(i+=Do(r)),i+=s;l=e[t],s=l+"",r=ea-s.length,r&&(i+=Do(r))}else if(l===0)return"0";for(;l%10===0;)l/=10;return i+l}var Ql=function(){function e(s,n){var i,l=0,o=s.length;for(s=s.slice();o--;)i=s[o]*n+l,s[o]=i%xs|0,l=i/xs|0;return l&&s.unshift(l),s}function t(s,n,i,l){var o,c;if(i!=l)c=i>l?1:-1;else for(o=c=0;o<i;o++)if(s[o]!=n[o]){c=s[o]>n[o]?1:-1;break}return c}function r(s,n,i){for(var l=0;i--;)s[i]-=l,l=s[i]<n[i]?1:0,s[i]=l*xs+s[i]-n[i];for(;!s[0]&&s.length>1;)s.shift()}return function(s,n,i,l){var o,c,u,d,h,f,x,p,g,y,v,j,b,w,k,N,S,_,O=s.constructor,E=s.s==n.s?1:-1,R=s.d,C=n.d;if(!s.s)return new O(s);if(!n.s)throw Error(ji+"Division by zero");for(c=s.e-n.e,S=C.length,k=R.length,x=new O(E),p=x.d=[],u=0;C[u]==(R[u]||0);)++u;if(C[u]>(R[u]||0)&&--c,i==null?j=i=O.precision:l?j=i+(Xa(s)-Xa(n))+1:j=i,j<0)return new O(0);if(j=j/ea+2|0,u=0,S==1)for(d=0,C=C[0],j++;(u<k||d)&&j--;u++)b=d*xs+(R[u]||0),p[u]=b/C|0,d=b%C|0;else{for(d=xs/(C[0]+1)|0,d>1&&(C=e(C,d),R=e(R,d),S=C.length,k=R.length),w=S,g=R.slice(0,S),y=g.length;y<S;)g[y++]=0;_=C.slice(),_.unshift(0),N=C[0],C[1]>=xs/2&&++N;do d=0,o=t(C,g,S,y),o<0?(v=g[0],S!=y&&(v=v*xs+(g[1]||0)),d=v/N|0,d>1?(d>=xs&&(d=xs-1),h=e(C,d),f=h.length,y=g.length,o=t(h,g,f,y),o==1&&(d--,r(h,S<f?_:C,f))):(d==0&&(o=d=1),h=C.slice()),f=h.length,f<y&&h.unshift(0),r(g,h,y),o==-1&&(y=g.length,o=t(C,g,S,y),o<1&&(d++,r(g,S<y?_:C,y))),y=g.length):o===0&&(d++,g=[0]),p[u++]=d,o&&g[0]?g[y++]=R[w]||0:(g=[R[w]],y=1);while((w++<k||g[0]!==void 0)&&j--)}return p[0]||p.shift(),x.e=c,Gr(x,l?i+Xa(x)+1:i)}}();function c8(e,t){var r,s,n,i,l,o,c=0,u=0,d=e.constructor,h=d.precision;if(Xa(e)>16)throw Error(XS+Xa(e));if(!e.s)return new d(Wn);for(ca=!1,o=h,l=new d(.03125);e.abs().gte(.1);)e=e.times(l),u+=5;for(s=Math.log($c(2,u))/Math.LN10*2+5|0,o+=s,r=n=i=new d(Wn),d.precision=o;;){if(n=Gr(n.times(e),o),r=r.times(++c),l=i.plus(Ql(n,r,o)),xl(l.d).slice(0,o)===xl(i.d).slice(0,o)){for(;u--;)i=Gr(i.times(i),o);return d.precision=h,t==null?(ca=!0,Gr(i,h)):i}i=l}}function Xa(e){for(var t=e.e*ea,r=e.d[0];r>=10;r/=10)t++;return t}function s1(e,t,r){if(t>e.LN10.sd())throw ca=!0,r&&(e.precision=r),Error(ji+"LN10 precision limit exceeded");return Gr(new e(e.LN10),t)}function Do(e){for(var t="";e--;)t+="0";return t}function zf(e,t){var r,s,n,i,l,o,c,u,d,h=1,f=10,x=e,p=x.d,g=x.constructor,y=g.precision;if(x.s<1)throw Error(ji+(x.s?"NaN":"-Infinity"));if(x.eq(Wn))return new g(0);if(t==null?(ca=!1,u=y):u=t,x.eq(10))return t==null&&(ca=!0),s1(g,u);if(u+=f,g.precision=u,r=xl(p),s=r.charAt(0),i=Xa(x),Math.abs(i)<15e14){for(;s<7&&s!=1||s==1&&r.charAt(1)>3;)x=x.times(e),r=xl(x.d),s=r.charAt(0),h++;i=Xa(x),s>1?(x=new g("0."+r),i++):x=new g(s+"."+r.slice(1))}else return c=s1(g,u+2,y).times(i+""),x=zf(new g(s+"."+r.slice(1)),u-f).plus(c),g.precision=y,t==null?(ca=!0,Gr(x,y)):x;for(o=l=x=Ql(x.minus(Wn),x.plus(Wn),u),d=Gr(x.times(x),u),n=3;;){if(l=Gr(l.times(d),u),c=o.plus(Ql(l,new g(n),u)),xl(c.d).slice(0,u)===xl(o.d).slice(0,u))return o=o.times(2),i!==0&&(o=o.plus(s1(g,u+2,y).times(i+""))),o=Ql(o,new g(h),u),g.precision=y,t==null?(ca=!0,Gr(o,y)):o;o=c,n+=2}}function nA(e,t){var r,s,n;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(s=t.search(/e/i))>0?(r<0&&(r=s),r+=+t.slice(s+1),t=t.substring(0,s)):r<0&&(r=t.length),s=0;t.charCodeAt(s)===48;)++s;for(n=t.length;t.charCodeAt(n-1)===48;)--n;if(t=t.slice(s,n),t){if(n-=s,r=r-s-1,e.e=B0(r/ea),e.d=[],s=(r+1)%ea,r<0&&(s+=ea),s<n){for(s&&e.d.push(+t.slice(0,s)),n-=ea;s<n;)e.d.push(+t.slice(s,s+=ea));t=t.slice(s),s=ea-t.length}else s-=n;for(;s--;)t+="0";if(e.d.push(+t),ca&&(e.e>Rg||e.e<-Rg))throw Error(XS+r)}else e.s=0,e.e=0,e.d=[0];return e}function Gr(e,t,r){var s,n,i,l,o,c,u,d,h=e.d;for(l=1,i=h[0];i>=10;i/=10)l++;if(s=t-l,s<0)s+=ea,n=t,u=h[d=0];else{if(d=Math.ceil((s+1)/ea),i=h.length,d>=i)return e;for(u=i=h[d],l=1;i>=10;i/=10)l++;s%=ea,n=s-ea+l}if(r!==void 0&&(i=$c(10,l-n-1),o=u/i%10|0,c=t<0||h[d+1]!==void 0||u%i,c=r<4?(o||c)&&(r==0||r==(e.s<0?3:2)):o>5||o==5&&(r==4||c||r==6&&(s>0?n>0?u/$c(10,l-n):0:h[d-1])%10&1||r==(e.s<0?8:7))),t<1||!h[0])return c?(i=Xa(e),h.length=1,t=t-i-1,h[0]=$c(10,(ea-t%ea)%ea),e.e=B0(-t/ea)||0):(h.length=1,h[0]=e.e=e.s=0),e;if(s==0?(h.length=d,i=1,d--):(h.length=d+1,i=$c(10,ea-s),h[d]=n>0?(u/$c(10,l-n)%$c(10,n)|0)*i:0),c)for(;;)if(d==0){(h[0]+=i)==xs&&(h[0]=1,++e.e);break}else{if(h[d]+=i,h[d]!=xs)break;h[d--]=0,i=1}for(s=h.length;h[--s]===0;)h.pop();if(ca&&(e.e>Rg||e.e<-Rg))throw Error(XS+Xa(e));return e}function d8(e,t){var r,s,n,i,l,o,c,u,d,h,f=e.constructor,x=f.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new f(e),ca?Gr(t,x):t;if(c=e.d,h=t.d,s=t.e,u=e.e,c=c.slice(),l=u-s,l){for(d=l<0,d?(r=c,l=-l,o=h.length):(r=h,s=u,o=c.length),n=Math.max(Math.ceil(x/ea),o)+2,l>n&&(l=n,r.length=1),r.reverse(),n=l;n--;)r.push(0);r.reverse()}else{for(n=c.length,o=h.length,d=n<o,d&&(o=n),n=0;n<o;n++)if(c[n]!=h[n]){d=c[n]<h[n];break}l=0}for(d&&(r=c,c=h,h=r,t.s=-t.s),o=c.length,n=h.length-o;n>0;--n)c[o++]=0;for(n=h.length;n>l;){if(c[--n]<h[n]){for(i=n;i&&c[--i]===0;)c[i]=xs-1;--c[i],c[n]+=xs}c[n]-=h[n]}for(;c[--o]===0;)c.pop();for(;c[0]===0;c.shift())--s;return c[0]?(t.d=c,t.e=s,ca?Gr(t,x):t):new f(0)}function Ld(e,t,r){var s,n=Xa(e),i=xl(e.d),l=i.length;return t?(r&&(s=r-l)>0?i=i.charAt(0)+"."+i.slice(1)+Do(s):l>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(n<0?"e":"e+")+n):n<0?(i="0."+Do(-n-1)+i,r&&(s=r-l)>0&&(i+=Do(s))):n>=l?(i+=Do(n+1-l),r&&(s=r-n-1)>0&&(i=i+"."+Do(s))):((s=n+1)<l&&(i=i.slice(0,s)+"."+i.slice(s)),r&&(s=r-l)>0&&(n+1===l&&(i+="."),i+=Do(s))),e.s<0?"-"+i:i}function iA(e,t){if(e.length>t)return e.length=t,!0}function u8(e){var t,r,s;function n(i){var l=this;if(!(l instanceof n))return new n(i);if(l.constructor=n,i instanceof n){l.s=i.s,l.e=i.e,l.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(gd+i);if(i>0)l.s=1;else if(i<0)i=-i,l.s=-1;else{l.s=0,l.e=0,l.d=[0];return}if(i===~~i&&i<1e7){l.e=0,l.d=[i];return}return nA(l,i.toString())}else if(typeof i!="string")throw Error(gd+i);if(i.charCodeAt(0)===45?(i=i.slice(1),l.s=-1):l.s=1,Nce.test(i))nA(l,i);else throw Error(gd+i)}if(n.prototype=wt,n.ROUND_UP=0,n.ROUND_DOWN=1,n.ROUND_CEIL=2,n.ROUND_FLOOR=3,n.ROUND_HALF_UP=4,n.ROUND_HALF_DOWN=5,n.ROUND_HALF_EVEN=6,n.ROUND_HALF_CEIL=7,n.ROUND_HALF_FLOOR=8,n.clone=u8,n.config=n.set=Sce,e===void 0&&(e={}),e)for(s=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<s.length;)e.hasOwnProperty(r=s[t++])||(e[r]=this[r]);return n.config(e),n}function Sce(e){if(!e||typeof e!="object")throw Error(ji+"Object expected");var t,r,s,n=["precision",1,$0,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<n.length;t+=3)if((s=e[r=n[t]])!==void 0)if(B0(s)===s&&s>=n[t+1]&&s<=n[t+2])this[r]=s;else throw Error(gd+r+": "+s);if((s=e[r="LN10"])!==void 0)if(s==Math.LN10)this[r]=new this(s);else throw Error(gd+r+": "+s);return this}var YS=u8(wce);Wn=new YS(1);const $r=YS;var kce=e=>e,h8={},f8=e=>e===h8,lA=e=>function t(){return arguments.length===0||arguments.length===1&&f8(arguments.length<=0?void 0:arguments[0])?t:e(...arguments)},x8=(e,t)=>e===1?t:lA(function(){for(var r=arguments.length,s=new Array(r),n=0;n<r;n++)s[n]=arguments[n];var i=s.filter(l=>l!==h8).length;return i>=e?t(...s):x8(e-i,lA(function(){for(var l=arguments.length,o=new Array(l),c=0;c<l;c++)o[c]=arguments[c];var u=s.map(d=>f8(d)?o.shift():d);return t(...u,...o)}))}),Cce=e=>x8(e.length,e),Dw=(e,t)=>{for(var r=[],s=e;s<t;++s)r[s-e]=s;return r},Ece=Cce((e,t)=>Array.isArray(t)?t.map(e):Object.keys(t).map(r=>t[r]).map(e)),Pce=function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];if(!r.length)return kce;var n=r.reverse(),i=n[0],l=n.slice(1);return function(){return l.reduce((o,c)=>c(o),i(...arguments))}},Fw=e=>Array.isArray(e)?e.reverse():e.split("").reverse().join("");function m8(e){var t;return e===0?t=1:t=Math.floor(new $r(e).abs().log(10).toNumber())+1,t}function p8(e,t,r){for(var s=new $r(e),n=0,i=[];s.lt(t)&&n<1e5;)i.push(s.toNumber()),s=s.add(r),n++;return i}var g8=e=>{var[t,r]=e,[s,n]=[t,r];return t>r&&([s,n]=[r,t]),[s,n]},y8=(e,t,r)=>{if(e.lte(0))return new $r(0);var s=m8(e.toNumber()),n=new $r(10).pow(s),i=e.div(n),l=s!==1?.05:.1,o=new $r(Math.ceil(i.div(l).toNumber())).add(r).mul(l),c=o.mul(n);return t?new $r(c.toNumber()):new $r(Math.ceil(c.toNumber()))},Ace=(e,t,r)=>{var s=new $r(1),n=new $r(e);if(!n.isint()&&r){var i=Math.abs(e);i<1?(s=new $r(10).pow(m8(e)-1),n=new $r(Math.floor(n.div(s).toNumber())).mul(s)):i>1&&(n=new $r(Math.floor(e)))}else e===0?n=new $r(Math.floor((t-1)/2)):r||(n=new $r(Math.floor(e)));var l=Math.floor((t-1)/2),o=Pce(Ece(c=>n.add(new $r(c-l).mul(s)).toNumber()),Dw);return o(0,t)},v8=function(t,r,s,n){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-t)/(s-1)))return{step:new $r(0),tickMin:new $r(0),tickMax:new $r(0)};var l=y8(new $r(r).sub(t).div(s-1),n,i),o;t<=0&&r>=0?o=new $r(0):(o=new $r(t).add(r).div(2),o=o.sub(new $r(o).mod(l)));var c=Math.ceil(o.sub(t).div(l).toNumber()),u=Math.ceil(new $r(r).sub(o).div(l).toNumber()),d=c+u+1;return d>s?v8(t,r,s,n,i+1):(d<s&&(u=r>0?u+(s-d):u,c=r>0?c:c+(s-d)),{step:l,tickMin:o.sub(new $r(c).mul(l)),tickMax:o.add(new $r(u).mul(l))})},_ce=function(t){var[r,s]=t,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=Math.max(n,2),[o,c]=g8([r,s]);if(o===-1/0||c===1/0){var u=c===1/0?[o,...Dw(0,n-1).map(()=>1/0)]:[...Dw(0,n-1).map(()=>-1/0),c];return r>s?Fw(u):u}if(o===c)return Ace(o,n,i);var{step:d,tickMin:h,tickMax:f}=v8(o,c,l,i,0),x=p8(h,f.add(new $r(.1).mul(d)),d);return r>s?Fw(x):x},Tce=function(t,r){var[s,n]=t,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[l,o]=g8([s,n]);if(l===-1/0||o===1/0)return[s,n];if(l===o)return[l];var c=Math.max(r,2),u=y8(new $r(o).sub(l).div(c-1),i,0),d=[...p8(new $r(l),new $r(o),u),o];return i===!1&&(d=d.map(h=>Math.round(h))),s>n?Fw(d):d},b8=e=>e.rootProps.maxBarSize,Ice=e=>e.rootProps.barGap,j8=e=>e.rootProps.barCategoryGap,Oce=e=>e.rootProps.barSize,_x=e=>e.rootProps.stackOffset,w8=e=>e.rootProps.reverseStackOrder,JS=e=>e.options.chartName,ZS=e=>e.rootProps.syncId,N8=e=>e.rootProps.syncMethod,ek=e=>e.options.eventEmitter,Qa={grid:-100,barBackground:-50,area:100,cursorRectangle:200,bar:300,line:400,axis:500,scatter:600,activeBar:1e3,cursorLine:1100,activeDot:1200,label:2e3},Ll={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},Ln={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},xv=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t},Dce={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:Ll.angleAxisId,includeHidden:!1,name:void 0,reversed:Ll.reversed,scale:Ll.scale,tick:Ll.tick,tickCount:void 0,ticks:void 0,type:Ll.type,unit:void 0},Fce={allowDataOverflow:Ln.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:Ln.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Ln.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Ln.scale,tick:Ln.tick,tickCount:Ln.tickCount,ticks:void 0,type:Ln.type,unit:void 0},Rce={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:Ll.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Ll.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Ll.scale,tick:Ll.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},Mce={allowDataOverflow:Ln.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:Ln.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Ln.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Ln.scale,tick:Ln.tick,tickCount:Ln.tickCount,ticks:void 0,type:"category",unit:void 0},tk=(e,t)=>e.polarAxis.angleAxis[t]!=null?e.polarAxis.angleAxis[t]:e.layout.layoutType==="radial"?Rce:Dce,rk=(e,t)=>e.polarAxis.radiusAxis[t]!=null?e.polarAxis.radiusAxis[t]:e.layout.layoutType==="radial"?Mce:Fce,mv=e=>e.polarOptions,ak=Te([bo,jo,as],yR),S8=Te([mv,ak],(e,t)=>{if(e!=null)return Qs(e.innerRadius,t,0)}),k8=Te([mv,ak],(e,t)=>{if(e!=null)return Qs(e.outerRadius,t,t*.8)}),Lce=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:r}=e;return[t,r]},C8=Te([mv],Lce);Te([tk,C8],xv);var E8=Te([ak,S8,k8],(e,t,r)=>{if(!(e==null||t==null||r==null))return[t,r]});Te([rk,E8],xv);var P8=Te([vr,mv,S8,k8,bo,jo],(e,t,r,s,n,i)=>{if(!(e!=="centric"&&e!=="radial"||t==null||r==null||s==null)){var{cx:l,cy:o,startAngle:c,endAngle:u}=t;return{cx:Qs(l,n,n/2),cy:Qs(o,i,i/2),innerRadius:r,outerRadius:s,startAngle:c,endAngle:u,clockWise:!1}}}),xa=(e,t)=>t,Tx=(e,t,r)=>r;function sk(e){return e==null?void 0:e.id}function A8(e,t,r){var{chartData:s=[]}=t,{allowDuplicatedCategory:n,dataKey:i}=r,l=new Map;return e.forEach(o=>{var c,u=(c=o.data)!==null&&c!==void 0?c:s;if(!(u==null||u.length===0)){var d=sk(o);u.forEach((h,f)=>{var x=i==null||n?f:String(Kr(h,i,null)),p=Kr(h,o.dataKey,0),g;l.has(x)?g=l.get(x):g={},Object.assign(g,{[d]:p}),l.set(x,g)})}}),Array.from(l.values())}function pv(e){return e.stackId!=null&&e.dataKey!=null}var gv=(e,t)=>e===t?!0:e==null||t==null?!1:e[0]===t[0]&&e[1]===t[1];function yv(e,t){return Array.isArray(e)&&Array.isArray(t)&&e.length===0&&t.length===0?!0:e===t}function $ce(e,t){if(e.length===t.length){for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}return!1}var ns=e=>{var t=vr(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},z0=e=>e.tooltip.settings.axisId;function oA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function Mg(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?oA(Object(r),!0).forEach(function(s){Bce(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oA(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Bce(e,t,r){return(t=zce(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zce(e){var t=Uce(e,"string");return typeof t=="symbol"?t:t+""}function Uce(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Rw=[0,"auto"],cs={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},_8=(e,t)=>e.cartesianAxis.xAxis[t],No=(e,t)=>{var r=_8(e,t);return r??cs},ds={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:Rw,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:bx},T8=(e,t)=>e.cartesianAxis.yAxis[t],So=(e,t)=>{var r=T8(e,t);return r??ds},Wce={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},nk=(e,t)=>{var r=e.cartesianAxis.zAxis[t];return r??Wce},ka=(e,t,r)=>{switch(t){case"xAxis":return No(e,r);case"yAxis":return So(e,r);case"zAxis":return nk(e,r);case"angleAxis":return tk(e,r);case"radiusAxis":return rk(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},Vce=(e,t,r)=>{switch(t){case"xAxis":return No(e,r);case"yAxis":return So(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},Ix=(e,t,r)=>{switch(t){case"xAxis":return No(e,r);case"yAxis":return So(e,r);case"angleAxis":return tk(e,r);case"radiusAxis":return rk(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},I8=e=>e.graphicalItems.cartesianItems.some(t=>t.type==="bar")||e.graphicalItems.polarItems.some(t=>t.type==="radialBar");function ik(e,t){return r=>{switch(e){case"xAxis":return"xAxisId"in r&&r.xAxisId===t;case"yAxis":return"yAxisId"in r&&r.yAxisId===t;case"zAxis":return"zAxisId"in r&&r.zAxisId===t;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===t;default:return!1}}}var vv=e=>e.graphicalItems.cartesianItems,Hce=Te([xa,Tx],ik),lk=(e,t,r)=>e.filter(r).filter(s=>(t==null?void 0:t.includeHidden)===!0?!0:!s.hide),Ox=Te([vv,ka,Hce],lk,{memoizeOptions:{resultEqualityCheck:yv}}),O8=Te([Ox],e=>e.filter(t=>t.type==="area"||t.type==="bar").filter(pv)),D8=e=>e.filter(t=>!("stackId"in t)||t.stackId===void 0),qce=Te([Ox],D8),ok=e=>e.map(t=>t.data).filter(Boolean).flat(1),Kce=Te([Ox],ok,{memoizeOptions:{resultEqualityCheck:yv}}),ck=(e,t)=>{var{chartData:r=[],dataStartIndex:s,dataEndIndex:n}=t;return e.length>0?e:r.slice(s,n+1)},dk=Te([Kce,fv],ck),uk=(e,t,r)=>(t==null?void 0:t.dataKey)!=null?e.map(s=>({value:Kr(s,t.dataKey)})):r.length>0?r.map(s=>s.dataKey).flatMap(s=>e.map(n=>({value:Kr(n,s)}))):e.map(s=>({value:s})),bv=Te([dk,ka,Ox],uk);function F8(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function op(e){if(vl(e)||e instanceof Date){var t=Number(e);if($a(t))return t}}function cA(e){if(Array.isArray(e)){var t=[op(e[0]),op(e[1])];return yc(t)?t:void 0}var r=op(e);if(r!=null)return[r,r]}function ho(e){return e.map(op).filter(Are)}function Gce(e,t,r){return!r||typeof t!="number"||Ki(t)?[]:r.length?ho(r.flatMap(s=>{var n=Kr(e,s.dataKey),i,l;if(Array.isArray(n)?[i,l]=n:i=l=n,!(!$a(i)||!$a(l)))return[t-i,t+l]})):[]}var is=e=>{var t=ns(e),r=z0(e);return Ix(e,t,r)},Dx=Te([is],e=>e==null?void 0:e.dataKey),Qce=Te([O8,fv,is],A8),R8=(e,t,r,s)=>{var n={},i=t.reduce((l,o)=>(o.stackId==null||(l[o.stackId]==null&&(l[o.stackId]=[]),l[o.stackId].push(o)),l),n);return Object.fromEntries(Object.entries(i).map(l=>{var[o,c]=l,u=s?[...c].reverse():c,d=u.map(sk);return[o,{stackedData:Lse(e,d,r),graphicalItems:u}]}))},Mw=Te([Qce,O8,_x,w8],R8),M8=(e,t,r,s)=>{var{dataStartIndex:n,dataEndIndex:i}=t;if(s==null&&r!=="zAxis"){var l=Wse(e,n,i);if(!(l!=null&&l[0]===0&&l[1]===0))return l}},Xce=Te([ka],e=>e.allowDataOverflow),hk=e=>{var t;if(e==null||!("domain"in e))return Rw;if(e.domain!=null)return e.domain;if(e.ticks!=null){if(e.type==="number"){var r=ho(e.ticks);return[Math.min(...r),Math.max(...r)]}if(e.type==="category")return e.ticks.map(String)}return(t=e==null?void 0:e.domain)!==null&&t!==void 0?t:Rw},fk=Te([ka],hk),xk=Te([fk,Xce],i8),Yce=Te([Mw,Ic,xa,xk],M8,{memoizeOptions:{resultEqualityCheck:gv}}),jv=e=>e.errorBars,Jce=(e,t,r)=>e.flatMap(s=>t[s.id]).filter(Boolean).filter(s=>F8(r,s)),Lg=function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];var n=r.filter(Boolean);if(n.length!==0){var i=n.flat(),l=Math.min(...i),o=Math.max(...i);return[l,o]}},mk=(e,t,r,s,n)=>{var i,l;if(r.length>0&&e.forEach(o=>{r.forEach(c=>{var u,d,h=(u=s[c.id])===null||u===void 0?void 0:u.filter(v=>F8(n,v)),f=Kr(o,(d=t.dataKey)!==null&&d!==void 0?d:c.dataKey),x=Gce(o,f,h);if(x.length>=2){var p=Math.min(...x),g=Math.max(...x);(i==null||p<i)&&(i=p),(l==null||g>l)&&(l=g)}var y=cA(f);y!=null&&(i=i==null?y[0]:Math.min(i,y[0]),l=l==null?y[1]:Math.max(l,y[1]))})}),(t==null?void 0:t.dataKey)!=null&&e.forEach(o=>{var c=cA(Kr(o,t.dataKey));c!=null&&(i=i==null?c[0]:Math.min(i,c[0]),l=l==null?c[1]:Math.max(l,c[1]))}),$a(i)&&$a(l))return[i,l]},Zce=Te([dk,ka,qce,jv,xa],mk,{memoizeOptions:{resultEqualityCheck:gv}});function ede(e){var{value:t}=e;if(vl(t)||t instanceof Date)return t}var tde=(e,t,r)=>{var s=e.map(ede).filter(n=>n!=null);return r&&(t.dataKey==null||t.allowDuplicatedCategory&&ID(s))?kR(0,e.length):t.allowDuplicatedCategory?s:Array.from(new Set(s))},L8=e=>e.referenceElements.dots,U0=(e,t,r)=>e.filter(s=>s.ifOverflow==="extendDomain").filter(s=>t==="xAxis"?s.xAxisId===r:s.yAxisId===r),rde=Te([L8,xa,Tx],U0),$8=e=>e.referenceElements.areas,ade=Te([$8,xa,Tx],U0),B8=e=>e.referenceElements.lines,sde=Te([B8,xa,Tx],U0),z8=(e,t)=>{var r=ho(e.map(s=>t==="xAxis"?s.x:s.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},nde=Te(rde,xa,z8),U8=(e,t)=>{var r=ho(e.flatMap(s=>[t==="xAxis"?s.x1:s.y1,t==="xAxis"?s.x2:s.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},ide=Te([ade,xa],U8);function lde(e){var t;if(e.x!=null)return ho([e.x]);var r=(t=e.segment)===null||t===void 0?void 0:t.map(s=>s.x);return r==null||r.length===0?[]:ho(r)}function ode(e){var t;if(e.y!=null)return ho([e.y]);var r=(t=e.segment)===null||t===void 0?void 0:t.map(s=>s.y);return r==null||r.length===0?[]:ho(r)}var W8=(e,t)=>{var r=e.flatMap(s=>t==="xAxis"?lde(s):ode(s));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},cde=Te([sde,xa],W8),dde=Te(nde,cde,ide,(e,t,r)=>Lg(e,r,t)),pk=(e,t,r,s,n,i,l,o)=>{if(r!=null)return r;var c=l==="vertical"&&o==="xAxis"||l==="horizontal"&&o==="yAxis",u=c?Lg(s,i,n):Lg(i,n);return jce(t,u,e.allowDataOverflow)},ude=Te([ka,fk,xk,Yce,Zce,dde,vr,xa],pk,{memoizeOptions:{resultEqualityCheck:gv}}),hde=[0,1],gk=(e,t,r,s,n,i,l)=>{if(!((e==null||r==null||r.length===0)&&l===void 0)){var{dataKey:o,type:c}=e,u=Ac(t,i);if(u&&o==null){var d;return kR(0,(d=r==null?void 0:r.length)!==null&&d!==void 0?d:0)}return c==="category"?tde(s,e,u):n==="expand"?hde:l}},yk=Te([ka,vr,dk,bv,_x,xa,ude],gk),V8=(e,t,r,s,n)=>{if(e!=null){var{scale:i,type:l}=e;if(i==="auto")return t==="radial"&&n==="radiusAxis"?"band":t==="radial"&&n==="angleAxis"?"linear":l==="category"&&s&&(s.indexOf("LineChart")>=0||s.indexOf("AreaChart")>=0||s.indexOf("ComposedChart")>=0&&!r)?"point":l==="category"?"band":"linear";if(typeof i=="string"){var o="scale".concat(mx(i));return o in Sh?o:"point"}}},W0=Te([ka,vr,I8,JS,xa],V8);function fde(e){if(e!=null){if(e in Sh)return Sh[e]();var t="scale".concat(mx(e));if(t in Sh)return Sh[t]()}}function vk(e,t,r,s){if(!(r==null||s==null)){if(typeof e.scale=="function")return e.scale.copy().domain(r).range(s);var n=fde(t);if(n!=null){var i=n.domain(r).range(s);return Ose(i),i}}}var bk=(e,t,r)=>{var s=hk(t);if(!(r!=="auto"&&r!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(s)&&(s[0]==="auto"||s[1]==="auto")&&yc(e))return _ce(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&yc(e))return Tce(e,t.tickCount,t.allowDecimals)}},jk=Te([yk,Ix,W0],bk),wk=(e,t,r,s)=>{if(s!=="angleAxis"&&(e==null?void 0:e.type)==="number"&&yc(t)&&Array.isArray(r)&&r.length>0){var n=t[0],i=r[0],l=t[1],o=r[r.length-1];return[Math.min(n,i),Math.max(l,o)]}return t},xde=Te([ka,yk,jk,xa],wk),mde=Te(bv,ka,(e,t)=>{if(!(!t||t.type!=="number")){var r=1/0,s=Array.from(ho(e.map(o=>o.value))).sort((o,c)=>o-c);if(s.length<2)return 1/0;var n=s[s.length-1]-s[0];if(n===0)return 1/0;for(var i=0;i<s.length-1;i++){var l=s[i+1]-s[i];r=Math.min(r,l)}return r/n}}),H8=Te(mde,vr,j8,as,(e,t,r,s)=>s,(e,t,r,s,n)=>{if(!$a(e))return 0;var i=t==="vertical"?s.height:s.width;if(n==="gap")return e*i/2;if(n==="no-gap"){var l=Qs(r,e*i),o=e*i/2;return o-l-(o-l)/i*l}return 0}),pde=(e,t)=>{var r=No(e,t);return r==null||typeof r.padding!="string"?0:H8(e,"xAxis",t,r.padding)},gde=(e,t)=>{var r=So(e,t);return r==null||typeof r.padding!="string"?0:H8(e,"yAxis",t,r.padding)},yde=Te(No,pde,(e,t)=>{var r,s;if(e==null)return{left:0,right:0};var{padding:n}=e;return typeof n=="string"?{left:t,right:t}:{left:((r=n.left)!==null&&r!==void 0?r:0)+t,right:((s=n.right)!==null&&s!==void 0?s:0)+t}}),vde=Te(So,gde,(e,t)=>{var r,s;if(e==null)return{top:0,bottom:0};var{padding:n}=e;return typeof n=="string"?{top:t,bottom:t}:{top:((r=n.top)!==null&&r!==void 0?r:0)+t,bottom:((s=n.bottom)!==null&&s!==void 0?s:0)+t}}),bde=Te([as,yde,tv,ev,(e,t,r)=>r],(e,t,r,s,n)=>{var{padding:i}=s;return n?[i.left,r.width-i.right]:[e.left+t.left,e.left+e.width-t.right]}),jde=Te([as,vr,vde,tv,ev,(e,t,r)=>r],(e,t,r,s,n,i)=>{var{padding:l}=n;return i?[s.height-l.bottom,l.top]:t==="horizontal"?[e.top+e.height-r.bottom,e.top+r.top]:[e.top+r.top,e.top+e.height-r.bottom]}),Fx=(e,t,r,s)=>{var n;switch(t){case"xAxis":return bde(e,r,s);case"yAxis":return jde(e,r,s);case"zAxis":return(n=nk(e,r))===null||n===void 0?void 0:n.range;case"angleAxis":return C8(e);case"radiusAxis":return E8(e,r);default:return}},q8=Te([ka,Fx],xv),V0=Te([ka,W0,xde,q8],vk);Te([Ox,jv,xa],Jce);function K8(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var wv=(e,t)=>t,Nv=(e,t,r)=>r,wde=Te(Jy,wv,Nv,(e,t,r)=>e.filter(s=>s.orientation===t).filter(s=>s.mirror===r).sort(K8)),Nde=Te(Zy,wv,Nv,(e,t,r)=>e.filter(s=>s.orientation===t).filter(s=>s.mirror===r).sort(K8)),G8=(e,t)=>({width:e.width,height:t.height}),Sde=(e,t)=>{var r=typeof t.width=="number"?t.width:bx;return{width:r,height:e.height}},Q8=Te(as,No,G8),kde=(e,t,r)=>{switch(t){case"top":return e.top;case"bottom":return r-e.bottom;default:return 0}},Cde=(e,t,r)=>{switch(t){case"left":return e.left;case"right":return r-e.right;default:return 0}},Ede=Te(jo,as,wde,wv,Nv,(e,t,r,s,n)=>{var i={},l;return r.forEach(o=>{var c=G8(t,o);l==null&&(l=kde(t,s,e));var u=s==="top"&&!n||s==="bottom"&&n;i[o.id]=l-Number(u)*c.height,l+=(u?-1:1)*c.height}),i}),Pde=Te(bo,as,Nde,wv,Nv,(e,t,r,s,n)=>{var i={},l;return r.forEach(o=>{var c=Sde(t,o);l==null&&(l=Cde(t,s,e));var u=s==="left"&&!n||s==="right"&&n;i[o.id]=l-Number(u)*c.width,l+=(u?-1:1)*c.width}),i}),Ade=(e,t)=>{var r=No(e,t);if(r!=null)return Ede(e,r.orientation,r.mirror)},_de=Te([as,No,Ade,(e,t)=>t],(e,t,r,s)=>{if(t!=null){var n=r==null?void 0:r[s];return n==null?{x:e.left,y:0}:{x:e.left,y:n}}}),Tde=(e,t)=>{var r=So(e,t);if(r!=null)return Pde(e,r.orientation,r.mirror)},Ide=Te([as,So,Tde,(e,t)=>t],(e,t,r,s)=>{if(t!=null){var n=r==null?void 0:r[s];return n==null?{x:0,y:e.top}:{x:n,y:e.top}}}),X8=Te(as,So,(e,t)=>{var r=typeof t.width=="number"?t.width:bx;return{width:r,height:e.height}}),dA=(e,t,r)=>{switch(t){case"xAxis":return Q8(e,r).width;case"yAxis":return X8(e,r).height;default:return}},Y8=(e,t,r,s)=>{if(r!=null){var{allowDuplicatedCategory:n,type:i,dataKey:l}=r,o=Ac(e,s),c=t.map(u=>u.value);if(l&&o&&i==="category"&&n&&ID(c))return c}},Nk=Te([vr,bv,ka,xa],Y8),J8=(e,t,r,s)=>{if(!(r==null||r.dataKey==null)){var{type:n,scale:i}=r,l=Ac(e,s);if(l&&(n==="number"||i!=="auto"))return t.map(o=>o.value)}},Sk=Te([vr,bv,Ix,xa],J8),uA=Te([vr,Vce,W0,V0,Nk,Sk,Fx,jk,xa],(e,t,r,s,n,i,l,o,c)=>{if(t!=null){var u=Ac(e,c);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:c,categoricalDomain:i,duplicateDomain:n,isCategorical:u,niceTicks:o,range:l,realScaleType:r,scale:s}}}),Ode=(e,t,r,s,n,i,l,o,c)=>{if(!(t==null||s==null)){var u=Ac(e,c),{type:d,ticks:h,tickCount:f}=t,x=r==="scaleBand"&&typeof s.bandwidth=="function"?s.bandwidth()/2:2,p=d==="category"&&s.bandwidth?s.bandwidth()/x:0;p=c==="angleAxis"&&i!=null&&i.length>=2?vs(i[0]-i[1])*2*p:p;var g=h||n;if(g){var y=g.map((v,j)=>{var b=l?l.indexOf(v):v;return{index:j,coordinate:s(b)+p,value:v,offset:p}});return y.filter(v=>$a(v.coordinate))}return u&&o?o.map((v,j)=>({coordinate:s(v)+p,value:v,index:j,offset:p})).filter(v=>$a(v.coordinate)):s.ticks?s.ticks(f).map(v=>({coordinate:s(v)+p,value:v,offset:p})):s.domain().map((v,j)=>({coordinate:s(v)+p,value:l?l[v]:v,index:j,offset:p}))}},Z8=Te([vr,Ix,W0,V0,jk,Fx,Nk,Sk,xa],Ode),Dde=(e,t,r,s,n,i,l)=>{if(!(t==null||r==null||s==null||s[0]===s[1])){var o=Ac(e,l),{tickCount:c}=t,u=0;return u=l==="angleAxis"&&(s==null?void 0:s.length)>=2?vs(s[0]-s[1])*2*u:u,o&&i?i.map((d,h)=>({coordinate:r(d)+u,value:d,index:h,offset:u})):r.ticks?r.ticks(c).map(d=>({coordinate:r(d)+u,value:d,offset:u})):r.domain().map((d,h)=>({coordinate:r(d)+u,value:n?n[d]:d,index:h,offset:u}))}},vc=Te([vr,Ix,V0,Fx,Nk,Sk,xa],Dde),bc=Te(ka,V0,(e,t)=>{if(!(e==null||t==null))return Mg(Mg({},e),{},{scale:t})}),Fde=Te([ka,W0,yk,q8],vk);Te((e,t,r)=>nk(e,r),Fde,(e,t)=>{if(!(e==null||t==null))return Mg(Mg({},e),{},{scale:t})});var Rde=Te([vr,Jy,Zy],(e,t,r)=>{switch(e){case"horizontal":return t.some(s=>s.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(s=>s.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),eM=e=>e.options.defaultTooltipEventType,tM=e=>e.options.validateTooltipEventTypes;function rM(e,t,r){if(e==null)return t;var s=e?"axis":"item";return r==null?t:r.includes(s)?s:t}function kk(e,t){var r=eM(e),s=tM(e);return rM(t,r,s)}function Mde(e){return St(t=>kk(t,e))}var aM=(e,t)=>{var r,s=Number(t);if(!(Ki(s)||t==null))return s>=0?e==null||(r=e[s])===null||r===void 0?void 0:r.value:void 0},Lde=e=>e.tooltip.settings,Lo={active:!1,index:null,dataKey:void 0,graphicalItemId:void 0,coordinate:void 0},$de={itemInteraction:{click:Lo,hover:Lo},axisInteraction:{click:Lo,hover:Lo},keyboardInteraction:Lo,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0,sourceViewBox:void 0,graphicalItemId:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},sM=Fn({name:"tooltip",initialState:$de,reducers:{addTooltipEntrySettings:{reducer(e,t){e.tooltipItemPayloads.push(t.payload)},prepare:ia()},replaceTooltipEntrySettings:{reducer(e,t){var{prev:r,next:s}=t.payload,n=Vi(e).tooltipItemPayloads.indexOf(r);n>-1&&(e.tooltipItemPayloads[n]=s)},prepare:ia()},removeTooltipEntrySettings:{reducer(e,t){var r=Vi(e).tooltipItemPayloads.indexOf(t.payload);r>-1&&e.tooltipItemPayloads.splice(r,1)},prepare:ia()},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.graphicalItemId=t.payload.activeGraphicalItemId,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.graphicalItemId=t.payload.activeGraphicalItemId,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate,e.keyboardInteraction.dataKey=t.payload.activeDataKey}}}),{addTooltipEntrySettings:Bde,replaceTooltipEntrySettings:zde,removeTooltipEntrySettings:Ude,setTooltipSettingsState:Wde,setActiveMouseOverItemIndex:nM,mouseLeaveItem:Vde,mouseLeaveChart:iM,setActiveClickItemIndex:Hde,setMouseOverAxisIndex:lM,setMouseClickAxisIndex:qde,setSyncInteraction:Lw,setKeyboardInteraction:$w}=sM.actions,Kde=sM.reducer;function hA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function Rm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?hA(Object(r),!0).forEach(function(s){Gde(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hA(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Gde(e,t,r){return(t=Qde(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Qde(e){var t=Xde(e,"string");return typeof t=="symbol"?t:t+""}function Xde(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Yde(e,t,r){return t==="axis"?r==="click"?e.axisInteraction.click:e.axisInteraction.hover:r==="click"?e.itemInteraction.click:e.itemInteraction.hover}function Jde(e){return e.index!=null}var oM=(e,t,r,s)=>{if(t==null)return Lo;var n=Yde(e,t,r);if(n==null)return Lo;if(n.active)return n;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var i=e.settings.active===!0;if(Jde(n)){if(i)return Rm(Rm({},n),{},{active:!0})}else if(s!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:s,graphicalItemId:void 0};return Rm(Rm({},Lo),{},{coordinate:n.coordinate})};function Zde(e){if(typeof e=="number")return Number.isFinite(e)?e:void 0;if(e instanceof Date){var t=e.valueOf();return Number.isFinite(t)?t:void 0}var r=Number(e);return Number.isFinite(r)?r:void 0}function eue(e,t){var r=Zde(e),s=t[0],n=t[1];if(r===void 0)return!1;var i=Math.min(s,n),l=Math.max(s,n);return r>=i&&r<=l}function tue(e,t,r){if(r==null||t==null)return!0;var s=Kr(e,t);return s==null||!yc(r)?!0:eue(s,r)}var Ck=(e,t,r,s)=>{var n=e==null?void 0:e.index;if(n==null)return null;var i=Number(n);if(!$a(i))return n;var l=0,o=1/0;t.length>0&&(o=t.length-1);var c=Math.max(l,Math.min(i,o)),u=t[c];return u==null||tue(u,r,s)?String(c):null},cM=(e,t,r,s,n,i,l,o)=>{if(!(i==null||o==null)){var c=l[0],u=c==null?void 0:o(c.positions,i);if(u!=null)return u;var d=n==null?void 0:n[Number(i)];if(d)switch(r){case"horizontal":return{x:d.coordinate,y:(s.top+t)/2};default:return{x:(s.left+e)/2,y:d.coordinate}}}},dM=(e,t,r,s)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var n;return r==="hover"?n=e.itemInteraction.hover.dataKey:n=e.itemInteraction.click.dataKey,n==null&&s!=null?[e.tooltipItemPayloads[0]]:e.tooltipItemPayloads.filter(i=>{var l;return((l=i.settings)===null||l===void 0?void 0:l.dataKey)===n})},Rx=e=>e.options.tooltipPayloadSearcher,H0=e=>e.tooltip;function fA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function xA(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fA(Object(r),!0).forEach(function(s){rue(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fA(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function rue(e,t,r){return(t=aue(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aue(e){var t=sue(e,"string");return typeof t=="symbol"?t:t+""}function sue(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function nue(e,t){return e??t}var uM=(e,t,r,s,n,i,l)=>{if(!(t==null||i==null)){var{chartData:o,computedData:c,dataStartIndex:u,dataEndIndex:d}=r,h=[];return e.reduce((f,x)=>{var p,{dataDefinedOnItem:g,settings:y}=x,v=nue(g,o),j=Array.isArray(v)?BF(v,u,d):v,b=(p=y==null?void 0:y.dataKey)!==null&&p!==void 0?p:s,w=y==null?void 0:y.nameKey,k;if(s&&Array.isArray(j)&&!Array.isArray(j[0])&&l==="axis"?k=OD(j,s,n):k=i(j,t,c,w),Array.isArray(k))k.forEach(S=>{var _=xA(xA({},y),{},{name:S.name,unit:S.unit,color:void 0,fill:void 0});f.push(VE({tooltipEntrySettings:_,dataKey:S.dataKey,payload:S.payload,value:Kr(S.payload,S.dataKey),name:S.name}))});else{var N;f.push(VE({tooltipEntrySettings:y,dataKey:b,payload:k,value:Kr(k,b),name:(N=Kr(k,w))!==null&&N!==void 0?N:y==null?void 0:y.name}))}return f},h)}},Ek=Te([is,vr,I8,JS,ns],V8),iue=Te([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),lue=Te([ns,z0],ik),Mx=Te([iue,is,lue],lk,{memoizeOptions:{resultEqualityCheck:yv}}),oue=Te([Mx],e=>e.filter(pv)),cue=Te([Mx],ok,{memoizeOptions:{resultEqualityCheck:yv}}),q0=Te([cue,Ic],ck),due=Te([oue,Ic,is],A8),Pk=Te([q0,is,Mx],uk),hM=Te([is],hk),uue=Te([is],e=>e.allowDataOverflow),fM=Te([hM,uue],i8),hue=Te([Mx],e=>e.filter(pv)),fue=Te([due,hue,_x,w8],R8),xue=Te([fue,Ic,ns,fM],M8),mue=Te([Mx],D8),pue=Te([q0,is,mue,jv,ns],mk,{memoizeOptions:{resultEqualityCheck:gv}}),gue=Te([L8,ns,z0],U0),yue=Te([gue,ns],z8),vue=Te([$8,ns,z0],U0),bue=Te([vue,ns],U8),jue=Te([B8,ns,z0],U0),wue=Te([jue,ns],W8),Nue=Te([yue,wue,bue],Lg),Sue=Te([is,hM,fM,xue,pue,Nue,vr,ns],pk),Lx=Te([is,vr,q0,Pk,_x,ns,Sue],gk),kue=Te([Lx,is,Ek],bk),Cue=Te([is,Lx,kue,ns],wk),xM=e=>{var t=ns(e),r=z0(e),s=!1;return Fx(e,t,r,s)},mM=Te([is,xM],xv),pM=Te([is,Ek,Cue,mM],vk),Eue=Te([vr,Pk,is,ns],Y8),Pue=Te([vr,Pk,is,ns],J8),Aue=(e,t,r,s,n,i,l,o)=>{if(t){var{type:c}=t,u=Ac(e,o);if(s){var d=r==="scaleBand"&&s.bandwidth?s.bandwidth()/2:2,h=c==="category"&&s.bandwidth?s.bandwidth()/d:0;return h=o==="angleAxis"&&n!=null&&(n==null?void 0:n.length)>=2?vs(n[0]-n[1])*2*h:h,u&&l?l.map((f,x)=>({coordinate:s(f)+h,value:f,index:x,offset:h})):s.domain().map((f,x)=>({coordinate:s(f)+h,value:i?i[f]:f,index:x,offset:h}))}}},ko=Te([vr,is,Ek,pM,xM,Eue,Pue,ns],Aue),Ak=Te([eM,tM,Lde],(e,t,r)=>rM(r.shared,e,t)),gM=e=>e.tooltip.settings.trigger,_k=e=>e.tooltip.settings.defaultIndex,$x=Te([H0,Ak,gM,_k],oM),jc=Te([$x,q0,Dx,Lx],Ck),yM=Te([ko,jc],aM),Tk=Te([$x],e=>{if(e)return e.dataKey}),_ue=Te([$x],e=>{if(e)return e.graphicalItemId}),vM=Te([H0,Ak,gM,_k],dM),Tue=Te([bo,jo,vr,as,ko,_k,vM,Rx],cM),Iue=Te([$x,Tue],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),Oue=Te([$x],e=>e.active),Due=Te([vM,jc,Ic,Dx,yM,Rx,Ak],uM),Fue=Te([Due],e=>{if(e!=null){var t=e.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(t))}});function mA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function pA(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?mA(Object(r),!0).forEach(function(s){Rue(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mA(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Rue(e,t,r){return(t=Mue(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Mue(e){var t=Lue(e,"string");return typeof t=="symbol"?t:t+""}function Lue(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $ue=()=>St(is),Bue=()=>{var e=$ue(),t=St(ko),r=St(pM);return y0(!e||!r?void 0:pA(pA({},e),{},{scale:r}),t)};function gA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function cu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?gA(Object(r),!0).forEach(function(s){zue(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gA(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function zue(e,t,r){return(t=Uue(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Uue(e){var t=Wue(e,"string");return typeof t=="symbol"?t:t+""}function Wue(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Vue=(e,t,r,s)=>{var n=t.find(i=>i&&i.index===r);if(n){if(e==="horizontal")return{x:n.coordinate,y:s.chartY};if(e==="vertical")return{x:s.chartX,y:n.coordinate}}return{x:0,y:0}},Hue=(e,t,r,s)=>{var n=t.find(u=>u&&u.index===r);if(n){if(e==="centric"){var i=n.coordinate,{radius:l}=s;return cu(cu(cu({},s),Ga(s.cx,s.cy,l,i)),{},{angle:i,radius:l})}var o=n.coordinate,{angle:c}=s;return cu(cu(cu({},s),Ga(s.cx,s.cy,o,c)),{},{angle:c,radius:o})}return{angle:0,clockWise:!1,cx:0,cy:0,endAngle:0,innerRadius:0,outerRadius:0,radius:0,startAngle:0,x:0,y:0}};function que(e,t){var{chartX:r,chartY:s}=e;return r>=t.left&&r<=t.left+t.width&&s>=t.top&&s<=t.top+t.height}var bM=(e,t,r,s,n)=>{var i,l=-1,o=(i=t==null?void 0:t.length)!==null&&i!==void 0?i:0;if(o<=1||e==null)return 0;if(s==="angleAxis"&&n!=null&&Math.abs(Math.abs(n[1]-n[0])-360)<=1e-6)for(var c=0;c<o;c++){var u=c>0?r[c-1].coordinate:r[o-1].coordinate,d=r[c].coordinate,h=c>=o-1?r[0].coordinate:r[c+1].coordinate,f=void 0;if(vs(d-u)!==vs(h-d)){var x=[];if(vs(h-d)===vs(n[1]-n[0])){f=h;var p=d+n[1]-n[0];x[0]=Math.min(p,(p+u)/2),x[1]=Math.max(p,(p+u)/2)}else{f=u;var g=h+n[1]-n[0];x[0]=Math.min(d,(g+d)/2),x[1]=Math.max(d,(g+d)/2)}var y=[Math.min(d,(f+d)/2),Math.max(d,(f+d)/2)];if(e>y[0]&&e<=y[1]||e>=x[0]&&e<=x[1]){({index:l}=r[c]);break}}else{var v=Math.min(u,h),j=Math.max(u,h);if(e>(v+d)/2&&e<=(j+d)/2){({index:l}=r[c]);break}}}else if(t){for(var b=0;b<o;b++)if(b===0&&e<=(t[b].coordinate+t[b+1].coordinate)/2||b>0&&b<o-1&&e>(t[b].coordinate+t[b-1].coordinate)/2&&e<=(t[b].coordinate+t[b+1].coordinate)/2||b===o-1&&e>(t[b].coordinate+t[b-1].coordinate)/2){({index:l}=t[b]);break}}return l},Kue=()=>St(JS),Ik=(e,t)=>t,jM=(e,t,r)=>r,Ok=(e,t,r,s)=>s,Gue=Te(ko,e=>Wy(e,t=>t.coordinate)),Dk=Te([H0,Ik,jM,Ok],oM),Fk=Te([Dk,q0,Dx,Lx],Ck),Que=(e,t,r)=>{if(t!=null){var s=H0(e);return t==="axis"?r==="hover"?s.axisInteraction.hover.dataKey:s.axisInteraction.click.dataKey:r==="hover"?s.itemInteraction.hover.dataKey:s.itemInteraction.click.dataKey}},wM=Te([H0,Ik,jM,Ok],dM),$g=Te([bo,jo,vr,as,ko,Ok,wM,Rx],cM),Xue=Te([Dk,$g],(e,t)=>{var r;return(r=e.coordinate)!==null&&r!==void 0?r:t}),NM=Te([ko,Fk],aM),Yue=Te([wM,Fk,Ic,Dx,NM,Rx,Ik],uM),Jue=Te([Dk,Fk],(e,t)=>({isActive:e.active&&t!=null,activeIndex:t})),Zue=(e,t,r,s,n,i,l)=>{if(!(!e||!r||!s||!n)&&que(e,l)){var o=Vse(e,t),c=bM(o,i,n,r,s),u=Vue(t,n,c,e);return{activeIndex:String(c),activeCoordinate:u}}},e0e=(e,t,r,s,n,i,l)=>{if(!(!e||!s||!n||!i||!r)){var o=zie(e,r);if(o){var c=Hse(o,t),u=bM(c,l,i,s,n),d=Hue(t,i,u,o);return{activeIndex:String(u),activeCoordinate:d}}}},t0e=(e,t,r,s,n,i,l,o)=>{if(!(!e||!t||!s||!n||!i))return t==="horizontal"||t==="vertical"?Zue(e,t,s,n,i,l,o):e0e(e,t,r,s,n,i,l)},r0e=Te(e=>e.zIndex.zIndexMap,(e,t)=>t,(e,t,r)=>r,(e,t,r)=>{if(t!=null){var s=e[t];if(s!=null)return r?s.panoramaElementId:s.elementId}}),a0e=Te(e=>e.zIndex.zIndexMap,e=>{var t=Object.keys(e).map(s=>parseInt(s,10)).concat(Object.values(Qa)),r=Array.from(new Set(t));return r.sort((s,n)=>s-n)},{memoizeOptions:{resultEqualityCheck:$ce}});function yA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function vA(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yA(Object(r),!0).forEach(function(s){s0e(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yA(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function s0e(e,t,r){return(t=n0e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function n0e(e){var t=i0e(e,"string");return typeof t=="symbol"?t:t+""}function i0e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var l0e={},o0e={zIndexMap:Object.values(Qa).reduce((e,t)=>vA(vA({},e),{},{[t]:{elementId:void 0,panoramaElementId:void 0,consumers:0}}),l0e)},c0e=new Set(Object.values(Qa));function d0e(e){return c0e.has(e)}var SM=Fn({name:"zIndex",initialState:o0e,reducers:{registerZIndexPortal:{reducer:(e,t)=>{var{zIndex:r}=t.payload;e.zIndexMap[r]?e.zIndexMap[r].consumers+=1:e.zIndexMap[r]={consumers:1,elementId:void 0,panoramaElementId:void 0}},prepare:ia()},unregisterZIndexPortal:{reducer:(e,t)=>{var{zIndex:r}=t.payload;e.zIndexMap[r]&&(e.zIndexMap[r].consumers-=1,e.zIndexMap[r].consumers<=0&&!d0e(r)&&delete e.zIndexMap[r])},prepare:ia()},registerZIndexPortalId:{reducer:(e,t)=>{var{zIndex:r,elementId:s,isPanorama:n}=t.payload;e.zIndexMap[r]?n?e.zIndexMap[r].panoramaElementId=s:e.zIndexMap[r].elementId=s:e.zIndexMap[r]={consumers:0,elementId:n?void 0:s,panoramaElementId:n?s:void 0}},prepare:ia()},unregisterZIndexPortalId:{reducer:(e,t)=>{var{zIndex:r}=t.payload;e.zIndexMap[r]&&(t.payload.isPanorama?e.zIndexMap[r].panoramaElementId=void 0:e.zIndexMap[r].elementId=void 0)},prepare:ia()}}}),{registerZIndexPortal:u0e,unregisterZIndexPortal:h0e,registerZIndexPortalId:f0e,unregisterZIndexPortalId:x0e}=SM.actions,m0e=SM.reducer;function Rn(e){var{zIndex:t,children:r}=e,s=gne(),n=s&&t!==void 0&&t!==0,i=Zs(),l=fa();m.useLayoutEffect(()=>n?(l(u0e({zIndex:t})),()=>{l(h0e({zIndex:t}))}):px,[l,t,n]);var o=St(u=>r0e(u,t,i));if(!n)return r;if(!o)return null;var c=document.getElementById(o);return c?GN.createPortal(r,c):null}function Bw(){return Bw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Bw.apply(null,arguments)}function bA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function Mm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?bA(Object(r),!0).forEach(function(s){p0e(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bA(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function p0e(e,t,r){return(t=g0e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function g0e(e){var t=y0e(e,"string");return typeof t=="symbol"?t:t+""}function y0e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function v0e(e){var{cursor:t,cursorComp:r,cursorProps:s}=e;return m.isValidElement(t)?m.cloneElement(t,s):m.createElement(r,s)}function b0e(e){var t,{coordinate:r,payload:s,index:n,offset:i,tooltipAxisBandSize:l,layout:o,cursor:c,tooltipEventType:u,chartName:d}=e,h=r,f=s,x=n;if(!c||!h||d!=="ScatterChart"&&u!=="axis")return null;var p,g,y;if(d==="ScatterChart")p=h,g=rie,y=Qa.cursorLine;else if(d==="BarChart")p=aie(o,h,i,l),g=gR,y=Qa.cursorRectangle;else if(o==="radial"&&RD(h)){var{cx:v,cy:j,radius:b,startAngle:w,endAngle:k}=vR(h);p={cx:v,cy:j,startAngle:w,endAngle:k,innerRadius:b,outerRadius:b},g=jR,y=Qa.cursorLine}else p={points:Hie(o,h,i)},g=kS,y=Qa.cursorLine;var N=typeof c=="object"&&"className"in c?c.className:void 0,S=Mm(Mm(Mm(Mm({stroke:"#ccc",pointerEvents:"none"},i),p),Dd(c)),{},{payload:f,payloadIndex:x,className:Ar("recharts-tooltip-cursor",N)});return m.createElement(Rn,{zIndex:(t=e.zIndex)!==null&&t!==void 0?t:y},m.createElement(v0e,{cursor:c,cursorComp:g,cursorProps:S}))}function j0e(e){var t=Bue(),r=ZF(),s=jx(),n=Kue();return t==null||r==null||s==null||n==null?null:m.createElement(b0e,Bw({},e,{offset:r,layout:s,tooltipAxisBandSize:t,chartName:n}))}var kM=m.createContext(null),w0e=()=>m.useContext(kM),CM={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,r="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(r=!1));function n(c,u,d){this.fn=c,this.context=u,this.once=d||!1}function i(c,u,d,h,f){if(typeof d!="function")throw new TypeError("The listener must be a function");var x=new n(d,h||c,f),p=r?r+u:u;return c._events[p]?c._events[p].fn?c._events[p]=[c._events[p],x]:c._events[p].push(x):(c._events[p]=x,c._eventsCount++),c}function l(c,u){--c._eventsCount===0?c._events=new s:delete c._events[u]}function o(){this._events=new s,this._eventsCount=0}o.prototype.eventNames=function(){var u=[],d,h;if(this._eventsCount===0)return u;for(h in d=this._events)t.call(d,h)&&u.push(r?h.slice(1):h);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(d)):u},o.prototype.listeners=function(u){var d=r?r+u:u,h=this._events[d];if(!h)return[];if(h.fn)return[h.fn];for(var f=0,x=h.length,p=new Array(x);f<x;f++)p[f]=h[f].fn;return p},o.prototype.listenerCount=function(u){var d=r?r+u:u,h=this._events[d];return h?h.fn?1:h.length:0},o.prototype.emit=function(u,d,h,f,x,p){var g=r?r+u:u;if(!this._events[g])return!1;var y=this._events[g],v=arguments.length,j,b;if(y.fn){switch(y.once&&this.removeListener(u,y.fn,void 0,!0),v){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,d),!0;case 3:return y.fn.call(y.context,d,h),!0;case 4:return y.fn.call(y.context,d,h,f),!0;case 5:return y.fn.call(y.context,d,h,f,x),!0;case 6:return y.fn.call(y.context,d,h,f,x,p),!0}for(b=1,j=new Array(v-1);b<v;b++)j[b-1]=arguments[b];y.fn.apply(y.context,j)}else{var w=y.length,k;for(b=0;b<w;b++)switch(y[b].once&&this.removeListener(u,y[b].fn,void 0,!0),v){case 1:y[b].fn.call(y[b].context);break;case 2:y[b].fn.call(y[b].context,d);break;case 3:y[b].fn.call(y[b].context,d,h);break;case 4:y[b].fn.call(y[b].context,d,h,f);break;default:if(!j)for(k=1,j=new Array(v-1);k<v;k++)j[k-1]=arguments[k];y[b].fn.apply(y[b].context,j)}}return!0},o.prototype.on=function(u,d,h){return i(this,u,d,h,!1)},o.prototype.once=function(u,d,h){return i(this,u,d,h,!0)},o.prototype.removeListener=function(u,d,h,f){var x=r?r+u:u;if(!this._events[x])return this;if(!d)return l(this,x),this;var p=this._events[x];if(p.fn)p.fn===d&&(!f||p.once)&&(!h||p.context===h)&&l(this,x);else{for(var g=0,y=[],v=p.length;g<v;g++)(p[g].fn!==d||f&&!p[g].once||h&&p[g].context!==h)&&y.push(p[g]);y.length?this._events[x]=y.length===1?y[0]:y:l(this,x)}return this},o.prototype.removeAllListeners=function(u){var d;return u?(d=r?r+u:u,this._events[d]&&l(this,d)):(this._events=new s,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=r,o.EventEmitter=o,e.exports=o})(CM);var N0e=CM.exports;const S0e=xo(N0e);var Uf=new S0e,zw="recharts.syncEvent.tooltip",jA="recharts.syncEvent.brush";function Rk(e,t){if(t){var r=Number.parseInt(t,10);if(!Ki(r))return e==null?void 0:e[r]}}var k0e={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},EM=Fn({name:"options",initialState:k0e,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),C0e=EM.reducer,{createEventEmitter:E0e}=EM.actions;function P0e(e){return e.tooltip.syncInteraction}var A0e={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},PM=Fn({name:"chartData",initialState:A0e,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:r,endIndex:s}=t.payload;r!=null&&(e.dataStartIndex=r),s!=null&&(e.dataEndIndex=s)}}}),{setChartData:wA,setDataStartEndIndexes:_0e,setComputedData:mbe}=PM.actions,T0e=PM.reducer,I0e=["x","y"];function NA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function du(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?NA(Object(r),!0).forEach(function(s){O0e(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):NA(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function O0e(e,t,r){return(t=D0e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function D0e(e){var t=F0e(e,"string");return typeof t=="symbol"?t:t+""}function F0e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function R0e(e,t){if(e==null)return{};var r,s,n=M0e(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function M0e(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}function L0e(){var e=St(ZS),t=St(ek),r=fa(),s=St(N8),n=St(ko),i=jx(),l=rv(),o=St(c=>c.rootProps.className);m.useEffect(()=>{if(e==null)return px;var c=(u,d,h)=>{if(t!==h&&e===u){if(s==="index"){var f;if(l&&d!==null&&d!==void 0&&(f=d.payload)!==null&&f!==void 0&&f.coordinate&&d.payload.sourceViewBox){var x=d.payload.coordinate,{x:p,y:g}=x,y=R0e(x,I0e),{x:v,y:j,width:b,height:w}=d.payload.sourceViewBox,k=du(du({},y),{},{x:l.x+(b?(p-v)/b:0)*l.width,y:l.y+(w?(g-j)/w:0)*l.height});r(du(du({},d),{},{payload:du(du({},d.payload),{},{coordinate:k})}))}else r(d);return}if(n!=null){var N;if(typeof s=="function"){var S={activeTooltipIndex:d.payload.index==null?void 0:Number(d.payload.index),isTooltipActive:d.payload.active,activeIndex:d.payload.index==null?void 0:Number(d.payload.index),activeLabel:d.payload.label,activeDataKey:d.payload.dataKey,activeCoordinate:d.payload.coordinate},_=s(n,S);N=n[_]}else s==="value"&&(N=n.find(Q=>String(Q.value)===d.payload.label));var{coordinate:O}=d.payload;if(N==null||d.payload.active===!1||O==null||l==null){r(Lw({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0,sourceViewBox:void 0,graphicalItemId:void 0}));return}var{x:E,y:R}=O,C=Math.min(E,l.x+l.width),I=Math.min(R,l.y+l.height),ne={x:i==="horizontal"?N.coordinate:C,y:i==="horizontal"?I:N.coordinate},W=Lw({active:d.payload.active,coordinate:ne,dataKey:d.payload.dataKey,index:String(N.index),label:d.payload.label,sourceViewBox:d.payload.sourceViewBox,graphicalItemId:d.payload.graphicalItemId});r(W)}}};return Uf.on(zw,c),()=>{Uf.off(zw,c)}},[o,r,t,e,s,n,i,l])}function $0e(){var e=St(ZS),t=St(ek),r=fa();m.useEffect(()=>{if(e==null)return px;var s=(n,i,l)=>{t!==l&&e===n&&r(_0e(i))};return Uf.on(jA,s),()=>{Uf.off(jA,s)}},[r,t,e])}function B0e(){var e=fa();m.useEffect(()=>{e(E0e())},[e]),L0e(),$0e()}function z0e(e,t,r,s,n,i){var l=St(x=>Que(x,e,t)),o=St(ek),c=St(ZS),u=St(N8),d=St(P0e),h=d==null?void 0:d.active,f=rv();m.useEffect(()=>{if(!h&&c!=null&&o!=null){var x=Lw({active:i,coordinate:r,dataKey:l,index:n,label:typeof s=="number"?String(s):s,sourceViewBox:f,graphicalItemId:void 0});Uf.emit(zw,c,x,o)}},[h,r,l,n,s,o,c,u,i,f])}function SA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function kA(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?SA(Object(r),!0).forEach(function(s){U0e(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):SA(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function U0e(e,t,r){return(t=W0e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function W0e(e){var t=V0e(e,"string");return typeof t=="symbol"?t:t+""}function V0e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function H0e(e){return e.dataKey}function q0e(e,t){return m.isValidElement(e)?m.cloneElement(e,t):typeof e=="function"?m.createElement(e,t):m.createElement(Fne,t)}var CA=[],K0e={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:"auto",itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function yd(e){var t,r,s=Ns(e,K0e),{active:n,allowEscapeViewBox:i,animationDuration:l,animationEasing:o,content:c,filterNull:u,isAnimationActive:d,offset:h,payloadUniqBy:f,position:x,reverseDirection:p,useTranslate3d:g,wrapperStyle:y,cursor:v,shared:j,trigger:b,defaultIndex:w,portal:k,axisId:N}=s,S=fa(),_=typeof w=="number"?String(w):w;m.useEffect(()=>{S(Wde({shared:j,trigger:b,axisId:N,active:n,defaultIndex:_}))},[S,j,b,N,n,_]);var O=rv(),E=hR(),R=Mde(j),{activeIndex:C,isActive:I}=(t=St(he=>Jue(he,R,b,_)))!==null&&t!==void 0?t:{},ne=St(he=>Yue(he,R,b,_)),W=St(he=>NM(he,R,b,_)),Q=St(he=>Xue(he,R,b,_)),H=ne,K=w0e(),q=(r=n??I)!==null&&r!==void 0?r:!1,[ge,G]=Pae([H,q]),B=R==="axis"?W:void 0;z0e(R,b,Q,B,C,q);var se=k??K;if(se==null||O==null||R==null)return null;var L=H??CA;q||(L=CA),u&&L.length&&(L=qre(L.filter(he=>he.value!=null&&(he.hide!==!0||s.includeHidden)),f,H0e));var Z=L.length>0,F=m.createElement(Une,{allowEscapeViewBox:i,animationDuration:l,animationEasing:o,isAnimationActive:d,active:q,coordinate:Q,hasPayload:Z,offset:h,position:x,reverseDirection:p,useTranslate3d:g,viewBox:O,wrapperStyle:y,lastBoundingBox:ge,innerRef:G,hasPortalFromProps:!!k},q0e(c,kA(kA({},s),{},{payload:L,label:B,active:q,activeIndex:C,coordinate:Q,accessibilityLayer:E})));return m.createElement(m.Fragment,null,GN.createPortal(F,se),q&&m.createElement(j0e,{cursor:v,tooltipEventType:R,coordinate:Q,payload:L,index:C}))}var $d=e=>null;$d.displayName="Cell";function G0e(e,t,r){return(t=Q0e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Q0e(e){var t=X0e(e,"string");return typeof t=="symbol"?t:t+""}function X0e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class Y0e{constructor(t){G0e(this,"cache",new Map),this.maxSize=t}get(t){var r=this.cache.get(t);return r!==void 0&&(this.cache.delete(t),this.cache.set(t,r)),r}set(t,r){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){var s=this.cache.keys().next().value;s!=null&&this.cache.delete(s)}this.cache.set(t,r)}clear(){this.cache.clear()}size(){return this.cache.size}}function EA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function J0e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?EA(Object(r),!0).forEach(function(s){Z0e(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):EA(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Z0e(e,t,r){return(t=ehe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ehe(e){var t=the(e,"string");return typeof t=="symbol"?t:t+""}function the(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rhe={cacheSize:2e3,enableCache:!0},AM=J0e({},rhe),PA=new Y0e(AM.cacheSize),ahe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},AA="recharts_measurement_span";function she(e,t){var r=t.fontSize||"",s=t.fontFamily||"",n=t.fontWeight||"",i=t.fontStyle||"",l=t.letterSpacing||"",o=t.textTransform||"";return"".concat(e,"|").concat(r,"|").concat(s,"|").concat(n,"|").concat(i,"|").concat(l,"|").concat(o)}var _A=(e,t)=>{try{var r=document.getElementById(AA);r||(r=document.createElement("span"),r.setAttribute("id",AA),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,ahe,t),r.textContent="".concat(e);var s=r.getBoundingClientRect();return{width:s.width,height:s.height}}catch{return{width:0,height:0}}},Hh=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||Nx.isSsr)return{width:0,height:0};if(!AM.enableCache)return _A(t,r);var s=she(t,r),n=PA.get(s);if(n)return n;var i=_A(t,r);return PA.set(s,i),i},TA=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,IA=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,nhe=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,ihe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,_M={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},lhe=Object.keys(_M),Pu="NaN";function ohe(e,t){return e*_M[t]}class wn{static parse(t){var r,[,s,n]=(r=ihe.exec(t))!==null&&r!==void 0?r:[];return new wn(parseFloat(s),n??"")}constructor(t,r){this.num=t,this.unit=r,this.num=t,this.unit=r,Ki(t)&&(this.unit=""),r!==""&&!nhe.test(r)&&(this.num=NaN,this.unit=""),lhe.includes(r)&&(this.num=ohe(t,r),this.unit="px")}add(t){return this.unit!==t.unit?new wn(NaN,""):new wn(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new wn(NaN,""):new wn(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new wn(NaN,""):new wn(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new wn(NaN,""):new wn(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return Ki(this.num)}}function TM(e){if(e.includes(Pu))return Pu;for(var t=e;t.includes("*")||t.includes("/");){var r,[,s,n,i]=(r=TA.exec(t))!==null&&r!==void 0?r:[],l=wn.parse(s??""),o=wn.parse(i??""),c=n==="*"?l.multiply(o):l.divide(o);if(c.isNaN())return Pu;t=t.replace(TA,c.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var u,[,d,h,f]=(u=IA.exec(t))!==null&&u!==void 0?u:[],x=wn.parse(d??""),p=wn.parse(f??""),g=h==="+"?x.add(p):x.subtract(p);if(g.isNaN())return Pu;t=t.replace(IA,g.toString())}return t}var OA=/\(([^()]*)\)/;function che(e){for(var t=e,r;(r=OA.exec(t))!=null;){var[,s]=r;t=t.replace(OA,TM(s))}return t}function dhe(e){var t=e.replace(/\s+/g,"");return t=che(t),t=TM(t),t}function uhe(e){try{return dhe(e)}catch{return Pu}}function n1(e){var t=uhe(e.slice(5,-1));return t===Pu?"":t}var hhe=["x","y","lineHeight","capHeight","fill","scaleToFit","textAnchor","verticalAnchor"],fhe=["dx","dy","angle","className","breakAll"];function Uw(){return Uw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Uw.apply(null,arguments)}function DA(e,t){if(e==null)return{};var r,s,n=xhe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function xhe(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var IM=/[ \f\n\r\t\v\u2028\u2029]+/,OM=e=>{var{children:t,breakAll:r,style:s}=e;try{var n=[];ha(t)||(r?n=t.toString().split(""):n=t.toString().split(IM));var i=n.map(o=>({word:o,width:Hh(o,s).width})),l=r?0:Hh("",s).width;return{wordsWithComputedWidth:i,spaceWidth:l}}catch{return null}};function mhe(e){return e==="start"||e==="middle"||e==="end"||e==="inherit"}var DM=(e,t,r,s)=>e.reduce((n,i)=>{var{word:l,width:o}=i,c=n[n.length-1];if(c&&o!=null&&(t==null||s||c.width+o+r<Number(t)))c.words.push(l),c.width+=o+r;else{var u={words:[l],width:o};n.push(u)}return n},[]),FM=e=>e.reduce((t,r)=>t.width>r.width?t:r),phe="",FA=(e,t,r,s,n,i,l,o)=>{var c=e.slice(0,t),u=OM({breakAll:r,style:s,children:c+phe});if(!u)return[!1,[]];var d=DM(u.wordsWithComputedWidth,i,l,o),h=d.length>n||FM(d).width>Number(i);return[h,d]},ghe=(e,t,r,s,n)=>{var{maxLines:i,children:l,style:o,breakAll:c}=e,u=Et(i),d=String(l),h=DM(t,s,r,n);if(!u||n)return h;var f=h.length>i||FM(h).width>Number(s);if(!f)return h;for(var x=0,p=d.length-1,g=0,y;x<=p&&g<=d.length-1;){var v=Math.floor((x+p)/2),j=v-1,[b,w]=FA(d,j,c,o,i,s,r,n),[k]=FA(d,v,c,o,i,s,r,n);if(!b&&!k&&(x=v+1),b&&k&&(p=v-1),!b&&k){y=w;break}g++}return y||h},RA=e=>{var t=ha(e)?[]:e.toString().split(IM);return[{words:t,width:void 0}]},yhe=e=>{var{width:t,scaleToFit:r,children:s,style:n,breakAll:i,maxLines:l}=e;if((t||r)&&!Nx.isSsr){var o,c,u=OM({breakAll:i,children:s,style:n});if(u){var{wordsWithComputedWidth:d,spaceWidth:h}=u;o=d,c=h}else return RA(s);return ghe({breakAll:i,children:s,maxLines:l,style:n},o,c,t,!!r)}return RA(s)},RM="#808080",vhe={angle:0,breakAll:!1,capHeight:"0.71em",fill:RM,lineHeight:"1em",scaleToFit:!1,textAnchor:"start",verticalAnchor:"end",x:0,y:0},Sv=m.forwardRef((e,t)=>{var r=Ns(e,vhe),{x:s,y:n,lineHeight:i,capHeight:l,fill:o,scaleToFit:c,textAnchor:u,verticalAnchor:d}=r,h=DA(r,hhe),f=m.useMemo(()=>yhe({breakAll:h.breakAll,children:h.children,maxLines:h.maxLines,scaleToFit:c,style:h.style,width:h.width}),[h.breakAll,h.children,h.maxLines,c,h.style,h.width]),{dx:x,dy:p,angle:g,className:y,breakAll:v}=h,j=DA(h,fhe);if(!vl(s)||!vl(n)||f.length===0)return null;var b=Number(s)+(Et(x)?x:0),w=Number(n)+(Et(p)?p:0);if(!$a(b)||!$a(w))return null;var k;switch(d){case"start":k=n1("calc(".concat(l,")"));break;case"middle":k=n1("calc(".concat((f.length-1)/2," * -").concat(i," + (").concat(l," / 2))"));break;default:k=n1("calc(".concat(f.length-1," * -").concat(i,")"));break}var N=[];if(c){var S=f[0].width,{width:_}=h;N.push("scale(".concat(Et(_)&&Et(S)?_/S:1,")"))}return g&&N.push("rotate(".concat(g,", ").concat(b,", ").concat(w,")")),N.length&&(j.transform=N.join(" ")),m.createElement("text",Uw({},fn(j),{ref:t,x:b,y:w,className:Ar("recharts-text",y),textAnchor:u,fill:o.includes("url")?RM:o}),f.map((O,E)=>{var R=O.words.join(v?"":" ");return m.createElement("tspan",{x:b,dy:E===0?k:i,key:"".concat(R,"-").concat(E)},R)}))});Sv.displayName="Text";var bhe=["labelRef"];function jhe(e,t){if(e==null)return{};var r,s,n=whe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function whe(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}function MA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function Fa(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?MA(Object(r),!0).forEach(function(s){Nhe(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):MA(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Nhe(e,t,r){return(t=She(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function She(e){var t=khe(e,"string");return typeof t=="symbol"?t:t+""}function khe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $l(){return $l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},$l.apply(null,arguments)}var MM=m.createContext(null),Che=e=>{var{x:t,y:r,upperWidth:s,lowerWidth:n,width:i,height:l,children:o}=e,c=m.useMemo(()=>({x:t,y:r,upperWidth:s,lowerWidth:n,width:i,height:l}),[t,r,s,n,i,l]);return m.createElement(MM.Provider,{value:c},o)},LM=()=>{var e=m.useContext(MM),t=rv();return e||JF(t)},Ehe=m.createContext(null),Phe=()=>{var e=m.useContext(Ehe),t=St(P8);return e||t},Ahe=e=>{var{value:t,formatter:r}=e,s=ha(e.children)?t:e.children;return typeof r=="function"?r(s):s},Mk=e=>e!=null&&typeof e=="function",_he=(e,t)=>{var r=vs(t-e),s=Math.min(Math.abs(t-e),360);return r*s},The=(e,t,r,s,n)=>{var{offset:i,className:l}=e,{cx:o,cy:c,innerRadius:u,outerRadius:d,startAngle:h,endAngle:f,clockWise:x}=n,p=(u+d)/2,g=_he(h,f),y=g>=0?1:-1,v,j;switch(t){case"insideStart":v=h+y*i,j=x;break;case"insideEnd":v=f-y*i,j=!x;break;case"end":v=f+y*i,j=x;break;default:throw new Error("Unsupported position ".concat(t))}j=g<=0?j:!j;var b=Ga(o,c,p,v),w=Ga(o,c,p,v+(j?1:-1)*359),k="M".concat(b.x,",").concat(b.y,`
    A`).concat(p,",").concat(p,",0,1,").concat(j?0:1,`,
    `).concat(w.x,",").concat(w.y),N=ha(e.id)?Af("recharts-radial-line-"):e.id;return m.createElement("text",$l({},s,{dominantBaseline:"central",className:Ar("recharts-radial-bar-label",l)}),m.createElement("defs",null,m.createElement("path",{id:N,d:k})),m.createElement("textPath",{xlinkHref:"#".concat(N)},r))},Ihe=(e,t,r)=>{var{cx:s,cy:n,innerRadius:i,outerRadius:l,startAngle:o,endAngle:c}=e,u=(o+c)/2;if(r==="outside"){var{x:d,y:h}=Ga(s,n,l+t,u);return{x:d,y:h,textAnchor:d>=s?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:s,y:n,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:s,y:n,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:s,y:n,textAnchor:"middle",verticalAnchor:"end"};var f=(i+l)/2,{x,y:p}=Ga(s,n,f,u);return{x,y:p,textAnchor:"middle",verticalAnchor:"middle"}},Ww=e=>"cx"in e&&Et(e.cx),Ohe=(e,t)=>{var{parentViewBox:r,offset:s,position:n}=e,i;r!=null&&!Ww(r)&&(i=r);var{x:l,y:o,upperWidth:c,lowerWidth:u,height:d}=t,h=l,f=l+(c-u)/2,x=(h+f)/2,p=(c+u)/2,g=h+c/2,y=d>=0?1:-1,v=y*s,j=y>0?"end":"start",b=y>0?"start":"end",w=c>=0?1:-1,k=w*s,N=w>0?"end":"start",S=w>0?"start":"end";if(n==="top"){var _={x:h+c/2,y:o-v,textAnchor:"middle",verticalAnchor:j};return Fa(Fa({},_),i?{height:Math.max(o-i.y,0),width:c}:{})}if(n==="bottom"){var O={x:f+u/2,y:o+d+v,textAnchor:"middle",verticalAnchor:b};return Fa(Fa({},O),i?{height:Math.max(i.y+i.height-(o+d),0),width:u}:{})}if(n==="left"){var E={x:x-k,y:o+d/2,textAnchor:N,verticalAnchor:"middle"};return Fa(Fa({},E),i?{width:Math.max(E.x-i.x,0),height:d}:{})}if(n==="right"){var R={x:x+p+k,y:o+d/2,textAnchor:S,verticalAnchor:"middle"};return Fa(Fa({},R),i?{width:Math.max(i.x+i.width-R.x,0),height:d}:{})}var C=i?{width:p,height:d}:{};return n==="insideLeft"?Fa({x:x+k,y:o+d/2,textAnchor:S,verticalAnchor:"middle"},C):n==="insideRight"?Fa({x:x+p-k,y:o+d/2,textAnchor:N,verticalAnchor:"middle"},C):n==="insideTop"?Fa({x:h+c/2,y:o+v,textAnchor:"middle",verticalAnchor:b},C):n==="insideBottom"?Fa({x:f+u/2,y:o+d-v,textAnchor:"middle",verticalAnchor:j},C):n==="insideTopLeft"?Fa({x:h+k,y:o+v,textAnchor:S,verticalAnchor:b},C):n==="insideTopRight"?Fa({x:h+c-k,y:o+v,textAnchor:N,verticalAnchor:b},C):n==="insideBottomLeft"?Fa({x:f+k,y:o+d-v,textAnchor:S,verticalAnchor:j},C):n==="insideBottomRight"?Fa({x:f+u-k,y:o+d-v,textAnchor:N,verticalAnchor:j},C):n&&typeof n=="object"&&(Et(n.x)||io(n.x))&&(Et(n.y)||io(n.y))?Fa({x:l+Qs(n.x,p),y:o+Qs(n.y,d),textAnchor:"end",verticalAnchor:"end"},C):Fa({x:g,y:o+d/2,textAnchor:"middle",verticalAnchor:"middle"},C)},Dhe={angle:0,offset:5,zIndex:Qa.label,position:"middle",textBreakAll:!1};function Fo(e){var t=Ns(e,Dhe),{viewBox:r,position:s,value:n,children:i,content:l,className:o="",textBreakAll:c,labelRef:u}=t,d=Phe(),h=LM(),f=s==="center"?h:d??h,x,p,g;if(r==null?x=f:Ww(r)?x=r:x=JF(r),!x||ha(n)&&ha(i)&&!m.isValidElement(l)&&typeof l!="function")return null;var y=Fa(Fa({},t),{},{viewBox:x});if(m.isValidElement(l)){var{labelRef:v}=y,j=jhe(y,bhe);return m.cloneElement(l,j)}if(typeof l=="function"){if(p=m.createElement(l,y),m.isValidElement(p))return p}else p=Ahe(t);var b=fn(t);if(Ww(x)){if(s==="insideStart"||s==="insideEnd"||s==="end")return The(t,s,p,b,x);g=Ihe(x,t.offset,t.position)}else g=Ohe(t,x);return m.createElement(Rn,{zIndex:t.zIndex},m.createElement(Sv,$l({ref:u,className:Ar("recharts-label",o)},b,g,{textAnchor:mhe(b.textAnchor)?b.textAnchor:g.textAnchor,breakAll:c}),p))}Fo.displayName="Label";var Fhe=(e,t,r)=>{if(!e)return null;var s={viewBox:t,labelRef:r};return e===!0?m.createElement(Fo,$l({key:"label-implicit"},s)):vl(e)?m.createElement(Fo,$l({key:"label-implicit",value:e},s)):m.isValidElement(e)?e.type===Fo?m.cloneElement(e,Fa({key:"label-implicit"},s)):m.createElement(Fo,$l({key:"label-implicit",content:e},s)):Mk(e)?m.createElement(Fo,$l({key:"label-implicit",content:e},s)):e&&typeof e=="object"?m.createElement(Fo,$l({},e,{key:"label-implicit"},s)):null};function Rhe(e){var{label:t,labelRef:r}=e,s=LM();return Fhe(t,s,r)||null}var $M={},BM={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r[r.length-1]}e.last=t})(BM);var zM={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Array.isArray(r)?r:Array.from(r)}e.toArray=t})(zM);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=BM,r=zM,s=zy;function n(i){if(s.isArrayLike(i))return t.last(r.toArray(i))}e.last=n})($M);var Mhe=$M.last;const Lhe=xo(Mhe);var $he=["valueAccessor"],Bhe=["dataKey","clockWise","id","textBreakAll","zIndex"];function Bg(){return Bg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Bg.apply(null,arguments)}function LA(e,t){if(e==null)return{};var r,s,n=zhe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function zhe(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Uhe=e=>Array.isArray(e.value)?Lhe(e.value):e.value,UM=m.createContext(void 0),WM=UM.Provider,VM=m.createContext(void 0),Whe=VM.Provider;function Vhe(){return m.useContext(UM)}function Hhe(){return m.useContext(VM)}function cp(e){var{valueAccessor:t=Uhe}=e,r=LA(e,$he),{dataKey:s,clockWise:n,id:i,textBreakAll:l,zIndex:o}=r,c=LA(r,Bhe),u=Vhe(),d=Hhe(),h=u||d;return!h||!h.length?null:m.createElement(Rn,{zIndex:o??Qa.label},m.createElement(ws,{className:"recharts-label-list"},h.map((f,x)=>{var p,g=ha(s)?t(f,x):Kr(f&&f.payload,s),y=ha(i)?{}:{id:"".concat(i,"-").concat(x)};return m.createElement(Fo,Bg({key:"label-".concat(x)},fn(f),c,y,{fill:(p=r.fill)!==null&&p!==void 0?p:f.fill,parentViewBox:f.parentViewBox,value:g,textBreakAll:l,viewBox:f.viewBox,index:x,zIndex:0}))})))}cp.displayName="LabelList";function Lk(e){var{label:t}=e;return t?t===!0?m.createElement(cp,{key:"labelList-implicit"}):m.isValidElement(t)||Mk(t)?m.createElement(cp,{key:"labelList-implicit",content:t}):typeof t=="object"?m.createElement(cp,Bg({key:"labelList-implicit"},t,{type:String(t.type)})):null:null}function Vw(){return Vw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Vw.apply(null,arguments)}var HM=e=>{var{cx:t,cy:r,r:s,className:n}=e,i=Ar("recharts-dot",n);return Et(t)&&Et(r)&&Et(s)?m.createElement("circle",Vw({},Xn(e),eS(e),{className:i,cx:t,cy:r,r:s})):null},qM=e=>e.graphicalItems.polarItems,qhe=Te([xa,Tx],ik),kv=Te([qM,ka,qhe],lk),Khe=Te([kv],ok),Cv=Te([Khe,QS],ck),Ghe=Te([Cv,ka,kv],uk);Te([Cv,ka,kv],(e,t,r)=>r.length>0?e.flatMap(s=>r.flatMap(n=>{var i,l=Kr(s,(i=t.dataKey)!==null&&i!==void 0?i:n.dataKey);return{value:l,errorDomain:[]}})).filter(Boolean):(t==null?void 0:t.dataKey)!=null?e.map(s=>({value:Kr(s,t.dataKey),errorDomain:[]})):e.map(s=>({value:s,errorDomain:[]})));var $A=()=>{},Qhe=Te([Cv,ka,kv,jv,xa],mk),Xhe=Te([ka,fk,xk,$A,Qhe,$A,vr,xa],pk),KM=Te([ka,vr,Cv,Ghe,_x,xa,Xhe],gk),Yhe=Te([KM,ka,W0],bk);Te([ka,KM,Yhe,xa],wk);var Jhe={radiusAxis:{},angleAxis:{}},GM=Fn({name:"polarAxis",initialState:Jhe,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:pbe,removeRadiusAxis:gbe,addAngleAxis:ybe,removeAngleAxis:vbe}=GM.actions,Zhe=GM.reducer;function BA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function zA(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?BA(Object(r),!0).forEach(function(s){efe(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):BA(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function efe(e,t,r){return(t=tfe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tfe(e){var t=rfe(e,"string");return typeof t=="symbol"?t:t+""}function rfe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var afe=(e,t)=>t,$k=Te([qM,afe],(e,t)=>e.filter(r=>r.type==="pie").find(r=>r.id===t)),sfe=[],Bk=(e,t,r)=>(r==null?void 0:r.length)===0?sfe:r,QM=Te([QS,$k,Bk],(e,t,r)=>{var{chartData:s}=e;if(t!=null){var n;if((t==null?void 0:t.data)!=null&&t.data.length>0?n=t.data:n=s,(!n||!n.length)&&r!=null&&(n=r.map(i=>zA(zA({},t.presentationProps),i.props))),n!=null)return n}}),nfe=Te([QM,$k,Bk],(e,t,r)=>{if(!(e==null||t==null))return e.map((s,n)=>{var i,l=Kr(s,t.nameKey,t.name),o;return r!=null&&(i=r[n])!==null&&i!==void 0&&(i=i.props)!==null&&i!==void 0&&i.fill?o=r[n].props.fill:typeof s=="object"&&s!=null&&"fill"in s?o=s.fill:o=t.fill,{value:M0(l,t.dataKey),color:o,payload:s,type:t.legendType}})}),ife=Te([QM,$k,Bk,as],(e,t,r,s)=>{if(!(t==null||e==null))return nxe({offset:s,pieSettings:t,displayedData:e,cells:r})}),XM={exports:{}},Qr={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zk=Symbol.for("react.transitional.element"),Uk=Symbol.for("react.portal"),Ev=Symbol.for("react.fragment"),Pv=Symbol.for("react.strict_mode"),Av=Symbol.for("react.profiler"),_v=Symbol.for("react.consumer"),Tv=Symbol.for("react.context"),Iv=Symbol.for("react.forward_ref"),Ov=Symbol.for("react.suspense"),Dv=Symbol.for("react.suspense_list"),Fv=Symbol.for("react.memo"),Rv=Symbol.for("react.lazy"),lfe=Symbol.for("react.view_transition"),ofe=Symbol.for("react.client.reference");function Si(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case zk:switch(e=e.type,e){case Ev:case Av:case Pv:case Ov:case Dv:case lfe:return e;default:switch(e=e&&e.$$typeof,e){case Tv:case Iv:case Rv:case Fv:return e;case _v:return e;default:return t}}case Uk:return t}}}Qr.ContextConsumer=_v;Qr.ContextProvider=Tv;Qr.Element=zk;Qr.ForwardRef=Iv;Qr.Fragment=Ev;Qr.Lazy=Rv;Qr.Memo=Fv;Qr.Portal=Uk;Qr.Profiler=Av;Qr.StrictMode=Pv;Qr.Suspense=Ov;Qr.SuspenseList=Dv;Qr.isContextConsumer=function(e){return Si(e)===_v};Qr.isContextProvider=function(e){return Si(e)===Tv};Qr.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===zk};Qr.isForwardRef=function(e){return Si(e)===Iv};Qr.isFragment=function(e){return Si(e)===Ev};Qr.isLazy=function(e){return Si(e)===Rv};Qr.isMemo=function(e){return Si(e)===Fv};Qr.isPortal=function(e){return Si(e)===Uk};Qr.isProfiler=function(e){return Si(e)===Av};Qr.isStrictMode=function(e){return Si(e)===Pv};Qr.isSuspense=function(e){return Si(e)===Ov};Qr.isSuspenseList=function(e){return Si(e)===Dv};Qr.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===Ev||e===Av||e===Pv||e===Ov||e===Dv||typeof e=="object"&&e!==null&&(e.$$typeof===Rv||e.$$typeof===Fv||e.$$typeof===Tv||e.$$typeof===_v||e.$$typeof===Iv||e.$$typeof===ofe||e.getModuleId!==void 0)};Qr.typeOf=Si;XM.exports=Qr;var cfe=XM.exports,UA=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",WA=null,i1=null,YM=e=>{if(e===WA&&Array.isArray(i1))return i1;var t=[];return m.Children.forEach(e,r=>{ha(r)||(cfe.isFragment(r)?t=t.concat(YM(r.props.children)):t.push(r))}),i1=t,WA=e,t};function Wk(e,t){var r=[],s=[];return Array.isArray(t)?s=t.map(n=>UA(n)):s=[UA(t)],YM(e).forEach(n=>{var i=Fd(n,"type.displayName")||Fd(n,"type.name");i&&s.indexOf(i)!==-1&&r.push(n)}),r}var JM=e=>e&&typeof e=="object"&&"clipDot"in e?!!e.clipDot:!0,ZM={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){var n;if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const i=r[Symbol.toStringTag];return i==null||!((n=Object.getOwnPropertyDescriptor(r,Symbol.toStringTag))!=null&&n.writable)?!1:r.toString()===`[object ${i}]`}let s=r;for(;Object.getPrototypeOf(s)!==null;)s=Object.getPrototypeOf(s);return Object.getPrototypeOf(r)===s}e.isPlainObject=t})(ZM);var dfe=ZM.isPlainObject;const ufe=xo(dfe);function VA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function HA(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?VA(Object(r),!0).forEach(function(s){hfe(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):VA(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function hfe(e,t,r){return(t=ffe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ffe(e){var t=xfe(e,"string");return typeof t=="symbol"?t:t+""}function xfe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zg(){return zg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},zg.apply(null,arguments)}var qA=(e,t,r,s,n)=>{var i=r-s,l;return l="M ".concat(e,",").concat(t),l+="L ".concat(e+r,",").concat(t),l+="L ".concat(e+r-i/2,",").concat(t+n),l+="L ".concat(e+r-i/2-s,",").concat(t+n),l+="L ".concat(e,",").concat(t," Z"),l},mfe={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},pfe=e=>{var t=Ns(e,mfe),{x:r,y:s,upperWidth:n,lowerWidth:i,height:l,className:o}=t,{animationEasing:c,animationDuration:u,animationBegin:d,isUpdateAnimationActive:h}=t,f=m.useRef(null),[x,p]=m.useState(-1),g=m.useRef(n),y=m.useRef(i),v=m.useRef(l),j=m.useRef(r),b=m.useRef(s),w=kx(e,"trapezoid-");if(m.useEffect(()=>{if(f.current&&f.current.getTotalLength)try{var ne=f.current.getTotalLength();ne&&p(ne)}catch{}},[]),r!==+r||s!==+s||n!==+n||i!==+i||l!==+l||n===0&&i===0||l===0)return null;var k=Ar("recharts-trapezoid",o);if(!h)return m.createElement("g",null,m.createElement("path",zg({},fn(t),{className:k,d:qA(r,s,n,i,l)})));var N=g.current,S=y.current,_=v.current,O=j.current,E=b.current,R="0px ".concat(x===-1?1:x,"px"),C="".concat(x,"px 0px"),I=fR(["strokeDasharray"],u,c);return m.createElement(Sx,{animationId:w,key:w,canBegin:x>0,duration:u,easing:c,isActive:h,begin:d},ne=>{var W=la(N,n,ne),Q=la(S,i,ne),H=la(_,l,ne),K=la(O,r,ne),q=la(E,s,ne);f.current&&(g.current=W,y.current=Q,v.current=H,j.current=K,b.current=q);var ge=ne>0?{transition:I,strokeDasharray:C}:{strokeDasharray:R};return m.createElement("path",zg({},fn(t),{className:k,d:qA(K,q,W,Q,H),ref:f,style:HA(HA({},ge),t.style)}))})},gfe=["option","shapeType","propTransformer","activeClassName"];function yfe(e,t){if(e==null)return{};var r,s,n=vfe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function vfe(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}function KA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function Ug(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?KA(Object(r),!0).forEach(function(s){bfe(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):KA(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function bfe(e,t,r){return(t=jfe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jfe(e){var t=wfe(e,"string");return typeof t=="symbol"?t:t+""}function wfe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Nfe(e,t){return Ug(Ug({},t),e)}function Sfe(e,t){return e==="symbols"}function GA(e){var{shapeType:t,elementProps:r}=e;switch(t){case"rectangle":return m.createElement(gR,r);case"trapezoid":return m.createElement(pfe,r);case"sector":return m.createElement(jR,r);case"symbols":if(Sfe(t))return m.createElement(FD,r);break;case"curve":return m.createElement(kS,r);default:return null}}function kfe(e){return m.isValidElement(e)?e.props:e}function Vk(e){var{option:t,shapeType:r,propTransformer:s=Nfe,activeClassName:n="recharts-active-shape"}=e,i=yfe(e,gfe),l;if(m.isValidElement(t))l=m.cloneElement(t,Ug(Ug({},i),kfe(t)));else if(typeof t=="function")l=t(i,i.index);else if(ufe(t)&&typeof t!="boolean"){var o=s(t,i);l=m.createElement(GA,{shapeType:r,elementProps:o})}else{var c=i;l=m.createElement(GA,{shapeType:r,elementProps:c})}return i.isActive?m.createElement(ws,{className:n},l):l}var Hk=(e,t,r)=>{var s=fa();return(n,i)=>l=>{e==null||e(n,i,l),s(nM({activeIndex:String(i),activeDataKey:t,activeCoordinate:n.tooltipPosition,activeGraphicalItemId:r}))}},qk=e=>{var t=fa();return(r,s)=>n=>{e==null||e(r,s,n),t(Vde())}},Kk=(e,t,r)=>{var s=fa();return(n,i)=>l=>{e==null||e(n,i,l),s(Hde({activeIndex:String(i),activeDataKey:t,activeCoordinate:n.tooltipPosition,activeGraphicalItemId:r}))}};function Gk(e){var{tooltipEntrySettings:t}=e,r=fa(),s=Zs(),n=m.useRef(null);return m.useLayoutEffect(()=>{s||(n.current===null?r(Bde(t)):n.current!==t&&r(zde({prev:n.current,next:t})),n.current=t)},[t,r,s]),m.useLayoutEffect(()=>()=>{n.current&&(r(Ude(n.current)),n.current=null)},[r]),null}function eL(e){var{legendPayload:t}=e,r=fa(),s=Zs(),n=m.useRef(null);return m.useLayoutEffect(()=>{s||(n.current===null?r(cR(t)):n.current!==t&&r(dR({prev:n.current,next:t})),n.current=t)},[r,s,t]),m.useLayoutEffect(()=>()=>{n.current&&(r(uR(n.current)),n.current=null)},[r]),null}function Cfe(e){var{legendPayload:t}=e,r=fa(),s=St(vr),n=m.useRef(null);return m.useLayoutEffect(()=>{s!=="centric"&&s!=="radial"||(n.current===null?r(cR(t)):n.current!==t&&r(dR({prev:n.current,next:t})),n.current=t)},[r,s,t]),m.useLayoutEffect(()=>()=>{n.current&&(r(uR(n.current)),n.current=null)},[r]),null}var l1,Efe=()=>{var[e]=m.useState(()=>Af("uid-"));return e},Pfe=(l1=G_.useId)!==null&&l1!==void 0?l1:Efe;function tL(e,t){var r=Pfe();return t||(e?"".concat(e,"-").concat(r):r)}var Afe=m.createContext(void 0),Qk=e=>{var{id:t,type:r,children:s}=e,n=tL("recharts-".concat(r),t);return m.createElement(Afe.Provider,{value:n},s(n))},_fe={cartesianItems:[],polarItems:[]},rL=Fn({name:"graphicalItems",initialState:_fe,reducers:{addCartesianGraphicalItem:{reducer(e,t){e.cartesianItems.push(t.payload)},prepare:ia()},replaceCartesianGraphicalItem:{reducer(e,t){var{prev:r,next:s}=t.payload,n=Vi(e).cartesianItems.indexOf(r);n>-1&&(e.cartesianItems[n]=s)},prepare:ia()},removeCartesianGraphicalItem:{reducer(e,t){var r=Vi(e).cartesianItems.indexOf(t.payload);r>-1&&e.cartesianItems.splice(r,1)},prepare:ia()},addPolarGraphicalItem:{reducer(e,t){e.polarItems.push(t.payload)},prepare:ia()},removePolarGraphicalItem:{reducer(e,t){var r=Vi(e).polarItems.indexOf(t.payload);r>-1&&e.polarItems.splice(r,1)},prepare:ia()}}}),{addCartesianGraphicalItem:Tfe,replaceCartesianGraphicalItem:Ife,removeCartesianGraphicalItem:Ofe,addPolarGraphicalItem:Dfe,removePolarGraphicalItem:Ffe}=rL.actions,Rfe=rL.reducer,Mfe=e=>{var t=fa(),r=m.useRef(null);return m.useLayoutEffect(()=>{r.current===null?t(Tfe(e)):r.current!==e&&t(Ife({prev:r.current,next:e})),r.current=e},[t,e]),m.useLayoutEffect(()=>()=>{r.current&&(t(Ofe(r.current)),r.current=null)},[t]),null},aL=m.memo(Mfe);function Lfe(e){var t=fa();return m.useLayoutEffect(()=>(t(Dfe(e)),()=>{t(Ffe(e))}),[t,e]),null}var $fe=["key"],Bfe=["onMouseEnter","onClick","onMouseLeave"],zfe=["id"],Ufe=["id"];function QA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function Ta(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?QA(Object(r),!0).forEach(function(s){Wfe(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):QA(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Wfe(e,t,r){return(t=Vfe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Vfe(e){var t=Hfe(e,"string");return typeof t=="symbol"?t:t+""}function Hfe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wc(){return wc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},wc.apply(null,arguments)}function Mv(e,t){if(e==null)return{};var r,s,n=qfe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function qfe(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}function Kfe(e){var t=m.useMemo(()=>Wk(e.children,$d),[e.children]),r=St(s=>nfe(s,e.id,t));return r==null?null:m.createElement(Cfe,{legendPayload:r})}var Gfe=m.memo(e=>{var{dataKey:t,nameKey:r,sectors:s,stroke:n,strokeWidth:i,fill:l,name:o,hide:c,tooltipType:u}=e,d={dataDefinedOnItem:s.map(h=>h.tooltipPayload),positions:s.map(h=>h.tooltipPosition),settings:{stroke:n,strokeWidth:i,fill:l,dataKey:t,nameKey:r,name:M0(o,t),hide:c,type:u,color:l,unit:""}};return m.createElement(Gk,{tooltipEntrySettings:d})}),Qfe=(e,t)=>e>t?"start":e<t?"end":"middle",Xfe=(e,t,r)=>Qs(typeof t=="function"?t(e):t,r,r*.8),Yfe=(e,t,r)=>{var{top:s,left:n,width:i,height:l}=t,o=yR(i,l),c=n+Qs(e.cx,i,i/2),u=s+Qs(e.cy,l,l/2),d=Qs(e.innerRadius,o,0),h=Xfe(r,e.outerRadius,o),f=e.maxRadius||Math.sqrt(i*i+l*l)/2;return{cx:c,cy:u,innerRadius:d,outerRadius:h,maxRadius:f}},Jfe=(e,t)=>{var r=vs(t-e),s=Math.min(Math.abs(t-e),360);return r*s};function Zfe(e){return e&&typeof e=="object"&&"className"in e&&typeof e.className=="string"?e.className:""}var exe=(e,t)=>{if(m.isValidElement(e))return m.cloneElement(e,t);if(typeof e=="function")return e(t);var r=Ar("recharts-pie-label-line",typeof e!="boolean"?e.className:""),{key:s}=t,n=Mv(t,$fe);return m.createElement(kS,wc({},n,{type:"linear",className:r}))},txe=(e,t,r)=>{if(m.isValidElement(e))return m.cloneElement(e,t);var s=r;if(typeof e=="function"&&(s=e(t),m.isValidElement(s)))return s;var n=Ar("recharts-pie-label-text",Zfe(e));return m.createElement(Sv,wc({},t,{alignmentBaseline:"middle",className:n}),s)};function rxe(e){var{sectors:t,props:r,showLabels:s}=e,{label:n,labelLine:i,dataKey:l}=r;if(!s||!n||!t)return null;var o=Xn(r),c=Dd(n),u=Dd(i),d=typeof n=="object"&&"offsetRadius"in n&&typeof n.offsetRadius=="number"&&n.offsetRadius||20,h=t.map((f,x)=>{var p=(f.startAngle+f.endAngle)/2,g=Ga(f.cx,f.cy,f.outerRadius+d,p),y=Ta(Ta(Ta(Ta({},o),f),{},{stroke:"none"},c),{},{index:x,textAnchor:Qfe(g.x,f.cx)},g),v=Ta(Ta(Ta(Ta({},o),f),{},{fill:"none",stroke:f.fill},u),{},{index:x,points:[Ga(f.cx,f.cy,f.outerRadius,p),g],key:"line"});return m.createElement(Rn,{zIndex:Qa.label,key:"label-".concat(f.startAngle,"-").concat(f.endAngle,"-").concat(f.midAngle,"-").concat(x)},m.createElement(ws,null,i&&exe(i,v),txe(n,y,Kr(f,l))))});return m.createElement(ws,{className:"recharts-pie-labels"},h)}function axe(e){var{sectors:t,props:r,showLabels:s}=e,{label:n}=r;return typeof n=="object"&&n!=null&&"position"in n?m.createElement(Lk,{label:n}):m.createElement(rxe,{sectors:t,props:r,showLabels:s})}function sxe(e){var{sectors:t,activeShape:r,inactiveShape:s,allOtherPieProps:n,shape:i,id:l}=e,o=St(jc),c=St(Tk),u=St(_ue),{onMouseEnter:d,onClick:h,onMouseLeave:f}=n,x=Mv(n,Bfe),p=Hk(d,n.dataKey,l),g=qk(f),y=Kk(h,n.dataKey,l);return t==null||t.length===0?null:m.createElement(m.Fragment,null,t.map((v,j)=>{if((v==null?void 0:v.startAngle)===0&&(v==null?void 0:v.endAngle)===0&&t.length!==1)return null;var b=u==null||u===l,w=String(j)===o&&(c==null||n.dataKey===c)&&b,k=o?s:null,N=r&&w?r:k,S=Ta(Ta({},v),{},{stroke:v.stroke,tabIndex:-1,[VF]:j,[HF]:n.dataKey});return m.createElement(ws,wc({key:"sector-".concat(v==null?void 0:v.startAngle,"-").concat(v==null?void 0:v.endAngle,"-").concat(v.midAngle,"-").concat(j),tabIndex:-1,className:"recharts-pie-sector"},By(x,v,j),{onMouseEnter:p(v,j),onMouseLeave:g(v,j),onClick:y(v,j)}),m.createElement(Vk,wc({option:i??N,index:j,shapeType:"sector",isActive:w},S)))}))}function nxe(e){var t,{pieSettings:r,displayedData:s,cells:n,offset:i}=e,{cornerRadius:l,startAngle:o,endAngle:c,dataKey:u,nameKey:d,tooltipType:h}=r,f=Math.abs(r.minAngle),x=Jfe(o,c),p=Math.abs(x),g=s.length<=1?0:(t=r.paddingAngle)!==null&&t!==void 0?t:0,y=s.filter(N=>Kr(N,u,0)!==0).length,v=(p>=360?y:y-1)*g,j=p-y*f-v,b=s.reduce((N,S)=>{var _=Kr(S,u,0);return N+(Et(_)?_:0)},0),w;if(b>0){var k;w=s.map((N,S)=>{var _=Kr(N,u,0),O=Kr(N,d,S),E=Yfe(r,i,N),R=(Et(_)?_:0)/b,C,I=Ta(Ta({},N),n&&n[S]&&n[S].props);S?C=k.endAngle+vs(x)*g*(_!==0?1:0):C=o;var ne=C+vs(x)*((_!==0?f:0)+R*j),W=(C+ne)/2,Q=(E.innerRadius+E.outerRadius)/2,H=[{name:O,value:_,payload:I,dataKey:u,type:h}],K=Ga(E.cx,E.cy,Q,W);return k=Ta(Ta(Ta(Ta({},r.presentationProps),{},{percent:R,cornerRadius:typeof l=="string"?parseFloat(l):l,name:O,tooltipPayload:H,midAngle:W,middleRadius:Q,tooltipPosition:K},I),E),{},{value:_,dataKey:u,startAngle:C,endAngle:ne,payload:I,paddingAngle:vs(x)*g}),k})}return w}function ixe(e){var{showLabels:t,sectors:r,children:s}=e,n=m.useMemo(()=>!t||!r?[]:r.map(i=>({value:i.value,payload:i.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:i.cx,cy:i.cy,innerRadius:i.innerRadius,outerRadius:i.outerRadius,startAngle:i.startAngle,endAngle:i.endAngle,clockWise:!1},fill:i.fill})),[r,t]);return m.createElement(Whe,{value:t?n:void 0},s)}function lxe(e){var{props:t,previousSectorsRef:r,id:s}=e,{sectors:n,isAnimationActive:i,animationBegin:l,animationDuration:o,animationEasing:c,activeShape:u,inactiveShape:d,onAnimationStart:h,onAnimationEnd:f}=t,x=kx(t,"recharts-pie-"),p=r.current,[g,y]=m.useState(!1),v=m.useCallback(()=>{typeof f=="function"&&f(),y(!1)},[f]),j=m.useCallback(()=>{typeof h=="function"&&h(),y(!0)},[h]);return m.createElement(ixe,{showLabels:!g,sectors:n},m.createElement(Sx,{animationId:x,begin:l,duration:o,isActive:i,easing:c,onAnimationStart:j,onAnimationEnd:v,key:x},b=>{var w=[],k=n&&n[0],N=k==null?void 0:k.startAngle;return n==null||n.forEach((S,_)=>{var O=p&&p[_],E=_>0?Fd(S,"paddingAngle",0):0;if(O){var R=la(O.endAngle-O.startAngle,S.endAngle-S.startAngle,b),C=Ta(Ta({},S),{},{startAngle:N+E,endAngle:N+R+E});w.push(C),N=C.endAngle}else{var{endAngle:I,startAngle:ne}=S,W=la(0,I-ne,b),Q=Ta(Ta({},S),{},{startAngle:N+E,endAngle:N+W+E});w.push(Q),N=Q.endAngle}}),r.current=w,m.createElement(ws,null,m.createElement(sxe,{sectors:w,activeShape:u,inactiveShape:d,allOtherPieProps:t,shape:t.shape,id:s}))}),m.createElement(axe,{showLabels:!g,sectors:n,props:t}),t.children)}var oxe={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:"auto",label:!1,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff",zIndex:Qa.area};function cxe(e){var{id:t}=e,r=Mv(e,zfe),{hide:s,className:n,rootTabIndex:i}=e,l=m.useMemo(()=>Wk(e.children,$d),[e.children]),o=St(d=>ife(d,t,l)),c=m.useRef(null),u=Ar("recharts-pie",n);return s||o==null?(c.current=null,m.createElement(ws,{tabIndex:i,className:u})):m.createElement(Rn,{zIndex:e.zIndex},m.createElement(Gfe,{dataKey:e.dataKey,nameKey:e.nameKey,sectors:o,stroke:e.stroke,strokeWidth:e.strokeWidth,fill:e.fill,name:e.name,hide:e.hide,tooltipType:e.tooltipType}),m.createElement(ws,{tabIndex:i,className:u},m.createElement(lxe,{props:Ta(Ta({},r),{},{sectors:o}),previousSectorsRef:c,id:t})))}function Xk(e){var t=Ns(e,oxe),{id:r}=t,s=Mv(t,Ufe),n=Xn(s);return m.createElement(Qk,{id:r,type:"pie"},i=>m.createElement(m.Fragment,null,m.createElement(Lfe,{type:"pie",id:i,data:s.data,dataKey:s.dataKey,hide:s.hide,angleAxisId:0,radiusAxisId:0,name:s.name,nameKey:s.nameKey,tooltipType:s.tooltipType,legendType:s.legendType,fill:s.fill,cx:s.cx,cy:s.cy,startAngle:s.startAngle,endAngle:s.endAngle,paddingAngle:s.paddingAngle,minAngle:s.minAngle,innerRadius:s.innerRadius,outerRadius:s.outerRadius,cornerRadius:s.cornerRadius,presentationProps:n,maxRadius:t.maxRadius}),m.createElement(Kfe,wc({},s,{id:i})),m.createElement(cxe,wc({},s,{id:i}))))}Xk.displayName="Pie";var dxe=["points"];function XA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function o1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?XA(Object(r),!0).forEach(function(s){uxe(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):XA(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function uxe(e,t,r){return(t=hxe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hxe(e){var t=fxe(e,"string");return typeof t=="symbol"?t:t+""}function fxe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Wg(){return Wg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Wg.apply(null,arguments)}function xxe(e,t){if(e==null)return{};var r,s,n=mxe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function mxe(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}function pxe(e){var{option:t,dotProps:r,className:s}=e;if(m.isValidElement(t))return m.cloneElement(t,r);if(typeof t=="function")return t(r);var n=Ar(s,typeof t!="boolean"?t.className:""),i=r??{},{points:l}=i,o=xxe(i,dxe);return m.createElement(HM,Wg({},o,{className:n}))}function gxe(e,t){return e==null?!1:t?!0:e.length===1}function yxe(e){var{points:t,dot:r,className:s,dotClassName:n,dataKey:i,baseProps:l,needClip:o,clipPathId:c,zIndex:u=Qa.scatter}=e;if(!gxe(t,r))return null;var d=JM(r),h=Bte(r),f=t.map((p,g)=>{var y,v,j=o1(o1(o1({r:3},l),h),{},{index:g,cx:(y=p.x)!==null&&y!==void 0?y:void 0,cy:(v=p.y)!==null&&v!==void 0?v:void 0,dataKey:i,value:p.value,payload:p.payload,points:t});return m.createElement(pxe,{key:"dot-".concat(g),option:r,dotProps:j,className:n})}),x={};return o&&c!=null&&(x.clipPath="url(#clipPath-".concat(d?"":"dots-").concat(c,")")),m.createElement(Rn,{zIndex:u},m.createElement(ws,Wg({className:s},x),f))}function YA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function JA(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?YA(Object(r),!0).forEach(function(s){vxe(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):YA(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function vxe(e,t,r){return(t=bxe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bxe(e){var t=jxe(e,"string");return typeof t=="symbol"?t:t+""}function jxe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wxe={xAxis:{},yAxis:{},zAxis:{}},sL=Fn({name:"cartesianAxis",initialState:wxe,reducers:{addXAxis:{reducer(e,t){e.xAxis[t.payload.id]=t.payload},prepare:ia()},replaceXAxis:{reducer(e,t){var{prev:r,next:s}=t.payload;e.xAxis[r.id]!==void 0&&(r.id!==s.id&&delete e.xAxis[r.id],e.xAxis[s.id]=s)},prepare:ia()},removeXAxis:{reducer(e,t){delete e.xAxis[t.payload.id]},prepare:ia()},addYAxis:{reducer(e,t){e.yAxis[t.payload.id]=t.payload},prepare:ia()},replaceYAxis:{reducer(e,t){var{prev:r,next:s}=t.payload;e.yAxis[r.id]!==void 0&&(r.id!==s.id&&delete e.yAxis[r.id],e.yAxis[s.id]=s)},prepare:ia()},removeYAxis:{reducer(e,t){delete e.yAxis[t.payload.id]},prepare:ia()},addZAxis:{reducer(e,t){e.zAxis[t.payload.id]=t.payload},prepare:ia()},replaceZAxis:{reducer(e,t){var{prev:r,next:s}=t.payload;e.zAxis[r.id]!==void 0&&(r.id!==s.id&&delete e.zAxis[r.id],e.zAxis[s.id]=s)},prepare:ia()},removeZAxis:{reducer(e,t){delete e.zAxis[t.payload.id]},prepare:ia()},updateYAxisWidth(e,t){var{id:r,width:s}=t.payload,n=e.yAxis[r];if(n){var i=n.widthHistory||[];if(i.length===3&&i[0]===i[2]&&s===i[1]&&s!==n.width&&Math.abs(s-i[0])<=1)return;var l=[...i,s].slice(-3);e.yAxis[r]=JA(JA({},e.yAxis[r]),{},{width:s,widthHistory:l})}}}}),{addXAxis:Nxe,replaceXAxis:Sxe,removeXAxis:kxe,addYAxis:Cxe,replaceYAxis:Exe,removeYAxis:Pxe,addZAxis:bbe,replaceZAxis:jbe,removeZAxis:wbe,updateYAxisWidth:Axe}=sL.actions,_xe=sL.reducer,Txe=Te([as],e=>({top:e.top,bottom:e.bottom,left:e.left,right:e.right})),Ixe=Te([Txe,bo,jo],(e,t,r)=>{if(!(!e||t==null||r==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,r-e.top-e.bottom)}}),Yk=()=>St(Ixe),Oxe=()=>St(Fue);function ZA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function c1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ZA(Object(r),!0).forEach(function(s){Dxe(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ZA(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Dxe(e,t,r){return(t=Fxe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Fxe(e){var t=Rxe(e,"string");return typeof t=="symbol"?t:t+""}function Rxe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Mxe=e=>{var{point:t,childIndex:r,mainColor:s,activeDot:n,dataKey:i,clipPath:l}=e;if(n===!1||t.x==null||t.y==null)return null;var o={index:r,dataKey:i,cx:t.x,cy:t.y,r:4,fill:s??"none",strokeWidth:2,stroke:"#fff",payload:t.payload,value:t.value},c=c1(c1(c1({},o),Dd(n)),eS(n)),u;return m.isValidElement(n)?u=m.cloneElement(n,c):typeof n=="function"?u=n(c):u=m.createElement(HM,c),m.createElement(ws,{className:"recharts-active-dot",clipPath:l},u)};function Lxe(e){var{points:t,mainColor:r,activeDot:s,itemDataKey:n,clipPath:i,zIndex:l=Qa.activeDot}=e,o=St(jc),c=Oxe();if(t==null||c==null)return null;var u=t.find(d=>c.includes(d.payload));return ha(u)?null:m.createElement(Rn,{zIndex:l},m.createElement(Mxe,{point:u,childIndex:Number(o),mainColor:r,dataKey:n,activeDot:s,clipPath:i}))}var $xe="Invariant failed";function Bxe(e,t){throw new Error($xe)}var zxe=["x","y"];function Hw(){return Hw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Hw.apply(null,arguments)}function e_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function fh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?e_(Object(r),!0).forEach(function(s){Uxe(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):e_(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Uxe(e,t,r){return(t=Wxe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Wxe(e){var t=Vxe(e,"string");return typeof t=="symbol"?t:t+""}function Vxe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Hxe(e,t){if(e==null)return{};var r,s,n=qxe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function qxe(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}function Kxe(e,t){var{x:r,y:s}=e,n=Hxe(e,zxe),i="".concat(r),l=parseInt(i,10),o="".concat(s),c=parseInt(o,10),u="".concat(t.height||n.height),d=parseInt(u,10),h="".concat(t.width||n.width),f=parseInt(h,10);return fh(fh(fh(fh(fh({},t),n),l?{x:l}:{}),c?{y:c}:{}),{},{height:d,width:f,name:t.name,radius:t.radius})}function Vg(e){return m.createElement(Vk,Hw({shapeType:"rectangle",propTransformer:Kxe,activeClassName:"recharts-active-bar"},e))}var Gxe=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(s,n)=>{if(Et(t))return t;var i=Et(s)||ha(s);return i?t(s,n):(i||Bxe(),r)}},Qxe={},nL=Fn({name:"errorBars",initialState:Qxe,reducers:{addErrorBar:(e,t)=>{var{itemId:r,errorBar:s}=t.payload;e[r]||(e[r]=[]),e[r].push(s)},replaceErrorBar:(e,t)=>{var{itemId:r,prev:s,next:n}=t.payload;e[r]&&(e[r]=e[r].map(i=>i.dataKey===s.dataKey&&i.direction===s.direction?n:i))},removeErrorBar:(e,t)=>{var{itemId:r,errorBar:s}=t.payload;e[r]&&(e[r]=e[r].filter(n=>n.dataKey!==s.dataKey||n.direction!==s.direction))}}}),{addErrorBar:Nbe,replaceErrorBar:Sbe,removeErrorBar:kbe}=nL.actions,Xxe=nL.reducer,Yxe=["children"];function Jxe(e,t){if(e==null)return{};var r,s,n=Zxe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Zxe(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var eme={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},tme=m.createContext(eme);function iL(e){var{children:t}=e,r=Jxe(e,Yxe);return m.createElement(tme.Provider,{value:r},t)}function Jk(e,t){var r,s,n=St(u=>No(u,e)),i=St(u=>So(u,t)),l=(r=n==null?void 0:n.allowDataOverflow)!==null&&r!==void 0?r:cs.allowDataOverflow,o=(s=i==null?void 0:i.allowDataOverflow)!==null&&s!==void 0?s:ds.allowDataOverflow,c=l||o;return{needClip:c,needClipX:l,needClipY:o}}function lL(e){var{xAxisId:t,yAxisId:r,clipPathId:s}=e,n=Yk(),{needClipX:i,needClipY:l,needClip:o}=Jk(t,r);if(!o||!n)return null;var{x:c,y:u,width:d,height:h}=n;return m.createElement("clipPath",{id:"clipPath-".concat(s)},m.createElement("rect",{x:i?c:c-d/2,y:l?u:u-h/2,width:i?d:d*2,height:l?h:h*2}))}function rme(e,t){return e&&typeof e=="object"&&"zIndex"in e&&typeof e.zIndex=="number"&&$a(e.zIndex)?e.zIndex:t}var ame={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bx=m;function sme(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var nme=typeof Object.is=="function"?Object.is:sme,ime=Bx.useSyncExternalStore,lme=Bx.useRef,ome=Bx.useEffect,cme=Bx.useMemo,dme=Bx.useDebugValue;ame.useSyncExternalStoreWithSelector=function(e,t,r,s,n){var i=lme(null);if(i.current===null){var l={hasValue:!1,value:null};i.current=l}else l=i.current;i=cme(function(){function c(x){if(!u){if(u=!0,d=x,x=s(x),n!==void 0&&l.hasValue){var p=l.value;if(n(p,x))return h=p}return h=x}if(p=h,nme(d,x))return p;var g=s(x);return n!==void 0&&n(p,g)?(d=x,p):(d=x,h=g)}var u=!1,d,h,f=r===void 0?null:r;return[function(){return c(t())},f===null?void 0:function(){return c(f())}]},[t,r,s,n]);var o=ime(e,i[0],i[1]);return ome(function(){l.hasValue=!0,l.value=o},[o]),dme(o),o};function ume(e){e()}function hme(){let e=null,t=null;return{clear(){e=null,t=null},notify(){ume(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){const r=[];let s=e;for(;s;)r.push(s),s=s.next;return r},subscribe(r){let s=!0;const n=t={callback:r,next:null,prev:t};return n.prev?n.prev.next=n:e=n,function(){!s||e===null||(s=!1,n.next?n.next.prev=n.prev:t=n.prev,n.prev?n.prev.next=n.next:e=n.next)}}}}var t_={notify(){},get:()=>[]};function fme(e,t){let r,s=t_,n=0,i=!1;function l(g){d();const y=s.subscribe(g);let v=!1;return()=>{v||(v=!0,y(),h())}}function o(){s.notify()}function c(){p.onStateChange&&p.onStateChange()}function u(){return i}function d(){n++,r||(r=e.subscribe(c),s=hme())}function h(){n--,r&&n===0&&(r(),r=void 0,s.clear(),s=t_)}function f(){i||(i=!0,d())}function x(){i&&(i=!1,h())}const p={addNestedSub:l,notifyNestedSubs:o,handleChangeWrapper:c,isSubscribed:u,trySubscribe:f,tryUnsubscribe:x,getListeners:()=>s};return p}var xme=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",mme=xme(),pme=()=>typeof navigator<"u"&&navigator.product==="ReactNative",gme=pme(),yme=()=>mme||gme?m.useLayoutEffect:m.useEffect,vme=yme();function r_(e,t){return e===t?e!==0||t!==0||1/e===1/t:e!==e&&t!==t}function bme(e,t){if(r_(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;const r=Object.keys(e),s=Object.keys(t);if(r.length!==s.length)return!1;for(let n=0;n<r.length;n++)if(!Object.prototype.hasOwnProperty.call(t,r[n])||!r_(e[r[n]],t[r[n]]))return!1;return!0}var d1=Symbol.for("react-redux-context"),u1=typeof globalThis<"u"?globalThis:{};function jme(){if(!m.createContext)return{};const e=u1[d1]??(u1[d1]=new Map);let t=e.get(m.createContext);return t||(t=m.createContext(null),e.set(m.createContext,t)),t}var wme=jme();function Nme(e){const{children:t,context:r,serverState:s,store:n}=e,i=m.useMemo(()=>{const c=fme(n);return{store:n,subscription:c,getServerState:s?()=>s:void 0}},[n,s]),l=m.useMemo(()=>n.getState(),[n]);vme(()=>{const{subscription:c}=i;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),l!==n.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[i,l]);const o=r||wme;return m.createElement(o.Provider,{value:i},t)}var Sme=Nme,kme=new Set(["axisLine","tickLine","activeBar","activeDot","activeLabel","activeShape","allowEscapeViewBox","background","cursor","dot","label","line","margin","padding","position","shape","style","tick","wrapperStyle"]);function Cme(e,t){return e==null&&t==null?!0:typeof e=="number"&&typeof t=="number"?e===t||e!==e&&t!==t:e===t}function Lv(e,t){var r=new Set([...Object.keys(e),...Object.keys(t)]);for(var s of r)if(kme.has(s)){if(e[s]==null&&t[s]==null)continue;if(!bme(e[s],t[s]))return!1}else if(!Cme(e[s],t[s]))return!1;return!0}var Eme=["onMouseEnter","onMouseLeave","onClick"],Pme=["value","background","tooltipPosition"],Ame=["id"],_me=["onMouseEnter","onClick","onMouseLeave"];function fo(){return fo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},fo.apply(null,arguments)}function a_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function on(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?a_(Object(r),!0).forEach(function(s){Tme(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a_(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Tme(e,t,r){return(t=Ime(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ime(e){var t=Ome(e,"string");return typeof t=="symbol"?t:t+""}function Ome(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Hg(e,t){if(e==null)return{};var r,s,n=Dme(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Dme(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var Fme=e=>{var{dataKey:t,name:r,fill:s,legendType:n,hide:i}=e;return[{inactive:i,dataKey:t,type:n,color:s,value:M0(r,t),payload:e}]},Rme=m.memo(e=>{var{dataKey:t,stroke:r,strokeWidth:s,fill:n,name:i,hide:l,unit:o,tooltipType:c}=e,u={dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:r,strokeWidth:s,fill:n,dataKey:t,nameKey:void 0,name:M0(i,t),hide:l,type:c,color:n,unit:o}};return m.createElement(Gk,{tooltipEntrySettings:u})});function Mme(e){var t=St(jc),{data:r,dataKey:s,background:n,allOtherBarProps:i}=e,{onMouseEnter:l,onMouseLeave:o,onClick:c}=i,u=Hg(i,Eme),d=Hk(l,s),h=qk(o),f=Kk(c,s);if(!n||r==null)return null;var x=Dd(n);return m.createElement(Rn,{zIndex:rme(n,Qa.barBackground)},r.map((p,g)=>{var{value:y,background:v,tooltipPosition:j}=p,b=Hg(p,Pme);if(!v)return null;var w=d(p,g),k=h(p,g),N=f(p,g),S=on(on(on(on(on({option:n,isActive:String(g)===t},b),{},{fill:"#eee"},v),x),By(u,p,g)),{},{onMouseEnter:w,onMouseLeave:k,onClick:N,dataKey:s,index:g,className:"recharts-bar-background-rectangle"});return m.createElement(Vg,fo({key:"background-bar-".concat(g)},S))}))}function Lme(e){var{showLabels:t,children:r,rects:s}=e,n=s==null?void 0:s.map(i=>{var l={x:i.x,y:i.y,width:i.width,lowerWidth:i.width,upperWidth:i.width,height:i.height};return on(on({},l),{},{value:i.value,payload:i.payload,parentViewBox:i.parentViewBox,viewBox:l,fill:i.fill})});return m.createElement(WM,{value:t?n:void 0},r)}function $me(e){var{shape:t,activeBar:r,baseProps:s,entry:n,index:i,dataKey:l}=e,o=St(jc),c=St(Tk),u=r&&String(i)===o&&(c==null||l===c),d=u?r:t;return u?m.createElement(Rn,{zIndex:Qa.activeBar},m.createElement(Vg,fo({},s,{name:String(s.name)},n,{isActive:u,option:d,index:i,dataKey:l}))):m.createElement(Vg,fo({},s,{name:String(s.name)},n,{isActive:u,option:d,index:i,dataKey:l}))}function Bme(e){var{shape:t,baseProps:r,entry:s,index:n,dataKey:i}=e;return m.createElement(Vg,fo({},r,{name:String(r.name)},s,{isActive:!1,option:t,index:n,dataKey:i}))}function zme(e){var t,{data:r,props:s}=e,n=(t=Xn(s))!==null&&t!==void 0?t:{},{id:i}=n,l=Hg(n,Ame),{shape:o,dataKey:c,activeBar:u}=s,{onMouseEnter:d,onClick:h,onMouseLeave:f}=s,x=Hg(s,_me),p=Hk(d,c),g=qk(f),y=Kk(h,c);return r?m.createElement(m.Fragment,null,r.map((v,j)=>m.createElement(ws,fo({key:"rectangle-".concat(v==null?void 0:v.x,"-").concat(v==null?void 0:v.y,"-").concat(v==null?void 0:v.value,"-").concat(j),className:"recharts-bar-rectangle"},By(x,v,j),{onMouseEnter:p(v,j),onMouseLeave:g(v,j),onClick:y(v,j)}),u?m.createElement($me,{shape:o,activeBar:u,baseProps:l,entry:v,index:j,dataKey:c}):m.createElement(Bme,{shape:o,baseProps:l,entry:v,index:j,dataKey:c})))):null}function Ume(e){var{props:t,previousRectanglesRef:r}=e,{data:s,layout:n,isAnimationActive:i,animationBegin:l,animationDuration:o,animationEasing:c,onAnimationEnd:u,onAnimationStart:d}=t,h=r.current,f=kx(t,"recharts-bar-"),[x,p]=m.useState(!1),g=!x,y=m.useCallback(()=>{typeof u=="function"&&u(),p(!1)},[u]),v=m.useCallback(()=>{typeof d=="function"&&d(),p(!0)},[d]);return m.createElement(Lme,{showLabels:g,rects:s},m.createElement(Sx,{animationId:f,begin:l,duration:o,isActive:i,easing:c,onAnimationEnd:y,onAnimationStart:v,key:f},j=>{var b=j===1?s:s==null?void 0:s.map((w,k)=>{var N=h&&h[k];if(N)return on(on({},w),{},{x:la(N.x,w.x,j),y:la(N.y,w.y,j),width:la(N.width,w.width,j),height:la(N.height,w.height,j)});if(n==="horizontal"){var S=la(0,w.height,j),_=la(w.stackedBarStart,w.y,j);return on(on({},w),{},{y:_,height:S})}var O=la(0,w.width,j),E=la(w.stackedBarStart,w.x,j);return on(on({},w),{},{width:O,x:E})});return j>0&&(r.current=b??null),b==null?null:m.createElement(ws,null,m.createElement(zme,{props:t,data:b}))}),m.createElement(Lk,{label:t.label}),t.children)}function Wme(e){var t=m.useRef(null);return m.createElement(Ume,{previousRectanglesRef:t,props:e})}var oL=0,Vme=(e,t)=>{var r=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:r,errorVal:Kr(e,t)}};class Hme extends m.PureComponent{render(){var{hide:t,data:r,dataKey:s,className:n,xAxisId:i,yAxisId:l,needClip:o,background:c,id:u}=this.props;if(t||r==null)return null;var d=Ar("recharts-bar",n),h=u;return m.createElement(ws,{className:d,id:u},o&&m.createElement("defs",null,m.createElement(lL,{clipPathId:h,xAxisId:i,yAxisId:l})),m.createElement(ws,{className:"recharts-bar-rectangles",clipPath:o?"url(#clipPath-".concat(h,")"):void 0},m.createElement(Mme,{data:r,dataKey:s,background:c,allOtherBarProps:this.props}),m.createElement(Wme,this.props)))}}var qme={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",background:!1,hide:!1,isAnimationActive:"auto",label:!1,legendType:"rect",minPointSize:oL,xAxisId:0,yAxisId:0,zIndex:Qa.bar};function Kme(e){var{xAxisId:t,yAxisId:r,hide:s,legendType:n,minPointSize:i,activeBar:l,animationBegin:o,animationDuration:c,animationEasing:u,isAnimationActive:d}=e,{needClip:h}=Jk(t,r),f=jx(),x=Zs(),p=Wk(e.children,$d),g=St(j=>jpe(j,t,r,x,e.id,p));if(f!=="vertical"&&f!=="horizontal")return null;var y,v=g==null?void 0:g[0];return v==null||v.height==null||v.width==null?y=0:y=f==="vertical"?v.height/2:v.width/2,m.createElement(iL,{xAxisId:t,yAxisId:r,data:g,dataPointFormatter:Vme,errorBarOffset:y},m.createElement(Hme,fo({},e,{layout:f,needClip:h,data:g,xAxisId:t,yAxisId:r,hide:s,legendType:n,minPointSize:i,activeBar:l,animationBegin:o,animationDuration:c,animationEasing:u,isAnimationActive:d})))}function Gme(e){var{layout:t,barSettings:{dataKey:r,minPointSize:s},pos:n,bandSize:i,xAxis:l,yAxis:o,xAxisTicks:c,yAxisTicks:u,stackedData:d,displayedData:h,offset:f,cells:x,parentViewBox:p,dataStartIndex:g}=e,y=t==="horizontal"?o:l,v=d?y.scale.domain():null,j=Bse({numericAxis:y}),b=y.scale(j);return h.map((w,k)=>{var N,S,_,O,E,R;d?N=Dse(d[k+g],v):(N=Kr(w,r),Array.isArray(N)||(N=[j,N]));var C=Gxe(s,oL)(N[1],k);if(t==="horizontal"){var I,[ne,W]=[o.scale(N[0]),o.scale(N[1])];S=zE({axis:l,ticks:c,bandSize:i,offset:n.offset,entry:w,index:k}),_=(I=W??ne)!==null&&I!==void 0?I:void 0,O=n.size;var Q=ne-W;if(E=Ki(Q)?0:Q,R={x:S,y:f.top,width:O,height:f.height},Math.abs(C)>0&&Math.abs(E)<Math.abs(C)){var H=vs(E||C)*(Math.abs(C)-Math.abs(E));_-=H,E+=H}}else{var[K,q]=[l.scale(N[0]),l.scale(N[1])];if(S=K,_=zE({axis:o,ticks:u,bandSize:i,offset:n.offset,entry:w,index:k}),O=q-K,E=n.size,R={x:f.left,y:_,width:f.width,height:E},Math.abs(C)>0&&Math.abs(O)<Math.abs(C)){var ge=vs(O||C)*(Math.abs(C)-Math.abs(O));O+=ge}}if(S==null||_==null||O==null||E==null)return null;var G=on(on({},w),{},{stackedBarStart:b,x:S,y:_,width:O,height:E,value:d?N:N[1],payload:w,background:R,tooltipPosition:{x:S+O/2,y:_+E/2},parentViewBox:p},x&&x[k]&&x[k].props);return G}).filter(Boolean)}function Qme(e){var t=Ns(e,qme),r=Zs();return m.createElement(Qk,{id:t.id,type:"bar"},s=>m.createElement(m.Fragment,null,m.createElement(eL,{legendPayload:Fme(t)}),m.createElement(Rme,{dataKey:t.dataKey,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill,name:t.name,hide:t.hide,unit:t.unit,tooltipType:t.tooltipType}),m.createElement(aL,{type:"bar",id:s,data:void 0,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,stackId:$se(t.stackId),hide:t.hide,barSize:t.barSize,minPointSize:t.minPointSize,maxBarSize:t.maxBarSize,isPanorama:r}),m.createElement(Rn,{zIndex:t.zIndex},m.createElement(Kme,fo({},t,{id:s})))))}var qg=m.memo(Qme,Lv);qg.displayName="Bar";function s_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function Lm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?s_(Object(r),!0).forEach(function(s){Xme(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s_(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Xme(e,t,r){return(t=Yme(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Yme(e){var t=Jme(e,"string");return typeof t=="symbol"?t:t+""}function Jme(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Zme=(e,t)=>t,epe=(e,t,r)=>r,tpe=(e,t,r,s)=>s,rpe=(e,t,r,s,n)=>n,zx=Te([vv,rpe],(e,t)=>e.filter(r=>r.type==="bar").find(r=>r.id===t)),ape=Te([zx],e=>e==null?void 0:e.maxBarSize),spe=(e,t,r,s,n,i)=>i,n_=(e,t,r)=>{var s=r??e;if(!ha(s))return Qs(s,t,0)},npe=Te([vr,vv,Zme,epe,tpe],(e,t,r,s,n)=>t.filter(i=>e==="horizontal"?i.xAxisId===r:i.yAxisId===s).filter(i=>i.isPanorama===n).filter(i=>i.hide===!1).filter(i=>i.type==="bar")),ipe=(e,t,r,s)=>{var n=vr(e);return n==="horizontal"?Mw(e,"yAxis",r,s):Mw(e,"xAxis",t,s)},lpe=(e,t,r)=>{var s=vr(e);return s==="horizontal"?dA(e,"xAxis",t):dA(e,"yAxis",r)},ope=(e,t,r)=>{var s={},n=e.filter(pv),i=e.filter(u=>u.stackId==null),l=n.reduce((u,d)=>(u[d.stackId]||(u[d.stackId]=[]),u[d.stackId].push(d),u),s),o=Object.entries(l).map(u=>{var[d,h]=u,f=h.map(p=>p.dataKey),x=n_(t,r,h[0].barSize);return{stackId:d,dataKeys:f,barSize:x}}),c=i.map(u=>{var d=[u.dataKey].filter(f=>f!=null),h=n_(t,r,u.barSize);return{stackId:void 0,dataKeys:d,barSize:h}});return[...o,...c]},cpe=Te([npe,Oce,lpe],ope),dpe=(e,t,r,s,n)=>{var i,l,o=zx(e,t,r,s,n);if(o!=null){var c=vr(e),u=b8(e),{maxBarSize:d}=o,h=ha(d)?u:d,f,x;return c==="horizontal"?(f=bc(e,"xAxis",t,s),x=vc(e,"xAxis",t,s)):(f=bc(e,"yAxis",r,s),x=vc(e,"yAxis",r,s)),(i=(l=y0(f,x,!0))!==null&&l!==void 0?l:h)!==null&&i!==void 0?i:0}},cL=(e,t,r,s)=>{var n=vr(e),i,l;return n==="horizontal"?(i=bc(e,"xAxis",t,s),l=vc(e,"xAxis",t,s)):(i=bc(e,"yAxis",r,s),l=vc(e,"yAxis",r,s)),y0(i,l)};function upe(e,t,r,s,n){var i=s.length;if(!(i<1)){var l=Qs(e,r,0,!0),o,c=[];if($a(s[0].barSize)){var u=!1,d=r/i,h=s.reduce((v,j)=>v+(j.barSize||0),0);h+=(i-1)*l,h>=r&&(h-=(i-1)*l,l=0),h>=r&&d>0&&(u=!0,d*=.9,h=i*d);var f=(r-h)/2>>0,x={offset:f-l,size:0};o=s.reduce((v,j)=>{var b,w={stackId:j.stackId,dataKeys:j.dataKeys,position:{offset:x.offset+x.size+l,size:u?d:(b=j.barSize)!==null&&b!==void 0?b:0}},k=[...v,w];return x=k[k.length-1].position,k},c)}else{var p=Qs(t,r,0,!0);r-2*p-(i-1)*l<=0&&(l=0);var g=(r-2*p-(i-1)*l)/i;g>1&&(g>>=0);var y=$a(n)?Math.min(g,n):g;o=s.reduce((v,j,b)=>[...v,{stackId:j.stackId,dataKeys:j.dataKeys,position:{offset:p+(g+l)*b+(g-y)/2,size:y}}],c)}return o}}var hpe=(e,t,r,s,n,i,l)=>{var o=ha(l)?t:l,c=upe(r,s,n!==i?n:i,e,o);return n!==i&&c!=null&&(c=c.map(u=>Lm(Lm({},u),{},{position:Lm(Lm({},u.position),{},{offset:u.position.offset-n/2})}))),c},fpe=Te([cpe,b8,Ice,j8,dpe,cL,ape],hpe),xpe=(e,t,r,s)=>bc(e,"xAxis",t,s),mpe=(e,t,r,s)=>bc(e,"yAxis",r,s),ppe=(e,t,r,s)=>vc(e,"xAxis",t,s),gpe=(e,t,r,s)=>vc(e,"yAxis",r,s),ype=Te([fpe,zx],(e,t)=>{if(!(e==null||t==null)){var r=e.find(s=>s.stackId===t.stackId&&t.dataKey!=null&&s.dataKeys.includes(t.dataKey));if(r!=null)return r.position}}),vpe=(e,t)=>{var r=sk(t);if(!(!e||r==null||t==null)){var{stackId:s}=t;if(s!=null){var n=e[s];if(n){var{stackedData:i}=n;if(i)return i.find(l=>l.key===r)}}}},bpe=Te([ipe,zx],vpe),jpe=Te([as,jS,xpe,mpe,ppe,gpe,ype,vr,fv,cL,bpe,zx,spe],(e,t,r,s,n,i,l,o,c,u,d,h,f)=>{var{chartData:x,dataStartIndex:p,dataEndIndex:g}=c;if(!(h==null||l==null||t==null||o!=="horizontal"&&o!=="vertical"||r==null||s==null||n==null||i==null||u==null)){var{data:y}=h,v;if(y!=null&&y.length>0?v=y:v=x==null?void 0:x.slice(p,g+1),v!=null)return Gme({layout:o,barSettings:h,pos:l,parentViewBox:t,bandSize:u,xAxis:r,yAxis:s,xAxisTicks:n,yAxisTicks:i,stackedData:d,displayedData:v,offset:e,cells:f,dataStartIndex:p})}}),dL=e=>{var{chartData:t}=e,r=fa(),s=Zs();return m.useEffect(()=>s?()=>{}:(r(wA(t)),()=>{r(wA(void 0))}),[t,r,s]),null},i_={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},uL=Fn({name:"brush",initialState:i_,reducers:{setBrushSettings(e,t){return t.payload==null?i_:t.payload}}}),{setBrushSettings:Cbe}=uL.actions,wpe=uL.reducer;function Npe(e,t,r){return(t=Spe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Spe(e){var t=kpe(e,"string");return typeof t=="symbol"?t:t+""}function kpe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class Zk{static create(t){return new Zk(t)}constructor(t){this.scale=t}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(t){var{bandAware:r,position:s}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t!==void 0){if(s)switch(s){case"start":return this.scale(t);case"middle":{var n=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+n}case"end":{var i=this.bandwidth?this.bandwidth():0;return this.scale(t)+i}default:return this.scale(t)}if(r){var l=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+l}return this.scale(t)}}isInRange(t){var r=this.range(),s=r[0],n=r[r.length-1];return s<=n?t>=s&&t<=n:t>=n&&t<=s}}Npe(Zk,"EPS",1e-4);function Cpe(e){return(e%180+180)%180}var Epe=function(t){var{width:r,height:s}=t,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=Cpe(n),l=i*Math.PI/180,o=Math.atan(s/r),c=l>o&&l<Math.PI-o?s/Math.sin(l):r/Math.cos(l);return Math.abs(c)},Ppe={dots:[],areas:[],lines:[]},hL=Fn({name:"referenceElements",initialState:Ppe,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var r=Vi(e).dots.findIndex(s=>s===t.payload);r!==-1&&e.dots.splice(r,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var r=Vi(e).areas.findIndex(s=>s===t.payload);r!==-1&&e.areas.splice(r,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var r=Vi(e).lines.findIndex(s=>s===t.payload);r!==-1&&e.lines.splice(r,1)}}}),{addDot:Ebe,removeDot:Pbe,addArea:Abe,removeArea:_be,addLine:Tbe,removeLine:Ibe}=hL.actions,Ape=hL.reducer,_pe=m.createContext(void 0),Tpe=e=>{var{children:t}=e,[r]=m.useState("".concat(Af("recharts"),"-clip")),s=Yk();if(s==null)return null;var{x:n,y:i,width:l,height:o}=s;return m.createElement(_pe.Provider,{value:r},m.createElement("defs",null,m.createElement("clipPath",{id:r},m.createElement("rect",{x:n,y:i,height:o,width:l}))),t)};function fL(e,t){if(t<1)return[];if(t===1)return e;for(var r=[],s=0;s<e.length;s+=t)r.push(e[s]);return r}function Ipe(e,t,r){var s={width:e.width+t.width,height:e.height+t.height};return Epe(s,r)}function Ope(e,t,r){var s=r==="width",{x:n,y:i,width:l,height:o}=e;return t===1?{start:s?n:i,end:s?n+l:i+o}:{start:s?n+l:i+o,end:s?n:i}}function Kg(e,t,r,s,n){if(e*t<e*s||e*t>e*n)return!1;var i=r();return e*(t-e*i/2-s)>=0&&e*(t+e*i/2-n)<=0}function Dpe(e,t){return fL(e,t+1)}function Fpe(e,t,r,s,n){for(var i=(s||[]).slice(),{start:l,end:o}=t,c=0,u=1,d=l,h=function(){var p=s==null?void 0:s[c];if(p===void 0)return{v:fL(s,u)};var g=c,y,v=()=>(y===void 0&&(y=r(p,g)),y),j=p.coordinate,b=c===0||Kg(e,j,v,d,o);b||(c=0,d=l,u+=1),b&&(d=j+e*(v()/2+n),c+=u)},f;u<=i.length;)if(f=h(),f)return f.v;return[]}function l_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function $s(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?l_(Object(r),!0).forEach(function(s){Rpe(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l_(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Rpe(e,t,r){return(t=Mpe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Mpe(e){var t=Lpe(e,"string");return typeof t=="symbol"?t:t+""}function Lpe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $pe(e,t,r,s,n){for(var i=(s||[]).slice(),l=i.length,{start:o}=t,{end:c}=t,u=function(f){var x=i[f],p,g=()=>(p===void 0&&(p=r(x,f)),p);if(f===l-1){var y=e*(x.coordinate+e*g()/2-c);i[f]=x=$s($s({},x),{},{tickCoord:y>0?x.coordinate-y*e:x.coordinate})}else i[f]=x=$s($s({},x),{},{tickCoord:x.coordinate});if(x.tickCoord!=null){var v=Kg(e,x.tickCoord,g,o,c);v&&(c=x.tickCoord-e*(g()/2+n),i[f]=$s($s({},x),{},{isShow:!0}))}},d=l-1;d>=0;d--)u(d);return i}function Bpe(e,t,r,s,n,i){var l=(s||[]).slice(),o=l.length,{start:c,end:u}=t;if(i){var d=s[o-1],h=r(d,o-1),f=e*(d.coordinate+e*h/2-u);if(l[o-1]=d=$s($s({},d),{},{tickCoord:f>0?d.coordinate-f*e:d.coordinate}),d.tickCoord!=null){var x=Kg(e,d.tickCoord,()=>h,c,u);x&&(u=d.tickCoord-e*(h/2+n),l[o-1]=$s($s({},d),{},{isShow:!0}))}}for(var p=i?o-1:o,g=function(j){var b=l[j],w,k=()=>(w===void 0&&(w=r(b,j)),w);if(j===0){var N=e*(b.coordinate-e*k()/2-c);l[j]=b=$s($s({},b),{},{tickCoord:N<0?b.coordinate-N*e:b.coordinate})}else l[j]=b=$s($s({},b),{},{tickCoord:b.coordinate});if(b.tickCoord!=null){var S=Kg(e,b.tickCoord,k,c,u);S&&(c=b.tickCoord+e*(k()/2+n),l[j]=$s($s({},b),{},{isShow:!0}))}},y=0;y<p;y++)g(y);return l}function e3(e,t,r){var{tick:s,ticks:n,viewBox:i,minTickGap:l,orientation:o,interval:c,tickFormatter:u,unit:d,angle:h}=e;if(!n||!n.length||!s)return[];if(Et(c)||Nx.isSsr){var f;return(f=Dpe(n,Et(c)?c:0))!==null&&f!==void 0?f:[]}var x=[],p=o==="top"||o==="bottom"?"width":"height",g=d&&p==="width"?Hh(d,{fontSize:t,letterSpacing:r}):{width:0,height:0},y=(b,w)=>{var k=typeof u=="function"?u(b.value,w):b.value;return p==="width"?Ipe(Hh(k,{fontSize:t,letterSpacing:r}),g,h):Hh(k,{fontSize:t,letterSpacing:r})[p]},v=n.length>=2?vs(n[1].coordinate-n[0].coordinate):1,j=Ope(i,v,p);return c==="equidistantPreserveStart"?Fpe(v,j,y,n,l):(c==="preserveStart"||c==="preserveStartEnd"?x=Bpe(v,j,y,n,l,c==="preserveStartEnd"):x=$pe(v,j,y,n,l),x.filter(b=>b.isShow))}var zpe=e=>{var{ticks:t,label:r,labelGapWithTick:s=5,tickSize:n=0,tickMargin:i=0}=e,l=0;if(t){Array.from(t).forEach(d=>{if(d){var h=d.getBoundingClientRect();h.width>l&&(l=h.width)}});var o=r?r.getBoundingClientRect().width:0,c=n+i,u=l+c+o+(r?s:0);return Math.round(u)}return 0},Upe=["axisLine","width","height","className","hide","ticks","axisType"];function Wpe(e,t){if(e==null)return{};var r,s,n=Vpe(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Vpe(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}function Bd(){return Bd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Bd.apply(null,arguments)}function o_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function qa(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?o_(Object(r),!0).forEach(function(s){Hpe(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o_(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Hpe(e,t,r){return(t=qpe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qpe(e){var t=Kpe(e,"string");return typeof t=="symbol"?t:t+""}function Kpe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Xl={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd",zIndex:Qa.axis};function Gpe(e){var{x:t,y:r,width:s,height:n,orientation:i,mirror:l,axisLine:o,otherSvgProps:c}=e;if(!o)return null;var u=qa(qa(qa({},c),Xn(o)),{},{fill:"none"});if(i==="top"||i==="bottom"){var d=+(i==="top"&&!l||i==="bottom"&&l);u=qa(qa({},u),{},{x1:t,y1:r+d*n,x2:t+s,y2:r+d*n})}else{var h=+(i==="left"&&!l||i==="right"&&l);u=qa(qa({},u),{},{x1:t+h*s,y1:r,x2:t+h*s,y2:r+n})}return m.createElement("line",Bd({},u,{className:Ar("recharts-cartesian-axis-line",Fd(o,"className"))}))}function Qpe(e,t,r,s,n,i,l,o,c){var u,d,h,f,x,p,g=o?-1:1,y=e.tickSize||l,v=Et(e.tickCoord)?e.tickCoord:e.coordinate;switch(i){case"top":u=d=e.coordinate,f=r+ +!o*n,h=f-g*y,p=h-g*c,x=v;break;case"left":h=f=e.coordinate,d=t+ +!o*s,u=d-g*y,x=u-g*c,p=v;break;case"right":h=f=e.coordinate,d=t+ +o*s,u=d+g*y,x=u+g*c,p=v;break;default:u=d=e.coordinate,f=r+ +o*n,h=f+g*y,p=h+g*c,x=v;break}return{line:{x1:u,y1:h,x2:d,y2:f},tick:{x,y:p}}}function Xpe(e,t){switch(e){case"left":return t?"start":"end";case"right":return t?"end":"start";default:return"middle"}}function Ype(e,t){switch(e){case"left":case"right":return"middle";case"top":return t?"start":"end";default:return t?"end":"start"}}function Jpe(e){var{option:t,tickProps:r,value:s}=e,n,i=Ar(r.className,"recharts-cartesian-axis-tick-value");if(m.isValidElement(t))n=m.cloneElement(t,qa(qa({},r),{},{className:i}));else if(typeof t=="function")n=t(qa(qa({},r),{},{className:i}));else{var l="recharts-cartesian-axis-tick-value";typeof t!="boolean"&&(l=Ar(l,t==null?void 0:t.className)),n=m.createElement(Sv,Bd({},r,{className:l}),s)}return n}var Zpe=m.forwardRef((e,t)=>{var{ticks:r=[],tick:s,tickLine:n,stroke:i,tickFormatter:l,unit:o,padding:c,tickTextProps:u,orientation:d,mirror:h,x:f,y:x,width:p,height:g,tickSize:y,tickMargin:v,fontSize:j,letterSpacing:b,getTicksConfig:w,events:k,axisType:N}=e,S=e3(qa(qa({},w),{},{ticks:r}),j,b),_=Xpe(d,h),O=Ype(d,h),E=Xn(w),R=Dd(s),C={};typeof n=="object"&&(C=n);var I=qa(qa({},E),{},{fill:"none"},C),ne=S.map(H=>qa({entry:H},Qpe(H,f,x,p,g,d,y,h,v))),W=ne.map(H=>{var{entry:K,line:q}=H;return m.createElement(ws,{className:"recharts-cartesian-axis-tick",key:"tick-".concat(K.value,"-").concat(K.coordinate,"-").concat(K.tickCoord)},n&&m.createElement("line",Bd({},I,q,{className:Ar("recharts-cartesian-axis-tick-line",Fd(n,"className"))})))}),Q=ne.map((H,K)=>{var{entry:q,tick:ge}=H,G=qa(qa(qa(qa({textAnchor:_,verticalAnchor:O},E),{},{stroke:"none",fill:i},R),ge),{},{index:K,payload:q,visibleTicksCount:S.length,tickFormatter:l,padding:c},u);return m.createElement(ws,Bd({className:"recharts-cartesian-axis-tick-label",key:"tick-label-".concat(q.value,"-").concat(q.coordinate,"-").concat(q.tickCoord)},By(k,q,K)),s&&m.createElement(Jpe,{option:s,tickProps:G,value:"".concat(typeof l=="function"?l(q.value,K):q.value).concat(o||"")}))});return m.createElement("g",{className:"recharts-cartesian-axis-ticks recharts-".concat(N,"-ticks")},Q.length>0&&m.createElement(Rn,{zIndex:Qa.label},m.createElement("g",{className:"recharts-cartesian-axis-tick-labels recharts-".concat(N,"-tick-labels"),ref:t},Q)),W.length>0&&m.createElement("g",{className:"recharts-cartesian-axis-tick-lines recharts-".concat(N,"-tick-lines")},W))}),ege=m.forwardRef((e,t)=>{var{axisLine:r,width:s,height:n,className:i,hide:l,ticks:o,axisType:c}=e,u=Wpe(e,Upe),[d,h]=m.useState(""),[f,x]=m.useState(""),p=m.useRef(null);m.useImperativeHandle(t,()=>({getCalculatedWidth:()=>{var y;return zpe({ticks:p.current,label:(y=e.labelRef)===null||y===void 0?void 0:y.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}}));var g=m.useCallback(y=>{if(y){var v=y.getElementsByClassName("recharts-cartesian-axis-tick-value");p.current=v;var j=v[0];if(j){var b=window.getComputedStyle(j),w=b.fontSize,k=b.letterSpacing;(w!==d||k!==f)&&(h(w),x(k))}}},[d,f]);return l||s!=null&&s<=0||n!=null&&n<=0?null:m.createElement(Rn,{zIndex:e.zIndex},m.createElement(ws,{className:Ar("recharts-cartesian-axis",i)},m.createElement(Gpe,{x:e.x,y:e.y,width:s,height:n,orientation:e.orientation,mirror:e.mirror,axisLine:r,otherSvgProps:Xn(e)}),m.createElement(Zpe,{ref:g,axisType:c,events:u,fontSize:d,getTicksConfig:e,height:e.height,letterSpacing:f,mirror:e.mirror,orientation:e.orientation,padding:e.padding,stroke:e.stroke,tick:e.tick,tickFormatter:e.tickFormatter,tickLine:e.tickLine,tickMargin:e.tickMargin,tickSize:e.tickSize,tickTextProps:e.tickTextProps,ticks:o,unit:e.unit,width:e.width,x:e.x,y:e.y}),m.createElement(Che,{x:e.x,y:e.y,width:e.width,height:e.height,lowerWidth:e.width,upperWidth:e.width},m.createElement(Rhe,{label:e.label,labelRef:e.labelRef}),e.children)))}),t3=m.forwardRef((e,t)=>{var r=Ns(e,Xl);return m.createElement(ege,Bd({},r,{ref:t}))});t3.displayName="CartesianAxis";var tge=["x1","y1","x2","y2","key"],rge=["offset"],age=["xAxisId","yAxisId"],sge=["xAxisId","yAxisId"];function c_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function Vs(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?c_(Object(r),!0).forEach(function(s){nge(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c_(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function nge(e,t,r){return(t=ige(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ige(e){var t=lge(e,"string");return typeof t=="symbol"?t:t+""}function lge(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Yc(){return Yc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Yc.apply(null,arguments)}function Gg(e,t){if(e==null)return{};var r,s,n=oge(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function oge(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var cge=e=>{var{fill:t}=e;if(!t||t==="none")return null;var{fillOpacity:r,x:s,y:n,width:i,height:l,ry:o}=e;return m.createElement("rect",{x:s,y:n,ry:o,width:i,height:l,stroke:"none",fill:t,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function xL(e){var{option:t,lineItemProps:r}=e,s;if(m.isValidElement(t))s=m.cloneElement(t,r);else if(typeof t=="function")s=t(r);else{var n,{x1:i,y1:l,x2:o,y2:c,key:u}=r,d=Gg(r,tge),h=(n=Xn(d))!==null&&n!==void 0?n:{},{offset:f}=h,x=Gg(h,rge);s=m.createElement("line",Yc({},x,{x1:i,y1:l,x2:o,y2:c,fill:"none",key:u}))}return s}function dge(e){var{x:t,width:r,horizontal:s=!0,horizontalPoints:n}=e;if(!s||!n||!n.length)return null;var{xAxisId:i,yAxisId:l}=e,o=Gg(e,age),c=n.map((u,d)=>{var h=Vs(Vs({},o),{},{x1:t,y1:u,x2:t+r,y2:u,key:"line-".concat(d),index:d});return m.createElement(xL,{key:"line-".concat(d),option:s,lineItemProps:h})});return m.createElement("g",{className:"recharts-cartesian-grid-horizontal"},c)}function uge(e){var{y:t,height:r,vertical:s=!0,verticalPoints:n}=e;if(!s||!n||!n.length)return null;var{xAxisId:i,yAxisId:l}=e,o=Gg(e,sge),c=n.map((u,d)=>{var h=Vs(Vs({},o),{},{x1:u,y1:t,x2:u,y2:t+r,key:"line-".concat(d),index:d});return m.createElement(xL,{option:s,lineItemProps:h,key:"line-".concat(d)})});return m.createElement("g",{className:"recharts-cartesian-grid-vertical"},c)}function hge(e){var{horizontalFill:t,fillOpacity:r,x:s,y:n,width:i,height:l,horizontalPoints:o,horizontal:c=!0}=e;if(!c||!t||!t.length||o==null)return null;var u=o.map(h=>Math.round(h+n-n)).sort((h,f)=>h-f);n!==u[0]&&u.unshift(0);var d=u.map((h,f)=>{var x=!u[f+1],p=x?n+l-h:u[f+1]-h;if(p<=0)return null;var g=f%t.length;return m.createElement("rect",{key:"react-".concat(f),y:h,x:s,height:p,width:i,stroke:"none",fill:t[g],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return m.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},d)}function fge(e){var{vertical:t=!0,verticalFill:r,fillOpacity:s,x:n,y:i,width:l,height:o,verticalPoints:c}=e;if(!t||!r||!r.length)return null;var u=c.map(h=>Math.round(h+n-n)).sort((h,f)=>h-f);n!==u[0]&&u.unshift(0);var d=u.map((h,f)=>{var x=!u[f+1],p=x?n+l-h:u[f+1]-h;if(p<=0)return null;var g=f%r.length;return m.createElement("rect",{key:"react-".concat(f),x:h,y:i,width:p,height:o,stroke:"none",fill:r[g],fillOpacity:s,className:"recharts-cartesian-grid-bg"})});return m.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},d)}var xge=(e,t)=>{var{xAxis:r,width:s,height:n,offset:i}=e;return zF(e3(Vs(Vs(Vs({},Xl),r),{},{ticks:UF(r),viewBox:{x:0,y:0,width:s,height:n}})),i.left,i.left+i.width,t)},mge=(e,t)=>{var{yAxis:r,width:s,height:n,offset:i}=e;return zF(e3(Vs(Vs(Vs({},Xl),r),{},{ticks:UF(r),viewBox:{x:0,y:0,width:s,height:n}})),i.top,i.top+i.height,t)},pge={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0,syncWithTicks:!1,zIndex:Qa.grid};function Wf(e){var t=eR(),r=tR(),s=ZF(),n=Vs(Vs({},Ns(e,pge)),{},{x:Et(e.x)?e.x:s.left,y:Et(e.y)?e.y:s.top,width:Et(e.width)?e.width:s.width,height:Et(e.height)?e.height:s.height}),{xAxisId:i,yAxisId:l,x:o,y:c,width:u,height:d,syncWithTicks:h,horizontalValues:f,verticalValues:x}=n,p=Zs(),g=St(O=>uA(O,"xAxis",i,p)),y=St(O=>uA(O,"yAxis",l,p));if(!bl(u)||!bl(d)||!Et(o)||!Et(c))return null;var v=n.verticalCoordinatesGenerator||xge,j=n.horizontalCoordinatesGenerator||mge,{horizontalPoints:b,verticalPoints:w}=n;if((!b||!b.length)&&typeof j=="function"){var k=f&&f.length,N=j({yAxis:y?Vs(Vs({},y),{},{ticks:k?f:y.ticks}):void 0,width:t??u,height:r??d,offset:s},k?!0:h);yg(Array.isArray(N),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof N,"]")),Array.isArray(N)&&(b=N)}if((!w||!w.length)&&typeof v=="function"){var S=x&&x.length,_=v({xAxis:g?Vs(Vs({},g),{},{ticks:S?x:g.ticks}):void 0,width:t??u,height:r??d,offset:s},S?!0:h);yg(Array.isArray(_),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof _,"]")),Array.isArray(_)&&(w=_)}return m.createElement(Rn,{zIndex:n.zIndex},m.createElement("g",{className:"recharts-cartesian-grid"},m.createElement(cge,{fill:n.fill,fillOpacity:n.fillOpacity,x:n.x,y:n.y,width:n.width,height:n.height,ry:n.ry}),m.createElement(hge,Yc({},n,{horizontalPoints:b})),m.createElement(fge,Yc({},n,{verticalPoints:w})),m.createElement(dge,Yc({},n,{offset:s,horizontalPoints:b,xAxis:g,yAxis:y})),m.createElement(uge,Yc({},n,{offset:s,verticalPoints:w,xAxis:g,yAxis:y}))))}Wf.displayName="CartesianGrid";var mL=(e,t,r,s)=>bc(e,"xAxis",t,s),pL=(e,t,r,s)=>vc(e,"xAxis",t,s),gL=(e,t,r,s)=>bc(e,"yAxis",r,s),yL=(e,t,r,s)=>vc(e,"yAxis",r,s),gge=Te([vr,mL,gL,pL,yL],(e,t,r,s,n)=>Ac(e,"xAxis")?y0(t,s,!1):y0(r,n,!1)),yge=(e,t,r,s,n)=>n;function vge(e){return e.type==="line"}var bge=Te([vv,yge],(e,t)=>e.filter(vge).find(r=>r.id===t)),jge=Te([vr,mL,gL,pL,yL,bge,gge,fv],(e,t,r,s,n,i,l,o)=>{var{chartData:c,dataStartIndex:u,dataEndIndex:d}=o;if(!(i==null||t==null||r==null||s==null||n==null||s.length===0||n.length===0||l==null||e!=="horizontal"&&e!=="vertical")){var{dataKey:h,data:f}=i,x;if(f!=null&&f.length>0?x=f:x=c==null?void 0:c.slice(u,d+1),x!=null)return Uge({layout:e,xAxis:t,yAxis:r,xAxisTicks:s,yAxisTicks:n,dataKey:h,bandSize:l,displayedData:x})}});function wge(e){var t=Dd(e),r=3,s=2;if(t!=null){var{r:n,strokeWidth:i}=t,l=Number(n),o=Number(i);return(Number.isNaN(l)||l<0)&&(l=r),(Number.isNaN(o)||o<0)&&(o=s),{r:l,strokeWidth:o}}return{r,strokeWidth:s}}var Nge=["id"],Sge=["type","layout","connectNulls","needClip","shape"],kge=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId","id"];function Vf(){return Vf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Vf.apply(null,arguments)}function d_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function ul(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?d_(Object(r),!0).forEach(function(s){Cge(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d_(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Cge(e,t,r){return(t=Ege(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ege(e){var t=Pge(e,"string");return typeof t=="symbol"?t:t+""}function Pge(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function r3(e,t){if(e==null)return{};var r,s,n=Age(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Age(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var _ge=e=>{var{dataKey:t,name:r,stroke:s,legendType:n,hide:i}=e;return[{inactive:i,dataKey:t,type:n,color:s,value:M0(r,t),payload:e}]},Tge=m.memo(e=>{var{dataKey:t,data:r,stroke:s,strokeWidth:n,fill:i,name:l,hide:o,unit:c,tooltipType:u}=e,d={dataDefinedOnItem:r,positions:void 0,settings:{stroke:s,strokeWidth:n,fill:i,dataKey:t,nameKey:void 0,name:M0(l,t),hide:o,type:u,color:s,unit:c}};return m.createElement(Gk,{tooltipEntrySettings:d})}),vL=(e,t)=>"".concat(t,"px ").concat(e-t,"px");function Ige(e,t){for(var r=e.length%2!==0?[...e,0]:e,s=[],n=0;n<t;++n)s=[...s,...r];return s}var Oge=(e,t,r)=>{var s=r.reduce((h,f)=>h+f);if(!s)return vL(t,e);for(var n=Math.floor(e/s),i=e%s,l=t-e,o=[],c=0,u=0;c<r.length;u+=r[c],++c)if(u+r[c]>i){o=[...r.slice(0,c),i-u];break}var d=o.length%2===0?[0,l]:[l];return[...Ige(r,n),...o,...d].map(h=>"".concat(h,"px")).join(", ")};function Dge(e){var{clipPathId:t,points:r,props:s}=e,{dot:n,dataKey:i,needClip:l}=s,{id:o}=s,c=r3(s,Nge),u=Xn(c);return m.createElement(yxe,{points:r,dot:n,className:"recharts-line-dots",dotClassName:"recharts-line-dot",dataKey:i,baseProps:u,needClip:l,clipPathId:t})}function Fge(e){var{showLabels:t,children:r,points:s}=e,n=m.useMemo(()=>s==null?void 0:s.map(i=>{var l,o,c={x:(l=i.x)!==null&&l!==void 0?l:0,y:(o=i.y)!==null&&o!==void 0?o:0,width:0,lowerWidth:0,upperWidth:0,height:0};return ul(ul({},c),{},{value:i.value,payload:i.payload,viewBox:c,parentViewBox:void 0,fill:void 0})}),[s]);return m.createElement(WM,{value:t?n:void 0},r)}function u_(e){var{clipPathId:t,pathRef:r,points:s,strokeDasharray:n,props:i}=e,{type:l,layout:o,connectNulls:c,needClip:u,shape:d}=i,h=r3(i,Sge),f=ul(ul({},fn(h)),{},{fill:"none",className:"recharts-line-curve",clipPath:u?"url(#clipPath-".concat(t,")"):void 0,points:s,type:l,layout:o,connectNulls:c,strokeDasharray:n??i.strokeDasharray});return m.createElement(m.Fragment,null,(s==null?void 0:s.length)>1&&m.createElement(Vk,Vf({shapeType:"curve",option:d},f,{pathRef:r})),m.createElement(Dge,{points:s,clipPathId:t,props:i}))}function Rge(e){try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch{return 0}}function Mge(e){var{clipPathId:t,props:r,pathRef:s,previousPointsRef:n,longestAnimatedLengthRef:i}=e,{points:l,strokeDasharray:o,isAnimationActive:c,animationBegin:u,animationDuration:d,animationEasing:h,animateNewValues:f,width:x,height:p,onAnimationEnd:g,onAnimationStart:y}=r,v=n.current,j=kx(l,"recharts-line-"),b=m.useRef(j),[w,k]=m.useState(!1),N=!w,S=m.useCallback(()=>{typeof g=="function"&&g(),k(!1)},[g]),_=m.useCallback(()=>{typeof y=="function"&&y(),k(!0)},[y]),O=Rge(s.current),E=m.useRef(0);b.current!==j&&(E.current=i.current,b.current=j);var R=E.current;return m.createElement(Fge,{points:l,showLabels:N},r.children,m.createElement(Sx,{animationId:j,begin:u,duration:d,isActive:c,easing:h,onAnimationEnd:S,onAnimationStart:_,key:j},C=>{var I=la(R,O+R,C),ne=Math.min(I,O),W;if(c)if(o){var Q="".concat(o).split(/[,\s]+/gim).map(q=>parseFloat(q));W=Oge(ne,O,Q)}else W=vL(O,ne);else W=o==null?void 0:String(o);if(C>0&&O>0&&(n.current=l,i.current=Math.max(i.current,ne)),v){var H=v.length/l.length,K=C===1?l:l.map((q,ge)=>{var G=Math.floor(ge*H);if(v[G]){var B=v[G];return ul(ul({},q),{},{x:la(B.x,q.x,C),y:la(B.y,q.y,C)})}return f?ul(ul({},q),{},{x:la(x*2,q.x,C),y:la(p/2,q.y,C)}):ul(ul({},q),{},{x:q.x,y:q.y})});return n.current=K,m.createElement(u_,{props:r,points:K,clipPathId:t,pathRef:s,strokeDasharray:W})}return m.createElement(u_,{props:r,points:l,clipPathId:t,pathRef:s,strokeDasharray:W})}),m.createElement(Lk,{label:r.label}))}function Lge(e){var{clipPathId:t,props:r}=e,s=m.useRef(null),n=m.useRef(0),i=m.useRef(null);return m.createElement(Mge,{props:r,clipPathId:t,previousPointsRef:s,longestAnimatedLengthRef:n,pathRef:i})}var $ge=(e,t)=>{var r,s;return{x:(r=e.x)!==null&&r!==void 0?r:void 0,y:(s=e.y)!==null&&s!==void 0?s:void 0,value:e.value,errorVal:Kr(e.payload,t)}};class Bge extends m.Component{render(){var{hide:t,dot:r,points:s,className:n,xAxisId:i,yAxisId:l,top:o,left:c,width:u,height:d,id:h,needClip:f,zIndex:x}=this.props;if(t)return null;var p=Ar("recharts-line",n),g=h,{r:y,strokeWidth:v}=wge(r),j=JM(r),b=y*2+v,w=f?"url(#clipPath-".concat(j?"":"dots-").concat(g,")"):void 0;return m.createElement(Rn,{zIndex:x},m.createElement(ws,{className:p},f&&m.createElement("defs",null,m.createElement(lL,{clipPathId:g,xAxisId:i,yAxisId:l}),!j&&m.createElement("clipPath",{id:"clipPath-dots-".concat(g)},m.createElement("rect",{x:c-b/2,y:o-b/2,width:u+b,height:d+b}))),m.createElement(iL,{xAxisId:i,yAxisId:l,data:s,dataPointFormatter:$ge,errorBarOffset:0},m.createElement(Lge,{props:this.props,clipPathId:g}))),m.createElement(Lxe,{activeDot:this.props.activeDot,points:s,mainColor:this.props.stroke,itemDataKey:this.props.dataKey,clipPath:w}))}}var bL={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:"auto",label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0,zIndex:Qa.line,type:"linear"};function zge(e){var t=Ns(e,bL),{activeDot:r,animateNewValues:s,animationBegin:n,animationDuration:i,animationEasing:l,connectNulls:o,dot:c,hide:u,isAnimationActive:d,label:h,legendType:f,xAxisId:x,yAxisId:p,id:g}=t,y=r3(t,kge),{needClip:v}=Jk(x,p),j=Yk(),b=jx(),w=Zs(),k=St(E=>jge(E,x,p,w,g));if(b!=="horizontal"&&b!=="vertical"||k==null||j==null)return null;var{height:N,width:S,x:_,y:O}=j;return m.createElement(Bge,Vf({},y,{id:g,connectNulls:o,dot:c,activeDot:r,animateNewValues:s,animationBegin:n,animationDuration:i,animationEasing:l,isAnimationActive:d,hide:u,label:h,legendType:f,xAxisId:x,yAxisId:p,points:k,layout:b,height:N,width:S,left:_,top:O,needClip:v}))}function Uge(e){var{layout:t,xAxis:r,yAxis:s,xAxisTicks:n,yAxisTicks:i,dataKey:l,bandSize:o,displayedData:c}=e;return c.map((u,d)=>{var h=Kr(u,l);if(t==="horizontal"){var f=BE({axis:r,ticks:n,bandSize:o,entry:u,index:d}),x=ha(h)?null:s.scale(h);return{x:f,y:x,value:h,payload:u}}var p=ha(h)?null:r.scale(h),g=BE({axis:s,ticks:i,bandSize:o,entry:u,index:d});return p==null||g==null?null:{x:p,y:g,value:h,payload:u}}).filter(Boolean)}function Wge(e){var t=Ns(e,bL),r=Zs();return m.createElement(Qk,{id:t.id,type:"line"},s=>m.createElement(m.Fragment,null,m.createElement(eL,{legendPayload:_ge(t)}),m.createElement(Tge,{dataKey:t.dataKey,data:t.data,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill,name:t.name,hide:t.hide,unit:t.unit,tooltipType:t.tooltipType}),m.createElement(aL,{type:"line",id:s,data:t.data,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,hide:t.hide,isPanorama:r}),m.createElement(zge,Vf({},t,{id:s}))))}var qw=m.memo(Wge,Lv);qw.displayName="Line";var Vge=["domain","range"],Hge=["domain","range"];function h_(e,t){if(e==null)return{};var r,s,n=qge(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function qge(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}function f_(e,t){return e===t?!0:Array.isArray(e)&&e.length===2&&Array.isArray(t)&&t.length===2?e[0]===t[0]&&e[1]===t[1]:!1}function jL(e,t){if(e===t)return!0;var{domain:r,range:s}=e,n=h_(e,Vge),{domain:i,range:l}=t,o=h_(t,Hge);return!f_(r,i)||!f_(s,l)?!1:Lv(n,o)}var Kge=["dangerouslySetInnerHTML","ticks"],Gge=["id"];function Kw(){return Kw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Kw.apply(null,arguments)}function x_(e,t){if(e==null)return{};var r,s,n=Qge(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Qge(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}function Xge(e){var t=fa(),r=m.useRef(null);return m.useLayoutEffect(()=>{r.current===null?t(Nxe(e)):r.current!==e&&t(Sxe({prev:r.current,next:e})),r.current=e},[e,t]),m.useLayoutEffect(()=>()=>{r.current&&(t(kxe(r.current)),r.current=null)},[t]),null}var Yge=e=>{var{xAxisId:t,className:r}=e,s=St(jS),n=Zs(),i="xAxis",l=St(y=>V0(y,i,t,n)),o=St(y=>Z8(y,i,t,n)),c=St(y=>Q8(y,t)),u=St(y=>_de(y,t)),d=St(y=>_8(y,t));if(c==null||u==null||d==null)return null;var{dangerouslySetInnerHTML:h,ticks:f}=e,x=x_(e,Kge),{id:p}=d,g=x_(d,Gge);return m.createElement(t3,Kw({},x,g,{scale:l,x:u.x,y:u.y,width:c.width,height:c.height,className:Ar("recharts-".concat(i," ").concat(i),r),viewBox:s,ticks:o,axisType:i}))},Jge={allowDataOverflow:cs.allowDataOverflow,allowDecimals:cs.allowDecimals,allowDuplicatedCategory:cs.allowDuplicatedCategory,angle:cs.angle,axisLine:Xl.axisLine,height:cs.height,hide:!1,includeHidden:cs.includeHidden,interval:cs.interval,minTickGap:cs.minTickGap,mirror:cs.mirror,orientation:cs.orientation,padding:cs.padding,reversed:cs.reversed,scale:cs.scale,tick:cs.tick,tickCount:cs.tickCount,tickLine:Xl.tickLine,tickSize:Xl.tickSize,type:cs.type,xAxisId:0},Zge=e=>{var t=Ns(e,Jge);return m.createElement(m.Fragment,null,m.createElement(Xge,{allowDataOverflow:t.allowDataOverflow,allowDecimals:t.allowDecimals,allowDuplicatedCategory:t.allowDuplicatedCategory,angle:t.angle,dataKey:t.dataKey,domain:t.domain,height:t.height,hide:t.hide,id:t.xAxisId,includeHidden:t.includeHidden,interval:t.interval,minTickGap:t.minTickGap,mirror:t.mirror,name:t.name,orientation:t.orientation,padding:t.padding,reversed:t.reversed,scale:t.scale,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit}),m.createElement(Yge,t))},N0=m.memo(Zge,jL);N0.displayName="XAxis";var eye=["dangerouslySetInnerHTML","ticks"],tye=["id"];function Gw(){return Gw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Gw.apply(null,arguments)}function m_(e,t){if(e==null)return{};var r,s,n=rye(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function rye(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}function aye(e){var t=fa(),r=m.useRef(null);return m.useLayoutEffect(()=>{r.current===null?t(Cxe(e)):r.current!==e&&t(Exe({prev:r.current,next:e})),r.current=e},[e,t]),m.useLayoutEffect(()=>()=>{r.current&&(t(Pxe(r.current)),r.current=null)},[t]),null}var sye=e=>{var{yAxisId:t,className:r,width:s,label:n}=e,i=m.useRef(null),l=m.useRef(null),o=St(jS),c=Zs(),u=fa(),d="yAxis",h=St(k=>V0(k,d,t,c)),f=St(k=>X8(k,t)),x=St(k=>Ide(k,t)),p=St(k=>Z8(k,d,t,c)),g=St(k=>T8(k,t));if(m.useLayoutEffect(()=>{if(!(s!=="auto"||!f||Mk(n)||m.isValidElement(n)||g==null)){var k=i.current;if(k){var N=k.getCalculatedWidth();Math.round(f.width)!==Math.round(N)&&u(Axe({id:t,width:N}))}}},[p,f,u,n,t,s,g]),f==null||x==null||g==null)return null;var{dangerouslySetInnerHTML:y,ticks:v}=e,j=m_(e,eye),{id:b}=g,w=m_(g,tye);return m.createElement(t3,Gw({},j,w,{ref:i,labelRef:l,scale:h,x:x.x,y:x.y,tickTextProps:s==="auto"?{width:void 0}:{width:s},width:f.width,height:f.height,className:Ar("recharts-".concat(d," ").concat(d),r),viewBox:o,ticks:p,axisType:d}))},nye={allowDataOverflow:ds.allowDataOverflow,allowDecimals:ds.allowDecimals,allowDuplicatedCategory:ds.allowDuplicatedCategory,angle:ds.angle,axisLine:Xl.axisLine,hide:!1,includeHidden:ds.includeHidden,interval:ds.interval,minTickGap:ds.minTickGap,mirror:ds.mirror,orientation:ds.orientation,padding:ds.padding,reversed:ds.reversed,scale:ds.scale,tick:ds.tick,tickCount:ds.tickCount,tickLine:Xl.tickLine,tickSize:Xl.tickSize,type:ds.type,width:ds.width,yAxisId:0},iye=e=>{var t=Ns(e,nye);return m.createElement(m.Fragment,null,m.createElement(aye,{interval:t.interval,id:t.yAxisId,scale:t.scale,type:t.type,domain:t.domain,allowDataOverflow:t.allowDataOverflow,dataKey:t.dataKey,allowDuplicatedCategory:t.allowDuplicatedCategory,allowDecimals:t.allowDecimals,tickCount:t.tickCount,padding:t.padding,includeHidden:t.includeHidden,reversed:t.reversed,ticks:t.ticks,width:t.width,orientation:t.orientation,mirror:t.mirror,hide:t.hide,unit:t.unit,name:t.name,angle:t.angle,minTickGap:t.minTickGap,tick:t.tick,tickFormatter:t.tickFormatter}),m.createElement(sye,t))},S0=m.memo(iye,jL);S0.displayName="YAxis";var lye=(e,t)=>t,a3=Te([lye,vr,P8,ns,mM,ko,Gue,as],t0e),s3=e=>{var t=e.currentTarget.getBoundingClientRect(),r=t.width/e.currentTarget.offsetWidth,s=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/r),chartY:Math.round((e.clientY-t.top)/s)}},wL=bi("mouseClick"),NL=vx();NL.startListening({actionCreator:wL,effect:(e,t)=>{var r=e.payload,s=a3(t.getState(),s3(r));(s==null?void 0:s.activeIndex)!=null&&t.dispatch(qde({activeIndex:s.activeIndex,activeDataKey:void 0,activeCoordinate:s.activeCoordinate}))}});var Qw=bi("mouseMove"),SL=vx(),$m=null;SL.startListening({actionCreator:Qw,effect:(e,t)=>{var r=e.payload;$m!==null&&cancelAnimationFrame($m);var s=s3(r);$m=requestAnimationFrame(()=>{var n=t.getState(),i=kk(n,n.tooltip.settings.shared);if(i==="axis"){var l=a3(n,s);(l==null?void 0:l.activeIndex)!=null?t.dispatch(lM({activeIndex:l.activeIndex,activeDataKey:void 0,activeCoordinate:l.activeCoordinate})):t.dispatch(iM())}$m=null})}});var p_={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index",baseValue:void 0,reverseStackOrder:!1},kL=Fn({name:"rootProps",initialState:p_,reducers:{updateOptions:(e,t)=>{var r;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(r=t.payload.barGap)!==null&&r!==void 0?r:p_.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className,e.baseValue=t.payload.baseValue,e.reverseStackOrder=t.payload.reverseStackOrder}}}),oye=kL.reducer,{updateOptions:cye}=kL.actions,CL=Fn({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(e,t)=>t.payload}}),{updatePolarOptions:dye}=CL.actions,uye=CL.reducer,EL=bi("keyDown"),PL=bi("focus"),n3=vx();n3.startListening({actionCreator:EL,effect:(e,t)=>{var r=t.getState(),s=r.rootProps.accessibilityLayer!==!1;if(s){var{keyboardInteraction:n}=r.tooltip,i=e.payload;if(!(i!=="ArrowRight"&&i!=="ArrowLeft"&&i!=="Enter")){var l=Ck(n,q0(r),Dx(r),Lx(r)),o=l==null?-1:Number(l);if(!(!Number.isFinite(o)||o<0)){var c=ko(r);if(i==="Enter"){var u=$g(r,"axis","hover",String(n.index));t.dispatch($w({active:!n.active,activeIndex:n.index,activeDataKey:n.dataKey,activeCoordinate:u}));return}var d=Rde(r),h=d==="left-to-right"?1:-1,f=i==="ArrowRight"?1:-1,x=o+f*h;if(!(c==null||x>=c.length||x<0)){var p=$g(r,"axis","hover",String(x));t.dispatch($w({active:!0,activeIndex:x.toString(),activeDataKey:void 0,activeCoordinate:p}))}}}}}});n3.startListening({actionCreator:PL,effect:(e,t)=>{var r=t.getState(),s=r.rootProps.accessibilityLayer!==!1;if(s){var{keyboardInteraction:n}=r.tooltip;if(!n.active&&n.index==null){var i="0",l=$g(r,"axis","hover",String(i));t.dispatch($w({activeDataKey:void 0,active:!0,activeIndex:i,activeCoordinate:l}))}}}});var ii=bi("externalEvent"),AL=vx(),h1=new Map;AL.startListening({actionCreator:ii,effect:(e,t)=>{var{handler:r,reactEvent:s}=e.payload;if(r!=null){s.persist();var n=s.type,i=h1.get(n);i!==void 0&&cancelAnimationFrame(i);var l=requestAnimationFrame(()=>{try{var o=t.getState(),c={activeCoordinate:Iue(o),activeDataKey:Tk(o),activeIndex:jc(o),activeLabel:yM(o),activeTooltipIndex:jc(o),isTooltipActive:Oue(o)};r(c,s)}finally{h1.delete(n)}});h1.set(n,l)}}});var hye=Te([H0],e=>e.tooltipItemPayloads),fye=Te([hye,Rx,(e,t,r)=>t,(e,t,r)=>r],(e,t,r,s)=>{var n=e.find(o=>o.settings.dataKey===s);if(n!=null){var{positions:i}=n;if(i!=null){var l=t(i,r);return l}}}),_L=bi("touchMove"),TL=vx();TL.startListening({actionCreator:_L,effect:(e,t)=>{var r=e.payload;if(!(r.touches==null||r.touches.length===0)){var s=t.getState(),n=kk(s,s.tooltip.settings.shared);if(n==="axis"){var i=a3(s,s3({clientX:r.touches[0].clientX,clientY:r.touches[0].clientY,currentTarget:r.currentTarget}));(i==null?void 0:i.activeIndex)!=null&&t.dispatch(lM({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate}))}else if(n==="item"){var l,o=r.touches[0];if(document.elementFromPoint==null)return;var c=document.elementFromPoint(o.clientX,o.clientY);if(!c||!c.getAttribute)return;var u=c.getAttribute(VF),d=(l=c.getAttribute(HF))!==null&&l!==void 0?l:void 0,h=fye(t.getState(),u,d);t.dispatch(nM({activeDataKey:d,activeIndex:u,activeCoordinate:h}))}}}});var xye=hF({brush:wpe,cartesianAxis:_xe,chartData:T0e,errorBars:Xxe,graphicalItems:Rfe,layout:Pse,legend:_ne,options:C0e,polarAxis:Zhe,polarOptions:uye,referenceElements:Ape,rootProps:oye,tooltip:Kde,zIndex:m0e}),mye=function(t){return Zae({reducer:xye,preloadedState:t,middleware:r=>{var s;return r({serializableCheck:!1,immutableCheck:!["commonjs","es6","production"].includes((s="es6")!==null&&s!==void 0?s:"")}).concat([NL.middleware,SL.middleware,n3.middleware,AL.middleware,TL.middleware])},enhancers:r=>{var s=r;return typeof r=="function"&&(s=r()),s.concat(EF({type:"raf"}))},devTools:Nx.devToolsEnabled})};function IL(e){var{preloadedState:t,children:r,reduxStoreName:s}=e,n=Zs(),i=m.useRef(null);if(n)return r;i.current==null&&(i.current=mye(t));var l=dS;return m.createElement(Sme,{context:l,store:i.current},r)}function pye(e){var{layout:t,margin:r}=e,s=fa(),n=Zs();return m.useEffect(()=>{n||(s(kse(t)),s(Sse(r)))},[s,n,t,r]),null}var OL=m.memo(pye,Lv);function DL(e){var t=fa();return m.useEffect(()=>{t(cye(e))},[t,e]),null}function g_(e){var{zIndex:t,isPanorama:r}=e,s=r?"recharts-zindex-panorama-":"recharts-zindex-",n=tL("".concat(s).concat(t)),i=fa();return m.useLayoutEffect(()=>(i(f0e({zIndex:t,elementId:n,isPanorama:r})),()=>{i(x0e({zIndex:t,isPanorama:r}))}),[i,t,n,r]),m.createElement("g",{tabIndex:-1,id:n})}function y_(e){var{children:t,isPanorama:r}=e,s=St(a0e);if(!s||s.length===0)return t;var n=s.filter(l=>l<0),i=s.filter(l=>l>0);return m.createElement(m.Fragment,null,n.map(l=>m.createElement(g_,{key:l,zIndex:l,isPanorama:r})),t,i.map(l=>m.createElement(g_,{key:l,zIndex:l,isPanorama:r})))}var gye=["children"];function yye(e,t){if(e==null)return{};var r,s,n=vye(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function vye(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}function Qg(){return Qg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Qg.apply(null,arguments)}var bye={width:"100%",height:"100%",display:"block"},jye=m.forwardRef((e,t)=>{var r=eR(),s=tR(),n=hR();if(!bl(r)||!bl(s))return null;var{children:i,otherAttributes:l,title:o,desc:c}=e,u,d;return l!=null&&(typeof l.tabIndex=="number"?u=l.tabIndex:u=n?0:void 0,typeof l.role=="string"?d=l.role:d=n?"application":void 0),m.createElement(fD,Qg({},l,{title:o,desc:c,role:d,tabIndex:u,width:r,height:s,style:bye,ref:t}),i)}),wye=e=>{var{children:t}=e,r=St(tv);if(!r)return null;var{width:s,height:n,y:i,x:l}=r;return m.createElement(fD,{width:s,height:n,x:l,y:i},t)},v_=m.forwardRef((e,t)=>{var{children:r}=e,s=yye(e,gye),n=Zs();return n?m.createElement(wye,null,m.createElement(y_,{isPanorama:!0},r)):m.createElement(jye,Qg({ref:t},s),m.createElement(y_,{isPanorama:!1},r))});function Nye(){var e=fa(),[t,r]=m.useState(null),s=St(qse);return m.useEffect(()=>{if(t!=null){var n=t.getBoundingClientRect(),i=n.width/t.offsetWidth;$a(i)&&i!==s&&e(Ese(i))}},[t,e,s]),r}function b_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function Sye(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?b_(Object(r),!0).forEach(function(s){kye(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b_(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function kye(e,t,r){return(t=Cye(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Cye(e){var t=Eye(e,"string");return typeof t=="symbol"?t:t+""}function Eye(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zd(){return zd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},zd.apply(null,arguments)}var Pye=()=>(B0e(),null);function Xg(e){if(typeof e=="number")return e;if(typeof e=="string"){var t=parseFloat(e);if(!Number.isNaN(t))return t}return 0}var Aye=m.forwardRef((e,t)=>{var r,s,n=m.useRef(null),[i,l]=m.useState({containerWidth:Xg((r=e.style)===null||r===void 0?void 0:r.width),containerHeight:Xg((s=e.style)===null||s===void 0?void 0:s.height)}),o=m.useCallback((u,d)=>{l(h=>{var f=Math.round(u),x=Math.round(d);return h.containerWidth===f&&h.containerHeight===x?h:{containerWidth:f,containerHeight:x}})},[]),c=m.useCallback(u=>{if(typeof t=="function"&&t(u),u!=null&&typeof ResizeObserver<"u"){var{width:d,height:h}=u.getBoundingClientRect();o(d,h);var f=p=>{var{width:g,height:y}=p[0].contentRect;o(g,y)},x=new ResizeObserver(f);x.observe(u),n.current=x}},[t,o]);return m.useEffect(()=>()=>{var u=n.current;u!=null&&u.disconnect()},[o]),m.createElement(m.Fragment,null,m.createElement(av,{width:i.containerWidth,height:i.containerHeight}),m.createElement("div",zd({ref:c},e)))}),_ye=m.forwardRef((e,t)=>{var{width:r,height:s}=e,[n,i]=m.useState({containerWidth:Xg(r),containerHeight:Xg(s)}),l=m.useCallback((c,u)=>{i(d=>{var h=Math.round(c),f=Math.round(u);return d.containerWidth===h&&d.containerHeight===f?d:{containerWidth:h,containerHeight:f}})},[]),o=m.useCallback(c=>{if(typeof t=="function"&&t(c),c!=null){var{width:u,height:d}=c.getBoundingClientRect();l(u,d)}},[t,l]);return m.createElement(m.Fragment,null,m.createElement(av,{width:n.containerWidth,height:n.containerHeight}),m.createElement("div",zd({ref:o},e)))}),Tye=m.forwardRef((e,t)=>{var{width:r,height:s}=e;return m.createElement(m.Fragment,null,m.createElement(av,{width:r,height:s}),m.createElement("div",zd({ref:t},e)))}),Iye=m.forwardRef((e,t)=>{var{width:r,height:s}=e;return io(r)||io(s)?m.createElement(_ye,zd({},e,{ref:t})):m.createElement(Tye,zd({},e,{ref:t}))});function Oye(e){return e===!0?Aye:Iye}var Dye=m.forwardRef((e,t)=>{var{children:r,className:s,height:n,onClick:i,onContextMenu:l,onDoubleClick:o,onMouseDown:c,onMouseEnter:u,onMouseLeave:d,onMouseMove:h,onMouseUp:f,onTouchEnd:x,onTouchMove:p,onTouchStart:g,style:y,width:v,responsive:j,dispatchTouchEvents:b=!0}=e,w=m.useRef(null),k=fa(),[N,S]=m.useState(null),[_,O]=m.useState(null),E=Nye(),R=wS(),C=(R==null?void 0:R.width)>0?R.width:v,I=(R==null?void 0:R.height)>0?R.height:n,ne=m.useCallback(z=>{E(z),typeof t=="function"&&t(z),S(z),O(z),z!=null&&(w.current=z)},[E,t,S,O]),W=m.useCallback(z=>{k(wL(z)),k(ii({handler:i,reactEvent:z}))},[k,i]),Q=m.useCallback(z=>{k(Qw(z)),k(ii({handler:u,reactEvent:z}))},[k,u]),H=m.useCallback(z=>{k(iM()),k(ii({handler:d,reactEvent:z}))},[k,d]),K=m.useCallback(z=>{k(Qw(z)),k(ii({handler:h,reactEvent:z}))},[k,h]),q=m.useCallback(()=>{k(PL())},[k]),ge=m.useCallback(z=>{k(EL(z.key))},[k]),G=m.useCallback(z=>{k(ii({handler:l,reactEvent:z}))},[k,l]),B=m.useCallback(z=>{k(ii({handler:o,reactEvent:z}))},[k,o]),se=m.useCallback(z=>{k(ii({handler:c,reactEvent:z}))},[k,c]),L=m.useCallback(z=>{k(ii({handler:f,reactEvent:z}))},[k,f]),Z=m.useCallback(z=>{k(ii({handler:g,reactEvent:z}))},[k,g]),F=m.useCallback(z=>{b&&k(_L(z)),k(ii({handler:p,reactEvent:z}))},[k,b,p]),he=m.useCallback(z=>{k(ii({handler:x,reactEvent:z}))},[k,x]),ye=Oye(j);return m.createElement(kM.Provider,{value:N},m.createElement(Kte.Provider,{value:_},m.createElement(ye,{width:C??(y==null?void 0:y.width),height:I??(y==null?void 0:y.height),className:Ar("recharts-wrapper",s),style:Sye({position:"relative",cursor:"default",width:C,height:I},y),onClick:W,onContextMenu:G,onDoubleClick:B,onFocus:q,onKeyDown:ge,onMouseDown:se,onMouseEnter:Q,onMouseLeave:H,onMouseMove:K,onMouseUp:L,onTouchEnd:he,onTouchMove:F,onTouchStart:Z,ref:ne},m.createElement(Pye,null),r)))}),Fye=["width","height","responsive","children","className","style","compact","title","desc"];function Rye(e,t){if(e==null)return{};var r,s,n=Mye(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Mye(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var FL=m.forwardRef((e,t)=>{var{width:r,height:s,responsive:n,children:i,className:l,style:o,compact:c,title:u,desc:d}=e,h=Rye(e,Fye),f=Xn(h);return c?m.createElement(m.Fragment,null,m.createElement(av,{width:r,height:s}),m.createElement(v_,{otherAttributes:f,title:u,desc:d},i)):m.createElement(Dye,{className:l,style:o,width:r,height:s,responsive:n??!1,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},m.createElement(v_,{otherAttributes:f,title:u,desc:d,ref:t},m.createElement(Tpe,null,i)))});function Xw(){return Xw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Xw.apply(null,arguments)}var Lye={top:5,right:5,bottom:5,left:5},$ye={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,layout:"horizontal",margin:Lye,responsive:!1,reverseStackOrder:!1,stackOffset:"none",syncMethod:"index"},RL=m.forwardRef(function(t,r){var s,n=Ns(t.categoricalChartProps,$ye),{chartName:i,defaultTooltipEventType:l,validateTooltipEventTypes:o,tooltipPayloadSearcher:c,categoricalChartProps:u}=t,d={chartName:i,defaultTooltipEventType:l,validateTooltipEventTypes:o,tooltipPayloadSearcher:c,eventEmitter:void 0};return m.createElement(IL,{preloadedState:{options:d},reduxStoreName:(s=u.id)!==null&&s!==void 0?s:i},m.createElement(dL,{chartData:u.data}),m.createElement(OL,{layout:n.layout,margin:n.margin}),m.createElement(DL,{baseValue:n.baseValue,accessibilityLayer:n.accessibilityLayer,barCategoryGap:n.barCategoryGap,maxBarSize:n.maxBarSize,stackOffset:n.stackOffset,barGap:n.barGap,barSize:n.barSize,syncId:n.syncId,syncMethod:n.syncMethod,className:n.className,reverseStackOrder:n.reverseStackOrder}),m.createElement(FL,Xw({},n,{ref:r})))}),Bye=["axis"],j_=m.forwardRef((e,t)=>m.createElement(RL,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:Bye,tooltipPayloadSearcher:Rk,categoricalChartProps:e,ref:t})),zye=["axis","item"],Yw=m.forwardRef((e,t)=>m.createElement(RL,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:zye,tooltipPayloadSearcher:Rk,categoricalChartProps:e,ref:t}));function Uye(e){var t=fa();return m.useEffect(()=>{t(dye(e))},[t,e]),null}var Wye=["layout"];function Jw(){return Jw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)({}).hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Jw.apply(null,arguments)}function Vye(e,t){if(e==null)return{};var r,s,n=Hye(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Hye(e,t){if(e==null)return{};var r={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;r[s]=e[s]}return r}var qye={top:5,right:5,bottom:5,left:5},ML={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:qye,reverseStackOrder:!1,syncMethod:"index",layout:"radial",responsive:!1,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},Kye=m.forwardRef(function(t,r){var s,n=Ns(t.categoricalChartProps,ML),{layout:i}=n,l=Vye(n,Wye),{chartName:o,defaultTooltipEventType:c,validateTooltipEventTypes:u,tooltipPayloadSearcher:d}=t,h={chartName:o,defaultTooltipEventType:c,validateTooltipEventTypes:u,tooltipPayloadSearcher:d,eventEmitter:void 0};return m.createElement(IL,{preloadedState:{options:h},reduxStoreName:(s=n.id)!==null&&s!==void 0?s:o},m.createElement(dL,{chartData:n.data}),m.createElement(OL,{layout:i,margin:n.margin}),m.createElement(DL,{baseValue:void 0,accessibilityLayer:n.accessibilityLayer,barCategoryGap:n.barCategoryGap,maxBarSize:n.maxBarSize,stackOffset:n.stackOffset,barGap:n.barGap,barSize:n.barSize,syncId:n.syncId,syncMethod:n.syncMethod,className:n.className,reverseStackOrder:n.reverseStackOrder}),m.createElement(Uye,{cx:n.cx,cy:n.cy,startAngle:n.startAngle,endAngle:n.endAngle,innerRadius:n.innerRadius,outerRadius:n.outerRadius}),m.createElement(FL,Jw({},l,{ref:r})))});function w_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,s)}return r}function N_(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?w_(Object(r),!0).forEach(function(s){Gye(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):w_(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Gye(e,t,r){return(t=Qye(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Qye(e){var t=Xye(e,"string");return typeof t=="symbol"?t:t+""}function Xye(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Yye=["item"],Jye=N_(N_({},ML),{},{layout:"centric",startAngle:0,endAngle:360}),LL=m.forwardRef((e,t)=>{var r=Ns(e,Jye);return m.createElement(Kye,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:Yye,tooltipPayloadSearcher:Rk,categoricalChartProps:r,ref:t})});function qr({permission:e,children:t,fallback:r=null,requireAll:s=!1}){const{hasAllPermissions:n,hasAnyPermission:i,isCompanyAdmin:l}=Ny();if(l)return a.jsx(a.Fragment,{children:t});const o=Array.isArray(e)?e:[e];return(s?n(o):i(o))?a.jsx(a.Fragment,{children:t}):a.jsx(a.Fragment,{children:r})}function Zye(){const[e,t]=m.useState([]),[r,s]=m.useState([]),[n,i]=m.useState([]),[l,o]=m.useState([]),[c,u]=m.useState([]),[d,h]=m.useState(!0),[f,x]=m.useState(!1),[p,g]=m.useState(""),[y,v]=m.useState(""),[j,b]=m.useState(!1),[w,k]=m.useState(!1),[N,S]=m.useState(!1),[_,O]=m.useState(!1),[E,R]=m.useState(!1),[C,I]=m.useState(null),[ne,W]=m.useState([]),[Q,H]=m.useState(!1),[K,q]=m.useState(!1),[ge,G]=m.useState(null),[B,se]=m.useState(!1),[L,Z]=m.useState(!1),[F,he]=m.useState(null),[ye,z]=m.useState([]),[A,de]=m.useState(null),[D,ze]=m.useState(null),[Fe,ct]=m.useState(!1),[$e,We]=m.useState({showSummary:!0,showPricing:!0,showInventory:!0,showCostTimeline:!0,showSalesHistory:!0}),Bt=m.useRef(null),[Ee,it]=m.useState({sku:"",barcode:"",boxBarcode:"",name:"",nameAr:"",description:"",categoryId:"",baseUnit:"Piece",secondUnit:"",unitsPerSecond:0,currency:"USD",defaultWarehouseId:"",retailPrice:0,wholesalePrice:0,superWholesalePrice:0,costPrice:0,boxRetailPrice:0,boxWholesalePrice:0,boxSuperWholesalePrice:0,boxCostPrice:0,lowStockAlert:10,lowStockAlertBox:0,isActive:!0,showInOnlineShop:!1,imageUrl:"",color:"",size:"",weight:"",length:"",height:"",initialQuantity:0,initialQuantityBox:0,initialWarehouseId:""}),[we,et]=m.useState(!1),[Ge,Nt]=m.useState(null),[Rt,pr]=m.useState("add"),[Zt,er]=m.useState(""),[ue,Le]=m.useState(""),[Je,Xe]=m.useState(""),[le,Me]=m.useState(""),[ut,ee]=m.useState(!1),[ve,xe]=m.useState([]),[oe,Ie]=m.useState(""),[me,ht]=m.useState(!1),At=async T=>{if(Nt(T),pr("add"),er(""),Le(""),Xe(n.length===1?n[0].id:""),Me(""),Ie(""),xe([]),et(!0),T.variants&&T.variants.length>0){ht(!0);try{const Ae=await br.getVariants(T.id);xe(Ae.data)}catch{}finally{ht(!1)}}},Er=async()=>{var T,Ae;if(!(!Ge||!Je||!Zt)){ee(!0);try{await br.adjustStock({productId:Ge.id,warehouseId:Je,variantId:oe!==""?oe:null,adjustmentType:Rt,baseUnitQuantity:parseFloat(Zt)||0,secondUnitQuantity:ue?parseFloat(ue):null,reason:le||null}),et(!1),qt()}catch(nt){alert(((Ae=(T=nt.response)==null?void 0:T.data)==null?void 0:Ae.message)||"Failed to adjust stock")}finally{ee(!1)}}},[or,Gt]=m.useState(!1),[zt,ma]=m.useState(null),[Or,_r]=m.useState([]),[Is,Jr]=m.useState(!1),[na,Os]=m.useState(!1),[gr,V]=m.useState(null),[J,X]=m.useState({name:"",sku:"",barcode:"",retailPrice:"",wholesalePrice:"",costPrice:"",boxRetailPrice:"",boxWholesalePrice:"",boxCostPrice:"",color:"",size:"",weight:"",length:"",height:"",quantity:"",isActive:!0}),te=async T=>{ma(T),_r(T.variants||[]),Gt(!0),V(null),re(),Jr(!0);try{const Ae=await br.getVariants(T.id);_r(Ae.data)}catch(Ae){console.error("Failed to load variants:",Ae)}finally{Jr(!1)}},re=()=>{X({name:"",sku:"",barcode:"",retailPrice:"",wholesalePrice:"",costPrice:"",boxRetailPrice:"",boxWholesalePrice:"",boxCostPrice:"",color:"",size:"",weight:"",length:"",height:"",quantity:"",isActive:!0}),V(null)},ae=T=>{var Ae,nt,Pt,fr,Dt,ls,Pl,Yi,ga,za;V(T),X({name:T.name,sku:T.sku||"",barcode:T.barcode||"",retailPrice:((Ae=T.retailPrice)==null?void 0:Ae.toString())||"",wholesalePrice:((nt=T.wholesalePrice)==null?void 0:nt.toString())||"",costPrice:((Pt=T.costPrice)==null?void 0:Pt.toString())||"",boxRetailPrice:((fr=T.boxRetailPrice)==null?void 0:fr.toString())||"",boxWholesalePrice:((Dt=T.boxWholesalePrice)==null?void 0:Dt.toString())||"",boxCostPrice:((ls=T.boxCostPrice)==null?void 0:ls.toString())||"",color:T.color||"",size:T.size||"",weight:((Pl=T.weight)==null?void 0:Pl.toString())||"",length:((Yi=T.length)==null?void 0:Yi.toString())||"",height:((ga=T.height)==null?void 0:ga.toString())||"",quantity:((za=T.quantity)==null?void 0:za.toString())||"",isActive:T.isActive})},Ne=async()=>{var T,Ae;if(zt){Os(!0);try{const nt={name:zt.name,sku:J.sku||null,barcode:J.barcode||null,retailPrice:J.retailPrice?parseFloat(J.retailPrice):null,wholesalePrice:J.wholesalePrice?parseFloat(J.wholesalePrice):null,costPrice:J.costPrice?parseFloat(J.costPrice):null,boxRetailPrice:J.boxRetailPrice?parseFloat(J.boxRetailPrice):null,boxWholesalePrice:J.boxWholesalePrice?parseFloat(J.boxWholesalePrice):null,boxCostPrice:J.boxCostPrice?parseFloat(J.boxCostPrice):null,color:J.color||null,size:J.size||null,weight:J.weight?parseFloat(J.weight):null,length:J.length?parseFloat(J.length):null,height:J.height?parseFloat(J.height):null,quantity:J.quantity?parseFloat(J.quantity):0,isActive:J.isActive};gr?await br.updateVariant(zt.id,gr.id,nt):await br.createVariant(zt.id,nt);const Pt=await br.getVariants(zt.id);_r(Pt.data),re(),qt()}catch(nt){alert(((Ae=(T=nt.response)==null?void 0:T.data)==null?void 0:Ae.message)||"Failed to save variant")}finally{Os(!1)}}},Be=async T=>{var Ae,nt;if(!(!zt||!confirm("Delete this variant?")))try{await br.deleteVariant(zt.id,T);const Pt=await br.getVariants(zt.id);_r(Pt.data),qt()}catch(Pt){alert(((nt=(Ae=Pt.response)==null?void 0:Ae.data)==null?void 0:nt.message)||"Failed to delete variant")}},[Se,Pe]=m.useState(!1),pe=m.useRef(null),qe=async T=>{const Ae="dcdyqjuiv",nt="Catalyst_unsigned",Pt=new FormData;Pt.append("file",T),Pt.append("upload_preset",nt),Pt.append("folder","Catalyst/products");try{const Dt=await(await fetch(`https://api.cloudinary.com/v1_1/${Ae}/image/upload`,{method:"POST",body:Pt})).json();return Dt.secure_url?Dt.secure_url:null}catch(fr){return console.error("Image upload failed:",fr),null}},lt=async T=>{var Pt;const Ae=(Pt=T.target.files)==null?void 0:Pt[0];if(!Ae)return;if(!Ae.type.startsWith("image/")){alert("Please select an image file");return}if(Ae.size>5*1024*1024){alert("Image size must be less than 5MB");return}Pe(!0);const nt=await qe(Ae);Pe(!1),nt?it(fr=>({...fr,imageUrl:nt})):alert("Failed to upload image. Please try again.")},[ft,Ze]=m.useState(!1),[dt,Ot]=m.useState(""),[Y,De]=m.useState(!1),[at,st]=m.useState(""),[Mt,Lt]=m.useState(!1),[pt,Ut]=m.useState("new");m.useEffect(()=>{qt()},[]);const qt=async()=>{try{h(!0);const[T,Ae,nt,Pt,fr]=await Promise.all([br.getAll(),il.getAll(),Ks.getAll(),ku.getAll({activeOnly:!0}),Kc.getAll()]);t(T.data),s(Ae.data||[]),i(nt.data||[]),o(Pt.data||[]),u(fr.data||[])}catch(T){console.error("Failed to load products:",T)}finally{h(!1)}},Ca=e.filter(T=>{var Pt,fr;const Ae=!p||T.name.toLowerCase().includes(p.toLowerCase())||T.sku.toLowerCase().includes(p.toLowerCase())||((Pt=T.barcode)==null?void 0:Pt.toLowerCase().includes(p.toLowerCase())),nt=!y||((fr=T.defaultWarehouseId)==null?void 0:fr.toString())===y;return Ae&&nt}),nr={total:e.length,active:e.filter(T=>T.isActive).length,lowStock:0},Ea=()=>{const T="200",Ae=Math.floor(Math.random()*1e9).toString().padStart(9,"0"),nt=T+Ae;let Pt=0;for(let Dt=0;Dt<12;Dt++)Pt+=parseInt(nt[Dt])*(Dt%2===0?1:3);const fr=(10-Pt%10)%10;return nt+fr},Dr=()=>{it({sku:"",barcode:"",boxBarcode:"",name:"",nameAr:"",description:"",categoryId:"",baseUnit:"Piece",secondUnit:"",unitsPerSecond:0,currency:"USD",defaultWarehouseId:"",retailPrice:0,wholesalePrice:0,superWholesalePrice:0,costPrice:0,boxRetailPrice:0,boxWholesalePrice:0,boxSuperWholesalePrice:0,boxCostPrice:0,lowStockAlert:10,lowStockAlertBox:0,isActive:!0,showInOnlineShop:!1,imageUrl:"",color:"",size:"",weight:"",length:"",height:"",initialQuantity:0,initialQuantityBox:0,initialWarehouseId:""}),S(!1),O(!1)},Ds=()=>{Dr(),st(""),Lt(!0),Ut("new"),b(!0)},Ue=T=>{if(st(T),!T.trim())return;const Ae=e.find(nt=>nt.barcode===T||nt.boxBarcode===T||nt.sku.toLowerCase()===T.toLowerCase());Ae&&(M(Ae),I(Ae),Ut("existing"))},M=T=>{var Ae,nt,Pt,fr,Dt,ls;it({sku:T.sku||"",barcode:T.barcode||"",boxBarcode:T.boxBarcode||"",name:T.name,nameAr:T.nameAr||"",description:T.description||"",categoryId:((Ae=T.categoryId)==null?void 0:Ae.toString())||"",baseUnit:T.baseUnit||"Piece",secondUnit:T.secondUnit||"",unitsPerSecond:T.unitsPerSecond||0,currency:T.currency||"USD",defaultWarehouseId:((nt=T.defaultWarehouseId)==null?void 0:nt.toString())||"",retailPrice:T.retailPrice||0,wholesalePrice:T.wholesalePrice||0,superWholesalePrice:T.superWholesalePrice||0,costPrice:T.costPrice||0,boxRetailPrice:T.boxRetailPrice||0,boxWholesalePrice:T.boxWholesalePrice||0,boxSuperWholesalePrice:T.boxSuperWholesalePrice||0,boxCostPrice:T.boxCostPrice||0,lowStockAlert:T.lowStockAlert||10,lowStockAlertBox:T.lowStockAlertBox||0,isActive:T.isActive,showInOnlineShop:T.showInOnlineShop||!1,imageUrl:T.imageUrl||"",color:T.color||"",size:T.size||"",weight:((Pt=T.weight)==null?void 0:Pt.toString())||"",length:((fr=T.length)==null?void 0:fr.toString())||"",height:((Dt=T.height)==null?void 0:Dt.toString())||"",initialQuantity:0,initialQuantityBox:0,initialWarehouseId:((ls=T.defaultWarehouseId)==null?void 0:ls.toString())||""}),S(!0),O(!!(T.secondUnit&&T.secondUnit.trim()!==""&&T.unitsPerSecond>0))},je=T=>{const Ae=e.find(nt=>nt.id===T);Ae&&(M(Ae),I(Ae),Ut("existing"),Lt(!1),b(!1),k(!0))},fe=()=>{Dr(),I(null),Ut("new"),Lt(!1)},Ce=e.filter(T=>{var nt,Pt;if(!at.trim())return!0;const Ae=at.toLowerCase();return T.name.toLowerCase().includes(Ae)||T.sku.toLowerCase().includes(Ae)||((nt=T.barcode)==null?void 0:nt.toLowerCase().includes(Ae))||((Pt=T.boxBarcode)==null?void 0:Pt.toLowerCase().includes(Ae))}),Qe=async T=>{var Ae,nt;if(T.preventDefault(),Ee.initialQuantity>0&&!Ee.initialWarehouseId){alert("Please select a warehouse for the initial inventory");return}x(!0);try{await br.create({...Ee,categoryId:Ee.categoryId?parseInt(Ee.categoryId):null,defaultWarehouseId:Ee.defaultWarehouseId?parseInt(Ee.defaultWarehouseId):null,initialQuantity:Ee.initialQuantity||0,initialWarehouseId:Ee.initialWarehouseId?parseInt(Ee.initialWarehouseId):null,weight:Ee.weight?parseFloat(Ee.weight):null,length:Ee.length?parseFloat(Ee.length):null,height:Ee.height?parseFloat(Ee.height):null}),b(!1),Dr(),qt()}catch(Pt){alert(((nt=(Ae=Pt.response)==null?void 0:Ae.data)==null?void 0:nt.message)||"Failed to create product")}finally{x(!1)}},_e=async T=>{var Pt,fr,Dt,ls,Pl,Yi,ga;I(T);const Ae=!!(T.secondUnit&&T.secondUnit.trim()!==""&&T.unitsPerSecond>0);O(Ae);let nt=0;if(T.defaultWarehouseId)try{const ru=(Pt=(await br.getInventory(T.id)).data.warehouseInventory)==null?void 0:Pt.find(ki=>ki.warehouseId===T.defaultWarehouseId);ru&&(nt=ru.quantity)}catch{}it({sku:T.sku,barcode:T.barcode||"",boxBarcode:T.boxBarcode||"",name:T.name,nameAr:T.nameAr||"",description:T.description||"",categoryId:((fr=T.categoryId)==null?void 0:fr.toString())||"",baseUnit:T.baseUnit||"Piece",secondUnit:T.secondUnit||"",unitsPerSecond:T.unitsPerSecond||0,currency:T.currency||"USD",defaultWarehouseId:((Dt=T.defaultWarehouseId)==null?void 0:Dt.toString())||"",retailPrice:T.retailPrice,wholesalePrice:T.wholesalePrice,superWholesalePrice:T.superWholesalePrice,costPrice:T.costPrice,boxRetailPrice:T.boxRetailPrice,boxWholesalePrice:T.boxWholesalePrice,boxSuperWholesalePrice:T.boxSuperWholesalePrice,boxCostPrice:T.boxCostPrice,lowStockAlert:T.lowStockAlert,lowStockAlertBox:T.lowStockAlertBox||0,isActive:T.isActive,showInOnlineShop:T.showInOnlineShop||!1,imageUrl:T.imageUrl||"",color:T.color||"",size:T.size||"",weight:((ls=T.weight)==null?void 0:ls.toString())||"",length:((Pl=T.length)==null?void 0:Pl.toString())||"",height:((Yi=T.height)==null?void 0:Yi.toString())||"",initialQuantity:nt,initialQuantityBox:T.unitsPerSecond&&T.unitsPerSecond>0?Math.floor(nt/T.unitsPerSecond):0,initialWarehouseId:((ga=T.defaultWarehouseId)==null?void 0:ga.toString())||""}),k(!0)},Vt=async T=>{var Ae,nt;if(T.preventDefault(),!!C){x(!0);try{await br.update(C.id,{...Ee,categoryId:Ee.categoryId?parseInt(Ee.categoryId):null,defaultWarehouseId:Ee.defaultWarehouseId?parseInt(Ee.defaultWarehouseId):null,initialWarehouseId:Ee.initialWarehouseId?parseInt(Ee.initialWarehouseId):null,weight:Ee.weight?parseFloat(Ee.weight):null,length:Ee.length?parseFloat(Ee.length):null,height:Ee.height?parseFloat(Ee.height):null}),k(!1),qt()}catch(Pt){alert(((nt=(Ae=Pt.response)==null?void 0:Ae.data)==null?void 0:nt.message)||"Failed to update product")}finally{x(!1)}}},Qt=async T=>{var Ae,nt;if(confirm("Are you sure you want to delete this product?"))try{await br.delete(T),qt()}catch(Pt){alert(((nt=(Ae=Pt.response)==null?void 0:Ae.data)==null?void 0:nt.message)||"Failed to delete product")}},U=async T=>{I(T),R(!0),H(!0);try{const Ae=await br.getCostHistory(T.id);W(Ae.data)}catch(Ae){console.error("Failed to load cost history:",Ae),W([])}finally{H(!1)}},Ke=async T=>{I(T),q(!0),se(!0);try{const Ae=await br.getInventory(T.id);G(Ae.data)}catch(Ae){console.error("Failed to load inventory:",Ae),G(null)}finally{se(!1)}},rt=()=>{if(ne.length===0)return null;const T=ne.map(Dt=>Dt.cost),Ae=Math.min(...T),nt=Math.max(...T),Pt=nt-Ae,fr=Ae>0?(Pt/Ae*100).toFixed(1):"0";return{minCost:Ae,maxCost:nt,increase:Pt,increasePercent:fr}},_t=async()=>{var T,Ae;if(dt.trim()){De(!0);try{const Pt=(await il.create({name:dt.trim()})).data;s([...r,Pt]),it({...Ee,categoryId:Pt.id.toString()}),Ot(""),Ze(!1)}catch(nt){alert(((Ae=(T=nt.response)==null?void 0:T.data)==null?void 0:Ae.message)||"Failed to create category")}finally{De(!1)}}},Fr=async T=>{he(T),Z(!0),ct(!0);try{const Ae=await br.getCostHistory(T.id);z(Ae.data||[])}catch(Ae){console.error("Failed to load cost history:",Ae),z([])}try{const Ae=await br.getInventory(T.id);de(Ae.data||null)}catch(Ae){console.error("Failed to load inventory:",Ae),de(null)}try{const Ae=await ie.get(`/reports/product-sales/${T.id}`);ze(Ae.data||null)}catch(Ae){console.error("Failed to load sales data:",Ae),ze(null)}ct(!1)},Xt=(T,Ae)=>`${Ae||""} ${T.toFixed(3)}`.trim(),Rr=T=>new Date(T).toLocaleDateString(),Yt=()=>{if(!F)return;const T=ye.length>0?{minCost:Math.min(...ye.map(Dt=>Dt.cost)),maxCost:Math.max(...ye.map(Dt=>Dt.cost)),currentCost:F.costPrice}:null,Ae=window.open("","_blank","width=1000,height=800");if(!Ae){alert("Please allow popups to print report");return}const nt=ye.length>0?ye.map((Dt,ls)=>({x:ls/Math.max(ye.length-1,1)*100,y:T?100-(Dt.cost-T.minCost)/Math.max(T.maxCost-T.minCost,1)*80:50,cost:Dt.cost,date:Rr(Dt.recordedDate)})):[],Pt=nt.length>1?nt.map((Dt,ls)=>`${ls===0?"M":"L"} ${Dt.x*4} ${Dt.y}`).join(" "):"",fr=`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Product Report - ${F.name}</title>
        <style>
          * { margin: 0; padding: 0; box-sizing: border-box; }
          body { font-family: Arial, sans-serif; font-size: 12px; padding: 20px; }
          .header { text-align: center; margin-bottom: 20px; border-bottom: 2px solid #333; padding-bottom: 10px; }
          .header h1 { font-size: 24px; margin-bottom: 5px; }
          .header p { color: #666; }
          .product-info { background: #f5f5f5; padding: 15px; border-radius: 8px; margin-bottom: 20px; }
          .product-info h2 { font-size: 18px; margin-bottom: 10px; }
          .product-info .grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; }
          .product-info .label { font-size: 10px; color: #666; text-transform: uppercase; }
          .product-info .value { font-weight: bold; }
          .summary-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-bottom: 20px; }
          .summary-card { border: 1px solid #ddd; padding: 12px; border-radius: 5px; text-align: center; }
          .summary-card .label { font-size: 10px; color: #666; text-transform: uppercase; }
          .summary-card .value { font-size: 20px; font-weight: bold; margin-top: 5px; }
          .summary-card .value.green { color: #22c55e; }
          .summary-card .value.red { color: #ef4444; }
          .summary-card .value.blue { color: #3b82f6; }
          .section { margin-bottom: 20px; }
          .section h2 { font-size: 16px; margin-bottom: 10px; border-bottom: 1px solid #ddd; padding-bottom: 5px; }
          table { width: 100%; border-collapse: collapse; margin-bottom: 15px; }
          th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
          th { background: #f5f5f5; font-weight: bold; }
          .text-right { text-align: right; }
          .text-center { text-align: center; }
          .pricing-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; margin-bottom: 20px; }
          .pricing-card { border: 1px solid #ddd; border-radius: 8px; overflow: hidden; }
          .pricing-card h3 { background: #f5f5f5; padding: 10px; font-size: 14px; }
          .pricing-card .prices { padding: 15px; }
          .pricing-card .price-row { display: flex; justify-content: space-between; padding: 5px 0; border-bottom: 1px dashed #eee; }
          .chart-container { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 8px; }
          .chart-container h3 { margin-bottom: 15px; }
          .chart { height: 150px; position: relative; }
          .footer { text-align: center; margin-top: 20px; padding-top: 10px; border-top: 1px solid #ddd; color: #666; font-size: 10px; }
          @media print { body { padding: 0; } }
        </style>
      </head>
      <body>
        <div class="header">
          <h1>Product Report</h1>
          <p>Generated: ${new Date().toLocaleString()}</p>
        </div>
        
        <div class="product-info">
          <h2>${F.name}</h2>
          <div class="grid">
            <div class="item">
              <div class="label">Product Code</div>
              <div class="value">${F.sku}</div>
            </div>
            <div class="item">
              <div class="label">Barcode</div>
              <div class="value">${F.barcode||"-"}</div>
            </div>
            <div class="item">
              <div class="label">Category</div>
              <div class="value">${F.categoryName||"-"}</div>
            </div>
            <div class="item">
              <div class="label">Base Unit</div>
              <div class="value">${F.baseUnit}</div>
            </div>
            <div class="item">
              <div class="label">Second Unit</div>
              <div class="value">${F.secondUnit&&F.unitsPerSecond>0?`${F.secondUnit} (${F.unitsPerSecond} ${F.baseUnit}s)`:"-"}</div>
            </div>
            <div class="item">
              <div class="label">Status</div>
              <div class="value">${F.isActive?"Active":"Inactive"}</div>
            </div>
          </div>
        </div>
        
        ${$e.showSummary&&A?`
        <div class="summary-grid">
          <div class="summary-card">
            <div class="label">Total Stock</div>
            <div class="value blue">${A.totalQuantity.toLocaleString()}</div>
          </div>
          <div class="summary-card">
            <div class="label">In Warehouses</div>
            <div class="value">${A.totalWarehouseQuantity.toLocaleString()}</div>
          </div>
          <div class="summary-card">
            <div class="label">In Vans</div>
            <div class="value">${A.totalVanQuantity.toLocaleString()}</div>
          </div>
          <div class="summary-card">
            <div class="label">Available</div>
            <div class="value green">${A.totalAvailableQuantity.toLocaleString()}</div>
          </div>
        </div>
        `:""}
        
        ${$e.showPricing?`
        <div class="section">
          <h2>Pricing Information</h2>
          <div class="pricing-grid">
            <div class="pricing-card">
              <h3>${F.baseUnit} Prices</h3>
              <div class="prices">
                <div class="price-row"><span>Retail Price</span><strong>${Xt(F.retailPrice,F.currency)}</strong></div>
                <div class="price-row"><span>Wholesale Price</span><strong>${Xt(F.wholesalePrice,F.currency)}</strong></div>
                <div class="price-row"><span>Super Wholesale</span><strong>${Xt(F.superWholesalePrice,F.currency)}</strong></div>
                <div class="price-row"><span>Cost Price</span><strong style="color: #ef4444">${Xt(F.costPrice,F.currency)}</strong></div>
              </div>
            </div>
            ${F.secondUnit&&F.unitsPerSecond>0?`
            <div class="pricing-card">
              <h3>${F.secondUnit} Prices</h3>
              <div class="prices">
                <div class="price-row"><span>Retail Price</span><strong>${Xt(F.boxRetailPrice,F.currency)}</strong></div>
                <div class="price-row"><span>Wholesale Price</span><strong>${Xt(F.boxWholesalePrice,F.currency)}</strong></div>
                <div class="price-row"><span>Super Wholesale</span><strong>${Xt(F.boxSuperWholesalePrice,F.currency)}</strong></div>
                <div class="price-row"><span>Cost Price</span><strong style="color: #ef4444">${Xt(F.boxCostPrice,F.currency)}</strong></div>
              </div>
            </div>
            `:""}
          </div>
        </div>
        `:""}
        
        ${$e.showCostTimeline&&ye.length>0?`
        <div class="section">
          <h2>Cost Timeline</h2>
          <div class="chart-container">
            <svg width="100%" height="150" viewBox="0 0 400 100" preserveAspectRatio="xMidYMid meet">
              <defs>
                <linearGradient id="lineGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" style="stop-color:#3b82f6;stop-opacity:0.3" />
                  <stop offset="100%" style="stop-color:#3b82f6;stop-opacity:0" />
                </linearGradient>
              </defs>
              ${Pt?`<path d="${Pt}" fill="none" stroke="#3b82f6" stroke-width="2" />`:""}
              ${nt.map(Dt=>`<circle cx="${Dt.x*4}" cy="${Dt.y}" r="4" fill="#3b82f6" />`).join("")}
            </svg>
            <div style="display: flex; justify-content: space-between; margin-top: 10px; font-size: 11px; color: #666;">
              ${nt.length>0?`<span>${nt[0].date}</span>`:""}
              ${nt.length>1?`<span>${nt[nt.length-1].date}</span>`:""}
            </div>
          </div>
          ${T?`
          <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-top: 15px;">
            <div style="text-align: center; padding: 10px; background: #f0fdf4; border-radius: 5px;">
              <div style="font-size: 10px; color: #666;">Min Cost</div>
              <div style="font-size: 16px; font-weight: bold; color: #22c55e;">${Xt(T.minCost,F.currency)}</div>
            </div>
            <div style="text-align: center; padding: 10px; background: #fef2f2; border-radius: 5px;">
              <div style="font-size: 10px; color: #666;">Max Cost</div>
              <div style="font-size: 16px; font-weight: bold; color: #ef4444;">${Xt(T.maxCost,F.currency)}</div>
            </div>
            <div style="text-align: center; padding: 10px; background: #eff6ff; border-radius: 5px;">
              <div style="font-size: 10px; color: #666;">Current Cost</div>
              <div style="font-size: 16px; font-weight: bold; color: #3b82f6;">${Xt(T.currentCost,F.currency)}</div>
            </div>
          </div>
          `:""}
          <table style="margin-top: 15px;">
            <thead>
              <tr>
                <th>Date</th>
                <th>Supplier</th>
                <th class="text-right">Cost</th>
                <th>Notes</th>
              </tr>
            </thead>
            <tbody>
              ${ye.map(Dt=>`
                <tr>
                  <td>${Rr(Dt.recordedDate)}</td>
                  <td>${Dt.supplierName}</td>
                  <td class="text-right">${Xt(Dt.cost)}</td>
                  <td>${Dt.notes||"-"}</td>
                </tr>
              `).join("")}
            </tbody>
          </table>
        </div>
        `:""}
        
        ${$e.showInventory&&A?`
        <div class="section">
          <h2>Inventory Details</h2>
          ${A.warehouseInventory.length>0?`
          <h3 style="font-size: 14px; margin: 10px 0;">Warehouse Stock</h3>
          <table>
            <thead>
              <tr>
                <th>Warehouse</th>
                <th class="text-right">Quantity</th>
                <th class="text-right">Reserved</th>
                <th class="text-right">Available</th>
              </tr>
            </thead>
            <tbody>
              ${A.warehouseInventory.map(Dt=>`
                <tr>
                  <td>${Dt.warehouseName}</td>
                  <td class="text-right">${Dt.quantity.toLocaleString()}</td>
                  <td class="text-right">${Dt.reservedQuantity.toLocaleString()}</td>
                  <td class="text-right" style="color: #22c55e; font-weight: bold;">${Dt.availableQuantity.toLocaleString()}</td>
                </tr>
              `).join("")}
            </tbody>
          </table>
          `:""}
          ${A.vanInventory.length>0?`
          <h3 style="font-size: 14px; margin: 15px 0 10px;">Van Stock</h3>
          <table>
            <thead>
              <tr>
                <th>Van</th>
                <th>Plate Number</th>
                <th class="text-right">Quantity</th>
              </tr>
            </thead>
            <tbody>
              ${A.vanInventory.map(Dt=>`
                <tr>
                  <td>${Dt.vanName}</td>
                  <td>${Dt.plateNumber||"-"}</td>
                  <td class="text-right" style="color: #8b5cf6; font-weight: bold;">${Dt.quantity.toLocaleString()}</td>
                </tr>
              `).join("")}
            </tbody>
          </table>
          `:""}
        </div>
        `:""}
        
        ${$e.showSalesHistory&&D?`
        <div class="section">
          <h2>Sales Summary</h2>
          <div class="summary-grid">
            <div class="summary-card">
              <div class="label">Total Orders</div>
              <div class="value">${D.orderCount}</div>
            </div>
            <div class="summary-card">
              <div class="label">Qty Sold</div>
              <div class="value blue">${D.totalQuantitySold.toLocaleString()}</div>
            </div>
            <div class="summary-card">
              <div class="label">Revenue</div>
              <div class="value">${Xt(D.totalRevenue)}</div>
            </div>
            <div class="summary-card">
              <div class="label">Profit</div>
              <div class="value green">${Xt(D.profit)}</div>
            </div>
          </div>
        </div>
        `:""}
        
        <div class="footer">
          <p>Catalyst Product Report - Confidential</p>
        </div>
      </body>
      </html>
    `;Ae.document.write(fr),Ae.document.close(),Ae.onload=()=>{Ae.focus(),Ae.print()}},[gt,tr]=m.useState(null),[Wr,gn]=m.useState(!1),[kl,eu]=m.useState(""),[tu,$v]=m.useState(""),[Ux,Cl]=m.useState(!1),[pa,El]=m.useState(new Set),Bv=()=>{const T=["SKU","Name","Description","Category","Barcode","BoxBarcode","BaseUnit","SecondUnit","UnitsPerSecond","Currency","RetailPrice","WholesalePrice","SuperWholesalePrice","CostPrice","BoxRetailPrice","BoxWholesalePrice","BoxSuperWholesalePrice","BoxCostPrice","LowStockAlert","LowStockAlertBox","InitialStock","Warehouse"],Ae=["SKU-001","Sample Product","Product description","Category Name","1234567890","","Piece","Box",12,"USD",10,8,7,5,120,96,84,60,10,2,100,"Main Warehouse"],nt=wm.aoa_to_sheet([T,Ae]);nt["!cols"]=T.map(fr=>({wch:Math.max(fr.length+2,15)}));const Pt=wm.book_new();wm.book_append_sheet(Pt,nt,"Products"),Cte(Pt,"products_import_template.xlsx")},zv=async T=>{var nt,Pt,fr;const Ae=(nt=T.target.files)==null?void 0:nt[0];if(Ae){T.target.value="";try{const Dt=await Ae.arrayBuffer(),ls=Xj(Dt),Pl=ls.Sheets[ls.SheetNames[0]],Yi=wm.sheet_to_json(Pl);if(Yi.length===0){alert("Excel file is empty");return}const ga=Tt=>Tt==null?"":String(Tt).trim(),za=(Tt,Vv=0)=>{const au=Number(Tt);return isNaN(au)?Vv:au},ru=Yi.map(Tt=>({sku:ga(Tt.SKU??Tt.sku),name:ga(Tt.Name??Tt.name),description:ga(Tt.Description??Tt.description),categoryName:ga(Tt.Category??Tt.category??Tt.CategoryName),barcode:ga(Tt.Barcode??Tt.barcode),boxBarcode:ga(Tt.BoxBarcode??Tt.boxBarcode),baseUnit:ga(Tt.BaseUnit??Tt.baseUnit)||"Piece",secondUnit:ga(Tt.SecondUnit??Tt.secondUnit),unitsPerSecond:za(Tt.UnitsPerSecond??Tt.unitsPerSecond,1),currency:ga(Tt.Currency??Tt.currency)||"USD",retailPrice:za(Tt.RetailPrice??Tt.retailPrice),wholesalePrice:za(Tt.WholesalePrice??Tt.wholesalePrice),superWholesalePrice:za(Tt.SuperWholesalePrice??Tt.superWholesalePrice),costPrice:za(Tt.CostPrice??Tt.costPrice),boxRetailPrice:za(Tt.BoxRetailPrice??Tt.boxRetailPrice),boxWholesalePrice:za(Tt.BoxWholesalePrice??Tt.boxWholesalePrice),boxSuperWholesalePrice:za(Tt.BoxSuperWholesalePrice??Tt.boxSuperWholesalePrice),boxCostPrice:za(Tt.BoxCostPrice??Tt.boxCostPrice),lowStockAlert:za(Tt.LowStockAlert??Tt.lowStockAlert,10),lowStockAlertBox:za(Tt.LowStockAlertBox??Tt.lowStockAlertBox,2),initialStock:za(Tt.InitialStock??Tt.initialStock??Tt.Stock??Tt.stock??Tt.Quantity??Tt.quantity),warehouseName:ga(Tt.Warehouse??Tt.warehouse??Tt.WarehouseName)})),ki=await br.bulkImport({products:ru});tr(ki.data),qt()}catch(Dt){alert(((fr=(Pt=Dt.response)==null?void 0:Pt.data)==null?void 0:fr.message)||"Failed to import products")}}},Uv=T=>{El(Ae=>{const nt=new Set(Ae);return nt.has(T)?nt.delete(T):nt.add(T),nt})},yn=()=>{pa.size===Ca.length?El(new Set):El(new Set(Ca.map(T=>T.id)))},Co=async()=>{var T,Ae;if(!kl&&!tu){alert("Please select at least a category or warehouse");return}if(pa.size===0){alert("Please select at least one product");return}Cl(!0);try{const nt=await br.bulkAssign({categoryId:kl||null,warehouseId:tu||null,productIds:Array.from(pa)});alert(nt.data.message),gn(!1),El(new Set),qt()}catch(nt){alert(((Ae=(T=nt.response)==null?void 0:T.data)==null?void 0:Ae.message)||"Failed to bulk assign")}finally{Cl(!1)}},Wv=async T=>{var nt,Pt;const Ae=pa.size>0?"selected":"all active";if(confirm(`Show ${Ae} products in online store?`))try{const fr=await br.bulkOnlineShop({showInOnlineShop:T,productIds:pa.size>0?Array.from(pa):null});alert(fr.data.message),El(new Set),qt()}catch(fr){alert(((Pt=(nt=fr.response)==null?void 0:nt.data)==null?void 0:Pt.message)||"Failed to update")}};return d?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx(vt,{className:"animate-spin",size:32})}):a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Products"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("button",{onClick:Bv,className:"flex items-center gap-2 px-4 py-2 bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100 border border-blue-200",children:[a.jsx(nx,{size:18})," Excel Template"]}),a.jsx(qr,{permission:Ve.CREATE_PRODUCTS,children:a.jsxs("label",{className:"flex items-center gap-2 px-4 py-2 bg-orange-50 text-orange-600 rounded-lg hover:bg-orange-100 border border-orange-200 cursor-pointer",children:[a.jsx(d0,{size:18})," Import Excel",a.jsx("input",{type:"file",accept:".xlsx,.xls",className:"hidden",onChange:zv})]})}),a.jsx(qr,{permission:Ve.CREATE_PRODUCTS,children:a.jsxs("button",{onClick:()=>{if(pa.size===0){alert("Please select products first using the checkboxes");return}gn(!0)},className:`flex items-center gap-2 px-4 py-2 rounded-lg border ${pa.size>0?"bg-purple-600 text-white border-purple-600 hover:bg-purple-700":"bg-purple-50 text-purple-600 border-purple-200 hover:bg-purple-100"}`,children:[a.jsx(gl,{size:18})," Bulk Assign ",pa.size>0&&`(${pa.size})`]})}),a.jsx(qr,{permission:Ve.CREATE_PRODUCTS,children:a.jsxs("button",{onClick:()=>Wv(!0),className:"flex items-center gap-2 px-4 py-2 bg-teal-50 text-teal-600 rounded-lg hover:bg-teal-100 border border-teal-200",children:[a.jsx(gs,{size:18})," ",pa.size>0?`Show (${pa.size}) in Store`:"Show All in Store"]})}),a.jsx(qr,{permission:Ve.CREATE_PRODUCTS,children:a.jsxs("button",{onClick:Ds,className:"flex items-center gap-2 px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600",children:[a.jsx(hr,{size:20})," Add Product"]})})]})]}),gt&&a.jsx("div",{className:`mb-4 p-4 rounded-lg border ${gt.errors.length>0?"bg-yellow-50 border-yellow-200":"bg-green-50 border-green-200"}`,children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-gray-900",children:gt.message}),gt.errors.length>0&&a.jsxs("ul",{className:"mt-2 text-sm text-yellow-700 space-y-1",children:[gt.errors.slice(0,5).map((T,Ae)=>a.jsxs("li",{children:[" ",T]},Ae)),gt.errors.length>5&&a.jsxs("li",{children:["...and ",gt.errors.length-5," more"]})]})]}),a.jsx("button",{onClick:()=>tr(null),className:"text-gray-400 hover:text-gray-600",children:a.jsx(yt,{size:18})})]})}),pa.size>0&&a.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-xl p-3 mb-4 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Jt,{size:18,className:"text-purple-600"}),a.jsxs("span",{className:"text-sm font-medium text-purple-800",children:[pa.size," product",pa.size>1?"s":""," selected"]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("button",{onClick:()=>gn(!0),className:"px-3 py-1.5 bg-purple-600 text-white text-sm rounded-lg hover:bg-purple-700 flex items-center gap-1",children:[a.jsx(gl,{size:14})," Bulk Assign"]}),a.jsx("button",{onClick:()=>El(new Set),className:"px-3 py-1.5 bg-white text-gray-600 text-sm rounded-lg hover:bg-gray-100 border",children:"Clear"})]})]}),Wr&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"Bulk Assign Products"}),a.jsx("button",{onClick:()=>gn(!1),className:"text-gray-400 hover:text-gray-600",children:a.jsx(yt,{size:20})})]}),a.jsx("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-3 mb-4",children:a.jsxs("p",{className:"text-sm font-medium text-purple-800",children:[pa.size," product",pa.size>1?"s":""," selected"]})}),a.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Assign category and/or warehouse to the selected products."}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category (for products without one)"}),a.jsxs("select",{value:kl,onChange:T=>eu(T.target.value?Number(T.target.value):""),className:"w-full border rounded-lg px-3 py-2",children:[a.jsx("option",{value:"",children:"-- Skip --"}),r.map(T=>a.jsx("option",{value:T.id,children:T.name},T.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Warehouse (add missing products)"}),a.jsxs("select",{value:tu,onChange:T=>$v(T.target.value?Number(T.target.value):""),className:"w-full border rounded-lg px-3 py-2",children:[a.jsx("option",{value:"",children:"-- Skip --"}),n.map(T=>a.jsx("option",{value:T.id,children:T.name},T.id))]})]}),a.jsx("button",{onClick:Co,disabled:Ux||!kl&&!tu,className:"w-full py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 flex items-center justify-center gap-2",children:Ux?a.jsxs(a.Fragment,{children:[a.jsx(vt,{size:16,className:"animate-spin"})," Assigning..."]}):"Assign Now"})]})]})}),a.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4 flex items-center gap-4",children:[a.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:a.jsx(Tr,{className:"text-blue-600",size:24})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Total Products"}),a.jsx("p",{className:"text-2xl font-bold",children:nr.total})]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4 flex items-center gap-4",children:[a.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:a.jsx(o0,{className:"text-green-600",size:24})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Active Products"}),a.jsx("p",{className:"text-2xl font-bold",children:nr.active})]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4 flex items-center gap-4",children:[a.jsx("div",{className:"p-3 bg-yellow-100 rounded-lg",children:a.jsx(c0,{className:"text-yellow-600",size:24})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Low Stock"}),a.jsx("p",{className:"text-2xl font-bold",children:nr.lowStock})]})]})]}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 mb-6",children:a.jsxs("div",{className:"flex gap-4",children:[a.jsxs("div",{className:"flex-1 relative",children:[a.jsx(Na,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:20}),a.jsx("input",{type:"text",placeholder:"Search by name, code, or barcode...",value:p,onChange:T=>g(T.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg"})]}),a.jsxs("select",{value:y,onChange:T=>v(T.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg",children:[a.jsx("option",{value:"",children:"All Warehouses"}),n.map(T=>a.jsx("option",{value:T.id,children:T.name},T.id))]})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[1100px]",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-3 w-10",children:a.jsx("input",{type:"checkbox",checked:pa.size===Ca.length&&Ca.length>0,onChange:yn,className:"rounded border-gray-300"})}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Product"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Codes"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Units"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"First Unit Prices"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Second Unit Prices"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Warehouse"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Status"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:Ca.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:10,className:"px-4 py-8 text-center text-gray-500",children:"No products found"})}):Ca.map(T=>a.jsxs("tr",{className:`hover:bg-gray-50 ${pa.has(T.id)?"bg-purple-50":""}`,children:[a.jsx("td",{className:"px-3 py-3",children:a.jsx("input",{type:"checkbox",checked:pa.has(T.id),onChange:()=>Uv(T.id),className:"rounded border-gray-300"})}),a.jsx("td",{className:"px-3 py-3",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:a.jsx(Tr,{className:"text-blue-600",size:20})}),a.jsxs("div",{children:[a.jsx("div",{className:"font-medium",children:T.name}),a.jsx("div",{className:"text-xs text-gray-500",children:T.categoryName||"-"})]})]})}),a.jsxs("td",{className:"px-3 py-3 text-sm",children:[a.jsxs("div",{className:"font-medium",children:["SKU: ",T.sku]}),a.jsxs("div",{className:"mt-1 space-y-0.5",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Oo,{size:12,className:"text-gray-400"}),a.jsxs("span",{className:"text-xs text-blue-600 font-medium",children:[T.baseUnit,":"]}),a.jsx("span",{className:"text-gray-600",children:T.barcode||"-"})]}),T.secondUnit&&T.unitsPerSecond>0&&a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Oo,{size:12,className:"text-gray-400"}),a.jsxs("span",{className:"text-xs text-blue-600 font-medium",children:[T.secondUnit,":"]}),a.jsx("span",{className:"text-gray-600",children:T.boxBarcode||"-"})]})]})]}),a.jsxs("td",{className:"px-3 py-3 text-sm",children:[a.jsx("div",{children:T.baseUnit}),T.secondUnit&&T.unitsPerSecond>0?a.jsxs("div",{className:"text-gray-500",children:[T.unitsPerSecond," per ",T.secondUnit]}):a.jsx("div",{className:"text-gray-400 text-xs",children:"No second unit"})]}),a.jsxs("td",{className:"px-3 py-3 text-sm",children:[a.jsx("div",{className:"text-xs font-medium text-blue-600 mb-1",children:T.baseUnit}),a.jsxs("div",{children:["R: ",T.currency," ",T.retailPrice.toFixed(3)]}),a.jsxs("div",{className:"text-gray-500",children:["W: ",T.currency," ",T.wholesalePrice.toFixed(3)]}),a.jsxs("div",{className:"text-gray-500",children:["C: ",T.currency," ",T.costPrice.toFixed(3)]})]}),a.jsx("td",{className:"px-3 py-3 text-sm",children:T.secondUnit&&T.unitsPerSecond>0?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-xs font-medium text-blue-600 mb-1",children:T.secondUnit}),a.jsxs("div",{children:["R: ",T.currency," ",T.boxRetailPrice.toFixed(3)]}),a.jsxs("div",{className:"text-gray-500",children:["W: ",T.currency," ",T.boxWholesalePrice.toFixed(3)]}),a.jsxs("div",{className:"text-gray-500",children:["C: ",T.currency," ",T.boxCostPrice.toFixed(3)]})]}):a.jsx("span",{className:"text-gray-400 text-xs",children:"N/A"})}),a.jsx("td",{className:"px-3 py-3",children:a.jsxs("button",{onClick:()=>Ke(T),className:"text-sm text-blue-600 hover:underline flex items-center gap-1",children:[a.jsx(gs,{size:14})," ",T.defaultWarehouseName||"View Stock"]})}),a.jsx("td",{className:"px-3 py-3",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${T.isActive?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:T.isActive?"Active":"Inactive"})}),a.jsx("td",{className:"px-3 py-3",children:a.jsxs("div",{className:"flex gap-1",children:[a.jsx(qr,{permission:Ve.MANAGE_COST_HISTORY,children:a.jsx("button",{onClick:()=>U(T),className:"p-1 text-green-600 hover:bg-green-50 rounded",title:"Cost Timeline",children:a.jsx(hn,{size:16})})}),a.jsx("button",{onClick:()=>Fr(T),className:"p-1 text-emerald-600 hover:bg-emerald-50 rounded",title:"Print Report",children:a.jsx(Br,{size:16})}),a.jsxs("button",{onClick:()=>te(T),className:"p-1 text-purple-600 hover:bg-purple-50 rounded",title:"Variants",children:[a.jsx(Tr,{size:16}),T.variants&&T.variants.length>0&&a.jsx("span",{className:"absolute -top-1 -right-1 bg-purple-500 text-white text-[9px] rounded-full w-3.5 h-3.5 flex items-center justify-center",children:T.variants.length})]}),a.jsx(qr,{permission:Ve.ADJUST_STOCK_LEVELS,children:a.jsx("button",{onClick:()=>At(T),className:"p-1 text-orange-600 hover:bg-orange-50 rounded",title:"Adjust Stock",children:a.jsx(Fh,{size:16})})}),a.jsx(qr,{permission:Ve.EDIT_PRODUCTS,children:a.jsx("button",{onClick:()=>_e(T),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",title:"Edit",children:a.jsx(js,{size:16})})}),a.jsx(qr,{permission:Ve.DELETE_PRODUCTS,children:a.jsx("button",{onClick:()=>Qt(T.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Delete",children:a.jsx(xr,{size:16})})})]})})]},T.id))})]})}),(j||w)&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-3xl max-h-[90vh] overflow-hidden",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-[#003366] text-white",children:[a.jsx("h2",{className:"text-lg font-semibold",children:w?"Edit Product":Mt?"Find or Add Product":"Add New Product"}),a.jsx("button",{onClick:()=>{b(!1),k(!1),Lt(!1)},children:a.jsx(yt,{size:24})})]}),j&&!w&&Mt&&a.jsxs("div",{className:"p-4 border-b bg-blue-50",children:[a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Scan Barcode or Enter Item Code"}),a.jsxs("div",{className:"relative",children:[a.jsx(Oo,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),a.jsx("input",{type:"text",value:at,onChange:T=>Ue(T.target.value),placeholder:"Scan barcode or enter SKU...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg",autoFocus:!0})]})]}),at&&Ce.length>0&&a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Or Select Existing Product to Edit"}),a.jsx("div",{className:"max-h-40 overflow-y-auto border border-gray-200 rounded-lg bg-white",children:Ce.slice(0,10).map(T=>a.jsxs("button",{type:"button",onClick:()=>je(T.id),className:"w-full px-3 py-2 text-left hover:bg-blue-50 border-b last:border-b-0 flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-sm",children:T.name}),a.jsxs("div",{className:"text-xs text-gray-500",children:["SKU: ",T.sku," ",T.barcode&&`| Barcode: ${T.barcode}`]})]}),a.jsx("div",{className:"text-right text-sm",children:a.jsxs("div",{className:"text-green-600",children:[T.currency," ",T.costPrice.toFixed(3)]})})]},T.id))})]}),a.jsx("div",{className:"flex gap-2",children:a.jsxs("button",{type:"button",onClick:fe,className:"flex-1 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 flex items-center justify-center gap-2",children:[a.jsx(hr,{size:18}),"Create New Product"]})}),pt==="existing"&&C&&a.jsxs("div",{className:"mt-3 p-3 bg-green-50 border border-green-200 rounded-lg",children:[a.jsxs("div",{className:"flex items-center gap-2 text-green-700",children:[a.jsx(Jt,{size:18}),a.jsxs("span",{className:"font-medium",children:["Product found: ",C.name]})]}),a.jsx("button",{type:"button",onClick:()=>je(C.id),className:"mt-2 w-full py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Edit This Product"})]})]}),a.jsxs("form",{onSubmit:w?Vt:Qe,className:"p-4 overflow-y-auto max-h-[calc(90vh-120px)] space-y-3",children:[j&&!w&&!Mt&&a.jsxs("button",{type:"button",onClick:()=>{Lt(!0),st("")},className:"text-xs text-blue-600 hover:underline flex items-center gap-1",children:[a.jsx(Na,{size:12})," Search for existing product"]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsxs("div",{className:"flex-shrink-0",children:[Ee.imageUrl?a.jsxs("div",{className:"relative",children:[a.jsx("img",{src:Ee.imageUrl,alt:"Product",className:"w-16 h-16 object-cover rounded-lg border"}),a.jsx("button",{type:"button",onClick:()=>it({...Ee,imageUrl:""}),className:"absolute -top-1 -right-1 p-0.5 bg-red-500 text-white rounded-full hover:bg-red-600",children:a.jsx(yt,{size:10})})]}):a.jsx("div",{className:"w-16 h-16 border-2 border-dashed border-gray-300 rounded-lg flex items-center justify-center bg-gray-50 cursor-pointer hover:bg-gray-100",onClick:()=>{var T;return(T=pe.current)==null?void 0:T.click()},children:Se?a.jsx(vt,{size:20,className:"animate-spin text-gray-400"}):a.jsx(Rj,{size:20,className:"text-gray-400"})}),a.jsx("input",{type:"file",ref:pe,accept:"image/*",onChange:lt,className:"hidden"})]}),a.jsxs("div",{className:"flex-1 grid grid-cols-5 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-0.5",children:"Name *"}),a.jsx("input",{type:"text",required:!0,value:Ee.name,onChange:T=>it({...Ee,name:T.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded-lg",placeholder:"Product name"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-0.5",children:" "}),a.jsx("input",{type:"text",value:Ee.nameAr,onChange:T=>it({...Ee,nameAr:T.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded-lg text-right",dir:"rtl",placeholder:" "})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-0.5",children:"Category"}),a.jsxs("div",{className:"flex gap-1",children:[a.jsxs("select",{value:Ee.categoryId,onChange:T=>it({...Ee,categoryId:T.target.value}),className:"flex-1 px-2 py-1.5 text-sm border border-gray-300 rounded-lg",children:[a.jsx("option",{value:"",children:"Select"}),r.map(T=>a.jsx("option",{value:T.id,children:T.name},T.id))]}),a.jsx("button",{type:"button",onClick:()=>Ze(!0),className:"px-2 py-1.5 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600",children:a.jsx(hr,{size:14})})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-0.5",children:"Warehouse"}),a.jsxs("select",{value:Ee.defaultWarehouseId,onChange:T=>it({...Ee,defaultWarehouseId:T.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded-lg",children:[a.jsx("option",{value:"",children:"Select"}),n.map(T=>a.jsx("option",{value:T.id,children:T.name},T.id))]})]})]})]}),a.jsxs("div",{className:"flex items-center gap-6 py-2 px-3 bg-slate-50 rounded-lg",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-xs font-medium text-slate-600",children:"Unit:"}),a.jsx("select",{value:Ee.baseUnit,onChange:T=>it({...Ee,baseUnit:T.target.value}),className:"px-2 py-1 text-sm border border-slate-300 rounded-md bg-white",children:l.length>0?l.map(T=>a.jsx("option",{value:T.name,children:T.name},T.id)):a.jsxs(a.Fragment,{children:[a.jsx("option",{value:"Piece",children:"Piece"}),a.jsx("option",{value:"Box",children:"Box"}),a.jsx("option",{value:"Kg",children:"Kg"})]})})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-xs font-medium text-slate-600",children:"Currency:"}),a.jsx("select",{value:Ee.currency,onChange:T=>it({...Ee,currency:T.target.value}),className:"px-2 py-1 text-sm border border-slate-300 rounded-md bg-white",children:c.filter(T=>T.isActive).length>0?c.filter(T=>T.isActive).map(T=>a.jsx("option",{value:T.code,children:T.code},T.id)):a.jsxs(a.Fragment,{children:[a.jsx("option",{value:"USD",children:"USD"}),a.jsx("option",{value:"LBP",children:"LBP"}),a.jsx("option",{value:"EUR",children:"EUR"})]})})]}),a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:Ee.isActive,onChange:T=>it({...Ee,isActive:T.target.checked}),className:"w-4 h-4 rounded border-slate-300 text-emerald-600 focus:ring-emerald-500"}),a.jsx("span",{className:"text-xs text-slate-600",children:"Active"})]}),a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:Ee.showInOnlineShop,onChange:T=>it({...Ee,showInOnlineShop:T.target.checked}),className:"w-4 h-4 rounded border-slate-300 text-emerald-600 focus:ring-emerald-500"}),a.jsx("span",{className:"text-xs text-slate-600",children:"Online Shop"})]}),a.jsx("button",{type:"button",onClick:()=>{it(_?{...Ee,secondUnit:"",unitsPerSecond:0,boxBarcode:"",boxRetailPrice:0,boxWholesalePrice:0,boxSuperWholesalePrice:0,boxCostPrice:0,lowStockAlertBox:0}:{...Ee,secondUnit:"Box",unitsPerSecond:0}),O(!_)},className:`ml-auto px-3 py-1.5 text-xs font-medium rounded-md flex items-center gap-1.5 transition-colors ${_?"bg-red-50 text-red-600 hover:bg-red-100 border border-red-200":"bg-blue-50 text-blue-600 hover:bg-blue-100 border border-blue-200"}`,children:_?a.jsxs(a.Fragment,{children:[a.jsx(yt,{size:14})," Remove Box Unit"]}):a.jsxs(a.Fragment,{children:[a.jsx(hr,{size:14})," Add Box Unit"]})})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsx("h4",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wide",children:"Identification"}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"SKU Code"}),a.jsx("input",{type:"text",value:Ee.sku,onChange:T=>it({...Ee,sku:T.target.value}),className:"w-full px-3 py-2 text-sm border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500",placeholder:"e.g. PRD-001"})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-xs font-medium text-slate-600 mb-1 flex justify-between",children:[a.jsx("span",{children:"Barcode"}),a.jsxs("button",{type:"button",onClick:()=>it({...Ee,barcode:Ea()}),className:"px-2 py-0.5 text-[10px] bg-emerald-500 hover:bg-emerald-600 text-white rounded-md flex items-center gap-1 transition-colors",children:[a.jsx(Oo,{size:10}),"Generate"]})]}),a.jsx("input",{type:"text",value:Ee.barcode,onChange:T=>it({...Ee,barcode:T.target.value}),className:"w-full px-3 py-2 text-sm border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500",placeholder:"Scan or enter"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Min Stock Alert"}),a.jsx("input",{type:"number",min:"0",value:Ee.lowStockAlert,onChange:T=>it({...Ee,lowStockAlert:parseInt(T.target.value)||0}),className:"w-full px-3 py-2 text-sm border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"})]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("h4",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wide",children:"Pricing"}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Cost Price"}),a.jsx("input",{type:"number",step:"0.01",value:Ee.costPrice,onChange:T=>it({...Ee,costPrice:parseFloat(T.target.value)||0}),className:"w-full px-3 py-2 text-sm border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500",placeholder:"0.00"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Retail Price"}),a.jsx("input",{type:"number",step:"0.01",value:Ee.retailPrice,onChange:T=>it({...Ee,retailPrice:parseFloat(T.target.value)||0}),className:"w-full px-3 py-2 text-sm border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500",placeholder:"0.00"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Wholesale"}),a.jsx("input",{type:"number",step:"0.01",value:Ee.wholesalePrice,onChange:T=>it({...Ee,wholesalePrice:parseFloat(T.target.value)||0}),className:"w-full px-3 py-2 text-sm border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500",placeholder:"0.00"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Super Wholesale"}),a.jsx("input",{type:"number",step:"0.01",value:Ee.superWholesalePrice,onChange:T=>it({...Ee,superWholesalePrice:parseFloat(T.target.value)||0}),className:"w-full px-3 py-2 text-sm border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500",placeholder:"0.00"})]})]})]})]}),a.jsxs("details",{className:"group",children:[a.jsxs("summary",{className:"cursor-pointer text-xs font-medium text-slate-500 hover:text-slate-700 flex items-center gap-2 py-2",children:[a.jsx("span",{className:"transition-transform group-open:rotate-90",children:""}),"Optional Attributes (Color, Size, Dimensions)"]}),a.jsxs("div",{className:"grid grid-cols-5 gap-3 mt-3 p-3 bg-slate-50 rounded-lg",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Color"}),a.jsx("input",{type:"text",value:Ee.color,onChange:T=>it({...Ee,color:T.target.value}),placeholder:"e.g. Red",className:"w-full px-3 py-2 text-sm border border-slate-300 rounded-lg"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Size"}),a.jsx("input",{type:"text",value:Ee.size,onChange:T=>it({...Ee,size:T.target.value}),placeholder:"e.g. Large",className:"w-full px-3 py-2 text-sm border border-slate-300 rounded-lg"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Weight (kg)"}),a.jsx("input",{type:"number",step:"0.01",value:Ee.weight,onChange:T=>it({...Ee,weight:T.target.value}),placeholder:"0.00",className:"w-full px-3 py-2 text-sm border border-slate-300 rounded-lg"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Length (cm)"}),a.jsx("input",{type:"number",step:"0.01",value:Ee.length,onChange:T=>it({...Ee,length:T.target.value}),placeholder:"0",className:"w-full px-3 py-2 text-sm border border-slate-300 rounded-lg"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Height (cm)"}),a.jsx("input",{type:"number",step:"0.01",value:Ee.height,onChange:T=>it({...Ee,height:T.target.value}),placeholder:"0",className:"w-full px-3 py-2 text-sm border border-slate-300 rounded-lg"})]})]})]}),_&&a.jsxs("div",{className:"border border-blue-200 rounded-lg p-4 bg-blue-50/30",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4 pb-3 border-b border-blue-200",children:[a.jsx("h4",{className:"text-sm font-semibold text-blue-700",children:"Box/Carton Unit"}),a.jsx("select",{value:Ee.secondUnit,onChange:T=>it({...Ee,secondUnit:T.target.value}),className:"px-2 py-1 text-sm border border-blue-300 rounded-md bg-white",children:l.length>0?l.map(T=>a.jsx("option",{value:T.name,children:T.name},T.id)):a.jsxs(a.Fragment,{children:[a.jsx("option",{value:"Box",children:"Box"}),a.jsx("option",{value:"Carton",children:"Carton"}),a.jsx("option",{value:"Pack",children:"Pack"})]})}),a.jsx("span",{className:"text-sm text-slate-600",children:"="}),a.jsx("input",{type:"number",min:"1",value:Ee.unitsPerSecond,onChange:T=>it({...Ee,unitsPerSecond:parseInt(T.target.value)||0}),className:"w-16 px-2 py-1 text-sm border border-blue-300 rounded-md bg-white text-center",placeholder:"0"}),a.jsxs("span",{className:"text-sm text-slate-600",children:[Ee.baseUnit,"s per ",Ee.secondUnit||"Box"]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-xs font-medium text-slate-600 mb-1 flex justify-between",children:[a.jsx("span",{children:"Box Barcode"}),a.jsxs("button",{type:"button",onClick:()=>it({...Ee,boxBarcode:Ea()}),className:"px-2 py-0.5 text-[10px] bg-emerald-500 hover:bg-emerald-600 text-white rounded-md flex items-center gap-1 transition-colors",children:[a.jsx(Oo,{size:10}),"Generate"]})]}),a.jsx("input",{type:"text",value:Ee.boxBarcode,onChange:T=>it({...Ee,boxBarcode:T.target.value}),className:"w-full px-3 py-2 text-sm border border-slate-300 rounded-lg",placeholder:"Scan or enter"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Min Stock Alert"}),a.jsx("input",{type:"number",min:"0",value:Ee.lowStockAlertBox,onChange:T=>it({...Ee,lowStockAlertBox:parseInt(T.target.value)||0}),className:"w-full px-3 py-2 text-sm border border-slate-300 rounded-lg"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Cost Price"}),a.jsx("input",{type:"number",step:"0.01",value:Ee.boxCostPrice,onChange:T=>it({...Ee,boxCostPrice:parseFloat(T.target.value)||0}),className:"w-full px-3 py-2 text-sm border border-slate-300 rounded-lg",placeholder:"0.00"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Retail Price"}),a.jsx("input",{type:"number",step:"0.01",value:Ee.boxRetailPrice,onChange:T=>it({...Ee,boxRetailPrice:parseFloat(T.target.value)||0}),className:"w-full px-3 py-2 text-sm border border-slate-300 rounded-lg",placeholder:"0.00"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Wholesale"}),a.jsx("input",{type:"number",step:"0.01",value:Ee.boxWholesalePrice,onChange:T=>it({...Ee,boxWholesalePrice:parseFloat(T.target.value)||0}),className:"w-full px-3 py-2 text-sm border border-slate-300 rounded-lg",placeholder:"0.00"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"Super Wholesale"}),a.jsx("input",{type:"number",step:"0.01",value:Ee.boxSuperWholesalePrice,onChange:T=>it({...Ee,boxSuperWholesalePrice:parseFloat(T.target.value)||0}),className:"w-full px-3 py-2 text-sm border border-slate-300 rounded-lg",placeholder:"0.00"})]})]})]})]}),!w&&a.jsxs("div",{className:"border rounded-lg p-3 border-green-200 bg-green-50/50",children:[a.jsx("div",{className:"text-xs font-semibold mb-2 text-green-700",children:"Initial Inventory (Optional)"}),a.jsxs("div",{className:`grid gap-3 ${_?"grid-cols-3":"grid-cols-2"}`,children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-xs text-gray-500 mb-0.5",children:["Qty (",Ee.baseUnit,"s)"]}),a.jsx("input",{type:"number",min:"0",value:Ee.initialQuantity,onChange:T=>it({...Ee,initialQuantity:parseInt(T.target.value)||0}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded-lg",placeholder:"0"})]}),_&&a.jsxs("div",{children:[a.jsxs("label",{className:"block text-xs text-gray-500 mb-0.5",children:["Qty (",Ee.secondUnit,"s)"]}),a.jsx("input",{type:"number",min:"0",value:Ee.initialQuantityBox,onChange:T=>it({...Ee,initialQuantityBox:parseInt(T.target.value)||0}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded-lg",placeholder:"0"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-gray-500 mb-0.5",children:"Warehouse"}),a.jsxs("select",{value:Ee.initialWarehouseId,onChange:T=>it({...Ee,initialWarehouseId:T.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded-lg",children:[a.jsx("option",{value:"",children:"Select warehouse"}),n.map(T=>a.jsx("option",{value:T.id,children:T.name},T.id))]})]})]})]}),a.jsxs("div",{className:"flex gap-2 pt-2",children:[a.jsx("button",{type:"button",onClick:()=>{b(!1),k(!1)},className:"flex-1 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:f,className:"flex-1 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 disabled:opacity-50",children:f?"Saving...":"Save"})]})]})]})}),E&&C&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-2xl max-h-[90vh] overflow-hidden",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-[#003366] text-white",children:[a.jsxs("h2",{className:"text-lg font-semibold",children:[C.name,"  Cost Timeline"]}),a.jsx("button",{onClick:()=>R(!1),children:a.jsx(yt,{size:24})})]}),a.jsxs("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-120px)]",children:[Q?a.jsx("div",{className:"flex items-center justify-center py-12",children:a.jsx(vt,{className:"animate-spin",size:32})}):ne.length===0?a.jsxs("div",{className:"text-center py-12 text-gray-500",children:[a.jsx(hn,{size:48,className:"mx-auto mb-4 opacity-50"}),a.jsx("p",{children:"No cost history available for this product."}),a.jsx("p",{className:"text-sm mt-2",children:"Cost history is recorded when purchasing from suppliers."})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("div",{className:"h-48",children:a.jsx(md,{width:"100%",height:"100%",children:a.jsxs(j_,{data:ne.map(T=>({date:new Date(T.recordedDate).toLocaleDateString("en-US",{month:"short",day:"numeric"}),cost:T.cost,supplier:T.supplierName})),margin:{top:5,right:20,left:10,bottom:5},children:[a.jsx(Wf,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),a.jsx(N0,{dataKey:"date",tick:{fontSize:12},stroke:"#6b7280"}),a.jsx(S0,{tick:{fontSize:12},stroke:"#6b7280",tickFormatter:T=>`${(C==null?void 0:C.currency)||""} ${T}`}),a.jsx(yd,{formatter:T=>[`${(C==null?void 0:C.currency)||""} ${T.toFixed(3)}`,"Cost"],labelStyle:{fontWeight:"bold"},contentStyle:{borderRadius:"8px",border:"1px solid #e5e7eb"}}),a.jsx(qw,{type:"monotone",dataKey:"cost",stroke:"#3b82f6",strokeWidth:2,dot:{fill:"#3b82f6",strokeWidth:2,r:5},activeDot:{r:8,fill:"#2563eb"}})]})})}),a.jsxs("div",{className:"text-xs text-gray-400 mt-2 text-center",children:["Cost (",(C==null?void 0:C.currency)||"",") over time"]})]}),a.jsx("div",{className:"flex flex-wrap gap-3 mb-4",children:[...new Set(ne.map(T=>T.supplierName))].map((T,Ae)=>{const nt=["bg-blue-500","bg-green-500","bg-red-500","bg-yellow-500","bg-purple-500"];return a.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[a.jsx("div",{className:`w-3 h-3 rounded ${nt[Ae%nt.length]}`}),a.jsx("span",{children:T})]},T)})}),(()=>{const T=rt();return T?a.jsx("div",{className:"bg-gray-50 rounded-lg p-4 text-sm",children:a.jsxs("div",{className:"grid grid-cols-4 gap-4 text-center",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-gray-500",children:"Min Cost"}),a.jsxs("div",{className:"font-semibold text-green-600",children:[C==null?void 0:C.currency," ",T.minCost.toFixed(3)]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-gray-500",children:"Max Cost"}),a.jsxs("div",{className:"font-semibold text-red-600",children:[C==null?void 0:C.currency," ",T.maxCost.toFixed(3)]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-gray-500",children:"Increase"}),a.jsxs("div",{className:"font-semibold",children:[C==null?void 0:C.currency," ",T.increase.toFixed(3)]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-gray-500",children:"Change"}),a.jsxs("div",{className:`font-semibold ${parseFloat(T.increasePercent)>0?"text-red-600":"text-green-600"}`,children:[T.increasePercent,"%"]})]})]})}):null})(),a.jsx("div",{className:"mt-4 border rounded-lg overflow-hidden",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-2 text-left",children:"Date"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Supplier"}),a.jsx("th",{className:"px-3 py-2 text-right",children:"Cost"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Notes"})]})}),a.jsx("tbody",{children:ne.map(T=>a.jsxs("tr",{className:"border-t",children:[a.jsx("td",{className:"px-3 py-2",children:new Date(T.recordedDate).toLocaleDateString()}),a.jsx("td",{className:"px-3 py-2",children:T.supplierName}),a.jsxs("td",{className:"px-3 py-2 text-right font-medium",children:[C==null?void 0:C.currency," ",T.cost.toFixed(3)]}),a.jsx("td",{className:"px-3 py-2 text-gray-500",children:T.notes||"-"})]},T.id))})]})})]}),a.jsx("div",{className:"flex justify-end pt-4",children:a.jsx("button",{onClick:()=>R(!1),className:"px-6 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Close"})})]})]})}),K&&C&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-3xl max-h-[90vh] overflow-hidden",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-blue-600 text-white",children:[a.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[a.jsx(Tr,{size:20})," Stock Details  ",C.name]}),a.jsx("button",{onClick:()=>q(!1),children:a.jsx(yt,{size:24})})]}),a.jsxs("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-80px)]",children:[B?a.jsx("div",{className:"flex items-center justify-center py-12",children:a.jsx(vt,{className:"animate-spin",size:32})}):ge?a.jsxs(a.Fragment,{children:[(()=>{const T=C.secondUnit&&C.unitsPerSecond>0,Ae=T?C.unitsPerSecond:1,nt=ge.totalQuantity*Ae,Pt=ge.totalWarehouseQuantity*Ae,fr=ge.totalVanQuantity*Ae,Dt=T?C.secondUnit:C.baseUnit;return a.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[a.jsxs("div",{className:`p-4 rounded-lg ${ge.isLowStock?"bg-red-50 border border-red-200":"bg-green-50 border border-green-200"}`,children:[a.jsx("div",{className:"text-sm text-gray-600",children:"Total Stock"}),a.jsx("div",{className:`text-2xl font-bold ${ge.isLowStock?"text-red-600":"text-green-600"}`,children:nt.toLocaleString()}),a.jsxs("div",{className:"text-xs text-gray-500",children:[Dt,"s"]})]}),a.jsxs("div",{className:"p-4 rounded-lg bg-blue-50 border border-blue-200",children:[a.jsx("div",{className:"text-sm text-gray-600",children:"In Warehouses"}),a.jsx("div",{className:"text-2xl font-bold text-blue-600",children:Pt.toLocaleString()}),a.jsxs("div",{className:"text-xs text-gray-500",children:[Dt,"s"]})]}),a.jsxs("div",{className:"p-4 rounded-lg bg-purple-50 border border-purple-200",children:[a.jsx("div",{className:"text-sm text-gray-600",children:"In Vans"}),a.jsx("div",{className:"text-2xl font-bold text-purple-600",children:fr.toLocaleString()}),a.jsxs("div",{className:"text-xs text-gray-500",children:[Dt,"s"]})]}),a.jsxs("div",{className:"p-4 rounded-lg bg-orange-50 border border-orange-200",children:[a.jsx("div",{className:"text-sm text-gray-600",children:"Reserved"}),a.jsx("div",{className:"text-2xl font-bold text-orange-600",children:(ge.totalReservedQuantity*Ae).toLocaleString()}),a.jsxs("div",{className:"text-xs text-gray-500",children:["Available: ",((ge.totalQuantity-ge.totalReservedQuantity)*Ae).toLocaleString()]})]})]})})(),ge.isLowStock&&a.jsxs("div",{className:"mb-6 p-3 bg-red-100 border border-red-300 rounded-lg flex items-center gap-2 text-red-700",children:[a.jsx(c0,{size:20}),a.jsx("span",{className:"font-medium",children:"Low Stock Alert!"}),a.jsxs("span",{className:"text-sm",children:["Stock is at or below ",ge.lowStockAlert," ",ge.baseUnit,"s"]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[a.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[a.jsxs("h4",{className:"font-semibold text-blue-800 mb-3",children:["First Unit: ",C.baseUnit]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Cost:"})," ",a.jsxs("span",{className:"font-medium",children:[C.currency," ",C.costPrice.toFixed(3)]})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Retail:"})," ",a.jsxs("span",{className:"font-medium",children:[C.currency," ",C.retailPrice.toFixed(3)]})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Wholesale:"})," ",a.jsxs("span",{className:"font-medium",children:[C.currency," ",C.wholesalePrice.toFixed(3)]})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Super W:"})," ",a.jsxs("span",{className:"font-medium",children:[C.currency," ",C.superWholesalePrice.toFixed(3)]})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("span",{className:"text-gray-600",children:"Min Stock:"})," ",a.jsxs("span",{className:"font-medium text-red-600",children:[C.lowStockAlert," ",C.baseUnit,"s"]})]})]})]}),C.secondUnit&&C.unitsPerSecond>0&&a.jsxs("div",{className:"p-4 bg-purple-50 border border-purple-200 rounded-lg",children:[a.jsxs("h4",{className:"font-semibold text-purple-800 mb-3",children:["Second Unit: ",C.secondUnit," = ",C.unitsPerSecond," ",C.baseUnit,"s"]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Cost:"})," ",a.jsxs("span",{className:"font-medium",children:[C.currency," ",C.boxCostPrice.toFixed(3)]})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Retail:"})," ",a.jsxs("span",{className:"font-medium",children:[C.currency," ",C.boxRetailPrice.toFixed(3)]})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Wholesale:"})," ",a.jsxs("span",{className:"font-medium",children:[C.currency," ",C.boxWholesalePrice.toFixed(3)]})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Super W:"})," ",a.jsxs("span",{className:"font-medium",children:[C.currency," ",C.boxSuperWholesalePrice.toFixed(3)]})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("span",{className:"text-gray-600",children:"Min Stock:"})," ",a.jsxs("span",{className:"font-medium text-red-600",children:[C.lowStockAlertBox," ",C.secondUnit,"s"]})]})]}),a.jsxs("div",{className:"mt-2 pt-2 border-t border-purple-200 text-sm text-purple-700",children:["Total in ",C.baseUnit,"s: ",a.jsx("span",{className:"font-bold",children:ge.totalQuantity.toLocaleString()}),a.jsx("span",{className:"mx-2",children:""}),"Total in ",C.secondUnit,"s: ",a.jsx("span",{className:"font-bold",children:(ge.totalQuantity*C.unitsPerSecond).toLocaleString()})]})]})]}),a.jsxs("div",{className:"mb-6",children:[a.jsxs("h3",{className:"font-semibold mb-3 flex items-center gap-2",children:[a.jsx(gl,{size:18,className:"text-blue-600"})," Warehouse Stock"]}),ge.warehouseInventory.length===0?a.jsx("div",{className:"text-center py-4 text-gray-500 bg-gray-50 rounded-lg",children:"No warehouse inventory"}):a.jsx("div",{className:"border rounded-lg overflow-hidden",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-2 text-left",children:"Warehouse"}),a.jsx("th",{className:"px-4 py-2 text-right",children:"Quantity"}),a.jsx("th",{className:"px-4 py-2 text-right",children:"Reserved"}),a.jsx("th",{className:"px-4 py-2 text-right",children:"Available"}),a.jsx("th",{className:"px-4 py-2 text-right",children:"Last Counted"})]})}),a.jsx("tbody",{children:ge.warehouseInventory.map(T=>a.jsxs("tr",{className:"border-t hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 font-medium",children:T.warehouseName}),a.jsx("td",{className:"px-4 py-3 text-right",children:T.quantity.toLocaleString()}),a.jsx("td",{className:"px-4 py-3 text-right text-orange-600",children:T.reservedQuantity.toLocaleString()}),a.jsx("td",{className:"px-4 py-3 text-right font-medium text-green-600",children:T.availableQuantity.toLocaleString()}),a.jsx("td",{className:"px-4 py-3 text-right text-gray-500",children:T.lastCountedAt?new Date(T.lastCountedAt).toLocaleDateString():"Never"})]},T.warehouseId))})]})})]}),a.jsxs("div",{children:[a.jsxs("h3",{className:"font-semibold mb-3 flex items-center gap-2",children:[a.jsx(On,{size:18,className:"text-purple-600"})," Van Stock"]}),ge.vanInventory.length===0?a.jsx("div",{className:"text-center py-4 text-gray-500 bg-gray-50 rounded-lg",children:"No van inventory"}):a.jsx("div",{className:"border rounded-lg overflow-hidden",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-2 text-left",children:"Van"}),a.jsx("th",{className:"px-4 py-2 text-left",children:"Plate Number"}),a.jsx("th",{className:"px-4 py-2 text-right",children:"Quantity"}),a.jsx("th",{className:"px-4 py-2 text-right",children:"Loaded At"})]})}),a.jsx("tbody",{children:ge.vanInventory.map(T=>a.jsxs("tr",{className:"border-t hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 font-medium",children:T.vanName}),a.jsx("td",{className:"px-4 py-3 text-gray-500",children:T.plateNumber||"-"}),a.jsx("td",{className:"px-4 py-3 text-right font-medium text-purple-600",children:T.quantity.toLocaleString()}),a.jsx("td",{className:"px-4 py-3 text-right text-gray-500",children:new Date(T.loadedAt).toLocaleDateString()})]},T.vanId))})]})})]})]}):a.jsxs("div",{className:"text-center py-12 text-gray-500",children:[a.jsx(Tr,{size:48,className:"mx-auto mb-3 opacity-50"}),a.jsx("p",{children:"No inventory data available"})]}),a.jsx("div",{className:"flex justify-end pt-4 mt-4 border-t",children:a.jsx("button",{onClick:()=>q(!1),className:"px-6 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Close"})})]})]})}),ft&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[60]",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-md p-6",children:[a.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Quick Add Category"}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category Name *"}),a.jsx("input",{type:"text",value:dt,onChange:T=>Ot(T.target.value),onKeyDown:T=>T.key==="Enter"&&_t(),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"Enter category name",autoFocus:!0})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{type:"button",onClick:()=>{Ze(!1),Ot("")},className:"flex-1 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{type:"button",onClick:_t,disabled:Y||!dt.trim(),className:"flex-1 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 disabled:opacity-50",children:Y?"Adding...":"Add Category"})]})]})}),L&&F&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-lg w-full mx-4 max-h-[90vh] overflow-auto",children:[a.jsx("div",{className:"p-6 border-b",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Br,{size:24,className:"text-emerald-600"}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-bold",children:"Product Report"}),a.jsx("p",{className:"text-sm text-gray-500",children:F.name})]})]}),a.jsx("button",{onClick:()=>Z(!1),className:"p-2 hover:bg-gray-100 rounded-lg",children:a.jsx(yt,{size:20})})]})}),a.jsx("div",{className:"p-6 space-y-4",children:Fe?a.jsxs("div",{className:"flex items-center justify-center py-8",children:[a.jsx(vt,{className:"animate-spin",size:32}),a.jsx("span",{className:"ml-2",children:"Loading report data..."})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:a.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Cost History:"}),a.jsxs("span",{className:"ml-2 font-medium",children:[ye.length," entries"]})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Total Stock:"}),a.jsx("span",{className:"ml-2 font-medium",children:(A==null?void 0:A.totalQuantity.toLocaleString())||0})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Current Cost:"}),a.jsxs("span",{className:"ml-2 font-medium text-red-600",children:[F.currency," ",F.costPrice.toFixed(3)]})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Retail Price:"}),a.jsxs("span",{className:"ml-2 font-medium text-green-600",children:[F.currency," ",F.retailPrice.toFixed(3)]})]})]})}),ye.length>0&&a.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",ref:Bt,children:[a.jsx("h4",{className:"text-sm font-medium text-blue-800 mb-2",children:"Cost Timeline Preview"}),a.jsx("div",{className:"h-24",children:a.jsx(md,{width:"100%",height:"100%",children:a.jsxs(j_,{data:ye.map(T=>({date:new Date(T.recordedDate).toLocaleDateString(),cost:T.cost})),children:[a.jsx(Wf,{strokeDasharray:"3 3",stroke:"#93c5fd"}),a.jsx(N0,{dataKey:"date",tick:{fontSize:10},stroke:"#3b82f6"}),a.jsx(S0,{tick:{fontSize:10},stroke:"#3b82f6"}),a.jsx(yd,{}),a.jsx(qw,{type:"monotone",dataKey:"cost",stroke:"#3b82f6",strokeWidth:2,dot:{fill:"#3b82f6",r:3}})]})})})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("h3",{className:"font-medium text-gray-700",children:"Include in Report:"}),a.jsxs("label",{className:"flex items-center gap-3 p-3 bg-white border rounded-lg cursor-pointer hover:bg-gray-50",children:[a.jsx("input",{type:"checkbox",checked:$e.showSummary,onChange:T=>We({...$e,showSummary:T.target.checked}),className:"w-5 h-5 text-emerald-600 rounded"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-medium",children:"Stock Summary"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Total stock, warehouse, van quantities"})]}),$e.showSummary&&a.jsx(Jt,{size:18,className:"text-emerald-600"})]}),a.jsxs("label",{className:"flex items-center gap-3 p-3 bg-white border rounded-lg cursor-pointer hover:bg-gray-50",children:[a.jsx("input",{type:"checkbox",checked:$e.showPricing,onChange:T=>We({...$e,showPricing:T.target.checked}),className:"w-5 h-5 text-emerald-600 rounded"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-medium",children:"Pricing Information"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Retail, wholesale, cost prices"})]}),$e.showPricing&&a.jsx(Jt,{size:18,className:"text-emerald-600"})]}),a.jsxs("label",{className:"flex items-center gap-3 p-3 bg-white border rounded-lg cursor-pointer hover:bg-gray-50",children:[a.jsx("input",{type:"checkbox",checked:$e.showCostTimeline,onChange:T=>We({...$e,showCostTimeline:T.target.checked}),className:"w-5 h-5 text-emerald-600 rounded"}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("p",{className:"font-medium",children:["Cost Timeline (",ye.length,")"]}),a.jsx("p",{className:"text-sm text-gray-500",children:"Cost history graph and table"})]}),$e.showCostTimeline&&a.jsx(Jt,{size:18,className:"text-emerald-600"})]}),a.jsxs("label",{className:"flex items-center gap-3 p-3 bg-white border rounded-lg cursor-pointer hover:bg-gray-50",children:[a.jsx("input",{type:"checkbox",checked:$e.showInventory,onChange:T=>We({...$e,showInventory:T.target.checked}),className:"w-5 h-5 text-emerald-600 rounded"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-medium",children:"Inventory Details"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Warehouse and van stock breakdown"})]}),$e.showInventory&&a.jsx(Jt,{size:18,className:"text-emerald-600"})]}),a.jsxs("label",{className:"flex items-center gap-3 p-3 bg-white border rounded-lg cursor-pointer hover:bg-gray-50",children:[a.jsx("input",{type:"checkbox",checked:$e.showSalesHistory,onChange:T=>We({...$e,showSalesHistory:T.target.checked}),className:"w-5 h-5 text-emerald-600 rounded"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-medium",children:"Sales Summary"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Quantity sold, revenue, profit"})]}),$e.showSalesHistory&&a.jsx(Jt,{size:18,className:"text-emerald-600"})]})]})]})}),a.jsxs("div",{className:"p-6 border-t bg-gray-50 flex gap-3",children:[a.jsx("button",{onClick:()=>Z(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-100",children:"Cancel"}),a.jsxs("button",{onClick:()=>{Yt(),Z(!1)},disabled:Fe,className:"flex-1 px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 disabled:opacity-50 flex items-center justify-center gap-2",children:[a.jsx(ua,{size:18}),"Print Report"]})]})]})}),we&&Ge&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-sm shadow-xl",children:[a.jsxs("div",{className:"p-4 border-b flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-gray-800",children:"Adjust Stock"}),a.jsxs("p",{className:"text-xs text-gray-500",children:[Ge.name," (",Ge.sku,")"]})]}),a.jsx("button",{onClick:()=>et(!1),className:"text-gray-400 hover:text-gray-600",children:a.jsx(yt,{size:18})})]}),a.jsxs("div",{className:"p-4 space-y-3",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsx("button",{type:"button",onClick:()=>pr("add"),className:`py-2 rounded-lg border text-sm font-medium ${Rt==="add"?"bg-green-50 border-green-500 text-green-700":"hover:bg-gray-50"}`,children:"+ Add"}),a.jsx("button",{type:"button",onClick:()=>pr("subtract"),className:`py-2 rounded-lg border text-sm font-medium ${Rt==="subtract"?"bg-red-50 border-red-500 text-red-700":"hover:bg-gray-50"}`,children:" Subtract"})]}),me&&a.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 py-1",children:[a.jsx(vt,{size:14,className:"animate-spin"})," Loading variants..."]}),!me&&ve.length>0&&a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-medium text-gray-600 mb-1 block",children:"Variant"}),a.jsxs("select",{value:oe,onChange:T=>Ie(T.target.value?parseInt(T.target.value):""),className:"w-full px-3 py-2 border rounded-lg text-sm",children:[a.jsx("option",{value:"",children:" Base product (no variant) "}),ve.map(T=>{const Ae=[T.color,T.size,T.weight?`${T.weight}kg`:null,T.length?`${T.length}cm`:null,T.height?`${T.height}cm`:null].filter(Boolean),nt=Ae.length>0?Ae.join(" / "):T.name;return a.jsxs("option",{value:T.id,children:[nt,T.sku?` (${T.sku})`:"","  Stock: ",T.quantity]},T.id)})]})]}),n.length>1&&a.jsxs("select",{value:Je,onChange:T=>Xe(T.target.value?parseInt(T.target.value):""),className:"w-full px-3 py-2 border rounded-lg text-sm",required:!0,children:[a.jsx("option",{value:"",children:"Select warehouse..."}),n.map(T=>a.jsx("option",{value:T.id,children:T.name},T.id))]}),a.jsxs("div",{children:[a.jsxs("label",{className:"text-xs text-gray-500 mb-1 block",children:[Ge.baseUnit," quantity"]}),a.jsx("input",{type:"number",value:Zt,onChange:T=>er(T.target.value),min:"0",step:"any",className:"w-full px-3 py-2 border rounded-lg text-sm",placeholder:"0",autoFocus:!0})]}),Ge.secondUnit&&Ge.unitsPerSecond>0&&a.jsxs("div",{children:[a.jsxs("label",{className:"text-xs text-gray-500 mb-1 block",children:[Ge.secondUnit," quantity"]}),a.jsx("input",{type:"number",value:ue,onChange:T=>Le(T.target.value),min:"0",step:"any",className:"w-full px-3 py-2 border rounded-lg text-sm",placeholder:"0"})]}),a.jsxs("select",{value:le,onChange:T=>Me(T.target.value),className:"w-full px-3 py-2 border rounded-lg text-sm",children:[a.jsx("option",{value:"",children:"Reason (optional)"}),a.jsx("option",{value:"Physical Count",children:"Physical Count"}),a.jsx("option",{value:"Damaged",children:"Damaged"}),a.jsx("option",{value:"Expired",children:"Expired"}),a.jsx("option",{value:"Lost",children:"Lost"}),a.jsx("option",{value:"Returned to Supplier",children:"Returned to Supplier"}),a.jsx("option",{value:"Received from Supplier",children:"Received from Supplier"}),a.jsx("option",{value:"Correction",children:"Correction"})]}),a.jsxs("button",{onClick:Er,disabled:ut||!Zt||!Je,className:`w-full py-2 rounded-lg text-white font-medium text-sm disabled:opacity-50 flex items-center justify-center gap-2 ${Rt==="add"?"bg-green-600 hover:bg-green-700":"bg-red-600 hover:bg-red-700"}`,children:[ut?a.jsx(vt,{size:16,className:"animate-spin"}):null,ut?"Saving...":Rt==="add"?"+ Add Stock":" Subtract Stock"]})]})]})}),or&&zt&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-2xl shadow-xl max-h-[90vh] flex flex-col",children:[a.jsxs("div",{className:"p-4 border-b flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-gray-800",children:"Product Variants"}),a.jsxs("p",{className:"text-xs text-gray-500",children:[zt.name," (",zt.sku,")"]})]}),a.jsx("button",{onClick:()=>{Gt(!1),re()},className:"text-gray-400 hover:text-gray-600",children:a.jsx(yt,{size:18})})]}),a.jsxs("div",{className:"flex-1 overflow-auto p-4 space-y-4",children:[Is?a.jsx("div",{className:"text-center py-4",children:a.jsx(vt,{className:"animate-spin mx-auto",size:24})}):Or.length===0?a.jsx("p",{className:"text-sm text-gray-400 text-center py-4",children:"No variants yet. Add one below."}):a.jsx("div",{className:"space-y-2",children:Or.map(T=>a.jsxs("div",{className:`flex items-center gap-3 p-3 rounded-lg border ${(gr==null?void 0:gr.id)===T.id?"border-purple-300 bg-purple-50":"hover:bg-gray-50"}`,children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"font-medium text-sm",children:T.name}),a.jsxs("div",{className:"text-xs text-gray-500 flex gap-3 flex-wrap",children:[T.sku&&a.jsxs("span",{children:["SKU: ",T.sku]}),T.barcode&&a.jsxs("span",{children:["Barcode: ",T.barcode]}),T.retailPrice!=null&&a.jsxs("span",{children:["Retail: ",T.retailPrice]}),T.wholesalePrice!=null&&a.jsxs("span",{children:["Wholesale: ",T.wholesalePrice]}),T.costPrice!=null&&a.jsxs("span",{children:["Cost: ",T.costPrice]})]})]}),a.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] font-medium ${T.isActive?"bg-green-100 text-green-700":"bg-gray-100 text-gray-500"}`,children:T.isActive?"Active":"Inactive"}),a.jsx("button",{onClick:()=>ae(T),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",title:"Edit",children:a.jsx(js,{size:14})}),a.jsx("button",{onClick:()=>Be(T.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Delete",children:a.jsx(xr,{size:14})})]},T.id))}),a.jsxs("div",{className:"border-t pt-4",children:[a.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:gr?"Edit Variant":"Add New Variant"}),a.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-500 mb-1 block",children:"Name"}),a.jsx("input",{type:"text",value:zt.name,readOnly:!0,className:"w-full px-3 py-2 border rounded-lg text-sm bg-gray-100 text-gray-600 cursor-not-allowed"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-500 mb-1 block",children:"SKU"}),a.jsx("input",{type:"text",value:J.sku,onChange:T=>X(Ae=>({...Ae,sku:T.target.value})),className:"w-full px-3 py-2 border rounded-lg text-sm",placeholder:"Variant SKU"})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"text-xs text-gray-500 mb-1 flex justify-between items-center",children:[a.jsx("span",{children:"Barcode"}),a.jsxs("button",{type:"button",onClick:()=>X(T=>({...T,barcode:Ea()})),className:"px-1.5 py-0.5 text-[10px] bg-blue-500 hover:bg-blue-600 text-white rounded flex items-center gap-0.5",title:"Generate Barcode",children:[a.jsx(Oo,{size:10}),"Gen"]})]}),a.jsx("input",{type:"text",value:J.barcode,onChange:T=>X(Ae=>({...Ae,barcode:T.target.value})),className:"w-full px-3 py-2 border rounded-lg text-sm",placeholder:"Enter or generate"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-500 mb-1 block",children:"Retail Price"}),a.jsx("input",{type:"number",value:J.retailPrice,onChange:T=>X(Ae=>({...Ae,retailPrice:T.target.value})),className:"w-full px-3 py-2 border rounded-lg text-sm",placeholder:`${zt.retailPrice}`,step:"any"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-500 mb-1 block",children:"Wholesale Price"}),a.jsx("input",{type:"number",value:J.wholesalePrice,onChange:T=>X(Ae=>({...Ae,wholesalePrice:T.target.value})),className:"w-full px-3 py-2 border rounded-lg text-sm",placeholder:`${zt.wholesalePrice}`,step:"any"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-500 mb-1 block",children:"Cost Price"}),a.jsx("input",{type:"number",value:J.costPrice,onChange:T=>X(Ae=>({...Ae,costPrice:T.target.value})),className:"w-full px-3 py-2 border rounded-lg text-sm",placeholder:`${zt.costPrice}`,step:"any"})]}),zt.secondUnit&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-500 mb-1 block",children:"Box Retail"}),a.jsx("input",{type:"number",value:J.boxRetailPrice,onChange:T=>X(Ae=>({...Ae,boxRetailPrice:T.target.value})),className:"w-full px-3 py-2 border rounded-lg text-sm",placeholder:`${zt.boxRetailPrice}`,step:"any"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-500 mb-1 block",children:"Box Wholesale"}),a.jsx("input",{type:"number",value:J.boxWholesalePrice,onChange:T=>X(Ae=>({...Ae,boxWholesalePrice:T.target.value})),className:"w-full px-3 py-2 border rounded-lg text-sm",placeholder:`${zt.boxWholesalePrice}`,step:"any"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-500 mb-1 block",children:"Box Cost"}),a.jsx("input",{type:"number",value:J.boxCostPrice,onChange:T=>X(Ae=>({...Ae,boxCostPrice:T.target.value})),className:"w-full px-3 py-2 border rounded-lg text-sm",placeholder:`${zt.boxCostPrice}`,step:"any"})]})]})]}),a.jsxs("div",{className:"grid grid-cols-5 gap-3 mt-3 p-3 bg-gray-50 rounded-lg",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-500 mb-1 block",children:"Color"}),a.jsx("input",{type:"text",value:J.color,onChange:T=>X(Ae=>({...Ae,color:T.target.value})),className:"w-full px-3 py-2 border rounded-lg text-sm",placeholder:"e.g. Red"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-500 mb-1 block",children:"Size"}),a.jsx("input",{type:"text",value:J.size,onChange:T=>X(Ae=>({...Ae,size:T.target.value})),className:"w-full px-3 py-2 border rounded-lg text-sm",placeholder:"e.g. Large"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-500 mb-1 block",children:"Weight"}),a.jsx("input",{type:"number",value:J.weight,onChange:T=>X(Ae=>({...Ae,weight:T.target.value})),className:"w-full px-3 py-2 border rounded-lg text-sm",placeholder:"kg",step:"any"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-500 mb-1 block",children:"Length"}),a.jsx("input",{type:"number",value:J.length,onChange:T=>X(Ae=>({...Ae,length:T.target.value})),className:"w-full px-3 py-2 border rounded-lg text-sm",placeholder:"cm",step:"any"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-gray-500 mb-1 block",children:"Height"}),a.jsx("input",{type:"number",value:J.height,onChange:T=>X(Ae=>({...Ae,height:T.target.value})),className:"w-full px-3 py-2 border rounded-lg text-sm",placeholder:"cm",step:"any"})]})]}),a.jsxs("div",{className:"mt-3",children:[a.jsx("label",{className:"text-xs text-gray-500 mb-1 block",children:"Initial Quantity (Stock)"}),a.jsx("input",{type:"number",value:J.quantity,onChange:T=>X(Ae=>({...Ae,quantity:T.target.value})),className:"w-full px-3 py-2 border rounded-lg text-sm",placeholder:"0",min:"0"})]}),gr&&a.jsx("div",{className:"mt-3",children:a.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[a.jsx("input",{type:"checkbox",checked:J.isActive,onChange:T=>X(Ae=>({...Ae,isActive:T.target.checked}))}),"Active"]})}),a.jsx("p",{className:"text-[11px] text-gray-400 mt-2",children:"Leave price fields empty to use parent product prices."}),a.jsxs("div",{className:"flex gap-2 mt-3",children:[a.jsxs("button",{onClick:Ne,disabled:na,className:"px-4 py-2 bg-purple-600 text-white rounded-lg text-sm font-medium hover:bg-purple-700 disabled:opacity-50 flex items-center gap-2",children:[na&&a.jsx(vt,{size:14,className:"animate-spin"}),gr?"Update Variant":"Add Variant"]}),gr&&a.jsx("button",{onClick:re,className:"px-4 py-2 border rounded-lg text-sm hover:bg-gray-50",children:"Cancel"})]})]})]})]})})]})}function eve(){const e=Hd(),[t,r]=m.useState([]),[s,n]=m.useState([]),[i,l]=m.useState([]),[o,c]=m.useState(!0),[u,d]=m.useState(!1),[h,f]=m.useState(""),[x,p]=m.useState(""),[g,y]=m.useState(""),[v,j]=m.useState(""),[b,w]=m.useState(!1),[k,N]=m.useState(!1),[S,_]=m.useState(null),[O,E]=m.useState(!1),[R,C]=m.useState(null),[I,ne]=m.useState([]),[W,Q]=m.useState([]),[H,K]=m.useState(!1),[q,ge]=m.useState(!1),[G,B]=m.useState({productId:"",unitType:"piece",specialPrice:0}),[se,L]=m.useState(""),[Z,F]=m.useState(!1),[he,ye]=m.useState("idle"),[z,A]=m.useState(!1),[de,D]=m.useState(null),[ze,Fe]=m.useState([]),[ct,$e]=m.useState([]),[We,Bt]=m.useState([]),[Ee,it]=m.useState(null),[we,et]=m.useState(!1),[Ge,Nt]=m.useState({showSummary:!0,showOrders:!0,showTasks:!0,showCollections:!0,showProducts:!0,showDebtHistory:!0}),[Rt,pr]=m.useState(!1),[Zt,er]=m.useState(null),[ue,Le]=m.useState(""),[Je,Xe]=m.useState("cash"),[le,Me]=m.useState(""),[ut,ee]=m.useState(!1),[ve,xe]=m.useState([]),[oe,Ie]=m.useState(!1),[me,ht]=m.useState({name:"",shopName:"",phone:"",email:"",address:"",customerType:"Retail",warehouseId:"",creditLimit:0,creditBalance:0,debtBalance:0,notes:"",status:"active",supplierId:"",locationUrl:""}),[At,Er]=m.useState(!1),[or,Gt]=m.useState(null),[zt,ma]=m.useState(!1),[Or,_r]=m.useState(null);m.useEffect(()=>{Is()},[]);const Is=async()=>{try{c(!0);const[Y,De,at]=await Promise.all([Ha.getAll(),Ks.getAll(),Vr.getAll()]);r(Y.data),n(De.data.map(st=>({id:st.id,name:st.name}))),l(at.data.map(st=>({id:st.id,name:st.name})))}catch(Y){console.error("Failed to load data:",Y)}finally{c(!1)}},Jr=async()=>{try{const Y={};x&&(Y.status=x),g&&(Y.customerType=g),v&&(Y.warehouseId=v);const De=await Ha.getAll(Y);r(De.data)}catch(Y){console.error("Failed to load customers:",Y)}};m.useEffect(()=>{o||Jr()},[x,g,v]);const na=t.filter(Y=>{var De,at;if(b&&Y.debtBalance<=0)return!1;if(h){const st=h.toLowerCase();if(!(Y.name.toLowerCase().includes(st)||(De=Y.shopName)!=null&&De.toLowerCase().includes(st)||(at=Y.phone)!=null&&at.includes(st)))return!1}return!0}),Os=()=>{var Lt;const Y=na.reduce((pt,Ut)=>pt+Ut.debtBalance,0),De=na.reduce((pt,Ut)=>pt+Ut.creditBalance,0),at=na.filter(pt=>pt.debtBalance>0).length,st=window.open("","_blank","width=1000,height=800");if(!st){alert("Please allow popups to print report");return}const Mt=`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Customers Report</title>
        <style>
          * { margin: 0; padding: 0; box-sizing: border-box; }
          body { font-family: Arial, sans-serif; font-size: 12px; padding: 20px; direction: ltr; }
          .header { text-align: center; margin-bottom: 20px; border-bottom: 2px solid #333; padding-bottom: 10px; }
          .header h1 { font-size: 24px; margin-bottom: 5px; }
          .header p { color: #666; }
          .filters-applied { background: #f0f9ff; padding: 10px; border-radius: 5px; margin-bottom: 15px; font-size: 11px; }
          .summary-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-bottom: 20px; }
          .summary-card { border: 1px solid #ddd; padding: 12px; border-radius: 5px; text-align: center; }
          .summary-card .label { font-size: 10px; color: #666; text-transform: uppercase; }
          .summary-card .value { font-size: 18px; font-weight: bold; margin-top: 5px; }
          .summary-card .value.red { color: #ef4444; }
          .summary-card .value.blue { color: #3b82f6; }
          .summary-card .value.green { color: #22c55e; }
          table { width: 100%; border-collapse: collapse; margin-bottom: 15px; }
          th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
          th { background: #f5f5f5; font-weight: bold; font-size: 11px; }
          td { font-size: 11px; }
          .text-right { text-align: right; }
          .text-center { text-align: center; }
          .debt { color: #ef4444; font-weight: bold; }
          .credit { color: #3b82f6; }
          .footer { text-align: center; margin-top: 20px; padding-top: 10px; border-top: 1px solid #ddd; color: #666; font-size: 10px; }
          @media print { body { padding: 0; } }
        </style>
      </head>
      <body>
        <div class="header">
          <h1>Customers Report${b?" - Customers with Debt":""}</h1>
          <p>Generated: ${new Date().toLocaleString()}</p>
        </div>
        
        <div class="filters-applied">
          <strong>Filters:</strong>
          ${b?" With Debt Only |":""}
          ${g?" Type: "+g+" |":""}
          ${x?" Status: "+x+" |":""}
          ${v?" Warehouse: "+(((Lt=s.find(pt=>pt.id.toString()===v))==null?void 0:Lt.name)||v)+" |":""}
          ${h?' Search: "'+h+'" |':""}
          ${!b&&!g&&!x&&!v&&!h?" None (All Customers)":""}
        </div>
        
        <div class="summary-grid">
          <div class="summary-card">
            <div class="label">Total Customers</div>
            <div class="value">${na.length}</div>
          </div>
          <div class="summary-card">
            <div class="label">Customers with Debt</div>
            <div class="value red">${at}</div>
          </div>
          <div class="summary-card">
            <div class="label">Total Debt</div>
            <div class="value red">$${Y.toFixed(3)}</div>
          </div>
          <div class="summary-card">
            <div class="label">Total Credit</div>
            <div class="value blue">$${De.toFixed(3)}</div>
          </div>
        </div>
        
        <table>
          <thead>
            <tr>
              <th>#</th>
              <th>Name</th>
              <th>Shop</th>
              <th>Phone</th>
              <th>Type</th>
              <th class="text-right">Credit (we owe)</th>
              <th class="text-right">Debt (they owe)</th>
              <th class="text-center">Status</th>
            </tr>
          </thead>
          <tbody>
            ${na.map((pt,Ut)=>`
              <tr>
                <td>${Ut+1}</td>
                <td>${pt.name}</td>
                <td>${pt.shopName||"-"}</td>
                <td>${pt.phone||"-"}</td>
                <td>${pt.customerType}</td>
                <td class="text-right credit">$${pt.creditBalance.toFixed(3)}</td>
                <td class="text-right ${pt.debtBalance>0?"debt":""}">$${pt.debtBalance.toFixed(3)}</td>
                <td class="text-center">${pt.status}</td>
              </tr>
            `).join("")}
          </tbody>
          <tfoot>
            <tr>
              <th colspan="5">Total (${na.length} customers)</th>
              <th class="text-right credit">$${De.toFixed(3)}</th>
              <th class="text-right debt">$${Y.toFixed(3)}</th>
              <th></th>
            </tr>
          </tfoot>
        </table>
        
        <div class="footer">
          <p>Catalyst Customers Report - Confidential</p>
        </div>
      </body>
      </html>
    `;st.document.write(Mt),st.document.close(),st.onload=()=>{st.focus(),st.print()}},gr=()=>ht({name:"",shopName:"",phone:"",email:"",address:"",customerType:"Retail",warehouseId:"",creditLimit:0,creditBalance:0,debtBalance:0,notes:"",status:"active",supplierId:"",locationUrl:""}),V=Y=>{if(!Y.trim()){ye("idle");return}ht({...me,locationUrl:Y.trim()}),ye("success")},J=Y=>{var De,at;_(Y),ht({name:Y.name,shopName:Y.shopName||"",phone:Y.phone||"",email:Y.email||"",address:Y.address||"",customerType:Y.customerType,warehouseId:((De=Y.warehouseId)==null?void 0:De.toString())||"",creditLimit:Y.creditLimit,creditBalance:Y.creditBalance,debtBalance:Y.debtBalance,notes:Y.notes||"",status:Y.status,supplierId:((at=Y.supplierId)==null?void 0:at.toString())||"",locationUrl:Y.locationUrl||""}),ye("idle"),N(!0)},X=async Y=>{var De,at;if(Y.preventDefault(),!!me.name.trim()){d(!0);try{const st={...me,warehouseId:me.warehouseId?parseInt(me.warehouseId):null,supplierId:me.supplierId?parseInt(me.supplierId):null,locationUrl:me.locationUrl||null};S?await Ha.update(S.id,st):await Ha.create(st),N(!1),gr(),_(null),Jr()}catch(st){alert(((at=(De=st.response)==null?void 0:De.data)==null?void 0:at.message)||"Failed to save customer")}finally{d(!1)}}},te=async Y=>{var De,at;if(confirm(`Delete customer "${Y.name}"? This action cannot be undone.`))try{await Ha.delete(Y.id),Jr()}catch(st){alert(((at=(De=st.response)==null?void 0:De.data)==null?void 0:at.message)||"Failed to delete customer. It may have related orders or transactions.")}},re=async Y=>{er(Y),Le(Y.debtBalance>0?Y.debtBalance.toString():""),Xe("cash"),Me(""),xe([]),pr(!0),Ie(!0);try{const De=await ie.get(`/collections?customerId=${Y.id}`);xe(De.data.map(at=>({id:at.id,collectionNumber:at.collectionNumber,collectionDate:at.collectionDate,amount:at.amount,paymentType:at.paymentType,notes:at.notes})))}catch(De){console.error("Failed to load collection history:",De)}finally{Ie(!1)}},ae=async Y=>{var at,st;if(Y.preventDefault(),!Zt||!ue)return;const De=parseFloat(ue);if(De<=0){alert("Please enter a valid amount");return}ee(!0);try{await ie.post("/cash/collections",{customerId:Zt.id,amount:De,paymentType:Je,collectionDate:new Date().toISOString(),collectionTime:new Date().toLocaleTimeString("en-US",{hour12:!1}),notes:le||"Debt settlement from company portal"}),pr(!1),er(null),Le(""),Jr()}catch(Mt){alert(((st=(at=Mt.response)==null?void 0:at.data)==null?void 0:st.message)||"Failed to settle debt")}finally{ee(!1)}},Ne=async Y=>{C(Y),E(!0),K(!0),B({productId:"",unitType:"piece",specialPrice:0}),L(""),F(!1);try{const[De,at]=await Promise.all([Ha.getSpecialPrices(Y.id),br.getAll()]);ne(De.data),Q(at.data.map(st=>({id:st.id,name:st.name,sku:st.sku,barcode:st.barcode,boxBarcode:st.boxBarcode,baseUnit:st.baseUnit||"Piece",secondUnit:st.secondUnit,unitsPerSecond:st.unitsPerSecond||0,retailPrice:st.retailPrice,costPrice:st.costPrice||0,boxRetailPrice:st.boxRetailPrice||0,boxCostPrice:st.boxCostPrice||0})))}catch(De){console.error("Failed to load special prices:",De)}finally{K(!1)}},Be=async Y=>{var De,at,st;if(Y.preventDefault(),!(!R||!G.productId)){ge(!0);try{await Ha.addSpecialPrice(R.id,{productId:parseInt(G.productId),unitType:G.unitType,specialPrice:G.specialPrice});const Mt=await Ha.getSpecialPrices(R.id);ne(Mt.data),B({productId:"",unitType:"piece",specialPrice:0}),L(""),F(!1)}catch(Mt){alert(((at=(De=Mt.response)==null?void 0:De.data)==null?void 0:at.message)||((st=Mt.response)==null?void 0:st.data)||"Failed to add special price")}finally{ge(!1)}}},Se=async Y=>{if(!(!R||!confirm("Delete this special price?")))try{await Ha.deleteSpecialPrice(R.id,Y),ne(I.filter(De=>De.id!==Y))}catch{alert("Failed to delete special price")}},Pe=async Y=>{D(Y),A(!0),et(!0),it(null);try{const[De,at,st,Mt]=await Promise.all([ie.get(`/orders?customerId=${Y.id}`),ie.get(`/tasks?customerId=${Y.id}&status=Completed`),ie.get(`/collections?customerId=${Y.id}`),ie.get(`/customers/${Y.id}/supplier-report`)]);it(Mt.data),Fe(De.data.map(Lt=>{var pt;return{id:Lt.id,orderNumber:Lt.orderNumber,orderDate:Lt.orderDate,totalAmount:Lt.totalAmount,paidAmount:Lt.paidAmount,orderStatus:Lt.orderStatus,paymentStatus:Lt.paymentStatus,items:((pt=Lt.orderItems)==null?void 0:pt.map(Ut=>{var qt;return{productName:((qt=Ut.product)==null?void 0:qt.name)||"Unknown",quantity:Ut.quantity,unitPrice:Ut.unitPrice,total:Ut.total}}))||[]}})),$e(at.data.map(Lt=>{var pt;return{id:Lt.id,taskNumber:Lt.taskNumber,scheduledDate:Lt.scheduledDate,total:Lt.total,paidAmount:Lt.paidAmount||0,debtAmount:Lt.debtAmount||0,status:Lt.status,paymentType:Lt.paymentType||"cash",items:((pt=Lt.items)==null?void 0:pt.map(Ut=>({productName:Ut.productName||"Unknown",quantity:Ut.quantity,unitPrice:Ut.unitPrice,total:Ut.total})))||[]}})),Bt(st.data.map(Lt=>({id:Lt.id,collectionNumber:Lt.collectionNumber,collectionDate:Lt.collectionDate,amount:Lt.amount,paymentType:Lt.paymentType,notes:Lt.notes})))}catch(De){console.error("Failed to load report data:",De)}finally{et(!1)}},pe=Y=>`$${Y.toFixed(3)}`,qe=Y=>new Date(Y).toLocaleDateString(),lt=()=>{var Ue,M,je;if(!de)return;const Y=new Map;ze.forEach(fe=>{fe.items.forEach(Ce=>{const Qe=Y.get(Ce.productName);Qe?(Qe.quantity+=Ce.quantity,Qe.total+=Ce.total):Y.set(Ce.productName,{quantity:Ce.quantity,total:Ce.total})})}),ct.forEach(fe=>{fe.items.forEach(Ce=>{const Qe=Y.get(Ce.productName);Qe?(Qe.quantity+=Ce.quantity,Qe.total+=Ce.total):Y.set(Ce.productName,{quantity:Ce.quantity,total:Ce.total})})});const De=Array.from(Y.entries()).map(([fe,Ce])=>({name:fe,...Ce})).sort((fe,Ce)=>Ce.total-fe.total),at=ze.reduce((fe,Ce)=>fe+Ce.totalAmount,0),st=ct.reduce((fe,Ce)=>fe+Ce.total,0),Mt=at+st,Lt=ze.reduce((fe,Ce)=>fe+Ce.paidAmount,0)+ct.reduce((fe,Ce)=>fe+Ce.paidAmount,0),pt=We.reduce((fe,Ce)=>fe+Ce.amount,0),Ut=Lt+pt,qt=de.debtBalance,Ca=de.creditBalance,nr=Ee!=null&&Ee.hasSupplier&&((Ue=Ee.supplier)==null?void 0:Ue.balance)||0,Ea=qt-Ca-nr,Dr=window.open("","_blank","width=1000,height=800");if(!Dr){alert("Please allow popups to print report");return}const Ds=`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Customer Report - ${de.name}</title>
        <style>
          * { margin: 0; padding: 0; box-sizing: border-box; }
          body { font-family: Arial, sans-serif; font-size: 12px; padding: 20px; }
          .header { text-align: center; margin-bottom: 20px; border-bottom: 2px solid #ec4899; padding-bottom: 10px; }
          .header h1 { font-size: 24px; color: #ec4899; margin-bottom: 5px; }
          .header p { color: #666; }
          .info-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 20px; background: linear-gradient(135deg, #fdf2f8 0%, #fce7f3 100%); padding: 15px; border-radius: 8px; }
          .info-item .label { font-size: 10px; color: #be185d; text-transform: uppercase; }
          .info-item .value { font-weight: bold; }
          .info-item .customer-name { font-size: 18px; color: #be185d; }
          .summary-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-bottom: 20px; }
          .summary-card { border: 1px solid #ddd; padding: 12px; border-radius: 8px; text-align: center; }
          .summary-card .label { font-size: 10px; color: #666; text-transform: uppercase; }
          .summary-card .value { font-size: 18px; font-weight: bold; margin-top: 5px; }
          .summary-card .value.pink { color: #ec4899; }
          .summary-card .value.green { color: #22c55e; }
          .summary-card .value.red { color: #ef4444; }
          .summary-card .value.blue { color: #3b82f6; }
          .section { margin-bottom: 20px; }
          .section h2 { font-size: 16px; margin-bottom: 10px; border-bottom: 1px solid #ec4899; padding-bottom: 5px; color: #ec4899; }
          table { width: 100%; border-collapse: collapse; margin-bottom: 15px; }
          th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
          th { background: #fdf2f8; font-weight: bold; }
          .text-right { text-align: right; }
          .text-center { text-align: center; }
          .status-paid { background: #dcfce7; color: #16a34a; padding: 2px 8px; border-radius: 10px; font-weight: bold; }
          .status-unpaid { background: #fee2e2; color: #dc2626; padding: 2px 8px; border-radius: 10px; font-weight: bold; }
          .status-partial { background: #fef3c7; color: #d97706; padding: 2px 8px; border-radius: 10px; font-weight: bold; }
          .footer { text-align: center; margin-top: 20px; padding-top: 10px; border-top: 1px solid #ddd; color: #666; font-size: 10px; }
          .net-balance-box { padding: 20px; border-radius: 10px; text-align: center; margin-bottom: 20px; }
          .net-balance-box.owes-us { background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%); border: 2px solid #ef4444; }
          .net-balance-box.we-owe { background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%); border: 2px solid #22c55e; }
          .net-balance-box.balanced { background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%); border: 2px solid #94a3b8; }
          .net-balance-box h3 { font-size: 14px; margin-bottom: 5px; color: #666; }
          .net-balance-box .status-text { font-size: 18px; font-weight: bold; margin-bottom: 5px; }
          .net-balance-box .amount { font-size: 36px; font-weight: bold; margin: 10px 0; }
          .net-balance-box .amount.red { color: #dc2626; }
          .net-balance-box .amount.green { color: #16a34a; }
          .net-balance-box .breakdown { font-size: 11px; color: #666; margin-top: 15px; display: flex; justify-content: center; gap: 20px; flex-wrap: wrap; }
          .net-balance-box .breakdown span { padding: 5px 10px; background: rgba(255,255,255,0.5); border-radius: 5px; }
          .row-highlight:hover { background: #fdf2f8; }
          .balance-cell { font-weight: bold; }
          @media print { body { padding: 0; } }
        </style>
      </head>
      <body>
        <div class="header">
          <h1>Customer Report</h1>
          <p>Customer Statement</p>
          <p style="margin-top: 5px; color: #666;">Generated: ${new Date().toLocaleString()}</p>
        </div>
        
        <div class="info-grid">
          <div class="info-item" style="grid-column: span 3;">
            <div class="customer-name">${de.name}${de.shopName?` - ${de.shopName}`:""}</div>
          </div>
          <div class="info-item">
            <div class="label">Phone</div>
            <div class="value">${de.phone||"-"}</div>
          </div>
          <div class="info-item">
            <div class="label">Email</div>
            <div class="value">${de.email||"-"}</div>
          </div>
          <div class="info-item">
            <div class="label">Address</div>
            <div class="value">${de.address||"-"}</div>
          </div>
          <div class="info-item">
            <div class="label">Type</div>
            <div class="value">${de.customerType}</div>
          </div>
          <div class="info-item">
            <div class="label">Credit Limit</div>
            <div class="value">${pe(de.creditLimit)}</div>
          </div>
          <div class="info-item">
            <div class="label">Status</div>
            <div class="value">${de.status}</div>
          </div>
        </div>
        
        <div class="net-balance-box ${Ea>0?"owes-us":Ea<0?"we-owe":"balanced"}">
          <h3> NET BALANCE</h3>
          <div class="status-text">${Ea>0?" This person OWES US":Ea<0?" We OWE this person":" Balanced"}</div>
          <div class="amount ${Ea>0?"red":"green"}">${pe(Math.abs(Ea))}</div>
          <div class="breakdown">
            <span> Customer Debt: ${pe(qt)}</span>
            <span> Credit Balance: ${pe(Ca)}</span>
            ${Ee!=null&&Ee.hasSupplier?`<span> Supplier Balance: ${pe(nr)}</span>`:""}
          </div>
        </div>
        
        ${Ge.showSummary?`
        <div class="summary-grid">
          <div class="summary-card">
            <div class="label"> Total Purchases</div>
            <div class="value pink">${pe(Mt)}</div>
          </div>
          <div class="summary-card">
            <div class="label"> Total Payments</div>
            <div class="value green">${pe(Ut)}</div>
          </div>
          <div class="summary-card">
            <div class="label"> Current Debt</div>
            <div class="value red">${pe(de.debtBalance)}</div>
          </div>
          <div class="summary-card">
            <div class="label"> Credit Balance</div>
            <div class="value blue">${pe(de.creditBalance)}</div>
          </div>
        </div>
        `:""}
        
        ${Ge.showProducts&&De.length>0?`
        <div class="section">
          <h2> Products Purchased</h2>
          <table>
            <thead>
              <tr>
                <th>Product</th>
                <th class="text-center">Total Qty</th>
                <th class="text-right">Total Amount</th>
              </tr>
            </thead>
            <tbody>
              ${De.map(fe=>`
                <tr class="row-highlight">
                  <td style="font-weight: 500;">${fe.name}</td>
                  <td class="text-center">${fe.quantity}</td>
                  <td class="text-right" style="font-weight: 500;">${pe(fe.total)}</td>
                </tr>
              `).join("")}
            </tbody>
            <tfoot>
              <tr style="font-weight: bold;">
                <th colspan="2">Total</th>
                <th class="text-right" style="color: #ec4899;">${pe(De.reduce((fe,Ce)=>fe+Ce.total,0))}</th>
              </tr>
            </tfoot>
          </table>
        </div>
        `:""}
        
        ${Ge.showOrders&&ze.length>0?`
        <div class="section">
          <h2> POS Orders (${ze.length})</h2>
          <table>
            <thead>
              <tr>
                <th>Order #</th>
                <th>Date</th>
                <th class="text-right">Total</th>
                <th class="text-right">Paid</th>
                <th class="text-right">Balance</th>
                <th class="text-center">Status</th>
              </tr>
            </thead>
            <tbody>
              ${ze.map(fe=>`
                <tr class="row-highlight">
                  <td style="color: #ec4899; font-weight: 500;">${fe.orderNumber}</td>
                  <td>${qe(fe.orderDate)}</td>
                  <td class="text-right" style="font-weight: 500;">${pe(fe.totalAmount)}</td>
                  <td class="text-right" style="color: #22c55e;">${pe(fe.paidAmount)}</td>
                  <td class="text-right" style="color: #ef4444;">${pe(fe.totalAmount-fe.paidAmount)}</td>
                  <td class="text-center">
                    <span class="${fe.paymentStatus==="paid"?"status-paid":fe.paymentStatus==="partial"?"status-partial":"status-unpaid"}">${fe.paymentStatus.toUpperCase()}</span>
                  </td>
                </tr>
              `).join("")}
            </tbody>
            <tfoot>
              <tr style="font-weight: bold;">
                <th colspan="2">Total</th>
                <th class="text-right">${pe(at)}</th>
                <th class="text-right" style="color: #22c55e;">${pe(ze.reduce((fe,Ce)=>fe+Ce.paidAmount,0))}</th>
                <th class="text-right" style="color: #ef4444;">${pe(at-ze.reduce((fe,Ce)=>fe+Ce.paidAmount,0))}</th>
                <th></th>
              </tr>
            </tfoot>
          </table>
        </div>
        `:""}
        
        ${Ge.showTasks&&ct.length>0?`
        <div class="section">
          <h2> Delivery Tasks (${ct.length})</h2>
          <table>
            <thead>
              <tr>
                <th>Task #</th>
                <th>Date</th>
                <th class="text-right">Total</th>
                <th class="text-right">Paid</th>
                <th class="text-right">Balance</th>
                <th class="text-center">Status</th>
              </tr>
            </thead>
            <tbody>
              ${ct.map(fe=>`
                <tr class="row-highlight">
                  <td style="color: #ec4899; font-weight: 500;">${fe.taskNumber}</td>
                  <td>${qe(fe.scheduledDate)}</td>
                  <td class="text-right" style="font-weight: 500;">${pe(fe.total)}</td>
                  <td class="text-right" style="color: #22c55e;">${pe(fe.paidAmount)}</td>
                  <td class="text-right" style="color: #ef4444;">${pe(fe.debtAmount)}</td>
                  <td class="text-center">
                    <span class="${fe.debtAmount===0?"status-paid":fe.paidAmount>0?"status-partial":"status-unpaid"}">${fe.debtAmount===0?"PAID":fe.paidAmount>0?"PARTIAL":"UNPAID"}</span>
                  </td>
                </tr>
              `).join("")}
            </tbody>
            <tfoot>
              <tr style="font-weight: bold;">
                <th colspan="2">Total</th>
                <th class="text-right">${pe(st)}</th>
                <th class="text-right" style="color: #22c55e;">${pe(ct.reduce((fe,Ce)=>fe+Ce.paidAmount,0))}</th>
                <th class="text-right" style="color: #ef4444;">${pe(ct.reduce((fe,Ce)=>fe+Ce.debtAmount,0))}</th>
                <th></th>
              </tr>
            </tfoot>
          </table>
        </div>
        `:""}
        
        ${Ge.showCollections&&We.length>0?`
        <div class="section">
          <h2> Debt Collections (${We.length})</h2>
          <table>
            <thead>
              <tr>
                <th>Collection #</th>
                <th>Date</th>
                <th class="text-right">Amount</th>
                <th class="text-center">Payment Type</th>
                <th>Notes</th>
              </tr>
            </thead>
            <tbody>
              ${We.map(fe=>`
                <tr class="row-highlight">
                  <td style="color: #ec4899; font-weight: 500;">${fe.collectionNumber}</td>
                  <td>${qe(fe.collectionDate)}</td>
                  <td class="text-right" style="color: #22c55e; font-weight: 500;">${pe(fe.amount)}</td>
                  <td class="text-center"><span class="status-paid">${fe.paymentType.toUpperCase()}</span></td>
                  <td>${fe.notes||"-"}</td>
                </tr>
              `).join("")}
            </tbody>
            <tfoot>
              <tr style="font-weight: bold;">
                <th colspan="2">Total Collected</th>
                <th class="text-right" style="color: #22c55e;">${pe(pt)}</th>
                <th colspan="2"></th>
              </tr>
            </tfoot>
          </table>
        </div>
        `:""}
        
        ${Ee!=null&&Ee.hasSupplier?`
        <div class="section" style="border-top: 3px solid #f59e0b; padding-top: 20px; margin-top: 20px;">
          <h2 style="color: #f59e0b;"> Linked Supplier: ${Ee.supplier.name}</h2>
          <p style="color: #666; margin-bottom: 15px;">This customer is also registered as a supplier. Below is their supplier activity.</p>
          
          <div class="summary-grid" style="grid-template-columns: repeat(3, 1fr);">
            <div class="summary-card">
              <div class="label">Total Invoices</div>
              <div class="value red">${pe(Ee.totalInvoices)}</div>
            </div>
            <div class="summary-card">
              <div class="label">Total Paid</div>
              <div class="value green">${pe(Ee.totalPaid)}</div>
            </div>
            <div class="summary-card">
              <div class="label">Supplier Balance</div>
              <div class="value ${Ee.supplier.balance>0?"red":"green"}">${pe(Ee.supplier.balance)}</div>
            </div>
          </div>
          
          ${((M=Ee.invoices)==null?void 0:M.length)>0?`
          <h3 style="margin-top: 15px; margin-bottom: 10px;">Purchase Invoices (${Ee.invoices.length})</h3>
          <table>
            <thead>
              <tr>
                <th>Invoice #</th>
                <th>Date</th>
                <th class="text-right">Total</th>
                <th class="text-right">Paid</th>
                <th class="text-right">Balance</th>
                <th class="text-center">Status</th>
              </tr>
            </thead>
            <tbody>
              ${Ee.invoices.map(fe=>`
                <tr class="row-highlight">
                  <td style="color: #f59e0b; font-weight: 500;">${fe.invoiceNumber}</td>
                  <td>${qe(fe.invoiceDate)}</td>
                  <td class="text-right" style="font-weight: 500;">${pe(fe.totalAmount)}</td>
                  <td class="text-right" style="color: #22c55e;">${pe(fe.paidAmount)}</td>
                  <td class="text-right" style="color: #ef4444;">${pe(fe.totalAmount-fe.paidAmount)}</td>
                  <td class="text-center">
                    <span class="${fe.paymentStatus==="paid"?"status-paid":fe.paymentStatus==="partial"?"status-partial":"status-unpaid"}">${fe.paymentStatus.toUpperCase()}</span>
                  </td>
                </tr>
              `).join("")}
            </tbody>
          </table>
          `:""}
          
          ${((je=Ee.payments)==null?void 0:je.length)>0?`
          <h3 style="margin-top: 15px; margin-bottom: 10px;">Supplier Payments (${Ee.payments.length})</h3>
          <table>
            <thead>
              <tr>
                <th>Payment #</th>
                <th>Date</th>
                <th class="text-right">Amount</th>
                <th class="text-center">Method</th>
                <th>Notes</th>
              </tr>
            </thead>
            <tbody>
              ${Ee.payments.map(fe=>`
                <tr class="row-highlight">
                  <td style="color: #f59e0b; font-weight: 500;">${fe.paymentNumber}</td>
                  <td>${qe(fe.paymentDate)}</td>
                  <td class="text-right" style="color: #22c55e; font-weight: 500;">${pe(fe.amount)}</td>
                  <td class="text-center"><span class="status-paid">${fe.method.toUpperCase()}</span></td>
                  <td>${fe.notes||"-"}</td>
                </tr>
              `).join("")}
            </tbody>
          </table>
          `:""}
        </div>
        `:""}
        
        <div class="footer">
          <p>Catalyst Customer Report - Confidential</p>
        </div>
      </body>
      </html>
    `;Dr.document.write(Ds),Dr.document.close(),Dr.onload=()=>{Dr.focus(),Dr.print()}},ft=W,Ze=()=>{window.open(`${ie.defaults.baseURL}/customers/template`,"_blank")},dt=async()=>{var Y,De;if(or){ma(!0),_r(null);try{const at=new FormData;at.append("file",or);const st=await ie.post("/customers/bulk-upload",at,{headers:{"Content-Type":"multipart/form-data"}});_r(st.data),st.data.successful>0&&Jr()}catch(at){_r({totalProcessed:0,successful:0,failed:1,errors:[((De=(Y=at.response)==null?void 0:Y.data)==null?void 0:De.message)||"Upload failed"]})}finally{ma(!1)}}},Ot=()=>{Er(!1),Gt(null),_r(null)};return o?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx(vt,{className:"animate-spin",size:32})}):a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[a.jsx(Hp,{className:"text-blue-600"})," Customers"]}),a.jsx(qr,{permission:Ve.CREATE_CUSTOMERS,children:a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("button",{onClick:()=>Er(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600",children:[a.jsx(d0,{size:20})," Bulk Upload"]}),a.jsxs("button",{onClick:()=>{gr(),_(null),ye("idle"),N(!0)},className:"flex items-center gap-2 px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600",children:[a.jsx(hr,{size:20})," Add Customer"]})]})})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4 mb-6",children:[a.jsxs("div",{className:"flex flex-wrap gap-3 items-center",children:[a.jsxs("div",{className:"flex-1 relative min-w-[200px]",children:[a.jsx(Na,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:20}),a.jsx("input",{type:"text",placeholder:"Search customers...",value:h,onChange:Y=>f(Y.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg"})]}),a.jsxs("select",{value:v,onChange:Y=>j(Y.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg",children:[a.jsx("option",{value:"",children:"All Warehouses"}),s.map(Y=>a.jsx("option",{value:Y.id,children:Y.name},Y.id))]}),a.jsxs("select",{value:g,onChange:Y=>y(Y.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg",children:[a.jsx("option",{value:"",children:"All Types"}),a.jsx("option",{value:"Retail",children:"Retail"}),a.jsx("option",{value:"Wholesale",children:"Wholesale"}),a.jsx("option",{value:"Special",children:"Special"})]}),a.jsxs("select",{value:x,onChange:Y=>p(Y.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg",children:[a.jsx("option",{value:"",children:"All Status"}),a.jsx("option",{value:"active",children:"Active"}),a.jsx("option",{value:"inactive",children:"Inactive"})]}),a.jsxs("label",{className:"flex items-center gap-2 px-3 py-2 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50",children:[a.jsx("input",{type:"checkbox",checked:b,onChange:Y=>w(Y.target.checked),className:"w-4 h-4 text-red-600 rounded"}),a.jsx(da,{size:16,className:"text-red-500"}),a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"With Debt"})]}),a.jsxs("button",{onClick:Os,className:"flex items-center gap-2 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700",children:[a.jsx(ua,{size:18})," Print Report"]})]}),a.jsxs("div",{className:"mt-3 flex items-center gap-4 text-sm text-gray-600",children:[a.jsxs("span",{children:["Showing ",a.jsx("strong",{children:na.length})," of ",t.length," customers"]}),b&&a.jsx("span",{className:"px-2 py-1 bg-red-100 text-red-700 rounded-full text-xs font-medium",children:"Debt Only"}),a.jsxs("span",{className:"text-red-600 font-medium",children:["Total Debt: $",na.reduce((Y,De)=>Y+De.debtBalance,0).toFixed(3)]})]})]}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden",children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Name"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Shop"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Phone"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Type"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Warehouse"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Credit (we owe)"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Debts (they owe)"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Status"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:na.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:9,className:"px-4 py-8 text-center text-gray-500",children:"No customers found"})}):na.map(Y=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 font-medium",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>e(`/tasks?customer=${Y.id}`),className:"p-1 text-blue-500 hover:bg-blue-50 rounded",title:"View Orders",children:a.jsx(gs,{size:14})}),Y.locationUrl&&a.jsx("a",{href:Y.locationUrl,target:"_blank",rel:"noopener noreferrer",className:"p-1 text-green-600 hover:bg-green-50 rounded",title:"View on Map",onClick:De=>De.stopPropagation(),children:a.jsx(dc,{size:14})}),Y.name]})}),a.jsx("td",{className:"px-4 py-3",children:Y.shopName||"-"}),a.jsx("td",{className:"px-4 py-3",children:Y.phone||"-"}),a.jsx("td",{className:"px-4 py-3",children:Y.customerType}),a.jsx("td",{className:"px-4 py-3",children:Y.warehouseName||"-"}),a.jsxs("td",{className:"px-4 py-3 text-blue-600",children:["$",Y.creditBalance.toFixed(3)]}),a.jsxs("td",{className:"px-4 py-3 text-red-600 font-medium",children:["$",Y.debtBalance.toFixed(3)]}),a.jsx("td",{className:"px-4 py-3",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${Y.status==="active"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:Y.status==="active"?"Active":"Inactive"})}),a.jsx("td",{className:"px-4 py-3",children:a.jsxs("div",{className:"flex gap-1",children:[a.jsx(qr,{permission:Ve.EDIT_CUSTOMERS,children:a.jsx("button",{onClick:()=>J(Y),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",title:"Edit",children:a.jsx(js,{size:16})})}),a.jsx(qr,{permission:Ve.MANAGE_SPECIAL_PRICES,children:a.jsx("button",{onClick:()=>Ne(Y),className:"p-1 text-purple-600 hover:bg-purple-50 rounded",title:"Special Pricing",children:a.jsx(xf,{size:16})})}),Y.debtBalance>0&&a.jsx("button",{onClick:()=>re(Y),className:"p-1 text-orange-600 hover:bg-orange-50 rounded",title:"Settle Debt",children:a.jsx(da,{size:16})}),a.jsx("button",{onClick:()=>e(`/customer-report/${Y.id}`),className:"p-1 text-pink-600 hover:bg-pink-50 rounded",title:"View Report",children:a.jsx(qi,{size:16})}),a.jsx("button",{onClick:()=>Pe(Y),className:"p-1 text-emerald-600 hover:bg-emerald-50 rounded",title:"Print Report",children:a.jsx(Br,{size:16})}),a.jsx(qr,{permission:Ve.EDIT_CUSTOMERS,children:a.jsx("button",{onClick:()=>te(Y),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Delete",children:a.jsx(xr,{size:16})})})]})})]},Y.id))})]})})}),k&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-2xl max-h-[90vh] overflow-hidden",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-[#003366] text-white",children:[a.jsx("h2",{className:"text-lg font-semibold",children:S?"Edit Customer":"Add Customer"}),a.jsx("button",{onClick:()=>N(!1),children:a.jsx(yt,{size:24})})]}),a.jsxs("form",{onSubmit:X,className:"p-6 space-y-4 overflow-y-auto max-h-[calc(90vh-120px)]",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name *"}),a.jsx("input",{type:"text",required:!0,value:me.name,onChange:Y=>ht({...me,name:Y.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"Enter name"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Shop Name"}),a.jsx("input",{type:"text",value:me.shopName,onChange:Y=>ht({...me,shopName:Y.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"Enter shop name"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),a.jsx("input",{type:"text",value:me.phone,onChange:Y=>ht({...me,phone:Y.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"Enter phone"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),a.jsx("input",{type:"email",value:me.email,onChange:Y=>ht({...me,email:Y.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"Enter email"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),a.jsx("input",{type:"text",value:me.address,onChange:Y=>ht({...me,address:Y.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"Enter address"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" Google Maps Link"}),a.jsx("input",{type:"text",onChange:Y=>V(Y.target.value),className:`w-full px-3 py-2 border rounded-lg ${he==="success"?"border-green-500 bg-green-50":he==="error"?"border-red-500 bg-red-50":he==="loading"?"border-blue-500 bg-blue-50":"border-gray-300"}`,placeholder:"Paste Google Maps link here to auto-fill coordinates"}),he==="success"&&a.jsx("span",{className:"text-xs text-green-600",children:" Location URL saved!"}),he==="idle"&&a.jsx("span",{className:"text-xs text-gray-500",children:"Paste any Google Maps link (short or full URL)"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer Type"}),a.jsxs("select",{value:me.customerType,onChange:Y=>ht({...me,customerType:Y.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[a.jsx("option",{value:"Retail",children:"Retail"}),a.jsx("option",{value:"Wholesale",children:"Wholesale"}),a.jsx("option",{value:"Special",children:"Special"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Assigned Warehouse"}),a.jsxs("select",{value:me.warehouseId,onChange:Y=>ht({...me,warehouseId:Y.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[a.jsx("option",{value:"",children:"Select Warehouse"}),s.map(Y=>a.jsx("option",{value:Y.id,children:Y.name},Y.id))]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Link to Supplier (Same Person)"}),a.jsxs("select",{value:me.supplierId,onChange:Y=>ht({...me,supplierId:Y.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[a.jsx("option",{value:"",children:"No Supplier Link"}),i.map(Y=>a.jsx("option",{value:Y.id,children:Y.name},Y.id))]}),a.jsx("span",{className:"text-xs text-gray-500",children:"If this customer is also a supplier, link them for combined reports"})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Credit Limit"}),a.jsx("input",{type:"number",step:"0.01",value:me.creditLimit,onChange:Y=>ht({...me,creditLimit:parseFloat(Y.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Credit (we owe them)"}),a.jsx("input",{type:"number",step:"0.01",value:me.creditBalance,onChange:Y=>ht({...me,creditBalance:parseFloat(Y.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"}),a.jsx("span",{className:"text-xs text-gray-500",children:"Advance or refund amount"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Debts (they owe us)"}),a.jsx("input",{type:"number",step:"0.01",value:me.debtBalance,onChange:Y=>ht({...me,debtBalance:parseFloat(Y.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"}),a.jsx("span",{className:"text-xs text-gray-500",children:"Unpaid invoices"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),a.jsx("textarea",{value:me.notes,onChange:Y=>ht({...me,notes:Y.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",rows:2,placeholder:"Enter notes"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",id:"isActive",checked:me.status==="active",onChange:Y=>ht({...me,status:Y.target.checked?"active":"inactive"}),className:"rounded"}),a.jsx("label",{htmlFor:"isActive",className:"text-sm",children:"Active"})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>N(!1),className:"flex-1 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:u,className:"flex-1 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 disabled:opacity-50",children:u?"Saving...":"Save"})]})]})]})}),O&&R&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-3xl max-h-[90vh] overflow-hidden",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-purple-600 text-white",children:[a.jsxs("h2",{className:"text-lg font-semibold",children:["Special Pricing  ",R.name]}),a.jsx("button",{onClick:()=>E(!1),children:a.jsx(yt,{size:24})})]}),a.jsxs("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-120px)]",children:[a.jsxs("form",{onSubmit:Be,className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-3",children:"Add Special Price"}),a.jsxs("div",{className:"flex gap-3 items-end",children:[a.jsxs("div",{className:"flex-1 relative",children:[a.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Search Product (name, code, or barcode)"}),a.jsxs("div",{className:"relative",children:[a.jsx(Na,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),a.jsx("input",{type:"text",value:se,onChange:Y=>{L(Y.target.value),F(!0),G.productId&&B({productId:"",unitType:"piece",specialPrice:0})},onFocus:()=>F(!0),placeholder:"Type to search...",className:`w-full pl-10 pr-3 py-2 border rounded-lg ${G.productId?"border-green-500 bg-green-50":"border-gray-300"}`})]}),Z&&se&&a.jsxs("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:[ft.filter(Y=>{const De=se.toLowerCase();return Y.name.toLowerCase().includes(De)||Y.sku.toLowerCase().includes(De)||Y.barcode&&Y.barcode.toLowerCase().includes(De)||Y.boxBarcode&&Y.boxBarcode.toLowerCase().includes(De)}).slice(0,10).map(Y=>a.jsxs("div",{onClick:()=>{const De=se.toLowerCase(),st=Y.boxBarcode&&Y.boxBarcode.toLowerCase().includes(De)&&Y.secondUnit?"box":"piece",Mt=st==="box"?Y.boxRetailPrice:Y.retailPrice;B({productId:Y.id.toString(),unitType:st,specialPrice:Mt}),L(`${Y.name} (${Y.sku})${st==="box"?` - ${Y.secondUnit}`:""}`),F(!1)},className:"px-3 py-2 hover:bg-purple-50 cursor-pointer border-b last:border-b-0",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"font-medium",children:Y.name}),a.jsxs("div",{className:"flex gap-1",children:[I.some(De=>De.productId===Y.id&&De.unitType==="piece")&&a.jsx("span",{className:"px-1.5 py-0.5 bg-gray-200 text-gray-600 rounded text-xs",children:"Piece "}),I.some(De=>De.productId===Y.id&&De.unitType==="box")&&a.jsx("span",{className:"px-1.5 py-0.5 bg-blue-200 text-blue-600 rounded text-xs",children:"Box "})]})]}),a.jsxs("div",{className:"text-xs text-gray-500",children:["Code: ",Y.sku," ",Y.barcode&&`| Barcode: ${Y.barcode}`," ",Y.boxBarcode&&`| Box: ${Y.boxBarcode}`]}),a.jsxs("div",{className:"text-xs",children:[a.jsxs("span",{className:"text-blue-600",children:["Retail: $",Y.retailPrice.toFixed(3)]}),a.jsxs("span",{className:"text-red-600 ml-2",children:["Cost: $",Y.costPrice.toFixed(3)]}),Y.secondUnit&&a.jsxs("span",{className:"text-purple-600 ml-2",children:["Box: $",Y.boxRetailPrice.toFixed(3)]})]})]},Y.id)),ft.filter(Y=>{const De=se.toLowerCase();return Y.name.toLowerCase().includes(De)||Y.sku.toLowerCase().includes(De)||Y.barcode&&Y.barcode.toLowerCase().includes(De)||Y.boxBarcode&&Y.boxBarcode.toLowerCase().includes(De)}).length===0&&a.jsx("div",{className:"px-3 py-4 text-center text-gray-500",children:"No products found"})]})]}),G.productId&&(()=>{const Y=W.find(De=>De.id===parseInt(G.productId));return!(Y!=null&&Y.secondUnit)||Y.unitsPerSecond<=0?null:a.jsxs("div",{className:"w-28",children:[a.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Unit"}),a.jsxs("select",{value:G.unitType,onChange:De=>{const at=De.target.value,st=at==="box"?Y.boxRetailPrice:Y.retailPrice;B({...G,unitType:at,specialPrice:st})},className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[a.jsx("option",{value:"piece",children:Y.baseUnit}),a.jsx("option",{value:"box",children:Y.secondUnit})]})]})})(),a.jsxs("div",{className:"w-28",children:[a.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Discount %"}),a.jsxs("select",{value:G.productId?(()=>{const Y=W.find(at=>at.id===parseInt(G.productId)),De=G.unitType==="box"?Y==null?void 0:Y.boxRetailPrice:Y==null?void 0:Y.retailPrice;return Math.round((1-G.specialPrice/(De||1))*100)})():"",onChange:Y=>{const De=parseInt(Y.target.value)||0,at=W.find(st=>st.id===parseInt(G.productId));if(at){const Mt=(G.unitType==="box"?at.boxRetailPrice:at.retailPrice)*(1-De/100);B({...G,specialPrice:Math.round(Mt*100)/100})}},disabled:!G.productId,className:"w-full px-3 py-2 border border-gray-300 rounded-lg disabled:bg-gray-100",children:[a.jsx("option",{value:"",children:"--"}),[...Array(50)].map((Y,De)=>a.jsxs("option",{value:De+1,children:[De+1,"%"]},De+1))]})]}),a.jsxs("div",{className:"w-28",children:[a.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Special Price"}),a.jsx("input",{type:"number",step:"0.01",min:G.productId&&(()=>{const Y=W.find(De=>De.id===parseInt(G.productId));return G.unitType==="box"?Y==null?void 0:Y.boxCostPrice:Y==null?void 0:Y.costPrice})()||0,value:G.specialPrice||"",onChange:Y=>{const De=Y.target.value===""?0:parseFloat(Y.target.value),at=W.find(Mt=>Mt.id===parseInt(G.productId)),st=G.unitType==="box"?(at==null?void 0:at.boxCostPrice)||0:(at==null?void 0:at.costPrice)||0;De<st&&De!==0?B({...G,specialPrice:st}):B({...G,specialPrice:De})},className:`w-full px-3 py-2 border rounded-lg ${G.productId&&G.specialPrice>0&&(()=>{const Y=W.find(at=>at.id===parseInt(G.productId)),De=G.unitType==="box"?Y==null?void 0:Y.boxCostPrice:Y==null?void 0:Y.costPrice;return G.specialPrice<=(De||0)})()?"border-red-500 bg-red-50":"border-gray-300"}`,required:!0})]}),a.jsx("button",{type:"submit",disabled:q||!G.productId||G.specialPrice>0&&(()=>{const Y=W.find(at=>at.id===parseInt(G.productId)),De=G.unitType==="box"?Y==null?void 0:Y.boxCostPrice:Y==null?void 0:Y.costPrice;return G.specialPrice<(De||0)})(),className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50",children:q?"Adding...":"Add"})]}),G.productId&&(()=>{const Y=W.find(pt=>pt.id===parseInt(G.productId));if(!Y)return null;const De=G.unitType==="box"?Y.boxCostPrice:Y.costPrice,at=G.unitType==="box"?Y.boxRetailPrice:Y.retailPrice,st=G.specialPrice-De,Mt=De>0?(st/De*100).toFixed(1):"0",Lt=G.unitType==="box"?Y.secondUnit||"Box":Y.baseUnit;return a.jsxs("div",{className:"mt-3 p-3 bg-blue-50 rounded-lg text-sm flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("span",{className:"text-gray-500 text-xs mr-2",children:["(",Lt,")"]}),a.jsx("span",{className:"text-gray-600",children:"Cost: "}),a.jsxs("span",{className:"font-semibold text-red-600",children:["$",De.toFixed(3)]}),a.jsx("span",{className:"text-gray-400 mx-2",children:"|"}),a.jsx("span",{className:"text-gray-600",children:"Retail: "}),a.jsxs("span",{className:"font-semibold text-blue-600",children:["$",at.toFixed(3)]})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Your Profit: "}),a.jsxs("span",{className:`font-semibold ${st>0?"text-green-600":"text-red-600"}`,children:["$",st.toFixed(3)," (",Mt,"%)"]})]})]})})()]}),H?a.jsx("div",{className:"flex items-center justify-center py-8",children:a.jsx(vt,{className:"animate-spin",size:32})}):I.length===0?a.jsxs("div",{className:"text-center py-8 text-gray-500",children:[a.jsx(xf,{size:48,className:"mx-auto mb-3 opacity-50"}),a.jsx("p",{children:"No special prices set for this customer."}),a.jsx("p",{className:"text-sm",children:"Add products above to give this customer special pricing."})]}):a.jsx("div",{className:"border rounded-lg overflow-hidden",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-600",children:"Product"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-600",children:"Unit"}),a.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-600",children:"Regular"}),a.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-600",children:"Special"}),a.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-600",children:"Discount"}),a.jsx("th",{className:"px-4 py-2 text-center text-xs font-semibold text-gray-600",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y",children:I.map(Y=>{const De=Y.regularPrice>0?((Y.regularPrice-Y.specialPrice)/Y.regularPrice*100).toFixed(1):"0";return a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsxs("td",{className:"px-4 py-3",children:[a.jsx("div",{className:"font-medium",children:Y.productName}),a.jsx("div",{className:"text-xs text-gray-500",children:Y.productSku})]}),a.jsx("td",{className:"px-4 py-3",children:a.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${Y.unitType==="box"?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"}`,children:Y.unitType==="box"?"Box":"Piece"})}),a.jsxs("td",{className:"px-4 py-3 text-right text-gray-500",children:["$",Y.regularPrice.toFixed(3)]}),a.jsxs("td",{className:"px-4 py-3 text-right font-medium text-purple-600",children:["$",Y.specialPrice.toFixed(3)]}),a.jsx("td",{className:"px-4 py-3 text-right",children:a.jsxs("span",{className:"px-2 py-1 bg-green-100 text-green-700 rounded text-xs font-medium",children:["-",De,"%"]})}),a.jsx("td",{className:"px-4 py-3 text-center",children:a.jsx("button",{onClick:()=>Se(Y.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Delete",children:a.jsx(xr,{size:16})})})]},Y.id)})})]})}),a.jsx("div",{className:"flex justify-end pt-4 mt-4 border-t",children:a.jsx("button",{onClick:()=>E(!1),className:"px-6 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Close"})})]})]})}),z&&de&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-lg w-full mx-4 max-h-[90vh] overflow-auto",children:[a.jsx("div",{className:"p-6 border-b",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Br,{size:24,className:"text-emerald-600"}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-bold",children:"Customer Report"}),a.jsx("p",{className:"text-sm text-gray-500",children:de.name})]})]}),a.jsx("button",{onClick:()=>A(!1),className:"p-2 hover:bg-gray-100 rounded-lg",children:a.jsx(yt,{size:20})})]})}),a.jsx("div",{className:"p-6 space-y-4",children:we?a.jsxs("div",{className:"flex items-center justify-center py-8",children:[a.jsx(vt,{className:"animate-spin",size:32}),a.jsx("span",{className:"ml-2",children:"Loading report data..."})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:a.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Orders:"}),a.jsx("span",{className:"ml-2 font-medium",children:ze.length})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Tasks:"}),a.jsx("span",{className:"ml-2 font-medium",children:ct.length})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Collections:"}),a.jsx("span",{className:"ml-2 font-medium",children:We.length})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Current Debt:"}),a.jsxs("span",{className:"ml-2 font-medium text-red-600",children:["$",de.debtBalance.toFixed(3)]})]})]})}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("h3",{className:"font-medium text-gray-700",children:"Include in Report:"}),a.jsxs("label",{className:"flex items-center gap-3 p-3 bg-white border rounded-lg cursor-pointer hover:bg-gray-50",children:[a.jsx("input",{type:"checkbox",checked:Ge.showSummary,onChange:Y=>Nt({...Ge,showSummary:Y.target.checked}),className:"w-5 h-5 text-emerald-600 rounded"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-medium",children:"Summary"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Total purchases, payments, debt"})]}),Ge.showSummary&&a.jsx(Jt,{size:18,className:"text-emerald-600"})]}),a.jsxs("label",{className:"flex items-center gap-3 p-3 bg-white border rounded-lg cursor-pointer hover:bg-gray-50",children:[a.jsx("input",{type:"checkbox",checked:Ge.showProducts,onChange:Y=>Nt({...Ge,showProducts:Y.target.checked}),className:"w-5 h-5 text-emerald-600 rounded"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-medium",children:"Products Purchased"}),a.jsx("p",{className:"text-sm text-gray-500",children:"All items bought by this customer"})]}),Ge.showProducts&&a.jsx(Jt,{size:18,className:"text-emerald-600"})]}),a.jsxs("label",{className:"flex items-center gap-3 p-3 bg-white border rounded-lg cursor-pointer hover:bg-gray-50",children:[a.jsx("input",{type:"checkbox",checked:Ge.showOrders,onChange:Y=>Nt({...Ge,showOrders:Y.target.checked}),className:"w-5 h-5 text-emerald-600 rounded"}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("p",{className:"font-medium",children:["POS Orders (",ze.length,")"]}),a.jsx("p",{className:"text-sm text-gray-500",children:"All POS sale orders"})]}),Ge.showOrders&&a.jsx(Jt,{size:18,className:"text-emerald-600"})]}),a.jsxs("label",{className:"flex items-center gap-3 p-3 bg-white border rounded-lg cursor-pointer hover:bg-gray-50",children:[a.jsx("input",{type:"checkbox",checked:Ge.showTasks,onChange:Y=>Nt({...Ge,showTasks:Y.target.checked}),className:"w-5 h-5 text-emerald-600 rounded"}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("p",{className:"font-medium",children:["Delivery Tasks (",ct.length,")"]}),a.jsx("p",{className:"text-sm text-gray-500",children:"All delivery task sales"})]}),Ge.showTasks&&a.jsx(Jt,{size:18,className:"text-emerald-600"})]}),a.jsxs("label",{className:"flex items-center gap-3 p-3 bg-white border rounded-lg cursor-pointer hover:bg-gray-50",children:[a.jsx("input",{type:"checkbox",checked:Ge.showCollections,onChange:Y=>Nt({...Ge,showCollections:Y.target.checked}),className:"w-5 h-5 text-emerald-600 rounded"}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("p",{className:"font-medium",children:["Debt Collections (",We.length,")"]}),a.jsx("p",{className:"text-sm text-gray-500",children:"Payment collection history"})]}),Ge.showCollections&&a.jsx(Jt,{size:18,className:"text-emerald-600"})]})]})]})}),a.jsxs("div",{className:"p-6 border-t bg-gray-50 flex gap-3",children:[a.jsx("button",{onClick:()=>A(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-100",children:"Cancel"}),a.jsxs("button",{onClick:()=>{lt(),A(!1)},disabled:we,className:"flex-1 px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 disabled:opacity-50 flex items-center justify-center gap-2",children:[a.jsx(ua,{size:18}),"Print Report"]})]})]})}),Rt&&Zt&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-2xl max-h-[90vh] overflow-hidden",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-orange-600 text-white",children:[a.jsxs("h2",{className:"text-lg font-semibold",children:["Settle Debt  ",Zt.name]}),a.jsx("button",{onClick:()=>pr(!1),children:a.jsx(yt,{size:24})})]}),a.jsx("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-80px)]",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-gray-800 mb-4",children:"New Collection"}),a.jsxs("form",{onSubmit:ae,className:"space-y-4",children:[a.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-gray-600",children:"Current Debt:"}),a.jsxs("span",{className:"text-xl font-bold text-red-600",children:["$",Zt.debtBalance.toFixed(3)]})]})}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount to Collect *"}),a.jsx("input",{type:"number",step:"0.01",min:"0.01",max:Zt.debtBalance,required:!0,value:ue,onChange:Y=>Le(Y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-lg font-medium",placeholder:"0.00"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Method"}),a.jsxs("select",{value:Je,onChange:Y=>Xe(Y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[a.jsx("option",{value:"cash",children:"Cash"}),a.jsx("option",{value:"check",children:"Check"}),a.jsx("option",{value:"bank_transfer",children:"Bank Transfer"}),a.jsx("option",{value:"credit_card",children:"Credit Card"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),a.jsx("textarea",{value:le,onChange:Y=>Me(Y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",rows:2,placeholder:"Optional notes..."})]}),parseFloat(ue)>0&&a.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-gray-600",children:"Remaining Debt:"}),a.jsxs("span",{className:"text-xl font-bold text-green-600",children:["$",Math.max(0,Zt.debtBalance-parseFloat(ue||"0")).toFixed(3)]})]})}),a.jsxs("div",{className:"flex gap-3 pt-2",children:[a.jsx("button",{type:"button",onClick:()=>pr(!1),className:"flex-1 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsxs("button",{type:"submit",disabled:ut||!ue||parseFloat(ue)<=0,className:"flex-1 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 disabled:opacity-50 flex items-center justify-center gap-2",children:[ut?a.jsx(vt,{className:"animate-spin",size:18}):a.jsx(da,{size:18}),ut?"Processing...":"Collect"]})]})]})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-gray-800 mb-4",children:"Collection History"}),oe?a.jsx("div",{className:"flex items-center justify-center py-8",children:a.jsx(vt,{className:"animate-spin text-gray-400",size:24})}):ve.length===0?a.jsx("div",{className:"text-center py-8 text-gray-500 bg-gray-50 rounded-lg",children:"No collection history"}):a.jsxs("div",{className:"space-y-2 max-h-[400px] overflow-y-auto",children:[ve.map(Y=>a.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg border",children:[a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-800",children:Y.collectionNumber}),a.jsx("p",{className:"text-sm text-gray-500",children:new Date(Y.collectionDate).toLocaleDateString()}),a.jsx("p",{className:"text-xs text-gray-400 capitalize",children:Y.paymentType.replace("_"," ")})]}),a.jsxs("span",{className:"font-bold text-green-600",children:["$",Y.amount.toFixed(3)]})]}),Y.notes&&a.jsx("p",{className:"text-xs text-gray-500 mt-1 truncate",children:Y.notes})]},Y.id)),a.jsx("div",{className:"p-3 bg-green-50 rounded-lg border border-green-200",children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"font-medium text-gray-700",children:"Total Collected"}),a.jsxs("span",{className:"font-bold text-green-700",children:["$",ve.reduce((Y,De)=>Y+De.amount,0).toFixed(3)]})]})})]})]})]})})]})}),At&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-lg overflow-hidden",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-blue-600 text-white",children:[a.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[a.jsx(X6,{size:24})," Bulk Upload Customers"]}),a.jsx("button",{onClick:Ot,children:a.jsx(yt,{size:24})})]}),a.jsxs("div",{className:"p-6 space-y-4",children:[a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[a.jsx("h3",{className:"font-medium text-blue-800 mb-2",children:"Step 1: Download Template"}),a.jsx("p",{className:"text-sm text-blue-600 mb-3",children:"Download the Excel template, fill in your customer data, then upload it."}),a.jsxs("button",{onClick:Ze,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[a.jsx(nx,{size:18})," Download Template"]})]}),a.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[a.jsx("h3",{className:"font-medium text-gray-800 mb-2",children:"Step 2: Upload Filled Template"}),a.jsx("input",{type:"file",accept:".xlsx",onChange:Y=>{var De;return Gt(((De=Y.target.files)==null?void 0:De[0])||null)},className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"}),or&&a.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:["Selected: ",or.name]})]}),Or&&a.jsxs("div",{className:`rounded-lg p-4 ${Or.successful>0?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"}`,children:[a.jsx("h3",{className:`font-medium mb-2 ${Or.successful>0?"text-green-800":"text-red-800"}`,children:"Upload Results"}),a.jsxs("div",{className:"space-y-1 text-sm",children:[a.jsxs("p",{children:[a.jsx("span",{className:"font-medium",children:"Total Processed:"})," ",Or.totalProcessed]}),a.jsxs("p",{className:"text-green-600",children:[a.jsx("span",{className:"font-medium",children:"Successful:"})," ",Or.successful]}),a.jsxs("p",{className:"text-red-600",children:[a.jsx("span",{className:"font-medium",children:"Failed:"})," ",Or.failed]})]}),Or.errors.length>0&&a.jsxs("div",{className:"mt-3",children:[a.jsx("p",{className:"font-medium text-red-700 mb-1",children:"Errors:"}),a.jsx("ul",{className:"text-xs text-red-600 max-h-32 overflow-y-auto space-y-1",children:Or.errors.map((Y,De)=>a.jsxs("li",{children:[" ",Y]},De))})]})]}),a.jsxs("div",{className:"flex gap-3 pt-2",children:[a.jsx("button",{onClick:Ot,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Close"}),a.jsxs("button",{onClick:dt,disabled:!or||zt,className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 disabled:opacity-50 disabled:cursor-not-allowed",children:[zt?a.jsx(vt,{className:"animate-spin",size:18}):a.jsx(d0,{size:18}),zt?"Uploading...":"Upload"]})]})]})]})})]})}const f1={salary:"Salary",advance:"Advance",withdrawal:"Withdrawal",bonus:"Bonus",commission:"Commission",deduction:"Deduction"},x1={monthly:"Monthly",daily:"Daily",hourly:"Hourly",commission:"Commission",monthly_commission:"Monthly + Commission"};function tve(){const[e,t]=m.useState([]),[r,s]=m.useState([]),[n,i]=m.useState([]),[l,o]=m.useState([]),[c,u]=m.useState(!0),[d,h]=m.useState(!1),[f,x]=m.useState(!1),[p,g]=m.useState(!1),[y,v]=m.useState(!1),[j,b]=m.useState(!1),[w,k]=m.useState(null),[N,S]=m.useState(""),[_,O]=m.useState("Driver"),[E,R]=m.useState("monthly"),[C,I]=m.useState({name:"",username:"",password:"",phone:"",basePay:0,hourlyRate:0,commissionRate:0,commissionBase:"sales",minimumGuarantee:0,expectedHoursPerWeek:40,warehouseId:"",vanId:"",address:"",useDefaultPermissions:!0,canAccessReports:!1,canApproveDeposits:!1,canEditPrices:!1,canEditCreditLimit:!1}),[ne,W]=m.useState(5),[Q,H]=m.useState(!1),[K,q]=m.useState(null),[ge,G]=m.useState([]),[B,se]=m.useState([]),[L,Z]=m.useState([]),[F,he]=m.useState([]),[ye,z]=m.useState([]),[A,de]=m.useState(null),[D,ze]=m.useState(!1),[Fe,ct]=m.useState({showSummary:!0,showOrders:!0,showTasks:!0,showCollections:!0,showDeposits:!0,showAttendance:!0,showSalaryPayments:!0}),[$e,We]=m.useState([]),[Bt,Ee]=m.useState(!1),[it,we]=m.useState(null),[et,Ge]=m.useState(null),[Nt,Rt]=m.useState(!1),[pr,Zt]=m.useState(!1),[er,ue]=m.useState(new Date().getMonth()+1),[Le,Je]=m.useState(new Date().getFullYear()),[Xe,le]=m.useState({paymentType:"salary",amount:0,paymentDate:new Date().toISOString().split("T")[0],notes:""}),[Me,ut]=m.useState(!1),[ee,ve]=m.useState(null),[xe,oe]=m.useState(null),[Ie,me]=m.useState(!1),[ht,At]=m.useState(()=>{const U=new Date;return U.setMonth(U.getMonth()-1),U.toISOString().split("T")[0]}),[Er,or]=m.useState(()=>new Date().toISOString().split("T")[0]),[Gt,zt]=m.useState([]),[ma,Or]=m.useState(!1),[_r,Is]=m.useState(null),[Jr,na]=m.useState({restrictCustomers:!1,restrictProducts:!1}),[Os,gr]=m.useState([]),[V,J]=m.useState([]),[X,te]=m.useState([]),[re,ae]=m.useState([]),[Ne,Be]=m.useState(!1),[Se,Pe]=m.useState(!1),[pe,qe]=m.useState("customers"),[lt,ft]=m.useState("");m.useEffect(()=>{Ze()},[]);const Ze=async()=>{try{u(!0);const[U,Ke,rt,_t]=await Promise.all([hs.getAll(),hs.getWarehouses(),hs.getVans(),vh.getAll()]);t(U.data),s(Ke.data),i(rt.data),o(_t.data),_t.data.length>0&&!N&&S(_t.data[0].name)}catch(U){console.error("Failed to load data:",U)}finally{u(!1)}},dt=()=>{I({name:"",username:"",password:"",phone:"",basePay:0,hourlyRate:0,commissionRate:0,commissionBase:"sales",minimumGuarantee:0,expectedHoursPerWeek:40,warehouseId:"",vanId:"",address:"",useDefaultPermissions:!0,canAccessReports:!1,canApproveDeposits:!1,canEditPrices:!1,canEditCreditLimit:!1}),O("Driver"),R("monthly")},Ot=()=>{x(!1),dt(),O(N),g(!0)},Y=async U=>{var Ke,rt;U.preventDefault(),h(!0);try{await hs.create({...C,role:_,salaryType:E,warehouseId:C.warehouseId?parseInt(C.warehouseId):null,vanId:C.vanId?parseInt(C.vanId):null}),g(!1),Ze()}catch(_t){alert(((rt=(Ke=_t.response)==null?void 0:Ke.data)==null?void 0:rt.message)||"Failed to create employee")}finally{h(!1)}},De=U=>{var Ke,rt;k(U),O(U.role),R(U.salaryType),I({name:U.name,username:U.username,password:"",phone:U.phone||"",basePay:U.basePay,hourlyRate:U.hourlyRate,commissionRate:U.commissionRate,commissionBase:U.commissionBase||"sales",minimumGuarantee:U.minimumGuarantee,expectedHoursPerWeek:U.expectedHoursPerWeek,warehouseId:((Ke=U.warehouseId)==null?void 0:Ke.toString())||"",vanId:((rt=U.vanId)==null?void 0:rt.toString())||"",address:U.address||"",useDefaultPermissions:U.useDefaultPermissions,canAccessReports:U.canAccessReports,canApproveDeposits:U.canApproveDeposits,canEditPrices:U.canEditPrices,canEditCreditLimit:U.canEditCreditLimit}),v(!0)},at=async U=>{var Ke,rt;if(U.preventDefault(),!!w){h(!0);try{await hs.update(w.id,{...C,role:_,salaryType:E,warehouseId:C.warehouseId?parseInt(C.warehouseId):null,vanId:C.vanId?parseInt(C.vanId):null}),v(!1),Ze()}catch(_t){alert(((rt=(Ke=_t.response)==null?void 0:Ke.data)==null?void 0:rt.message)||"Failed to update employee")}finally{h(!1)}}},st=async U=>{if(confirm("Are you sure you want to delete this employee?"))try{await hs.delete(U),Ze()}catch{alert("Failed to delete employee")}},Mt=U=>{k(U),W(U.rating),b(!0)},Lt=async()=>{if(w)try{await hs.updateRating(w.id,ne),b(!1),Ze()}catch{alert("Failed to update rating")}},pt=async U=>{const Ke=U.status==="active"?"deactivate":"activate";if(confirm(`Are you sure you want to ${Ke} ${U.name}?`))try{await hs.toggleStatus(U.id),Ze()}catch{alert(`Failed to ${Ke} employee`)}},Ut=U=>U.includes(_.toLowerCase()),qt=async U=>{we(U),Ee(!0),Rt(!0),le({paymentType:"salary",amount:U.basePay,paymentDate:new Date().toISOString().split("T")[0],notes:""});try{const Ke=await Rc.getByEmployee(U.id);Ge(Ke)}catch(Ke){console.error("Failed to load salary data:",Ke),Ge(null)}finally{Rt(!1)}},Ca=async()=>{var U,Ke,rt,_t,Fr,Xt,Rr;if(!(!it||Xe.amount<=0)){Zt(!0);try{await Rc.create({employeeId:it.id,paymentType:Xe.paymentType,amount:Xe.amount,paymentDate:Xe.paymentDate,notes:Xe.notes||null});const Yt=await Rc.getByEmployee(it.id);Ge(Yt),le({paymentType:"salary",amount:it.basePay,paymentDate:new Date().toISOString().split("T")[0],notes:""})}catch(Yt){const gt=((Ke=(U=Yt.response)==null?void 0:U.data)==null?void 0:Ke.details)||((_t=(rt=Yt.response)==null?void 0:rt.data)==null?void 0:_t.error)||((Xt=(Fr=Yt.response)==null?void 0:Fr.data)==null?void 0:Xt.message)||"Failed to create payment";alert(`Error: ${gt}`),console.error("Payment error:",(Rr=Yt.response)==null?void 0:Rr.data)}finally{Zt(!1)}}},nr=async U=>{if(confirm("Are you sure you want to delete this payment?"))try{if(await Rc.delete(U),it){const Ke=await Rc.getByEmployee(it.id);Ge(Ke)}}catch{alert("Failed to delete payment")}},Ea=async U=>{ve(U),ut(!0),zt([]),Dr(U.id)},Dr=async U=>{me(!0);try{const Ke=await hs.getVisitAnalysis(U,ht,Er);oe(Ke.data)}catch(Ke){console.error("Failed to load visit analysis:",Ke)}finally{me(!1)}},Ds=U=>{zt(Ke=>Ke.includes(U)?Ke.filter(rt=>rt!==U):[...Ke,U])},Ue=async U=>{Is(U),Or(!0),Be(!0),ft("");try{const[Ke,rt,_t]=await Promise.all([hs.getVisibility(U.id),Ha.getAll(),br.getAll()]);na({restrictCustomers:Ke.data.restrictCustomers,restrictProducts:Ke.data.restrictProducts}),te(Ke.data.assignedCustomerIds||[]),ae(Ke.data.assignedProductIds||[]),gr(rt.data.map(Fr=>({id:Fr.id,name:Fr.name}))),J(_t.data.map(Fr=>({id:Fr.id,name:Fr.name})))}catch(Ke){console.error("Failed to load visibility data:",Ke),alert("Failed to load visibility settings")}finally{Be(!1)}},M=async()=>{if(_r){Pe(!0);try{await Promise.all([hs.updateVisibilitySettings(_r.id,Jr),hs.assignCustomers(_r.id,X),hs.assignProducts(_r.id,re)]),alert("Visibility settings saved successfully!"),Or(!1)}catch(U){console.error("Failed to save visibility:",U),alert("Failed to save visibility settings")}finally{Pe(!1)}}},je=U=>{te(Ke=>Ke.includes(U)?Ke.filter(rt=>rt!==U):[...Ke,U])},fe=U=>{ae(Ke=>Ke.includes(U)?Ke.filter(rt=>rt!==U):[...Ke,U])},Ce=()=>{if(!it||!et)return{owed:0,paid:0,balance:0,commission:0,bonus:0,totalOwed:0,advances:0,deductions:0,dailyEarned:0,presentDays:0,halfDays:0};const Ke=it.salaryType==="daily"?et.dailyEarnedThisMonth||0:it.basePay,rt=et.commissionEarnedThisMonth||0,_t=et.payments.filter(tr=>tr.paymentType==="salary").reduce((tr,Wr)=>tr+Wr.amount,0),Fr=et.payments.filter(tr=>tr.paymentType==="advance").reduce((tr,Wr)=>tr+Wr.amount,0),Xt=et.payments.filter(tr=>tr.paymentType==="bonus").reduce((tr,Wr)=>tr+Wr.amount,0),Rr=et.payments.filter(tr=>tr.paymentType==="deduction").reduce((tr,Wr)=>tr+Wr.amount,0),Yt=Ke+rt+Xt-Rr,gt=_t+Fr;return{owed:Ke,paid:gt,balance:Yt-gt,commission:rt,bonus:Xt,totalOwed:Yt,advances:Fr,deductions:Rr,dailyEarned:et.dailyEarnedThisMonth||0,presentDays:et.presentDaysThisMonth||0,halfDays:et.halfDaysThisMonth||0}},Qe=async U=>{q(U),H(!0),ze(!0);try{const[Ke,rt,_t,Fr,Xt,Rr]=await Promise.all([ie.get(`/orders?driverId=${U.id}`),ie.get(`/tasks?driverId=${U.id}`),ie.get(`/cash/collections?driverId=${U.id}`),ie.get(`/cash/deposits?driverId=${U.id}`),ie.get(`/attendance/employee/${U.id}`),Rc.getByEmployee(U.id).catch(()=>({payments:[]}))]);G(Ke.data.map(Yt=>({id:Yt.id,orderNumber:Yt.orderNumber,orderDate:Yt.orderDate,totalAmount:Yt.totalAmount,paidAmount:Yt.paidAmount,paymentStatus:Yt.paymentStatus}))),se(rt.data.map(Yt=>({id:Yt.id,taskNumber:Yt.taskNumber,scheduledDate:Yt.scheduledDate,total:Yt.total,paidAmount:Yt.paidAmount||0,debtAmount:Yt.debtAmount||0,status:Yt.status}))),Z(_t.data.map(Yt=>({id:Yt.id,collectionNumber:Yt.collectionNumber,collectionDate:Yt.collectionDate,amount:Yt.amount,paymentType:Yt.paymentType}))),he(Fr.data.map(Yt=>({id:Yt.id,depositDate:Yt.depositDate||Yt.createdAt,amount:Yt.amount,status:Yt.status||"pending"}))),z(Xt.data.attendances||[]),de(Xt.data.summary||null),We(Rr.payments||[])}catch(Ke){console.error("Failed to load report data:",Ke)}finally{ze(!1)}},_e=U=>`$${U.toFixed(3)}`,Vt=U=>new Date(U).toLocaleDateString(),Qt=()=>{if(!K)return;const U=ge.reduce((gt,tr)=>gt+tr.totalAmount,0),Ke=B.reduce((gt,tr)=>gt+tr.total,0),rt=U+Ke,_t=ge.reduce((gt,tr)=>gt+tr.paidAmount,0)+B.reduce((gt,tr)=>gt+tr.paidAmount,0),Fr=L.reduce((gt,tr)=>gt+tr.amount,0),Xt=F.reduce((gt,tr)=>gt+tr.amount,0),Rr=window.open("","_blank","width=1000,height=800");if(!Rr){alert("Please allow popups to print report");return}const Yt=`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Employee Report - ${K.name}</title>
        <style>
          * { margin: 0; padding: 0; box-sizing: border-box; }
          body { font-family: Arial, sans-serif; font-size: 12px; padding: 20px; }
          .header { text-align: center; margin-bottom: 20px; border-bottom: 2px solid #333; padding-bottom: 10px; }
          .header h1 { font-size: 24px; margin-bottom: 5px; }
          .header p { color: #666; }
          .employee-info { background: #f5f5f5; padding: 15px; border-radius: 8px; margin-bottom: 20px; }
          .employee-info h2 { font-size: 18px; margin-bottom: 10px; }
          .employee-info .grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; }
          .employee-info .label { font-size: 10px; color: #666; text-transform: uppercase; }
          .employee-info .value { font-weight: bold; }
          .summary-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-bottom: 20px; }
          .summary-card { border: 1px solid #ddd; padding: 12px; border-radius: 5px; text-align: center; }
          .summary-card .label { font-size: 10px; color: #666; text-transform: uppercase; }
          .summary-card .value { font-size: 20px; font-weight: bold; margin-top: 5px; }
          .summary-card .value.green { color: #22c55e; }
          .summary-card .value.red { color: #ef4444; }
          .summary-card .value.blue { color: #3b82f6; }
          .section { margin-bottom: 20px; }
          .section h2 { font-size: 16px; margin-bottom: 10px; border-bottom: 1px solid #ddd; padding-bottom: 5px; }
          table { width: 100%; border-collapse: collapse; margin-bottom: 15px; }
          th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
          th { background: #f5f5f5; font-weight: bold; }
          .text-right { text-align: right; }
          .text-center { text-align: center; }
          .status-completed { color: #22c55e; }
          .status-pending { color: #f59e0b; }
          .footer { text-align: center; margin-top: 20px; padding-top: 10px; border-top: 1px solid #ddd; color: #666; font-size: 10px; }
          @media print { body { padding: 0; } }
        </style>
      </head>
      <body>
        <div class="header">
          <h1>Employee Report</h1>
          <p>Generated: ${new Date().toLocaleString()}</p>
        </div>
        
        <div class="employee-info">
          <h2>${K.name}</h2>
          <div class="grid">
            <div class="item">
              <div class="label">Username</div>
              <div class="value">${K.username}</div>
            </div>
            <div class="item">
              <div class="label">Phone</div>
              <div class="value">${K.phone||"-"}</div>
            </div>
            <div class="item">
              <div class="label">Role</div>
              <div class="value">${K.role}</div>
            </div>
            <div class="item">
              <div class="label">Salary Type</div>
              <div class="value">${x1[K.salaryType]||K.salaryType}</div>
            </div>
            <div class="item">
              <div class="label">Base Pay</div>
              <div class="value">${_e(K.basePay)}</div>
            </div>
            <div class="item">
              <div class="label">Commission</div>
              <div class="value">${K.commissionRate>0?K.commissionRate+"%":"-"}</div>
            </div>
            <div class="item">
              <div class="label">Rating</div>
              <div class="value">${K.rating}/10</div>
            </div>
            <div class="item">
              <div class="label">Warehouse</div>
              <div class="value">${K.warehouse||"-"}</div>
            </div>
            <div class="item">
              <div class="label">Van</div>
              <div class="value">${K.van||"-"}</div>
            </div>
          </div>
        </div>
        
        ${Fe.showSummary?`
        <div class="summary-grid">
          <div class="summary-card">
            <div class="label">Total Sales</div>
            <div class="value blue">${_e(rt)}</div>
          </div>
          <div class="summary-card">
            <div class="label">Cash Collected</div>
            <div class="value green">${_e(_t)}</div>
          </div>
          <div class="summary-card">
            <div class="label">Debt Collections</div>
            <div class="value">${_e(Fr)}</div>
          </div>
          <div class="summary-card">
            <div class="label">Total Deposits</div>
            <div class="value red">${_e(Xt)}</div>
          </div>
        </div>
        `:""}
        
        ${Fe.showOrders&&ge.length>0?`
        <div class="section">
          <h2>POS Orders (${ge.length})</h2>
          <table>
            <thead>
              <tr>
                <th>Order #</th>
                <th>Date</th>
                <th class="text-right">Total</th>
                <th class="text-right">Paid</th>
                <th class="text-center">Status</th>
              </tr>
            </thead>
            <tbody>
              ${ge.map(gt=>`
                <tr>
                  <td>${gt.orderNumber}</td>
                  <td>${Vt(gt.orderDate)}</td>
                  <td class="text-right">${_e(gt.totalAmount)}</td>
                  <td class="text-right">${_e(gt.paidAmount)}</td>
                  <td class="text-center">${gt.paymentStatus}</td>
                </tr>
              `).join("")}
            </tbody>
            <tfoot>
              <tr>
                <th colspan="2">Total</th>
                <th class="text-right">${_e(U)}</th>
                <th class="text-right">${_e(ge.reduce((gt,tr)=>gt+tr.paidAmount,0))}</th>
                <th></th>
              </tr>
            </tfoot>
          </table>
        </div>
        `:""}
        
        ${Fe.showTasks&&B.length>0?`
        <div class="section">
          <h2>Completed Tasks (${B.length})</h2>
          <table>
            <thead>
              <tr>
                <th>Task #</th>
                <th>Date</th>
                <th class="text-right">Total</th>
                <th class="text-right">Paid</th>
                <th class="text-right">Debt</th>
                <th class="text-center">Status</th>
              </tr>
            </thead>
            <tbody>
              ${B.map(gt=>`
                <tr>
                  <td>${gt.taskNumber}</td>
                  <td>${Vt(gt.scheduledDate)}</td>
                  <td class="text-right">${_e(gt.total)}</td>
                  <td class="text-right">${_e(gt.paidAmount)}</td>
                  <td class="text-right">${gt.debtAmount>0?_e(gt.debtAmount):"-"}</td>
                  <td class="text-center">${gt.status}</td>
                </tr>
              `).join("")}
            </tbody>
            <tfoot>
              <tr>
                <th colspan="2">Total</th>
                <th class="text-right">${_e(Ke)}</th>
                <th class="text-right">${_e(B.reduce((gt,tr)=>gt+tr.paidAmount,0))}</th>
                <th class="text-right">${_e(B.reduce((gt,tr)=>gt+tr.debtAmount,0))}</th>
                <th></th>
              </tr>
            </tfoot>
          </table>
        </div>
        `:""}
        
        ${Fe.showCollections&&L.length>0?`
        <div class="section">
          <h2>Debt Collections (${L.length})</h2>
          <table>
            <thead>
              <tr>
                <th>Collection #</th>
                <th>Date</th>
                <th class="text-right">Amount</th>
                <th class="text-center">Payment Type</th>
              </tr>
            </thead>
            <tbody>
              ${L.map(gt=>`
                <tr>
                  <td>${gt.collectionNumber}</td>
                  <td>${Vt(gt.collectionDate)}</td>
                  <td class="text-right">${_e(gt.amount)}</td>
                  <td class="text-center">${gt.paymentType}</td>
                </tr>
              `).join("")}
            </tbody>
            <tfoot>
              <tr>
                <th colspan="2">Total</th>
                <th class="text-right">${_e(Fr)}</th>
                <th></th>
              </tr>
            </tfoot>
          </table>
        </div>
        `:""}
        
        ${Fe.showDeposits&&F.length>0?`
        <div class="section">
          <h2>Deposits (${F.length})</h2>
          <table>
            <thead>
              <tr>
                <th>Date</th>
                <th class="text-right">Amount</th>
                <th class="text-center">Status</th>
              </tr>
            </thead>
            <tbody>
              ${F.map(gt=>`
                <tr>
                  <td>${Vt(gt.depositDate)}</td>
                  <td class="text-right">${_e(gt.amount)}</td>
                  <td class="text-center">${gt.status}</td>
                </tr>
              `).join("")}
            </tbody>
            <tfoot>
              <tr>
                <th>Total</th>
                <th class="text-right">${_e(Xt)}</th>
                <th></th>
              </tr>
            </tfoot>
          </table>
        </div>
        `:""}
        
        ${Fe.showAttendance&&A?`
        <div class="section">
          <h2>Attendance Summary</h2>
          <div class="summary-grid">
            <div class="summary-card">
              <div class="label">Present Days</div>
              <div class="value green">${A.presentDays}</div>
            </div>
            <div class="summary-card">
              <div class="label">Absent Days</div>
              <div class="value red">${A.absentDays}</div>
            </div>
            <div class="summary-card">
              <div class="label">Late Days</div>
              <div class="value" style="color: #eab308;">${A.lateDays}</div>
            </div>
            <div class="summary-card">
              <div class="label">Leave Days</div>
              <div class="value blue">${A.leaveDays}</div>
            </div>
          </div>
          <div class="summary-grid">
            <div class="summary-card">
              <div class="label">Total Days</div>
              <div class="value">${A.totalDays}</div>
            </div>
            <div class="summary-card">
              <div class="label">Half Days</div>
              <div class="value" style="color: #f97316;">${A.halfDays}</div>
            </div>
            <div class="summary-card">
              <div class="label">Hours Worked</div>
              <div class="value">${A.totalWorkedHours.toFixed(1)}h</div>
            </div>
            <div class="summary-card">
              <div class="label">Overtime Hours</div>
              <div class="value">${A.totalOvertimeHours.toFixed(1)}h</div>
            </div>
          </div>
          ${ye.length>0?`
          <table>
            <thead>
              <tr>
                <th>Date</th>
                <th class="text-center">Status</th>
                <th class="text-center">Check In</th>
                <th class="text-center">Check Out</th>
                <th class="text-center">Hours</th>
              </tr>
            </thead>
            <tbody>
              ${ye.slice(0,20).map(gt=>`
                <tr>
                  <td>${Vt(gt.date)}</td>
                  <td class="text-center">${gt.status}</td>
                  <td class="text-center">${gt.checkIn?new Date(gt.checkIn).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):"-"}</td>
                  <td class="text-center">${gt.checkOut?new Date(gt.checkOut).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):"-"}</td>
                  <td class="text-center">${gt.workedHours>0?gt.workedHours+"h":"-"}</td>
                </tr>
              `).join("")}
            </tbody>
          </table>
          ${ye.length>20?`<p style="text-align: center; color: #666; margin-top: 10px;">Showing 20 of ${ye.length} records</p>`:""}
          `:""}
        </div>
        `:""}
        
        ${Fe.showSalaryPayments&&$e.length>0?`
        <div class="section">
          <h2>Salary Payments (${$e.length})</h2>
          <table>
            <thead>
              <tr>
                <th>Date</th>
                <th>Type</th>
                <th class="text-right">Amount</th>
                <th>Notes</th>
              </tr>
            </thead>
            <tbody>
              ${$e.map(gt=>`
                <tr>
                  <td>${Vt(gt.paymentDate)}</td>
                  <td>${f1[gt.paymentType]||gt.paymentType}</td>
                  <td class="text-right">${_e(gt.amount)}</td>
                  <td>${gt.notes||"-"}</td>
                </tr>
              `).join("")}
            </tbody>
            <tfoot>
              <tr>
                <th colspan="2">Total Salary Paid</th>
                <th class="text-right">${_e($e.reduce((gt,tr)=>gt+tr.amount,0))}</th>
                <th></th>
              </tr>
            </tfoot>
          </table>
        </div>
        `:""}
        
        <div class="footer">
          <p>Catalyst Employee Report - Confidential</p>
        </div>
      </body>
      </html>
    `;Rr.document.write(Yt),Rr.document.close(),Rr.onload=()=>{Rr.focus(),Rr.print()}};return c?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx(vt,{className:"animate-spin",size:32})}):a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Employees"}),a.jsx(qr,{permission:Ve.CREATE_EMPLOYEES,children:a.jsxs("button",{onClick:()=>x(!0),className:"flex items-center gap-2 px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600",children:[a.jsx(hr,{size:20})," Add Employee"]})})]}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[1000px]",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Name"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Username"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Phone"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Role"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Salary Type"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Base Pay"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Commission"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Rating"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Address"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Warehouse"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Van"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Status"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:e.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:13,className:"px-4 py-8 text-center text-gray-500",children:"No employees found"})}):e.map(U=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 font-medium",children:U.name}),a.jsx("td",{className:"px-4 py-3 text-gray-500",children:U.username}),a.jsx("td",{className:"px-4 py-3",children:U.phone||"-"}),a.jsx("td",{className:"px-4 py-3",children:U.role}),a.jsx("td",{className:"px-4 py-3",children:x1[U.salaryType]||U.salaryType}),a.jsxs("td",{className:"px-4 py-3 font-medium",children:["$",U.basePay.toLocaleString()]}),a.jsx("td",{className:"px-4 py-3",children:U.commissionRate>0?`${U.commissionRate}%`:"-"}),a.jsx("td",{className:"px-4 py-3",children:a.jsx("span",{className:"px-2 py-1 bg-blue-500 text-white rounded text-xs",children:U.rating})}),a.jsx("td",{className:"px-4 py-3",children:U.address||"-"}),a.jsx("td",{className:"px-4 py-3",children:U.managedWarehouses||U.warehouse||"-"}),a.jsx("td",{className:"px-4 py-3",children:U.van||"None"}),a.jsx("td",{className:"px-4 py-3",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${U.status==="active"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:U.status})}),a.jsx("td",{className:"px-4 py-3",children:a.jsxs("div",{className:"flex gap-1",children:[a.jsx(qr,{permission:Ve.MANAGE_EMPLOYEE_PAYMENTS,children:a.jsx("button",{onClick:()=>qt(U),className:"p-1 text-purple-600 hover:bg-purple-50 rounded",title:"Salary & Payments",children:a.jsx(da,{size:16})})}),U.role==="Salesman"&&a.jsx("button",{onClick:()=>Ea(U),className:"p-1 text-indigo-600 hover:bg-indigo-50 rounded",title:"Visit Analysis",children:a.jsx(qi,{size:16})}),a.jsxs(qr,{permission:Ve.EDIT_EMPLOYEES,children:[a.jsx("button",{onClick:()=>Ue(U),className:"p-1 text-amber-600 hover:bg-amber-50 rounded",title:"Visibility Control",children:a.jsx(gs,{size:16})}),a.jsx("button",{onClick:()=>Mt(U),className:"p-1 text-cyan-600 hover:bg-cyan-50 rounded",title:"Set Rating",children:a.jsx(CW,{size:16})}),a.jsx("button",{onClick:()=>pt(U),className:`p-1 rounded ${U.status==="active"?"text-orange-600 hover:bg-orange-50":"text-green-600 hover:bg-green-50"}`,title:U.status==="active"?"Deactivate":"Activate",children:U.status==="active"?a.jsx(AW,{size:16}):a.jsx(Hp,{size:16})}),a.jsx("button",{onClick:()=>De(U),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",title:"Edit",children:a.jsx(js,{size:16})})]}),a.jsx("button",{onClick:()=>Qe(U),className:"p-1 text-emerald-600 hover:bg-emerald-50 rounded",title:"Print Report",children:a.jsx(Br,{size:16})}),a.jsx(qr,{permission:Ve.DELETE_EMPLOYEES,children:a.jsx("button",{onClick:()=>st(U.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Delete",children:a.jsx(xr,{size:16})})})]})})]},U.id))})]})}),f&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-sm",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-[#003366] text-white rounded-t-xl",children:[a.jsx("h2",{className:"text-lg font-semibold",children:"Select Employee Type"}),a.jsx("button",{onClick:()=>x(!1),children:a.jsx(yt,{size:24})})]}),a.jsxs("div",{className:"p-6",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Employee Type"}),a.jsx("select",{value:N,onChange:U=>S(U.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg mb-4",children:l.map(U=>a.jsx("option",{value:U.name,children:U.name},U.id))}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:()=>x(!1),className:"flex-1 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{onClick:Ot,className:"flex-1 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600",children:"Continue"})]})]})]})}),(p||y)&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-3xl max-h-[90vh] overflow-hidden",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-[#003366] text-white",children:[a.jsx("h2",{className:"text-lg font-semibold",children:y?"Edit Employee":"Add Employee"}),a.jsx("button",{onClick:()=>{g(!1),v(!1)},children:a.jsx(yt,{size:24})})]}),a.jsx("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-120px)]",children:a.jsxs("form",{onSubmit:y?at:Y,className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name *"}),a.jsx("input",{type:"text",required:!0,value:C.name,onChange:U=>I({...C,name:U.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"Enter full name"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Username *"}),a.jsx("input",{type:"text",required:!0,value:C.username,onChange:U=>I({...C,username:U.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"Enter username"})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Password ",y?"":"*"]}),a.jsx("input",{type:"password",required:!y,value:C.password,onChange:U=>I({...C,password:U.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:y?"Leave blank to keep":"Enter password"})]})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),a.jsx("input",{type:"text",value:C.phone,onChange:U=>I({...C,phone:U.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"Enter phone"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role"}),a.jsx("select",{value:_,onChange:U=>O(U.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:l.map(U=>a.jsx("option",{value:U.name,children:U.name},U.id))})]}),Ut(["driver","supervisor","manager"])&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Assigned Warehouse"}),a.jsxs("select",{value:C.warehouseId,onChange:U=>I({...C,warehouseId:U.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[a.jsx("option",{value:"",children:"None"}),r.map(U=>a.jsx("option",{value:U.id,children:U.name},U.id))]})]})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[Ut(["driver"])&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Assigned Van"}),a.jsxs("select",{value:C.vanId,onChange:U=>I({...C,vanId:U.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[a.jsx("option",{value:"",children:"None"}),n.map(U=>a.jsx("option",{value:U.id,children:U.name},U.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Salary Type"}),a.jsxs("select",{value:E,onChange:U=>R(U.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[a.jsx("option",{value:"monthly",children:"Monthly"}),a.jsx("option",{value:"daily",children:"Daily (Per Attendance)"}),a.jsx("option",{value:"hourly",children:"Hourly"}),a.jsx("option",{value:"commission",children:"Commission"}),a.jsx("option",{value:"monthly_commission",children:"Monthly + Commission"})]})]}),(E==="monthly"||E==="monthly_commission")&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Base Pay / Monthly Salary"}),a.jsx("input",{type:"number",value:C.basePay,onChange:U=>I({...C,basePay:parseFloat(U.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"Enter amount"})]}),E==="daily"&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Daily Rate (per day attended)"}),a.jsx("input",{type:"number",value:C.basePay,onChange:U=>I({...C,basePay:parseFloat(U.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"Enter daily rate"})]}),E==="hourly"&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Hourly Rate"}),a.jsx("input",{type:"number",value:C.hourlyRate,onChange:U=>I({...C,hourlyRate:parseFloat(U.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"Enter rate"})]})]}),E.includes("commission")&&a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Commission Rate (%)"}),a.jsx("input",{type:"number",value:C.commissionRate,onChange:U=>I({...C,commissionRate:parseFloat(U.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"Enter rate"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Commission Base"}),a.jsxs("select",{value:C.commissionBase,onChange:U=>I({...C,commissionBase:U.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[a.jsx("option",{value:"sales",children:"Sales"}),a.jsx("option",{value:"collections",children:"Collections"}),a.jsx("option",{value:"both",children:"Both"})]})]})]}),E==="hourly"&&Ut(["driver","supervisor","manager"])&&a.jsx("div",{className:"grid grid-cols-3 gap-4",children:a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Expected Hours/Week"}),a.jsx("input",{type:"number",value:C.expectedHoursPerWeek,onChange:U=>I({...C,expectedHoursPerWeek:parseInt(U.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"Enter hours"})]})}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),a.jsx("input",{type:"text",value:C.address,onChange:U=>I({...C,address:U.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"Enter address"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",checked:C.useDefaultPermissions,onChange:U=>I({...C,useDefaultPermissions:U.target.checked}),className:"rounded"}),a.jsx("span",{className:"text-sm",children:"Use default role permissions"})]}),!C.useDefaultPermissions&&a.jsxs("div",{className:"grid grid-cols-2 gap-2 ml-6",children:[a.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[a.jsx("input",{type:"checkbox",checked:C.canAccessReports,onChange:U=>I({...C,canAccessReports:U.target.checked}),className:"rounded"})," Can access reports"]}),a.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[a.jsx("input",{type:"checkbox",checked:C.canApproveDeposits,onChange:U=>I({...C,canApproveDeposits:U.target.checked}),className:"rounded"})," Can approve deposits"]}),a.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[a.jsx("input",{type:"checkbox",checked:C.canEditPrices,onChange:U=>I({...C,canEditPrices:U.target.checked}),className:"rounded"})," Can edit prices"]}),a.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[a.jsx("input",{type:"checkbox",checked:C.canEditCreditLimit,onChange:U=>I({...C,canEditCreditLimit:U.target.checked}),className:"rounded"})," Can edit credit limit"]})]})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>{g(!1),v(!1)},className:"flex-1 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:d,className:"flex-1 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 disabled:opacity-50",children:d?"Saving...":y?"Save Changes":"Save"})]})]})})]})}),j&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-sm",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-[#003366] text-white rounded-t-xl",children:[a.jsx("h2",{className:"text-lg font-semibold",children:"Set Performance Rating"}),a.jsx("button",{onClick:()=>b(!1),children:a.jsx(yt,{size:24})})]}),a.jsxs("div",{className:"p-6",children:[a.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["Employee: ",w==null?void 0:w.name]}),a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rating"}),a.jsxs("select",{value:ne,onChange:U=>W(parseInt(U.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg mb-4",children:[a.jsx("option",{value:1,children:"1"}),a.jsx("option",{value:2,children:"2"}),a.jsx("option",{value:3,children:"3"}),a.jsx("option",{value:4,children:"4"}),a.jsx("option",{value:5,children:"5"})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:()=>b(!1),className:"flex-1 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{onClick:Lt,className:"flex-1 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600",children:"Save"})]})]})]})}),Q&&K&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-lg w-full mx-4 max-h-[90vh] overflow-auto",children:[a.jsx("div",{className:"p-6 border-b",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Br,{size:24,className:"text-emerald-600"}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-bold",children:"Employee Report"}),a.jsxs("p",{className:"text-sm text-gray-500",children:[K.name," - ",K.role]})]})]}),a.jsx("button",{onClick:()=>H(!1),className:"p-2 hover:bg-gray-100 rounded-lg",children:a.jsx(yt,{size:20})})]})}),a.jsx("div",{className:"p-6 space-y-4",children:D?a.jsxs("div",{className:"flex items-center justify-center py-8",children:[a.jsx(vt,{className:"animate-spin",size:32}),a.jsx("span",{className:"ml-2",children:"Loading report data..."})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:a.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Orders:"}),a.jsx("span",{className:"ml-2 font-medium",children:ge.length})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Tasks:"}),a.jsx("span",{className:"ml-2 font-medium",children:B.length})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Collections:"}),a.jsx("span",{className:"ml-2 font-medium",children:L.length})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Deposits:"}),a.jsx("span",{className:"ml-2 font-medium",children:F.length})]})]})}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("h3",{className:"font-medium text-gray-700",children:"Include in Report:"}),a.jsxs("label",{className:"flex items-center gap-3 p-3 bg-white border rounded-lg cursor-pointer hover:bg-gray-50",children:[a.jsx("input",{type:"checkbox",checked:Fe.showSummary,onChange:U=>ct({...Fe,showSummary:U.target.checked}),className:"w-5 h-5 text-emerald-600 rounded"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-medium",children:"Summary"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Total sales, collections, deposits"})]}),Fe.showSummary&&a.jsx(Jt,{size:18,className:"text-emerald-600"})]}),a.jsxs("label",{className:"flex items-center gap-3 p-3 bg-white border rounded-lg cursor-pointer hover:bg-gray-50",children:[a.jsx("input",{type:"checkbox",checked:Fe.showOrders,onChange:U=>ct({...Fe,showOrders:U.target.checked}),className:"w-5 h-5 text-emerald-600 rounded"}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("p",{className:"font-medium",children:["POS Orders (",ge.length,")"]}),a.jsx("p",{className:"text-sm text-gray-500",children:"All POS sales by this employee"})]}),Fe.showOrders&&a.jsx(Jt,{size:18,className:"text-emerald-600"})]}),a.jsxs("label",{className:"flex items-center gap-3 p-3 bg-white border rounded-lg cursor-pointer hover:bg-gray-50",children:[a.jsx("input",{type:"checkbox",checked:Fe.showTasks,onChange:U=>ct({...Fe,showTasks:U.target.checked}),className:"w-5 h-5 text-emerald-600 rounded"}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("p",{className:"font-medium",children:["Completed Tasks (",B.length,")"]}),a.jsx("p",{className:"text-sm text-gray-500",children:"All delivery tasks completed"})]}),Fe.showTasks&&a.jsx(Jt,{size:18,className:"text-emerald-600"})]}),a.jsxs("label",{className:"flex items-center gap-3 p-3 bg-white border rounded-lg cursor-pointer hover:bg-gray-50",children:[a.jsx("input",{type:"checkbox",checked:Fe.showCollections,onChange:U=>ct({...Fe,showCollections:U.target.checked}),className:"w-5 h-5 text-emerald-600 rounded"}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("p",{className:"font-medium",children:["Debt Collections (",L.length,")"]}),a.jsx("p",{className:"text-sm text-gray-500",children:"All debt collections made"})]}),Fe.showCollections&&a.jsx(Jt,{size:18,className:"text-emerald-600"})]}),a.jsxs("label",{className:"flex items-center gap-3 p-3 bg-white border rounded-lg cursor-pointer hover:bg-gray-50",children:[a.jsx("input",{type:"checkbox",checked:Fe.showDeposits,onChange:U=>ct({...Fe,showDeposits:U.target.checked}),className:"w-5 h-5 text-emerald-600 rounded"}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("p",{className:"font-medium",children:["Deposits (",F.length,")"]}),a.jsx("p",{className:"text-sm text-gray-500",children:"All cash deposits made"})]}),Fe.showDeposits&&a.jsx(Jt,{size:18,className:"text-emerald-600"})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"flex items-center gap-3 p-3 bg-white border rounded-lg cursor-pointer hover:bg-gray-50",children:[a.jsx("input",{type:"checkbox",checked:Fe.showAttendance,onChange:U=>ct({...Fe,showAttendance:U.target.checked}),className:"w-5 h-5 text-emerald-600 rounded"}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("p",{className:"font-medium",children:["Attendance (",ye.length,")"]}),a.jsx("p",{className:"text-sm text-gray-500",children:"Attendance records and summary"})]}),Fe.showAttendance&&a.jsx(Jt,{size:18,className:"text-emerald-600"})]}),a.jsxs("label",{className:"flex items-center gap-3 p-3 bg-white border rounded-lg cursor-pointer hover:bg-gray-50 mt-3",children:[a.jsx("input",{type:"checkbox",checked:Fe.showSalaryPayments,onChange:U=>ct({...Fe,showSalaryPayments:U.target.checked}),className:"w-5 h-5 text-purple-600 rounded"}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("p",{className:"font-medium",children:["Salary Payments (",$e.length,")"]}),a.jsx("p",{className:"text-sm text-gray-500",children:"All salary, advances, and withdrawals"})]}),Fe.showSalaryPayments&&a.jsx(Jt,{size:18,className:"text-purple-600"})]})]})]})}),a.jsxs("div",{className:"p-6 border-t bg-gray-50 flex gap-3",children:[a.jsx("button",{onClick:()=>H(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-100",children:"Cancel"}),a.jsxs("button",{onClick:()=>{Qt(),H(!1)},disabled:D,className:"flex-1 px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 disabled:opacity-50 flex items-center justify-center gap-2",children:[a.jsx(ua,{size:18}),"Print Report"]})]})]})}),Bt&&it&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-2xl max-h-[90vh] overflow-hidden",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-purple-600 text-white",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-lg font-semibold",children:"Salary & Payments"}),a.jsxs("p",{className:"text-sm text-purple-200",children:[it.name," - ",x1[it.salaryType]]})]}),a.jsx("button",{onClick:()=>Ee(!1),children:a.jsx(yt,{size:24})})]}),a.jsx("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-180px)]",children:Nt?a.jsx("div",{className:"flex items-center justify-center py-8",children:a.jsx(vt,{className:"animate-spin",size:32})}):a.jsxs(a.Fragment,{children:[(()=>{const U=Ce(),Ke=U.balance<0,rt=it.salaryType==="daily";return a.jsxs("div",{className:"space-y-4 mb-6",children:[rt&&a.jsxs("div",{className:"bg-amber-50 border border-amber-200 p-3 rounded-lg",children:[a.jsx("p",{className:"text-sm font-medium text-amber-800 mb-2",children:" Attendance This Month"}),a.jsxs("div",{className:"flex flex-wrap gap-4 text-sm",children:[a.jsxs("span",{className:"text-gray-700",children:["Daily Rate: ",a.jsxs("strong",{children:["$",it.basePay]})]}),a.jsxs("span",{className:"text-green-700",children:["Present: ",a.jsxs("strong",{children:[U.presentDays," days"]})]}),a.jsxs("span",{className:"text-orange-700",children:["Half Days: ",a.jsx("strong",{children:U.halfDays})]}),a.jsxs("span",{className:"text-blue-700",children:["Earned: ",a.jsxs("strong",{children:["$",U.dailyEarned.toLocaleString()]})]})]})]}),a.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[a.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg text-center",children:[a.jsx("p",{className:"text-sm text-gray-600",children:rt?"Earned (Attendance)":"Base Salary"}),a.jsxs("p",{className:"text-xl font-bold text-blue-600",children:["$",U.owed.toLocaleString()]})]}),a.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg text-center",children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Commission"}),a.jsxs("p",{className:"text-xl font-bold text-purple-600",children:["$",U.commission.toLocaleString()]})]}),a.jsxs("div",{className:"bg-green-50 p-4 rounded-lg text-center",children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Paid"}),a.jsxs("p",{className:"text-xl font-bold text-green-600",children:["$",U.paid.toLocaleString()]})]}),a.jsxs("div",{className:`p-4 rounded-lg text-center ${Ke?"bg-red-50":U.balance===0?"bg-green-50":"bg-orange-50"}`,children:[a.jsxs("p",{className:"text-sm text-gray-600 flex items-center justify-center gap-1",children:["Balance",Ke&&a.jsx(c0,{size:14,className:"text-red-500"})]}),a.jsx("p",{className:`text-xl font-bold ${Ke?"text-red-600":U.balance>0?"text-orange-600":"text-green-600"}`,children:Ke?a.jsxs("span",{className:"flex items-center justify-center gap-1",children:[a.jsx(EW,{size:18}),"-$",Math.abs(U.balance).toLocaleString()]}):U.balance>0?a.jsxs("span",{className:"flex items-center justify-center gap-1",children:[a.jsx(hn,{size:18}),"$",U.balance.toLocaleString()]}):a.jsx("span",{className:"flex items-center justify-center gap-1",children:" Paid"})}),Ke&&a.jsx("p",{className:"text-xs text-red-500 mt-1",children:"Overdraw!"})]})]}),(U.commission>0||U.bonus>0||U.deductions>0)&&a.jsx("div",{className:"bg-purple-100 border border-purple-200 p-3 rounded-lg text-center",children:a.jsxs("p",{className:"text-sm text-purple-700",children:[a.jsx("strong",{children:"Total to Pay:"})," $",U.totalOwed.toLocaleString(),"(Base",U.commission>0&&" + Commission",U.bonus>0&&" + Bonus",U.deductions>0&&" - Deductions",")"]})})]})})(),et&&(()=>{const U={advance:et.payments.filter(rt=>rt.paymentType==="advance").reduce((rt,_t)=>rt+_t.amount,0),withdrawal:et.payments.filter(rt=>rt.paymentType==="withdrawal").reduce((rt,_t)=>rt+_t.amount,0),bonus:et.payments.filter(rt=>rt.paymentType==="bonus").reduce((rt,_t)=>rt+_t.amount,0),commission:et.payments.filter(rt=>rt.paymentType==="commission").reduce((rt,_t)=>rt+_t.amount,0),deduction:et.payments.filter(rt=>rt.paymentType==="deduction").reduce((rt,_t)=>rt+_t.amount,0)};return U.advance>0||U.withdrawal>0||U.bonus>0||U.commission>0||U.deduction>0?a.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg mb-4",children:[a.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Other Payments This Month"}),a.jsxs("div",{className:"flex flex-wrap gap-3 text-sm",children:[U.advance>0&&a.jsxs("span",{className:"bg-amber-100 text-amber-700 px-2 py-1 rounded",children:["Advance: $",U.advance]}),U.withdrawal>0&&a.jsxs("span",{className:"bg-orange-100 text-orange-700 px-2 py-1 rounded",children:["Withdrawal: $",U.withdrawal]}),U.bonus>0&&a.jsxs("span",{className:"bg-green-100 text-green-700 px-2 py-1 rounded",children:["Bonus: $",U.bonus]}),U.commission>0&&a.jsxs("span",{className:"bg-blue-100 text-blue-700 px-2 py-1 rounded",children:["Commission: $",U.commission]}),U.deduction>0&&a.jsxs("span",{className:"bg-red-100 text-red-700 px-2 py-1 rounded",children:["Deduction: -$",U.deduction]})]})]}):null})(),et&&a.jsx("div",{className:"bg-gray-50 p-4 rounded-lg mb-6",children:a.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500",children:"This Month"}),a.jsxs("p",{className:"font-bold",children:["$",et.totalPaidThisMonth.toLocaleString()]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500",children:"This Year"}),a.jsxs("p",{className:"font-bold",children:["$",et.totalPaidThisYear.toLocaleString()]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500",children:"All Time"}),a.jsxs("p",{className:"font-bold",children:["$",et.totalPaidAllTime.toLocaleString()]})]})]})}),a.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg mb-6",children:[a.jsx("h3",{className:"font-semibold text-purple-800 mb-3",children:"Record Payment"}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type"}),a.jsx("select",{value:Xe.paymentType,onChange:U=>le({...Xe,paymentType:U.target.value}),className:"w-full px-3 py-2 border rounded-lg",children:Object.entries(f1).map(([U,Ke])=>a.jsx("option",{value:U,children:Ke},U))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount"}),a.jsx("input",{type:"number",value:Xe.amount,onChange:U=>le({...Xe,amount:parseFloat(U.target.value)||0}),className:"w-full px-3 py-2 border rounded-lg",min:"0",step:"0.01"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),a.jsx("input",{type:"date",value:Xe.paymentDate,onChange:U=>le({...Xe,paymentDate:U.target.value}),className:"w-full px-3 py-2 border rounded-lg"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),a.jsx("input",{type:"text",value:Xe.notes,onChange:U=>le({...Xe,notes:U.target.value}),className:"w-full px-3 py-2 border rounded-lg",placeholder:"Optional"})]})]}),a.jsxs("button",{onClick:Ca,disabled:pr||Xe.amount<=0,className:"mt-3 w-full py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 flex items-center justify-center gap-2",children:[pr?a.jsx(vt,{className:"animate-spin",size:18}):a.jsx(hr,{size:18}),pr?"Saving...":"Record Payment"]})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h3",{className:"font-semibold text-gray-800",children:"Payment History"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("select",{value:er,onChange:U=>ue(parseInt(U.target.value)),className:"px-2 py-1 text-sm border rounded-lg",children:[{value:1,label:"January"},{value:2,label:"February"},{value:3,label:"March"},{value:4,label:"April"},{value:5,label:"May"},{value:6,label:"June"},{value:7,label:"July"},{value:8,label:"August"},{value:9,label:"September"},{value:10,label:"October"},{value:11,label:"November"},{value:12,label:"December"}].map(U=>a.jsx("option",{value:U.value,children:U.label},U.value))}),a.jsx("select",{value:Le,onChange:U=>Je(parseInt(U.target.value)),className:"px-2 py-1 text-sm border rounded-lg",children:Array.from({length:5},(U,Ke)=>new Date().getFullYear()-Ke).map(U=>a.jsx("option",{value:U,children:U},U))})]})]}),(()=>{const U=(et==null?void 0:et.payments.filter(rt=>{const _t=new Date(rt.paymentDate);return _t.getMonth()+1===er&&_t.getFullYear()===Le}))||[],Ke=U.reduce((rt,_t)=>rt+_t.amount,0);return U.length>0?a.jsx("div",{className:"border rounded-lg overflow-hidden",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-left px-3 py-2",children:"Date"}),a.jsx("th",{className:"text-left px-3 py-2",children:"Type"}),a.jsx("th",{className:"text-right px-3 py-2",children:"Amount"}),a.jsx("th",{className:"text-left px-3 py-2",children:"Notes"}),a.jsx("th",{className:"px-3 py-2"})]})}),a.jsx("tbody",{className:"divide-y",children:U.map(rt=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-3 py-2",children:new Date(rt.paymentDate).toLocaleDateString()}),a.jsx("td",{className:"px-3 py-2",children:a.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${rt.paymentType==="salary"?"bg-blue-100 text-blue-700":rt.paymentType==="advance"?"bg-orange-100 text-orange-700":rt.paymentType==="withdrawal"?"bg-red-100 text-red-700":rt.paymentType==="bonus"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:f1[rt.paymentType]||rt.paymentType})}),a.jsxs("td",{className:"px-3 py-2 text-right font-medium",children:["$",rt.amount.toLocaleString()]}),a.jsx("td",{className:"px-3 py-2 text-gray-500 text-xs",children:rt.notes||"-"}),a.jsx("td",{className:"px-3 py-2",children:a.jsx("button",{onClick:()=>nr(rt.id),className:"p-1 text-red-500 hover:bg-red-50 rounded",children:a.jsx(xr,{size:14})})})]},rt.id))}),a.jsx("tfoot",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsxs("td",{colSpan:2,className:"px-3 py-2 font-semibold",children:["Total for ",["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][er-1]," ",Le]}),a.jsxs("td",{className:"px-3 py-2 text-right font-bold text-purple-600",children:["$",Ke.toLocaleString()]}),a.jsx("td",{colSpan:2})]})})]})}):a.jsxs("p",{className:"text-center text-gray-500 py-4",children:["No payments for ",["January","February","March","April","May","June","July","August","September","October","November","December"][er-1]," ",Le]})})()]})]})}),a.jsx("div",{className:"p-4 border-t bg-gray-50",children:a.jsx("button",{onClick:()=>Ee(!1),className:"w-full py-2 border border-gray-300 rounded-lg hover:bg-gray-100",children:"Close"})})]})}),ma&&_r&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-2xl max-h-[90vh] overflow-hidden",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-amber-600 text-white",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-lg font-semibold",children:"Visibility Control"}),a.jsxs("p",{className:"text-sm text-amber-100",children:[_r.name," - ",_r.role]})]}),a.jsx("button",{onClick:()=>Or(!1),children:a.jsx(yt,{size:24})})]}),a.jsx("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-180px)]",children:Ne?a.jsx("div",{className:"flex justify-center py-8",children:a.jsx(vt,{className:"animate-spin",size:32})}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"mb-6 p-4 bg-amber-50 rounded-lg",children:[a.jsx("h3",{className:"font-semibold text-gray-800 mb-3",children:"Restriction Settings"}),a.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"When enabled, this employee will only see assigned items. When disabled, they see all items."}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:Jr.restrictCustomers,onChange:U=>na(Ke=>({...Ke,restrictCustomers:U.target.checked})),className:"w-5 h-5 rounded border-gray-300"}),a.jsx("span",{className:"font-medium",children:"Restrict Customers"}),a.jsxs("span",{className:"text-sm text-gray-500",children:["(",X.length," assigned)"]})]}),a.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:Jr.restrictProducts,onChange:U=>na(Ke=>({...Ke,restrictProducts:U.target.checked})),className:"w-5 h-5 rounded border-gray-300"}),a.jsx("span",{className:"font-medium",children:"Restrict Products"}),a.jsxs("span",{className:"text-sm text-gray-500",children:["(",re.length," assigned)"]})]})]})]}),a.jsxs("div",{className:"flex gap-2 mb-4",children:[a.jsxs("button",{onClick:()=>qe("customers"),className:`px-4 py-2 rounded-lg font-medium ${pe==="customers"?"bg-amber-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["Customers (",X.length,")"]}),a.jsxs("button",{onClick:()=>qe("products"),className:`px-4 py-2 rounded-lg font-medium ${pe==="products"?"bg-amber-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["Products (",re.length,")"]})]}),a.jsx("input",{type:"text",value:lt,onChange:U=>ft(U.target.value),placeholder:`Search ${pe}...`,className:"w-full px-4 py-2 border rounded-lg mb-4"}),a.jsx("div",{className:"border rounded-lg max-h-64 overflow-y-auto",children:pe==="customers"?Os.filter(U=>U.name.toLowerCase().includes(lt.toLowerCase())).map(U=>a.jsxs("label",{className:"flex items-center gap-3 px-4 py-2 hover:bg-gray-50 cursor-pointer border-b last:border-b-0",children:[a.jsx("input",{type:"checkbox",checked:X.includes(U.id),onChange:()=>je(U.id),className:"w-4 h-4 rounded border-gray-300"}),a.jsx("span",{children:U.name})]},U.id)):V.filter(U=>U.name.toLowerCase().includes(lt.toLowerCase())).map(U=>a.jsxs("label",{className:"flex items-center gap-3 px-4 py-2 hover:bg-gray-50 cursor-pointer border-b last:border-b-0",children:[a.jsx("input",{type:"checkbox",checked:re.includes(U.id),onChange:()=>fe(U.id),className:"w-4 h-4 rounded border-gray-300"}),a.jsx("span",{children:U.name})]},U.id))}),a.jsx("div",{className:"flex gap-2 mt-4",children:pe==="customers"?a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>te(Os.map(U=>U.id)),className:"px-3 py-1 text-sm bg-gray-100 hover:bg-gray-200 rounded",children:"Select All"}),a.jsx("button",{onClick:()=>te([]),className:"px-3 py-1 text-sm bg-gray-100 hover:bg-gray-200 rounded",children:"Deselect All"})]}):a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>ae(V.map(U=>U.id)),className:"px-3 py-1 text-sm bg-gray-100 hover:bg-gray-200 rounded",children:"Select All"}),a.jsx("button",{onClick:()=>ae([]),className:"px-3 py-1 text-sm bg-gray-100 hover:bg-gray-200 rounded",children:"Deselect All"})]})})]})}),a.jsxs("div",{className:"p-4 border-t bg-gray-50 flex gap-3",children:[a.jsx("button",{onClick:()=>Or(!1),className:"flex-1 py-2 border border-gray-300 rounded-lg hover:bg-gray-100",children:"Cancel"}),a.jsx("button",{onClick:M,disabled:Se,className:"flex-1 py-2 bg-amber-600 text-white rounded-lg hover:bg-amber-700 disabled:opacity-50",children:Se?"Saving...":"Save Changes"})]})]})}),Me&&ee&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-indigo-600 text-white",children:[a.jsxs("h2",{className:"text-lg font-semibold",children:["Visit Analysis - ",ee.name]}),a.jsx("button",{onClick:()=>ut(!1),children:a.jsx(yt,{size:24})})]}),a.jsxs("div",{className:"p-4 border-b bg-gray-50 flex gap-4 items-end",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date"}),a.jsx("input",{type:"date",value:ht,onChange:U=>At(U.target.value),className:"px-3 py-2 border rounded-lg"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date"}),a.jsx("input",{type:"date",value:Er,onChange:U=>or(U.target.value),className:"px-3 py-2 border rounded-lg"})]}),a.jsx("button",{onClick:()=>Dr(ee.id),className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700",children:"Apply"})]}),a.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:Ie?a.jsx("div",{className:"flex justify-center py-12",children:a.jsx(vt,{className:"animate-spin",size:32})}):xe?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[a.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[a.jsx("div",{className:"text-2xl font-bold text-blue-700",children:xe.totalCustomersVisited}),a.jsx("div",{className:"text-sm text-blue-600",children:"Customers Visited"})]}),a.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[a.jsx("div",{className:"text-2xl font-bold text-green-700",children:xe.totalVisits}),a.jsx("div",{className:"text-sm text-green-600",children:"Total Visits"})]}),a.jsxs("div",{className:"bg-purple-50 rounded-lg p-4",children:[a.jsx("div",{className:"text-2xl font-bold text-purple-700",children:xe.totalCompletedVisits}),a.jsx("div",{className:"text-sm text-purple-600",children:"Completed"})]}),a.jsxs("div",{className:"bg-amber-50 rounded-lg p-4",children:[a.jsxs("div",{className:"text-2xl font-bold text-amber-700",children:["$",xe.totalSales.toFixed(2)]}),a.jsx("div",{className:"text-sm text-amber-600",children:"Total Sales"})]})]}),a.jsxs("div",{className:"mb-4 flex gap-4 text-sm",children:[a.jsxs("span",{className:"text-indigo-600",children:[" Assigned: ",xe.totalAssignedVisits]}),a.jsxs("span",{className:"text-teal-600",children:[" Created by Salesman: ",xe.totalCreatedVisits]})]}),a.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left font-semibold",children:"Customer"}),a.jsx("th",{className:"px-4 py-3 text-center font-semibold",children:"Visits"}),a.jsx("th",{className:"px-4 py-3 text-center font-semibold",children:"Assigned"}),a.jsx("th",{className:"px-4 py-3 text-center font-semibold",children:"Created"}),a.jsx("th",{className:"px-4 py-3 text-center font-semibold",children:"Completed"}),a.jsx("th",{className:"px-4 py-3 text-right font-semibold",children:"Sales"}),a.jsx("th",{className:"px-4 py-3 text-center font-semibold",children:"Last Visit"})]})}),a.jsx("tbody",{children:xe.customerVisits.map(U=>a.jsxs(a.Fragment,{children:[a.jsxs("tr",{className:"border-t hover:bg-gray-50 cursor-pointer",onClick:()=>Ds(U.customerId),children:[a.jsx("td",{className:"px-4 py-3",children:a.jsxs("div",{className:"flex items-center gap-2",children:[Gt.includes(U.customerId)?a.jsx(G6,{size:16}):a.jsx(i2,{size:16}),a.jsxs("div",{children:[a.jsx("div",{className:"font-medium",children:U.customerName}),U.customerPhone&&a.jsx("div",{className:"text-xs text-gray-500",children:U.customerPhone})]})]})}),a.jsx("td",{className:"px-4 py-3 text-center",children:U.totalVisits}),a.jsx("td",{className:"px-4 py-3 text-center text-indigo-600",children:U.assignedVisits}),a.jsx("td",{className:"px-4 py-3 text-center text-teal-600",children:U.createdVisits}),a.jsx("td",{className:"px-4 py-3 text-center text-green-600",children:U.completedVisits}),a.jsxs("td",{className:"px-4 py-3 text-right",children:["$",U.totalSales.toFixed(2)]}),a.jsx("td",{className:"px-4 py-3 text-center text-gray-500",children:new Date(U.lastVisitDate).toLocaleDateString()})]},U.customerId),Gt.includes(U.customerId)&&U.visits.map(Ke=>a.jsxs("tr",{className:"bg-gray-50 border-t",children:[a.jsx("td",{className:"px-4 py-2 pl-10",colSpan:2,children:a.jsxs("div",{className:"text-sm",children:[a.jsx("span",{className:"font-medium",children:Ke.taskNumber}),a.jsx("span",{className:`ml-2 px-2 py-0.5 rounded text-xs ${Ke.isAssigned?"bg-indigo-100 text-indigo-700":"bg-teal-100 text-teal-700"}`,children:Ke.isAssigned?"Assigned":"Created"})]})}),a.jsx("td",{className:"px-4 py-2 text-center text-sm",children:Ke.taskType}),a.jsx("td",{className:"px-4 py-2 text-center",children:a.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${Ke.status==="Completed"||Ke.status==="Delivered"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:Ke.status})}),a.jsxs("td",{className:"px-4 py-2 text-right text-sm",children:["$",Ke.total.toFixed(2)]}),a.jsx("td",{className:"px-4 py-2 text-center text-sm text-gray-500",children:new Date(Ke.createdAt).toLocaleDateString()})]},Ke.taskId))]}))})]}),xe.customerVisits.length===0&&a.jsx("div",{className:"p-8 text-center text-gray-500",children:"No visits found for this period"})]})]}):a.jsx("div",{className:"p-8 text-center text-gray-500",children:"No data available"})}),a.jsx("div",{className:"p-4 border-t bg-gray-50",children:a.jsx("button",{onClick:()=>ut(!1),className:"w-full py-2 border border-gray-300 rounded-lg hover:bg-gray-100",children:"Close"})})]})})]})}function rve(){const[e,t]=m.useState([]),[r,s]=m.useState([]),[n,i]=m.useState([]),[l,o]=m.useState(!0),[c,u]=m.useState(!1),[d,h]=m.useState(!1),[f,x]=m.useState(!1),[p,g]=m.useState(!1),[y,v]=m.useState(!1),[j,b]=m.useState(!1),[w,k]=m.useState(!1),[N,S]=m.useState(null),[_,O]=m.useState(new Date().toISOString().split("T")[0]),[E,R]=m.useState(null),[C,I]=m.useState(!1),[ne,W]=m.useState([]),[Q,H]=m.useState([]),[K,q]=m.useState([]),[ge,G]=m.useState(!1),[B,se]=m.useState(!1),[L,Z]=m.useState({productId:"",quantity:0,notes:""}),[F,he]=m.useState(""),[ye,z]=m.useState(!1),[A,de]=m.useState(!1),[D,ze]=m.useState({name:"",plateNumber:"",warehouseId:"",assignedDriverId:"",maxCash:1e4,status:"active",notes:""});m.useEffect(()=>{Fe()},[]);const Fe=async()=>{try{o(!0);const[ue,Le,Je]=await Promise.all([rn.getAll(),Ks.getAll(),rn.getDrivers()]);t(ue.data),s(Le.data),i(Je.data||[])}catch(ue){console.error("Failed to load vans:",ue)}finally{o(!1)}},ct=()=>{ze({name:"",plateNumber:"",warehouseId:"",assignedDriverId:"",maxCash:1e4,status:"active",notes:""})},$e=async ue=>{var Le,Je;ue.preventDefault(),u(!0);try{await rn.create({...D,warehouseId:D.warehouseId?parseInt(D.warehouseId):null,assignedDriverId:D.assignedDriverId?parseInt(D.assignedDriverId):null}),h(!1),ct(),Fe()}catch(Xe){alert(((Je=(Le=Xe.response)==null?void 0:Le.data)==null?void 0:Je.message)||"Failed to create van")}finally{u(!1)}},We=ue=>{var Le,Je;S(ue),ze({name:ue.name,plateNumber:ue.plateNumber||"",warehouseId:((Le=ue.warehouseId)==null?void 0:Le.toString())||"",assignedDriverId:((Je=ue.assignedDriverId)==null?void 0:Je.toString())||"",maxCash:ue.maxCash,status:ue.status,notes:ue.notes||""}),x(!0)},Bt=async ue=>{var Le,Je;if(ue.preventDefault(),!!N){u(!0);try{await rn.update(N.id,{...D,warehouseId:D.warehouseId?parseInt(D.warehouseId):null,assignedDriverId:D.assignedDriverId?parseInt(D.assignedDriverId):null}),x(!1),Fe()}catch(Xe){alert(((Je=(Le=Xe.response)==null?void 0:Le.data)==null?void 0:Je.message)||"Failed to update van")}finally{u(!1)}}},Ee=async ue=>{var Le,Je;if(confirm("Are you sure you want to delete this van?"))try{await rn.delete(ue),Fe()}catch(Xe){alert(((Je=(Le=Xe.response)==null?void 0:Le.data)==null?void 0:Je.message)||"Failed to delete van")}},it=async ue=>{S(ue),g(!0),G(!0);try{const[Le,Je]=await Promise.all([rn.getStock(ue.id),br.getAll()]);W(Le.data),q(Je.data.map(Xe=>({id:Xe.id,name:Xe.name,sku:Xe.sku,barcode:Xe.barcode})))}catch(Le){console.error("Failed to load stock:",Le)}finally{G(!1)}},we=async ue=>{S(ue),v(!0),se(!0);try{const Le=await rn.getMovements(ue.id,50);H(Le.data)}catch(Le){console.error("Failed to load movements:",Le)}finally{se(!1)}},et=async ue=>{S(ue),b(!0),Z({productId:"",quantity:0,notes:""}),he("");try{const Le=await br.getAll();q(Le.data.map(Je=>({id:Je.id,name:Je.name,sku:Je.sku,barcode:Je.barcode})))}catch(Le){console.error("Failed to load products:",Le)}},Ge=async()=>{var ue,Le;if(!(!N||!L.productId||L.quantity<=0)){de(!0);try{await rn.loadStock(N.id,{productId:parseInt(L.productId),quantity:L.quantity,notes:L.notes||void 0}),alert("Stock loaded successfully!"),b(!1),p&&it(N)}catch(Je){alert(((Le=(ue=Je.response)==null?void 0:ue.data)==null?void 0:Le.message)||"Failed to load stock")}finally{de(!1)}}},Nt=async(ue,Le)=>{var le,Me;if(!N)return;const Je=prompt(`Enter quantity to unload (max ${Le}):`);if(!Je)return;const Xe=parseFloat(Je);if(isNaN(Xe)||Xe<=0||Xe>Le){alert("Invalid quantity");return}de(!0);try{await rn.unloadStock(N.id,{productId:ue,quantity:Xe}),alert("Stock unloaded successfully!"),it(N)}catch(ut){alert(((Me=(le=ut.response)==null?void 0:le.data)==null?void 0:Me.message)||"Failed to unload stock")}finally{de(!1)}},Rt=ue=>({load_van:{bg:"bg-green-100",text:"text-green-700",label:"Loaded"},unload_van:{bg:"bg-orange-100",text:"text-orange-700",label:"Unloaded"},sale:{bg:"bg-blue-100",text:"text-blue-700",label:"Sale"},return:{bg:"bg-purple-100",text:"text-purple-700",label:"Return"},adjustment:{bg:"bg-gray-100",text:"text-gray-700",label:"Adjustment"}})[ue]||{bg:"bg-gray-100",text:"text-gray-700",label:ue},pr=ue=>({active:"bg-green-100 text-green-700",available:"bg-green-100 text-green-700",on_duty:"bg-blue-100 text-blue-700",maintenance:"bg-yellow-100 text-yellow-700"})[ue]||"bg-gray-100 text-gray-700",Zt=async(ue,Le)=>{S(ue),k(!0),I(!0);const Je=Le||_;try{const[Xe,le,Me,ut,ee]=await Promise.all([rn.getStock(ue.id),ie.get(`/tasks?vanId=${ue.id}&date=${Je}`),ie.get(`/collections?date=${Je}`),ie.get(`/orders?vanId=${ue.id}&date=${Je}`),rn.getMovements(ue.id,200)]),ve=new Map;ee.data.forEach(xe=>{const oe=new Date(xe.createdAt),Ie=`${oe.getFullYear()}-${String(oe.getMonth()+1).padStart(2,"0")}-${String(oe.getDate()).padStart(2,"0")}`;if(xe.movementType==="load_van"&&Ie===Je){const me=ve.get(xe.productId);me?me.quantity+=xe.quantity:ve.set(xe.productId,{productId:xe.productId,productName:xe.productName,quantity:xe.quantity})}}),R({stock:Xe.data,tasks:le.data.map(xe=>{var oe,Ie;return{id:xe.id,taskNumber:xe.taskNumber,customerName:xe.customerName||((oe=xe.customer)==null?void 0:oe.name)||"Unknown",total:xe.total,paidAmount:xe.paidAmount||0,debtAmount:xe.debtAmount||0,status:xe.status,paymentType:xe.paymentType||"cash",completedAt:xe.completedAt,items:((Ie=xe.items)==null?void 0:Ie.map(me=>{var ht;return{productName:me.productName||((ht=me.product)==null?void 0:ht.name),quantity:me.quantity,unitPrice:me.unitPrice,total:me.total}}))||[]}}),collections:Me.data.map(xe=>{var oe;return{id:xe.id,collectionNumber:xe.collectionNumber,customerName:xe.customerName||((oe=xe.customer)==null?void 0:oe.name)||"Unknown",amount:xe.amount,paymentType:xe.paymentType,collectionDate:xe.collectionDate}}),orders:ut.data.map(xe=>{var oe,Ie;return{id:xe.id,orderNumber:xe.orderNumber,customerName:xe.customerName||((oe=xe.customer)==null?void 0:oe.name)||"Unknown",totalAmount:xe.totalAmount,paidAmount:xe.paidAmount,paymentStatus:xe.paymentStatus,orderDate:xe.orderDate,items:((Ie=xe.items)==null?void 0:Ie.map(me=>{var ht;return{productName:me.productName||((ht=me.product)==null?void 0:ht.name),quantity:me.quantity,unitPrice:me.unitPrice,total:me.total}}))||[]}}),todayLoads:Array.from(ve.values())})}catch(Xe){console.error("Failed to load performance:",Xe),R({stock:[],tasks:[],collections:[],orders:[],todayLoads:[]})}finally{I(!1)}},er=()=>{if(!N||!E)return;const ue=E.tasks.filter(ee=>ee.status==="Completed").reduce((ee,ve)=>ee+ve.total,0)+E.orders.reduce((ee,ve)=>ee+ve.totalAmount,0),Le=E.tasks.filter(ee=>ee.status==="Completed").reduce((ee,ve)=>ee+ve.paidAmount,0)+E.orders.reduce((ee,ve)=>ee+ve.paidAmount,0),Je=E.tasks.filter(ee=>ee.status==="Completed").reduce((ee,ve)=>ee+ve.debtAmount,0),Xe=E.collections.reduce((ee,ve)=>ee+ve.amount,0),le=E.tasks.filter(ee=>ee.status==="Completed").length,Me=new Map;E.tasks.filter(ee=>ee.status==="Completed").forEach(ee=>{ee.items.forEach(ve=>{const xe=Me.get(ve.productName)||{qty:0,total:0};xe.qty+=ve.quantity,xe.total+=ve.total,Me.set(ve.productName,xe)})});const ut=window.open("","_blank","width=1000,height=800");if(!ut){alert("Please allow popups");return}ut.document.write(`
      <!DOCTYPE html><html><head><title>Van Performance - ${N.name}</title>
      <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: Arial, sans-serif; font-size: 11px; padding: 15px; }
        .header { text-align: center; border-bottom: 2px solid #333; padding-bottom: 10px; margin-bottom: 15px; }
        .header h1 { font-size: 20px; } .header p { color: #666; font-size: 10px; }
        .van-info { background: #f5f5f5; padding: 10px; border-radius: 5px; margin-bottom: 15px; display: flex; gap: 20px; }
        .van-info .item { } .van-info .label { font-size: 9px; color: #666; } .van-info .value { font-weight: bold; }
        .summary { display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px; margin-bottom: 15px; }
        .summary-card { border: 1px solid #ddd; padding: 8px; border-radius: 5px; text-align: center; }
        .summary-card .label { font-size: 9px; color: #666; } .summary-card .value { font-size: 16px; font-weight: bold; }
        .summary-card .value.green { color: #22c55e; } .summary-card .value.blue { color: #3b82f6; }
        .summary-card .value.red { color: #ef4444; } .summary-card .value.purple { color: #9333ea; }
        .section { margin-bottom: 15px; } .section h2 { font-size: 13px; border-bottom: 1px solid #ddd; padding-bottom: 5px; margin-bottom: 8px; }
        table { width: 100%; border-collapse: collapse; font-size: 10px; }
        th, td { border: 1px solid #ddd; padding: 5px; text-align: left; }
        th { background: #f5f5f5; font-size: 9px; } .text-right { text-align: right; } .text-center { text-align: center; }
        .badge { padding: 2px 6px; border-radius: 3px; font-size: 9px; }
        .badge-green { background: #dcfce7; color: #166534; } .badge-blue { background: #dbeafe; color: #1e40af; }
        .badge-red { background: #fee2e2; color: #991b1b; } .footer { text-align: center; margin-top: 15px; font-size: 9px; color: #666; border-top: 1px solid #ddd; padding-top: 10px; }
        @media print { body { padding: 0; } }
      </style></head><body>
      <div class="header">
        <h1> Van Daily Performance Report</h1>
        <p>${N.name} ${N.plateNumber?"("+N.plateNumber+")":""} | Date: ${_} | Generated: ${new Date().toLocaleString()}</p>
      </div>
      
      <div class="van-info">
        <div class="item"><div class="label">Driver</div><div class="value">${N.assignedDriverName||"Not Assigned"}</div></div>
        <div class="item"><div class="label">Warehouse</div><div class="value">${N.warehouseName||"Not Assigned"}</div></div>
        <div class="item"><div class="label">Current Cash</div><div class="value">$${N.currentCash.toFixed(3)}</div></div>
        <div class="item"><div class="label">Status</div><div class="value">${N.status}</div></div>
      </div>
      
      <div class="summary">
        <div class="summary-card"><div class="label">Total Sales</div><div class="value blue">$${ue.toFixed(3)}</div></div>
        <div class="summary-card"><div class="label">Cash Received</div><div class="value green">$${Le.toFixed(3)}</div></div>
        <div class="summary-card"><div class="label">Credit Given</div><div class="value red">$${Je.toFixed(3)}</div></div>
        <div class="summary-card"><div class="label">Debt Collected</div><div class="value purple">$${Xe.toFixed(3)}</div></div>
        <div class="summary-card"><div class="label">Tasks Done</div><div class="value">${le}/${E.tasks.length}</div></div>
      </div>
      
      <div class="section">
        <h2> Inventory & Sales Summary</h2>
        ${(()=>{const ee=new Map;E.todayLoads.forEach(xe=>ee.set(xe.productName,(ee.get(xe.productName)||0)+xe.quantity));const ve=new Map;return E.stock.forEach(xe=>ve.set(xe.productName,{sku:xe.productSku,stock:xe.quantity,loaded:ee.get(xe.productName)||0,soldQty:0,soldTotal:0})),Me.forEach((xe,oe)=>{const Ie=ve.get(oe)||{sku:"-",stock:0,loaded:ee.get(oe)||0,soldQty:0,soldTotal:0};Ie.soldQty=xe.qty,Ie.soldTotal=xe.total,ve.set(oe,Ie)}),ee.forEach((xe,oe)=>{ve.has(oe)||ve.set(oe,{sku:"-",stock:0,loaded:xe,soldQty:0,soldTotal:0})}),ve.size===0?'<p style="color:#666;padding:10px;">No inventory data</p>':'<table><thead><tr><th>Product</th><th>SKU</th><th class="text-right" style="color:#9333ea;">Loaded</th><th class="text-right" style="color:#22c55e;">In Stock</th><th class="text-right" style="color:#3b82f6;">Sold</th><th class="text-right">Sales $</th></tr></thead><tbody>'+Array.from(ve.entries()).map(([xe,oe])=>"<tr><td>"+xe+"</td><td>"+oe.sku+'</td><td class="text-right">'+(oe.loaded>0?oe.loaded:"-")+'</td><td class="text-right">'+oe.stock+'</td><td class="text-right">'+(oe.soldQty>0?oe.soldQty:"-")+'</td><td class="text-right">'+(oe.soldTotal>0?"$"+oe.soldTotal.toFixed(3):"-")+"</td></tr>").join("")+"</tbody></table>"})()}
      </div>
      
      <div class="section">
        <h2> Tasks (${E.tasks.length})</h2>
        ${E.tasks.length>0?`<table><thead><tr><th>Task #</th><th>Customer</th><th class="text-right">Total</th><th class="text-right">Paid</th><th class="text-right">Debt</th><th class="text-center">Status</th></tr></thead><tbody>
          ${E.tasks.map(ee=>`<tr><td>${ee.taskNumber}</td><td>${ee.customerName}</td><td class="text-right">$${ee.total.toFixed(3)}</td><td class="text-right">$${ee.paidAmount.toFixed(3)}</td><td class="text-right ${ee.debtAmount>0?"text-red":""}">$${ee.debtAmount.toFixed(3)}</td><td class="text-center"><span class="badge ${ee.status==="Completed"?"badge-green":"badge-blue"}">${ee.status}</span></td></tr>`).join("")}
        </tbody></table>`:'<p style="color:#666;padding:10px;">No tasks today</p>'}
      </div>
      
      <div class="section">
        <h2> Debt Collections (${E.collections.length})</h2>
        ${E.collections.length>0?`<table><thead><tr><th>Collection #</th><th>Customer</th><th class="text-right">Amount</th><th class="text-center">Payment</th></tr></thead><tbody>
          ${E.collections.map(ee=>`<tr><td>${ee.collectionNumber}</td><td>${ee.customerName}</td><td class="text-right">$${ee.amount.toFixed(3)}</td><td class="text-center">${ee.paymentType}</td></tr>`).join("")}
        </tbody></table>`:'<p style="color:#666;padding:10px;">No collections today</p>'}
      </div>
      
      <div class="footer">Catalyst Performance Report - Confidential</div>
      </body></html>
    `),ut.document.close(),ut.onload=()=>{ut.focus(),ut.print()}};return l?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx(vt,{className:"animate-spin",size:32})}):a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Vans"}),a.jsx(qr,{permission:Ve.CREATE_VANS,children:a.jsxs("button",{onClick:()=>{ct(),h(!0)},className:"flex items-center gap-2 px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600",children:[a.jsx(hr,{size:20})," Add Van"]})})]}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[900px]",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Name"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Plate Number"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Driver"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Warehouse"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Max Cash"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Current Cash"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Status"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:e.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:8,className:"px-4 py-8 text-center text-gray-500",children:"No vans found"})}):e.map(ue=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 font-medium",children:ue.name}),a.jsx("td",{className:"px-4 py-3 text-gray-500",children:ue.plateNumber||"-"}),a.jsx("td",{className:"px-4 py-3",children:ue.assignedDriverName||"-"}),a.jsx("td",{className:"px-4 py-3",children:ue.warehouseName||"-"}),a.jsxs("td",{className:"px-4 py-3",children:["$",ue.maxCash.toLocaleString()]}),a.jsxs("td",{className:"px-4 py-3 font-medium",children:["$",ue.currentCash.toLocaleString()]}),a.jsx("td",{className:"px-4 py-3",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${pr(ue.status)}`,children:ue.status.replace("_"," ")})}),a.jsx("td",{className:"px-4 py-3",children:a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:()=>Zt(ue),className:"p-1 text-orange-600 hover:bg-orange-50 rounded",title:"Today's Performance",children:a.jsx(qi,{size:16})}),a.jsxs(qr,{permission:Ve.VIEW_VAN_STOCK,children:[a.jsx("button",{onClick:()=>it(ue),className:"p-1 text-green-600 hover:bg-green-50 rounded",title:"Van Stock",children:a.jsx(Tr,{size:16})}),a.jsx("button",{onClick:()=>we(ue),className:"p-1 text-cyan-600 hover:bg-cyan-50 rounded",title:"Transfer Log",children:a.jsx(sp,{size:16})})]}),a.jsx(qr,{permission:Ve.EDIT_VANS,children:a.jsx("button",{onClick:()=>We(ue),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",title:"Edit",children:a.jsx(js,{size:16})})}),a.jsx(qr,{permission:Ve.DELETE_VANS,children:a.jsx("button",{onClick:()=>Ee(ue.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Delete",children:a.jsx(xr,{size:16})})})]})})]},ue.id))})]})}),(d||f)&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-2xl",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-[#003366] text-white rounded-t-xl",children:[a.jsx("h2",{className:"text-lg font-semibold",children:f?"Edit Van":"Add Van"}),a.jsx("button",{onClick:()=>{h(!1),x(!1)},children:a.jsx(yt,{size:24})})]}),a.jsxs("form",{onSubmit:f?Bt:$e,className:"p-6 space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Van Name *"}),a.jsx("input",{type:"text",required:!0,value:D.name,onChange:ue=>ze({...D,name:ue.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"Enter van name"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Plate Number"}),a.jsx("input",{type:"text",value:D.plateNumber,onChange:ue=>ze({...D,plateNumber:ue.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"Enter plate number"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Assigned Driver"}),a.jsxs("select",{value:D.assignedDriverId,onChange:ue=>{var Xe;const Le=ue.target.value,Je=n.find(le=>le.id.toString()===Le);ze({...D,assignedDriverId:Le,warehouseId:((Xe=Je==null?void 0:Je.warehouseId)==null?void 0:Xe.toString())||D.warehouseId})},className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[a.jsx("option",{value:"",children:"None"}),n.map(ue=>a.jsx("option",{value:ue.id,children:ue.name},ue.id))]})]})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Warehouse"}),a.jsxs("select",{value:D.warehouseId,onChange:ue=>ze({...D,warehouseId:ue.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[a.jsx("option",{value:"",children:"None"}),r.map(ue=>a.jsx("option",{value:ue.id,children:ue.name},ue.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Max Cash Capacity"}),a.jsx("input",{type:"number",value:D.maxCash,onChange:ue=>ze({...D,maxCash:parseFloat(ue.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"Enter max cash"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),a.jsxs("select",{value:D.status,onChange:ue=>ze({...D,status:ue.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[a.jsx("option",{value:"active",children:"Available"}),a.jsx("option",{value:"on_duty",children:"On Duty"}),a.jsx("option",{value:"maintenance",children:"Maintenance"})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),a.jsx("textarea",{value:D.notes,onChange:ue=>ze({...D,notes:ue.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",rows:2,placeholder:"Enter notes"})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>{h(!1),x(!1)},className:"flex-1 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:c,className:"flex-1 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 disabled:opacity-50",children:c?"Saving...":"Save"})]})]})]})}),p&&N&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-3xl max-h-[90vh] overflow-hidden",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-green-600 text-white",children:[a.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[a.jsx(Tr,{size:20})," Van Stock  ",N.name]}),a.jsx("button",{onClick:()=>g(!1),children:a.jsx(yt,{size:24})})]}),a.jsxs("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-80px)]",children:[ge?a.jsx("div",{className:"flex items-center justify-center py-12",children:a.jsx(vt,{className:"animate-spin",size:32})}):ne.length===0?a.jsxs("div",{className:"text-center py-12 text-gray-500",children:[a.jsx(Tr,{size:48,className:"mx-auto mb-3 opacity-50"}),a.jsx("p",{children:"No stock in this van"}),a.jsx("p",{className:"text-sm",children:"Load stock from warehouse to get started"})]}):a.jsx("div",{className:"border rounded-lg overflow-hidden",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600",children:"Product"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600",children:"SKU"}),a.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-gray-600",children:"Quantity"}),a.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-gray-600",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y",children:ne.map(ue=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 font-medium",children:ue.productName}),a.jsx("td",{className:"px-4 py-3 text-gray-500",children:ue.productSku}),a.jsx("td",{className:"px-4 py-3 text-right font-medium text-green-600",children:ue.quantity}),a.jsx("td",{className:"px-4 py-3 text-center",children:a.jsxs("button",{onClick:()=>Nt(ue.productId,ue.quantity),className:"px-3 py-1 text-sm text-orange-600 hover:bg-orange-50 rounded border border-orange-200",disabled:A,children:[a.jsx(XU,{size:14,className:"inline mr-1"})," Unload"]})})]},ue.productId))})]})}),a.jsxs("div",{className:"flex justify-between pt-4 mt-4 border-t",children:[a.jsxs("button",{onClick:()=>et(N),className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 flex items-center gap-2",children:[a.jsx(ZC,{size:16})," Load Stock"]}),a.jsx("button",{onClick:()=>g(!1),className:"px-6 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Close"})]})]})]})}),y&&N&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-4xl max-h-[90vh] overflow-hidden",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-cyan-600 text-white",children:[a.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[a.jsx(sp,{size:20})," Transfer Log  ",N.name]}),a.jsx("button",{onClick:()=>v(!1),children:a.jsx(yt,{size:24})})]}),a.jsxs("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-80px)]",children:[B?a.jsx("div",{className:"flex items-center justify-center py-12",children:a.jsx(vt,{className:"animate-spin",size:32})}):Q.length===0?a.jsxs("div",{className:"text-center py-12 text-gray-500",children:[a.jsx(sp,{size:48,className:"mx-auto mb-3 opacity-50"}),a.jsx("p",{children:"No transfer history"})]}):a.jsx("div",{className:"border rounded-lg overflow-hidden",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600",children:"Date"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600",children:"Type"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600",children:"Product"}),a.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-gray-600",children:"Quantity"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600",children:"Warehouse"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600",children:"Notes"})]})}),a.jsx("tbody",{className:"divide-y",children:Q.map(ue=>{const Le=Rt(ue.movementType);return a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 text-sm",children:new Date(ue.createdAt).toLocaleString()}),a.jsx("td",{className:"px-4 py-3",children:a.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${Le.bg} ${Le.text}`,children:Le.label})}),a.jsxs("td",{className:"px-4 py-3",children:[a.jsx("div",{className:"font-medium",children:ue.productName}),a.jsx("div",{className:"text-xs text-gray-500",children:ue.productSku})]}),a.jsx("td",{className:"px-4 py-3 text-right font-medium",children:ue.quantity}),a.jsx("td",{className:"px-4 py-3 text-gray-500",children:ue.warehouseName||"-"}),a.jsx("td",{className:"px-4 py-3 text-gray-500 text-sm",children:ue.notes||"-"})]},ue.id)})})]})}),a.jsx("div",{className:"flex justify-end pt-4 mt-4 border-t",children:a.jsx("button",{onClick:()=>v(!1),className:"px-6 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Close"})})]})]})}),j&&N&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-lg",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-purple-600 text-white rounded-t-xl",children:[a.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[a.jsx(ZC,{size:20})," Load Stock  ",N.name]}),a.jsx("button",{onClick:()=>b(!1),children:a.jsx(yt,{size:24})})]}),a.jsxs("div",{className:"p-6 space-y-4",children:[N.warehouseId?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg text-sm",children:[a.jsx("span",{className:"font-medium",children:"Loading from:"})," ",N.warehouseName]}),a.jsxs("div",{className:"relative",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Product *"}),a.jsxs("div",{className:"relative",children:[a.jsx(Na,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),a.jsx("input",{type:"text",value:F,onChange:ue=>{he(ue.target.value),z(!0),Z({...L,productId:""})},onFocus:()=>z(!0),placeholder:"Search product...",className:`w-full pl-10 pr-3 py-2 border rounded-lg ${L.productId?"border-green-500 bg-green-50":"border-gray-300"}`})]}),ye&&F&&a.jsxs("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-48 overflow-y-auto",children:[K.filter(ue=>ue.name.toLowerCase().includes(F.toLowerCase())||ue.sku.toLowerCase().includes(F.toLowerCase())||ue.barcode&&ue.barcode.includes(F)).slice(0,10).map(ue=>a.jsxs("div",{onClick:()=>{Z({...L,productId:ue.id.toString()}),he(`${ue.name} (${ue.sku})`),z(!1)},className:"px-3 py-2 hover:bg-purple-50 cursor-pointer border-b last:border-b-0",children:[a.jsx("div",{className:"font-medium",children:ue.name}),a.jsxs("div",{className:"text-xs text-gray-500",children:["SKU: ",ue.sku]})]},ue.id)),K.filter(ue=>ue.name.toLowerCase().includes(F.toLowerCase())||ue.sku.toLowerCase().includes(F.toLowerCase())).length===0&&a.jsx("div",{className:"px-3 py-4 text-center text-gray-500",children:"No products found"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Quantity *"}),a.jsx("input",{type:"number",min:"1",value:L.quantity||"",onChange:ue=>Z({...L,quantity:parseFloat(ue.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"Enter quantity"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),a.jsx("input",{type:"text",value:L.notes,onChange:ue=>Z({...L,notes:ue.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"Optional notes"})]})]}):a.jsxs("div",{className:"text-center py-8 text-orange-600 bg-orange-50 rounded-lg",children:[a.jsx(gl,{size:48,className:"mx-auto mb-3 opacity-50"}),a.jsx("p",{className:"font-medium",children:"Van not assigned to warehouse"}),a.jsx("p",{className:"text-sm",children:"Please assign this van to a warehouse first"})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsx("button",{onClick:()=>b(!1),className:"flex-1 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),N.warehouseId&&a.jsx("button",{onClick:Ge,disabled:!L.productId||L.quantity<=0||A,className:"flex-1 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50",children:A?"Loading...":"Load Stock"})]})]})]})}),w&&N&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-5xl max-h-[95vh] overflow-hidden",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-orange-600 text-white",children:[a.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[a.jsx(qi,{size:20})," Daily Performance  ",N.name]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("div",{className:"flex items-center gap-2 bg-white/20 rounded-lg px-3 py-1",children:[a.jsx(ro,{size:16}),a.jsx("input",{type:"date",value:_,onChange:ue=>{O(ue.target.value),Zt(N,ue.target.value)},className:"bg-transparent text-white text-sm border-none outline-none"})]}),a.jsxs("button",{onClick:er,className:"flex items-center gap-1 px-3 py-1 bg-white/20 rounded-lg hover:bg-white/30",children:[a.jsx(ua,{size:16})," Print"]}),a.jsx("button",{onClick:()=>k(!1),children:a.jsx(yt,{size:24})})]})]}),a.jsx("div",{className:"p-4 overflow-y-auto max-h-[calc(95vh-70px)]",children:C?a.jsx("div",{className:"flex items-center justify-center py-16",children:a.jsx(vt,{className:"animate-spin",size:40})}):E?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 mb-4 flex flex-wrap gap-6 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Driver:"})," ",a.jsx("strong",{children:N.assignedDriverName||"Not Assigned"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Warehouse:"})," ",a.jsx("strong",{children:N.warehouseName||"-"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Cash in Van:"})," ",a.jsxs("strong",{className:"text-green-600",children:["$",N.currentCash.toFixed(3)]})]})]}),a.jsxs("div",{className:"grid grid-cols-5 gap-3 mb-4",children:[a.jsxs("div",{className:"bg-blue-50 rounded-lg p-3 text-center",children:[a.jsx("div",{className:"text-xs text-blue-600 font-medium",children:"Total Sales"}),a.jsxs("div",{className:"text-xl font-bold text-blue-700",children:["$",(E.tasks.filter(ue=>ue.status==="Completed").reduce((ue,Le)=>ue+Le.total,0)+E.orders.reduce((ue,Le)=>ue+Le.totalAmount,0)).toFixed(3)]})]}),a.jsxs("div",{className:"bg-green-50 rounded-lg p-3 text-center",children:[a.jsx("div",{className:"text-xs text-green-600 font-medium",children:"Cash Received"}),a.jsxs("div",{className:"text-xl font-bold text-green-700",children:["$",(E.tasks.filter(ue=>ue.status==="Completed").reduce((ue,Le)=>ue+Le.paidAmount,0)+E.orders.reduce((ue,Le)=>ue+Le.paidAmount,0)).toFixed(3)]})]}),a.jsxs("div",{className:"bg-red-50 rounded-lg p-3 text-center",children:[a.jsx("div",{className:"text-xs text-red-600 font-medium",children:"Credit Given"}),a.jsxs("div",{className:"text-xl font-bold text-red-700",children:["$",E.tasks.filter(ue=>ue.status==="Completed").reduce((ue,Le)=>ue+Le.debtAmount,0).toFixed(3)]})]}),a.jsxs("div",{className:"bg-purple-50 rounded-lg p-3 text-center",children:[a.jsx("div",{className:"text-xs text-purple-600 font-medium",children:"Debt Collected"}),a.jsxs("div",{className:"text-xl font-bold text-purple-700",children:["$",E.collections.reduce((ue,Le)=>ue+Le.amount,0).toFixed(3)]})]}),a.jsxs("div",{className:"bg-gray-100 rounded-lg p-3 text-center",children:[a.jsx("div",{className:"text-xs text-gray-600 font-medium",children:"Tasks Done"}),a.jsxs("div",{className:"text-xl font-bold text-gray-700",children:[E.tasks.filter(ue=>ue.status==="Completed").length,"/",E.tasks.length]})]})]}),a.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[a.jsxs("div",{className:"bg-gray-100 px-3 py-2 font-semibold text-sm flex items-center gap-2",children:[a.jsx(Tr,{size:16,className:"text-green-600"})," Inventory & Sales Summary"]}),a.jsx("div",{className:"max-h-56 overflow-y-auto",children:(()=>{const ue=new Map;E.tasks.filter(Xe=>Xe.status==="Completed").forEach(Xe=>Xe.items.forEach(le=>{const Me=ue.get(le.productName)||{qty:0,total:0};Me.qty+=le.quantity,Me.total+=le.total,ue.set(le.productName,Me)})),E.orders.forEach(Xe=>Xe.items.forEach(le=>{const Me=ue.get(le.productName)||{qty:0,total:0};Me.qty+=le.quantity,Me.total+=le.total,ue.set(le.productName,Me)}));const Le=new Map;E.todayLoads.forEach(Xe=>Le.set(Xe.productName,(Le.get(Xe.productName)||0)+Xe.quantity));const Je=new Map;return E.stock.forEach(Xe=>Je.set(Xe.productName,{stock:Xe.quantity,loaded:Le.get(Xe.productName)||0,soldQty:0,soldTotal:0})),ue.forEach((Xe,le)=>{const Me=Je.get(le)||{stock:0,loaded:Le.get(le)||0,soldQty:0,soldTotal:0};Me.soldQty=Xe.qty,Me.soldTotal=Xe.total,Je.set(le,Me)}),Le.forEach((Xe,le)=>{Je.has(le)||Je.set(le,{stock:0,loaded:Xe,soldQty:0,soldTotal:0})}),Je.size===0?a.jsx("div",{className:"p-4 text-center text-gray-500 text-sm",children:"No inventory data"}):a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50 sticky top-0",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-2 text-left",children:"Product"}),a.jsx("th",{className:"px-3 py-2 text-right text-purple-600",children:"Loaded"}),a.jsx("th",{className:"px-3 py-2 text-right text-green-600",children:"In Stock"}),a.jsx("th",{className:"px-3 py-2 text-right text-blue-600",children:"Sold"}),a.jsx("th",{className:"px-3 py-2 text-right text-emerald-600",children:"Sales $"})]})}),a.jsx("tbody",{className:"divide-y",children:Array.from(Je.entries()).map(([Xe,le])=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-3 py-2 font-medium",children:Xe}),a.jsx("td",{className:"px-3 py-2 text-right text-purple-700 font-medium",children:le.loaded>0?le.loaded:"-"}),a.jsx("td",{className:"px-3 py-2 text-right text-green-700 font-medium",children:le.stock}),a.jsx("td",{className:"px-3 py-2 text-right text-blue-700 font-medium",children:le.soldQty>0?le.soldQty:"-"}),a.jsx("td",{className:"px-3 py-2 text-right text-emerald-600 font-medium",children:le.soldTotal>0?`$${le.soldTotal.toFixed(3)}`:"-"})]},Xe))})]})})()})]}),a.jsxs("div",{className:"border rounded-lg overflow-hidden mt-4",children:[a.jsxs("div",{className:"bg-gray-100 px-3 py-2 font-semibold text-sm flex items-center gap-2",children:[a.jsx(so,{size:16,className:"text-indigo-600"})," Sales by Customer"]}),a.jsx("div",{className:"max-h-56 overflow-y-auto",children:(()=>{const ue=new Map;E.tasks.filter(Je=>Je.status==="Completed").forEach(Je=>{Je.items.forEach(Xe=>{const le=`${Je.customerName}|||${Xe.productName}`,Me=ue.get(le);Me?(Me.qty+=Xe.quantity,Me.total+=Xe.total):ue.set(le,{customer:Je.customerName,product:Xe.productName,qty:Xe.quantity,total:Xe.total})})}),E.orders.forEach(Je=>{Je.items.forEach(Xe=>{const le=`${Je.customerName}|||${Xe.productName}`,Me=ue.get(le);Me?(Me.qty+=Xe.quantity,Me.total+=Xe.total):ue.set(le,{customer:Je.customerName,product:Xe.productName,qty:Xe.quantity,total:Xe.total})})});const Le=Array.from(ue.values());return Le.length===0?a.jsx("div",{className:"p-4 text-center text-gray-500 text-sm",children:"No customer sales"}):a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50 sticky top-0",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-2 text-left",children:"Customer"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Product"}),a.jsx("th",{className:"px-3 py-2 text-right",children:"Qty"}),a.jsx("th",{className:"px-3 py-2 text-right",children:"Total"})]})}),a.jsx("tbody",{className:"divide-y",children:Le.map((Je,Xe)=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-3 py-2 font-medium",children:Je.customer}),a.jsx("td",{className:"px-3 py-2",children:Je.product}),a.jsx("td",{className:"px-3 py-2 text-right",children:Je.qty}),a.jsxs("td",{className:"px-3 py-2 text-right text-green-600 font-medium",children:["$",Je.total.toFixed(3)]})]},Xe))})]})})()})]}),a.jsxs("div",{className:"border rounded-lg overflow-hidden mt-4",children:[a.jsxs("div",{className:"bg-gray-100 px-3 py-2 font-semibold text-sm flex items-center gap-2",children:[a.jsx(o0,{size:16,className:"text-emerald-600"})," Tasks (",E.tasks.length,")"]}),a.jsx("div",{className:"max-h-52 overflow-y-auto",children:E.tasks.length===0?a.jsx("div",{className:"p-4 text-center text-gray-500 text-sm",children:"No tasks"}):a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50 sticky top-0",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-2 text-left",children:"Task #"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Customer"}),a.jsx("th",{className:"px-3 py-2 text-right",children:"Total"}),a.jsx("th",{className:"px-3 py-2 text-right",children:"Paid"}),a.jsx("th",{className:"px-3 py-2 text-right",children:"Debt"}),a.jsx("th",{className:"px-3 py-2 text-center",children:"Status"})]})}),a.jsx("tbody",{className:"divide-y",children:E.tasks.map(ue=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-3 py-2 font-medium",children:ue.taskNumber}),a.jsx("td",{className:"px-3 py-2",children:ue.customerName}),a.jsxs("td",{className:"px-3 py-2 text-right",children:["$",ue.total.toFixed(3)]}),a.jsxs("td",{className:"px-3 py-2 text-right text-green-600",children:["$",ue.paidAmount.toFixed(3)]}),a.jsx("td",{className:"px-3 py-2 text-right text-red-600",children:ue.debtAmount>0?`$${ue.debtAmount.toFixed(3)}`:"-"}),a.jsx("td",{className:"px-3 py-2 text-center",children:a.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${ue.status==="Completed"?"bg-green-100 text-green-700":"bg-blue-100 text-blue-700"}`,children:ue.status})})]},ue.id))})]})})]}),a.jsxs("div",{className:"border rounded-lg overflow-hidden mt-4",children:[a.jsxs("div",{className:"bg-gray-100 px-3 py-2 font-semibold text-sm flex items-center gap-2",children:[a.jsx(da,{size:16,className:"text-purple-600"})," Debt Collections (",E.collections.length,")"]}),a.jsx("div",{className:"max-h-40 overflow-y-auto",children:E.collections.length===0?a.jsx("div",{className:"p-4 text-center text-gray-500 text-sm",children:"No collections"}):a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50 sticky top-0",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-2 text-left",children:"Collection #"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Customer"}),a.jsx("th",{className:"px-3 py-2 text-right",children:"Amount"}),a.jsx("th",{className:"px-3 py-2 text-center",children:"Payment"})]})}),a.jsx("tbody",{className:"divide-y",children:E.collections.map(ue=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-3 py-2 font-medium",children:ue.collectionNumber}),a.jsx("td",{className:"px-3 py-2",children:ue.customerName}),a.jsxs("td",{className:"px-3 py-2 text-right text-purple-600 font-medium",children:["$",ue.amount.toFixed(3)]}),a.jsx("td",{className:"px-3 py-2 text-center",children:ue.paymentType})]},ue.id))})]})})]})]}):null})]})})]})}function ave(){const[e,t]=m.useState([]),[r,s]=m.useState(!0),[n,i]=m.useState(!1),[l,o]=m.useState(null),[c,u]=m.useState(new Date().toISOString().split("T")[0]),[d,h]=m.useState(null),[f,x]=m.useState(!1),[p,g]=m.useState([]),[y,v]=m.useState(new Date().toISOString().split("T")[0]),[j,b]=m.useState(""),[w,k]=m.useState(""),[N,S]=m.useState(!1),[_,O]=m.useState([]),[E,R]=m.useState(!1),[C,I]=m.useState(!1),[ne,W]=m.useState({salesmanId:"",customerId:"",scheduledDate:new Date().toISOString().split("T")[0],notes:""}),[Q,H]=m.useState("");m.useEffect(()=>{K()},[]);const K=async()=>{try{s(!0);const[z,A]=await Promise.all([JC.getAll(),qc.getAll()]);t(z.data),g(A.data.filter(de=>de.type==="Customer Visit"))}catch(z){console.error("Failed to load data:",z)}finally{s(!1)}},q=async(z,A)=>{o(z),i(!0),x(!0);const de=A||c;try{const D=await JC.getPerformance(z.id,de);h(D.data)}catch(D){console.error("Failed to load performance:",D),h(null)}finally{x(!1)}},ge=z=>{u(z),l&&q(l,z)},G=()=>{window.print()},B=async z=>{if(S(!0),W({salesmanId:(z==null?void 0:z.id.toString())||"",customerId:"",scheduledDate:new Date().toISOString().split("T")[0],notes:""}),H(""),_.length===0){R(!0);try{const A=await Ha.getAll();O(A.data.map(de=>({id:de.id,name:de.name,phone:de.phone,address:de.address})))}catch(A){console.error("Failed to load customers:",A)}finally{R(!1)}}},se=async z=>{var A,de;if(z.preventDefault(),!ne.salesmanId||!ne.customerId){alert("Please select a salesman and customer");return}I(!0);try{await qc.create({type:"Customer Visit",customerId:parseInt(ne.customerId),salesmanId:parseInt(ne.salesmanId),scheduledDate:ne.scheduledDate,notes:ne.notes||"Visit task assigned by company",items:[]}),S(!1),await K(),alert("Visit task created successfully!")}catch(D){alert(((de=(A=D.response)==null?void 0:A.data)==null?void 0:de.message)||"Failed to create visit task")}finally{I(!1)}},L=async z=>{var A,de;if(confirm("Are you sure you want to delete this visit task?"))try{await qc.delete(z),await K()}catch(D){alert(((de=(A=D.response)==null?void 0:A.data)==null?void 0:de.message)||"Failed to delete task")}},Z=p.filter(z=>{var A;return!(y&&!z.scheduledDate.startsWith(y)||j&&z.status!==j||w&&((A=z.salesmanId)==null?void 0:A.toString())!==w)}),F=z=>({Pending:"bg-yellow-100 text-yellow-700",Completed:"bg-green-100 text-green-700",Cancelled:"bg-red-100 text-red-700"})[z]||"bg-gray-100 text-gray-700",he=_.filter(z=>z.name.toLowerCase().includes(Q.toLowerCase())||z.phone&&z.phone.includes(Q)),ye=z=>new Date(z).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"});return r?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx(vt,{className:"w-8 h-8 animate-spin text-blue-600"})}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Salesmen"}),a.jsxs("p",{className:"text-gray-600",children:[e.length," active salesmen"]})]}),a.jsxs("button",{onClick:()=>B(),className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition",children:[a.jsx(hr,{className:"w-5 h-5"}),"Assign Visit Task"]})]}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4",children:[a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 border border-gray-100",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:a.jsx(so,{className:"w-5 h-5 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Salesmen"}),a.jsx("p",{className:"text-xl font-bold text-gray-900",children:e.length})]})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 border border-gray-100",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:a.jsx(a4,{className:"w-5 h-5 text-green-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Leads Today"}),a.jsx("p",{className:"text-xl font-bold text-gray-900",children:e.reduce((z,A)=>z+A.leadsToday,0)})]})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 border border-gray-100",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:a.jsx(Ed,{className:"w-5 h-5 text-purple-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Customers Today"}),a.jsx("p",{className:"text-xl font-bold text-gray-900",children:e.reduce((z,A)=>z+A.customersToday,0)})]})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 border border-gray-100",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-2 bg-indigo-100 rounded-lg",children:a.jsx(r4,{className:"w-5 h-5 text-indigo-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Tasks Today"}),a.jsx("p",{className:"text-xl font-bold text-gray-900",children:e.reduce((z,A)=>z+A.tasksToday,0)})]})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 border border-gray-100",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-2 bg-emerald-100 rounded-lg",children:a.jsx(da,{className:"w-5 h-5 text-emerald-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Sales Today"}),a.jsxs("p",{className:"text-xl font-bold text-gray-900",children:["$",e.reduce((z,A)=>z+A.tasksSalesToday,0).toFixed(2)]})]})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 border border-gray-100",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-2 bg-orange-100 rounded-lg",children:a.jsx(vW,{className:"w-5 h-5 text-orange-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Commission Today"}),a.jsxs("p",{className:"text-xl font-bold text-gray-900",children:["$",e.reduce((z,A)=>z+A.commissionToday,0).toFixed(2)]})]})]})})]}),e.length===0?a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-12 text-center",children:[a.jsx(so,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Salesmen Found"}),a.jsx("p",{className:"text-gray-500",children:'Create employees with the "Salesman" role to see them here.'})]}):a.jsx("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Salesman"}),a.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Rate"}),a.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Leads"}),a.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Customers"}),a.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Tasks"}),a.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Sales Today"}),a.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Commission Today"}),a.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Total Commission"}),a.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(z=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:a.jsx("span",{className:"text-blue-600 font-semibold",children:z.name.charAt(0).toUpperCase()})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-900",children:z.name}),a.jsx("p",{className:"text-sm text-gray-500",children:z.phone||"-"})]})]})}),a.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-center",children:a.jsxs("span",{className:"px-2 py-1 bg-orange-100 text-orange-700 rounded text-sm font-medium",children:[z.commissionRate,"%"]})}),a.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-center",children:a.jsxs("div",{className:"flex flex-col",children:[a.jsxs("span",{className:`inline-flex px-2 py-0.5 rounded text-xs font-medium ${z.leadsToday>0?"bg-green-100 text-green-700":"bg-gray-100 text-gray-500"}`,children:[z.leadsToday," today"]}),a.jsxs("span",{className:"text-xs text-gray-500 mt-1",children:[z.totalLeads," total"]})]})}),a.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-center",children:a.jsxs("div",{className:"flex flex-col",children:[a.jsxs("span",{className:`inline-flex px-2 py-0.5 rounded text-xs font-medium ${z.customersToday>0?"bg-purple-100 text-purple-700":"bg-gray-100 text-gray-500"}`,children:[z.customersToday," today"]}),a.jsxs("span",{className:"text-xs text-gray-500 mt-1",children:[z.totalCustomers," total"]})]})}),a.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-center",children:a.jsx("span",{className:`inline-flex px-2 py-1 rounded text-sm font-medium ${z.tasksToday>0?"bg-indigo-100 text-indigo-700":"bg-gray-100 text-gray-500"}`,children:z.tasksToday})}),a.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-right",children:a.jsxs("span",{className:"text-gray-900 font-medium",children:["$",z.tasksSalesToday.toFixed(2)]})}),a.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-right",children:a.jsxs("span",{className:"text-emerald-600 font-semibold",children:["$",z.commissionToday.toFixed(2)]})}),a.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-right",children:a.jsxs("span",{className:"text-orange-600 font-semibold",children:["$",z.totalCommission.toFixed(2)]})}),a.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-center",children:a.jsxs("div",{className:"flex items-center justify-center gap-2",children:[a.jsxs("button",{onClick:()=>B(z),className:"inline-flex items-center gap-1 px-3 py-1.5 bg-indigo-50 text-indigo-600 rounded-lg hover:bg-indigo-100 transition",title:"Assign Visit Task",children:[a.jsx(dc,{className:"w-4 h-4"}),a.jsx("span",{children:"Visit"})]}),a.jsxs("button",{onClick:()=>q(z),className:"inline-flex items-center gap-1 px-3 py-1.5 bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100 transition",children:[a.jsx(qi,{className:"w-4 h-4"}),a.jsx("span",{children:"Details"})]})]})})]},z.id))})]})}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden",children:[a.jsxs("div",{className:"p-4 border-b bg-indigo-50",children:[a.jsx("div",{className:"flex items-center justify-between mb-3",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(dc,{className:"w-5 h-5 text-indigo-600"}),a.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"Visit Tasks"}),a.jsxs("span",{className:"text-sm text-gray-500",children:["(",Z.length," tasks)"]})]})}),a.jsxs("div",{className:"flex flex-wrap gap-3",children:[a.jsx("input",{type:"date",value:y,onChange:z=>v(z.target.value),className:"px-3 py-1.5 border border-gray-300 rounded-lg text-sm"}),a.jsxs("select",{value:w,onChange:z=>k(z.target.value),className:"px-3 py-1.5 border border-gray-300 rounded-lg text-sm",children:[a.jsx("option",{value:"",children:"All Salesmen"}),e.map(z=>a.jsx("option",{value:z.id,children:z.name},z.id))]}),a.jsxs("select",{value:j,onChange:z=>b(z.target.value),className:"px-3 py-1.5 border border-gray-300 rounded-lg text-sm",children:[a.jsx("option",{value:"",children:"All Status"}),a.jsx("option",{value:"Pending",children:"Pending"}),a.jsx("option",{value:"Completed",children:"Completed"}),a.jsx("option",{value:"Cancelled",children:"Cancelled"})]}),a.jsx("button",{onClick:()=>{v(""),b(""),k("")},className:"px-3 py-1.5 text-sm text-gray-500 hover:text-gray-700",children:"Clear filters"})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Task #"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Salesman"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Customer"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Scheduled"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Status"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Notes"}),a.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-gray-600 uppercase",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:Z.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"px-4 py-8 text-center text-gray-500",children:"No visit tasks found"})}):Z.map(z=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsxs("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:["#",z.taskNumber]}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:z.salesmanName||"-"}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:z.customerName||"-"}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:z.scheduledDate.split("T")[0]}),a.jsx("td",{className:"px-4 py-3",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${F(z.status)}`,children:z.status==="Completed"?" Visited":z.status})}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-500 max-w-[200px] truncate",children:z.notes||"-"}),a.jsx("td",{className:"px-4 py-3 text-center",children:a.jsx("button",{onClick:()=>L(z.id),className:"p-1.5 text-red-600 hover:bg-red-50 rounded-lg",title:"Delete",children:a.jsx(xr,{className:"w-4 h-4"})})})]},z.id))})]})})]}),n&&l&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col print:max-w-none print:max-h-none print:rounded-none",children:[a.jsxs("div",{className:"flex justify-between items-center p-6 border-b print:hidden",children:[a.jsxs("div",{children:[a.jsxs("h2",{className:"text-xl font-bold text-gray-900",children:[l.name," - Daily Performance"]}),a.jsx("p",{className:"text-gray-500",children:"View leads and customers captured"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:G,className:"p-2 hover:bg-gray-100 rounded-lg",title:"Print",children:a.jsx(ua,{className:"w-5 h-5 text-gray-600"})}),a.jsx("button",{onClick:()=>i(!1),className:"p-2 hover:bg-gray-100 rounded-lg",children:a.jsx(yt,{className:"w-5 h-5 text-gray-600"})})]})]}),a.jsxs("div",{className:"hidden print:block p-6 border-b",children:[a.jsxs("h1",{className:"text-2xl font-bold",children:[l.name," - Daily Performance Report"]}),a.jsxs("p",{className:"text-gray-600",children:["Date: ",c]})]}),a.jsxs("div",{className:"p-4 bg-gray-50 border-b flex items-center gap-4 print:hidden",children:[a.jsx(ro,{className:"w-5 h-5 text-gray-500"}),a.jsx("input",{type:"date",value:c,onChange:z=>ge(z.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg"})]}),a.jsx("div",{className:"flex-1 overflow-y-auto p-6 print:overflow-visible",children:f?a.jsx("div",{className:"flex items-center justify-center py-12",children:a.jsx(vt,{className:"w-8 h-8 animate-spin text-blue-600"})}):d?a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[a.jsx("p",{className:"text-sm text-green-600",children:"Leads Today"}),a.jsx("p",{className:"text-2xl font-bold text-green-700",children:d.leadsToday}),a.jsxs("p",{className:"text-xs text-green-500 mt-1",children:[d.totalLeads," total"]})]}),a.jsxs("div",{className:"bg-purple-50 rounded-lg p-4",children:[a.jsx("p",{className:"text-sm text-purple-600",children:"Customers Today"}),a.jsx("p",{className:"text-2xl font-bold text-purple-700",children:d.customersToday}),a.jsxs("p",{className:"text-xs text-purple-500 mt-1",children:[d.totalCustomers," total"]})]}),a.jsxs("div",{className:"bg-indigo-50 rounded-lg p-4",children:[a.jsx("p",{className:"text-sm text-indigo-600",children:"Tasks Today"}),a.jsx("p",{className:"text-2xl font-bold text-indigo-700",children:d.tasksToday}),a.jsxs("p",{className:"text-xs text-indigo-500 mt-1",children:["$",d.tasksSalesToday.toFixed(2)," sales"]})]}),a.jsxs("div",{className:"bg-orange-50 rounded-lg p-4",children:[a.jsxs("p",{className:"text-sm text-orange-600",children:["Commission (",d.commissionRate,"%)"]}),a.jsxs("p",{className:"text-2xl font-bold text-orange-700",children:["$",d.commissionToday.toFixed(2)]}),a.jsxs("p",{className:"text-xs text-orange-500 mt-1",children:["$",d.totalCommission.toFixed(2)," total"]})]})]}),a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[a.jsx(a4,{className:"w-5 h-5 text-green-600"}),"Leads Captured (",d.leads.length,")"]}),d.leads.length===0?a.jsx("p",{className:"text-gray-500 py-4 text-center bg-gray-50 rounded-lg",children:"No leads captured on this date"}):a.jsx("div",{className:"border rounded-lg overflow-hidden",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Business"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Contact"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Phone"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Address"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Time"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:d.leads.map(z=>a.jsxs("tr",{children:[a.jsx("td",{className:"px-4 py-2 text-sm font-medium text-gray-900",children:z.businessName}),a.jsx("td",{className:"px-4 py-2 text-sm text-gray-600",children:z.contactName||"-"}),a.jsx("td",{className:"px-4 py-2 text-sm text-gray-600",children:z.phone||"-"}),a.jsx("td",{className:"px-4 py-2 text-sm text-gray-600",children:z.address||"-"}),a.jsx("td",{className:"px-4 py-2",children:a.jsx("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-700 rounded text-xs",children:z.status})}),a.jsx("td",{className:"px-4 py-2 text-sm text-gray-500",children:ye(z.createdAt)})]},z.id))})]})})]}),a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[a.jsx(Ed,{className:"w-5 h-5 text-purple-600"}),"Customers Created (",d.customers.length,")"]}),d.customers.length===0?a.jsx("p",{className:"text-gray-500 py-4 text-center bg-gray-50 rounded-lg",children:"No customers created on this date"}):a.jsx("div",{className:"border rounded-lg overflow-hidden",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Code"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Name"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Phone"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Address"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Type"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Time"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:d.customers.map(z=>a.jsxs("tr",{children:[a.jsx("td",{className:"px-4 py-2 text-sm font-medium text-blue-600",children:z.code||"-"}),a.jsx("td",{className:"px-4 py-2 text-sm font-medium text-gray-900",children:z.name}),a.jsx("td",{className:"px-4 py-2 text-sm text-gray-600",children:z.phone||"-"}),a.jsx("td",{className:"px-4 py-2 text-sm text-gray-600",children:z.address||"-"}),a.jsx("td",{className:"px-4 py-2",children:a.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 rounded text-xs",children:z.customerType||"Retail"})}),a.jsx("td",{className:"px-4 py-2 text-sm text-gray-500",children:ye(z.createdAt)})]},z.id))})]})})]}),a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[a.jsx(r4,{className:"w-5 h-5 text-indigo-600"}),"Tasks Created (",d.tasks.length,")",d.tasks.length>0&&a.jsxs("span",{className:"text-sm font-normal text-gray-500",children:["- Commission: $",d.commissionToday.toFixed(2)]})]}),d.tasks.length===0?a.jsx("p",{className:"text-gray-500 py-4 text-center bg-gray-50 rounded-lg",children:"No tasks created on this date"}):a.jsx("div",{className:"border rounded-lg overflow-hidden",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Task #"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Customer"}),a.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase",children:"Total"}),a.jsx("th",{className:"px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase",children:"Status"}),a.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase",children:"Commission"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Time"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:d.tasks.map(z=>{const A=z.status==="Completed"||z.status==="Delivered",de=A?z.total*(d.commissionRate/100):0;return a.jsxs("tr",{children:[a.jsx("td",{className:"px-4 py-2 text-sm font-medium text-indigo-600",children:z.taskNumber}),a.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:z.customerName||"-"}),a.jsxs("td",{className:"px-4 py-2 text-sm text-right font-medium text-gray-900",children:["$",z.total.toFixed(2)]}),a.jsx("td",{className:"px-4 py-2 text-center",children:a.jsx("span",{className:`px-2 py-1 rounded text-xs ${A?"bg-green-100 text-green-700":z.status==="Pending"?"bg-yellow-100 text-yellow-700":"bg-gray-100 text-gray-700"}`,children:z.status})}),a.jsx("td",{className:"px-4 py-2 text-sm text-right font-medium text-orange-600",children:A?`$${de.toFixed(2)}`:"-"}),a.jsx("td",{className:"px-4 py-2 text-sm text-gray-500",children:ye(z.createdAt)})]},z.id)})}),a.jsx("tfoot",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("td",{colSpan:2,className:"px-4 py-2 text-sm font-medium text-gray-700",children:"Total"}),a.jsxs("td",{className:"px-4 py-2 text-sm text-right font-bold text-gray-900",children:["$",d.tasks.reduce((z,A)=>z+A.total,0).toFixed(2)]}),a.jsx("td",{}),a.jsxs("td",{className:"px-4 py-2 text-sm text-right font-bold text-orange-600",children:["$",d.commissionToday.toFixed(2)]}),a.jsx("td",{})]})})]})})]})]}):a.jsx("div",{className:"text-center py-12 text-gray-500",children:"Failed to load performance data"})})]})}),N&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-lg overflow-hidden",children:[a.jsxs("div",{className:"flex justify-between items-center p-6 bg-indigo-600 text-white",children:[a.jsx("h2",{className:"text-xl font-bold",children:"Assign Visit Task"}),a.jsx("button",{onClick:()=>S(!1),className:"p-1 hover:bg-indigo-500 rounded",children:a.jsx(yt,{className:"w-5 h-5"})})]}),a.jsxs("form",{onSubmit:se,className:"p-6 space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Salesman *"}),a.jsxs("select",{value:ne.salesmanId,onChange:z=>W({...ne,salesmanId:z.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",required:!0,children:[a.jsx("option",{value:"",children:"Select salesman"}),e.map(z=>a.jsx("option",{value:z.id,children:z.name},z.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer *"}),a.jsx("input",{type:"text",placeholder:"Search customers...",value:Q,onChange:z=>H(z.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg mb-2 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"}),E?a.jsx("div",{className:"flex justify-center py-4",children:a.jsx(vt,{className:"w-6 h-6 animate-spin text-indigo-600"})}):a.jsx("div",{className:"max-h-40 overflow-y-auto border border-gray-200 rounded-lg",children:he.length===0?a.jsx("p",{className:"p-3 text-gray-500 text-center text-sm",children:"No customers found"}):he.slice(0,50).map(z=>a.jsxs("label",{className:`flex items-center gap-3 p-3 hover:bg-gray-50 cursor-pointer border-b last:border-b-0 ${ne.customerId===z.id.toString()?"bg-indigo-50":""}`,children:[a.jsx("input",{type:"radio",name:"customer",value:z.id,checked:ne.customerId===z.id.toString(),onChange:A=>W({...ne,customerId:A.target.value}),className:"text-indigo-600"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-900",children:z.name}),z.phone&&a.jsx("p",{className:"text-xs text-gray-500",children:z.phone})]})]},z.id))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Scheduled Date"}),a.jsx("input",{type:"date",value:ne.scheduledDate,onChange:z=>W({...ne,scheduledDate:z.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),a.jsx("textarea",{value:ne.notes,onChange:z=>W({...ne,notes:z.target.value}),placeholder:"Optional notes for this visit...",rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>S(!1),className:"flex-1 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:C||!ne.salesmanId||!ne.customerId,className:"flex-1 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed transition",children:C?"Creating...":"Create Visit Task"})]})]})]})})]})}function sve(){const[e,t]=m.useState([]),[r,s]=m.useState([]),[n,i]=m.useState(!0),[l,o]=m.useState(!1),[c,u]=m.useState(!1),[d,h]=m.useState(!1),[f,x]=m.useState(null),[p,g]=m.useState({name:"",code:"",address:"",phone:"",managerId:"",isActive:!0});m.useEffect(()=>{y()},[]);const y=async()=>{try{i(!0);const[N,S]=await Promise.all([Ks.getAll(),hs.getAll()]);t(N.data),s(S.data.filter(_=>_.status==="active").map(_=>({id:_.id,name:_.name})))}catch(N){console.error("Failed to load warehouses:",N)}finally{i(!1)}},v=()=>{g({name:"",code:"",address:"",phone:"",managerId:"",isActive:!0})},j=async N=>{var S,_;if(N.preventDefault(),!p.managerId){alert("Please select a manager");return}o(!0);try{await Ks.create({...p,managerId:parseInt(p.managerId)}),u(!1),v(),y()}catch(O){alert(((_=(S=O.response)==null?void 0:S.data)==null?void 0:_.message)||"Failed to create warehouse")}finally{o(!1)}},b=N=>{var S;x(N),g({name:N.name,code:N.code||"",address:N.address||"",phone:N.phone||"",managerId:((S=N.managerId)==null?void 0:S.toString())||"",isActive:N.isActive}),h(!0)},w=async N=>{var S,_;if(N.preventDefault(),!!f){if(!p.managerId){alert("Please select a manager");return}o(!0);try{await Ks.update(f.id,{...p,managerId:parseInt(p.managerId)}),h(!1),y()}catch(O){alert(((_=(S=O.response)==null?void 0:S.data)==null?void 0:_.message)||"Failed to update warehouse")}finally{o(!1)}}},k=async N=>{var S,_;if(confirm("Are you sure you want to delete this warehouse?"))try{await Ks.delete(N),y()}catch(O){alert(((_=(S=O.response)==null?void 0:S.data)==null?void 0:_.message)||"Failed to delete warehouse")}};return n?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx(vt,{className:"animate-spin",size:32})}):a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Warehouses"}),a.jsx(qr,{permission:Ve.CREATE_WAREHOUSES,children:a.jsxs("button",{onClick:()=>u(!0),className:"flex items-center gap-2 px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600",children:[a.jsx(hr,{size:20})," Add Warehouse"]})})]}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Name"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Location"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Manager"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Phone"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Active"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:e.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:6,className:"px-4 py-8 text-center text-gray-500",children:"No warehouses found"})}):e.map(N=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 font-medium",children:N.name}),a.jsx("td",{className:"px-4 py-3",children:N.address||"-"}),a.jsx("td",{className:"px-4 py-3",children:N.managerName||"-"}),a.jsx("td",{className:"px-4 py-3",children:N.phone||"-"}),a.jsx("td",{className:"px-4 py-3",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${N.isActive?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:N.isActive?"Yes":"No"})}),a.jsx("td",{className:"px-4 py-3",children:a.jsxs("div",{className:"flex gap-1",children:[a.jsx(qr,{permission:Ve.EDIT_WAREHOUSES,children:a.jsx("button",{onClick:()=>b(N),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",title:"Edit",children:a.jsx(js,{size:16})})}),a.jsx(qr,{permission:Ve.DELETE_WAREHOUSES,children:a.jsx("button",{onClick:()=>k(N.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Delete",children:a.jsx(xr,{size:16})})})]})})]},N.id))})]})}),(c||d)&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-lg",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-[#003366] text-white rounded-t-xl",children:[a.jsx("h2",{className:"text-lg font-semibold",children:d?"Edit Warehouse":"Add Warehouse"}),a.jsx("button",{onClick:()=>{u(!1),h(!1)},children:a.jsx(yt,{size:24})})]}),a.jsxs("form",{onSubmit:d?w:j,className:"p-6 space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Warehouse Name *"}),a.jsx("input",{type:"text",required:!0,value:p.name,onChange:N=>g({...p,name:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"Enter name"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Location"}),a.jsx("input",{type:"text",value:p.address,onChange:N=>g({...p,address:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"Enter location"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),a.jsx("input",{type:"text",value:p.phone,onChange:N=>g({...p,phone:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"Enter phone"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Manager"}),a.jsxs("select",{value:p.managerId,onChange:N=>g({...p,managerId:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[a.jsx("option",{value:"",children:"Select Manager"}),r.map(N=>a.jsx("option",{value:N.id,children:N.name},N.id))]})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",id:"isActive",checked:p.isActive,onChange:N=>g({...p,isActive:N.target.checked}),className:"rounded"}),a.jsx("label",{htmlFor:"isActive",className:"text-sm",children:"Active"})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>{u(!1),h(!1)},className:"flex-1 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:l,className:"flex-1 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 disabled:opacity-50",children:l?"Saving...":"Save"})]})]})]})})]})}function nve(){const[e,t]=m.useState([]),[r,s]=m.useState([]),[n,i]=m.useState([]),[l,o]=m.useState([]),[c,u]=m.useState([]),[d,h]=m.useState([]),[f,x]=m.useState([]),[p,g]=m.useState([]),[y,v]=m.useState(!0),[j,b]=m.useState(!1),[w,k]=m.useState(null),[N]=Az(),S=()=>{const le=new Date;return`${le.getFullYear()}-${String(le.getMonth()+1).padStart(2,"0")}-${String(le.getDate()).padStart(2,"0")}`},[_,O]=m.useState(S()),[E,R]=m.useState(N.get("customer")||""),[C,I]=m.useState(""),[ne,W]=m.useState(""),[Q,H]=m.useState(""),[K,q]=m.useState(!1),[ge,G]=m.useState(!1),[B,se]=m.useState(!1),[L,Z]=m.useState(""),[F,he]=m.useState(null),[ye,z]=m.useState(null),[A,de]=m.useState({type:"Order",customerId:"",driverId:"",vanId:"",warehouseId:"",supplierId:"",scheduledDate:S(),notes:"",discount:0,extraCharge:0,tax:0,items:[]}),[D,ze]=m.useState({}),[Fe,ct]=m.useState(null),$e=m.useRef(null);m.useEffect(()=>{We()},[]),m.useEffect(()=>{const le=Me=>{$e.current&&!$e.current.contains(Me.target)&&ct(null)};return document.addEventListener("mousedown",le),()=>document.removeEventListener("mousedown",le)},[]);const We=async()=>{try{v(!0);const[le,Me,ut,ee,ve,xe,oe]=await Promise.all([qc.getAll(),Ha.getAll(),hs.getAll(),rn.getAll(),Ks.getAll(),br.getAll(),Vr.getAll()]);t(le.data),s(Me.data.map(Ie=>({id:Ie.id,name:Ie.name}))),i(ut.data.filter(Ie=>Ie.isDriver).map(Ie=>({id:Ie.id,name:Ie.name,vanId:Ie.vanId,warehouseId:Ie.warehouseId}))),o(ee.data.map(Ie=>({id:Ie.id,name:Ie.name}))),u(ve.data.map(Ie=>({id:Ie.id,name:Ie.name}))),h(oe.data.map(Ie=>({id:Ie.id,name:Ie.name}))),x(xe.data)}catch(le){console.error("Failed to load data:",le)}finally{v(!1)}},Bt=e.filter(le=>{var Me,ut,ee;return!(_&&!le.scheduledDate.startsWith(_)||E&&((Me=le.customerId)==null?void 0:Me.toString())!==E||C&&((ut=le.driverId)==null?void 0:ut.toString())!==C||ne&&((ee=le.vanId)==null?void 0:ee.toString())!==ne||Q&&le.status!==Q)}),Ee=()=>{de({type:"Order",customerId:"",driverId:"",vanId:"",warehouseId:"",supplierId:"",scheduledDate:S(),notes:"",discount:0,extraCharge:0,tax:0,items:[]}),g([])},it=()=>{de({...A,items:[...A.items,{productId:0,unitType:"Piece",quantity:1,unitPrice:0,defaultPrice:0,discountPercent:0,total:0}]})},we=async le=>{if(!le){g([]);return}try{const Me=await Ha.getSpecialPrices(parseInt(le));g(Me.data)}catch(Me){console.error("Failed to load special prices:",Me),g([])}},et=(le,Me)=>{const ut=f.find(oe=>oe.id===le);if(!ut)return{price:0,isSpecial:!1,defaultPrice:0};const ee=Me===ut.secondUnit,ve=ee?ut.boxRetailPrice:ut.retailPrice,xe=p.find(oe=>oe.productId===le);return xe?{price:ee?xe.boxRetailPrice:xe.retailPrice,isSpecial:!0,defaultPrice:ve}:{price:ve,isSpecial:!1,defaultPrice:ve}},Ge=le=>{const Me=[...A.items],ut=Me[le];Me[le]={...ut,unitPrice:ut.defaultPrice,total:ut.quantity*ut.defaultPrice*(1-ut.discountPercent/100)},de({...A,items:Me})},Nt=(le,Me,ut)=>{const ee=[...A.items];ee[le]={...ee[le],[Me]:ut};const ve=ee[le].quantity,xe=ee[le].unitPrice,oe=ee[le].discountPercent;ee[le].total=ve*xe*(1-oe/100),de({...A,items:ee})},Rt=le=>{de({...A,items:A.items.filter((Me,ut)=>ut!==le)})},pr=()=>{const le=A.items.reduce((Me,ut)=>Me+ut.total,0);return{subtotal:le,total:le-A.discount+A.tax+A.extraCharge}},Zt=async le=>{var ee,ve,xe,oe,Ie,me,ht;le.preventDefault();const Me=A.items.filter(At=>At.productId>0&&At.quantity>0);if(A.type!=="Customer Visit"&&A.type!=="Cash Collection"&&Me.length===0){alert("Please add at least one product with a valid quantity");return}b(!0);try{const At={...A,items:Me,customerId:A.customerId?parseInt(A.customerId):null,driverId:A.driverId?parseInt(A.driverId):null,supplierId:A.supplierId?parseInt(A.supplierId):null,vanId:A.vanId?parseInt(A.vanId):null,warehouseId:A.warehouseId?parseInt(A.warehouseId):null};if(ye?await qc.update(ye.id,At):await qc.create(At),A.customerId){const Er=parseInt(A.customerId),or=Me.filter(Gt=>Gt.defaultPrice>0&&Gt.unitPrice!==Gt.defaultPrice);for(const Gt of or)try{const zt=p.find(_r=>_r.productId===Gt.productId),ma=f.find(_r=>_r.id===Gt.productId),Or=ma&&Gt.unitType===ma.secondUnit;zt?await Ha.updateSpecialPrice(Er,zt.id,{retailPrice:Or?zt.retailPrice:Gt.unitPrice,boxRetailPrice:Or?Gt.unitPrice:zt.boxRetailPrice}):await Ha.addSpecialPrice(Er,{productId:Gt.productId,retailPrice:Or?Gt.defaultPrice:Gt.unitPrice,boxRetailPrice:Or?Gt.unitPrice:0})}catch(zt){console.error("Failed to save special price for product",Gt.productId,zt)}}q(!1),z(null),Ee(),g([]),We()}catch(At){const Er=((ve=(ee=At.response)==null?void 0:ee.data)==null?void 0:ve.details)||((oe=(xe=At.response)==null?void 0:xe.data)==null?void 0:oe.error)||((me=(Ie=At.response)==null?void 0:Ie.data)==null?void 0:me.message)||"Failed to save task";alert(`Error: ${Er}`),console.error("Task error:",(ht=At.response)==null?void 0:ht.data)}finally{b(!1)}},er=le=>{he(le),G(!0)},ue=le=>{var Me,ut,ee,ve,xe;z(le),de({type:le.type,customerId:((Me=le.customerId)==null?void 0:Me.toString())||"",driverId:((ut=le.driverId)==null?void 0:ut.toString())||"",vanId:((ee=le.vanId)==null?void 0:ee.toString())||"",warehouseId:((ve=le.warehouseId)==null?void 0:ve.toString())||"",supplierId:((xe=le.supplierId)==null?void 0:xe.toString())||"",scheduledDate:le.scheduledDate.split("T")[0],notes:le.notes||"",discount:le.discount,extraCharge:le.extraCharge||0,tax:le.tax,items:le.items.map(oe=>({...oe,defaultPrice:oe.unitPrice,discountPercent:oe.discountPercent||0}))}),le.customerId&&we(le.customerId.toString()),q(!0)},Le=async le=>{var Me,ut;if(confirm("Are you sure you want to delete this task?"))try{await qc.delete(le),We()}catch(ee){alert(((ut=(Me=ee.response)==null?void 0:Me.data)==null?void 0:ut.message)||"Failed to delete task")}},Je=le=>({Pending:"bg-yellow-100 text-yellow-700",Started:"bg-blue-100 text-blue-700","In Progress":"bg-indigo-100 text-indigo-700",Completed:"bg-green-100 text-green-700",Delayed:"bg-orange-100 text-orange-700",Cancelled:"bg-red-100 text-red-700"})[le]||"bg-gray-100 text-gray-700";if(y)return a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx(vt,{className:"animate-spin",size:32})});const Xe=pr();return a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Orders & Tasks"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("button",{onClick:()=>se(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600",children:[a.jsx(Tr,{size:20})," Products Summary"]}),a.jsxs("button",{onClick:()=>{Ee(),z(null),q(!0)},className:"flex items-center gap-2 px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600",children:[a.jsx(hr,{size:20})," Create Order / Task"]})]})]}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 mb-6",children:a.jsxs("div",{className:"flex flex-wrap gap-3",children:[a.jsx("input",{type:"date",value:_,onChange:le=>O(le.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm"}),a.jsxs("select",{value:E,onChange:le=>R(le.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[a.jsx("option",{value:"",children:"All Customers"}),r.map(le=>a.jsx("option",{value:le.id,children:le.name},le.id))]}),a.jsxs("select",{value:C,onChange:le=>I(le.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[a.jsx("option",{value:"",children:"All Drivers"}),n.map(le=>a.jsx("option",{value:le.id,children:le.name},le.id))]}),a.jsxs("select",{value:ne,onChange:le=>W(le.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[a.jsx("option",{value:"",children:"All Vans"}),l.map(le=>a.jsx("option",{value:le.id,children:le.name},le.id))]}),a.jsxs("select",{value:Q,onChange:le=>H(le.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[a.jsx("option",{value:"",children:"All Status"}),a.jsx("option",{value:"Pending",children:"Pending"}),a.jsx("option",{value:"Started",children:"Started"}),a.jsx("option",{value:"In Progress",children:"In Progress"}),a.jsx("option",{value:"Completed",children:"Completed"}),a.jsx("option",{value:"Delayed",children:"Delayed"}),a.jsx("option",{value:"Cancelled",children:"Cancelled"})]})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden overflow-x-auto",children:a.jsxs("table",{className:"w-full min-w-[1000px]",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Order / Task"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Type"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Customer"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Driver"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Van"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Warehouse"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Status"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Scheduled"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Total"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:Bt.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:10,className:"px-4 py-8 text-center text-gray-500",children:"No tasks found"})}):Bt.map(le=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsxs("td",{className:"px-4 py-3 font-medium",children:["#",le.taskNumber]}),a.jsx("td",{className:"px-4 py-3",children:le.type}),a.jsx("td",{className:"px-4 py-3",children:le.type==="Supplier Pickup"?le.supplierName?a.jsx("span",{className:"text-orange-600",children:le.supplierName}):"-":le.customerName||"-"}),a.jsx("td",{className:"px-4 py-3",children:le.driverName||"-"}),a.jsx("td",{className:"px-4 py-3",children:le.vanName||"-"}),a.jsx("td",{className:"px-4 py-3",children:le.warehouseName||"-"}),a.jsx("td",{className:"px-4 py-3",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${Je(le.status)}`,children:le.status})}),a.jsx("td",{className:"px-4 py-3",children:le.scheduledDate.split("T")[0]}),a.jsxs("td",{className:"px-4 py-3 font-medium",children:["$",le.total.toFixed(3)]}),a.jsx("td",{className:"px-4 py-3",children:a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:()=>er(le),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",title:"View",children:a.jsx(gs,{size:16})}),le.proofOfDeliveryUrl&&a.jsx("button",{onClick:()=>k(le.proofOfDeliveryUrl),className:"p-1 text-purple-600 hover:bg-purple-50 rounded",title:"Proof of Delivery",children:a.jsx(Br,{size:16})}),a.jsx("button",{onClick:()=>ue(le),className:"p-1 text-green-600 hover:bg-green-50 rounded",title:"Edit",children:a.jsx(js,{size:16})}),a.jsx("button",{onClick:()=>Le(le.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Delete",children:a.jsx(xr,{size:16})})]})})]},le.id))})]})}),K&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-4xl max-h-[90vh] overflow-hidden",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-[#003366] text-white",children:[a.jsx("h2",{className:"text-lg font-semibold",children:ye?"Edit Order / Task":"Create Order / Task"}),a.jsx("button",{onClick:()=>{q(!1),z(null)},children:a.jsx(yt,{size:24})})]}),a.jsxs("form",{onSubmit:Zt,className:"p-6 overflow-y-auto max-h-[calc(90vh-120px)] space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Type"}),a.jsxs("select",{value:A.type,onChange:le=>de({...A,type:le.target.value,supplierId:"",customerId:""}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[a.jsx("option",{value:"Order",children:"Order"}),a.jsx("option",{value:"Customer Visit",children:"Customer Visit"}),a.jsx("option",{value:"Cash Collection",children:"Cash Collection"}),a.jsx("option",{value:"Supplier Pickup",children:"Supplier Pickup"})]})]}),A.type==="Supplier Pickup"?a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Supplier"}),a.jsxs("select",{value:A.supplierId,onChange:le=>de({...A,supplierId:le.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[a.jsx("option",{value:"",children:"Select supplier"}),d.map(le=>a.jsx("option",{value:le.id,children:le.name},le.id))]})]}):a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Customer"}),a.jsxs("select",{value:A.customerId,onChange:le=>{const Me=le.target.value;de({...A,customerId:Me,items:[]}),we(Me)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[a.jsx("option",{value:"",children:"Select customer"}),r.map(le=>a.jsx("option",{value:le.id,children:le.name},le.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Driver"}),a.jsxs("select",{value:A.driverId,onChange:le=>{var ee,ve;const Me=le.target.value,ut=n.find(xe=>xe.id.toString()===Me);de({...A,driverId:Me,vanId:((ee=ut==null?void 0:ut.vanId)==null?void 0:ee.toString())||A.vanId,warehouseId:((ve=ut==null?void 0:ut.warehouseId)==null?void 0:ve.toString())||A.warehouseId})},className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[a.jsx("option",{value:"",children:"Select driver"}),n.map(le=>a.jsx("option",{value:le.id,children:le.name},le.id))]})]})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Van"}),a.jsxs("select",{value:A.vanId,onChange:le=>de({...A,vanId:le.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[a.jsx("option",{value:"",children:"Select van"}),l.map(le=>a.jsx("option",{value:le.id,children:le.name},le.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Warehouse"}),a.jsxs("select",{value:A.warehouseId,onChange:le=>de({...A,warehouseId:le.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[a.jsx("option",{value:"",children:"Select warehouse"}),c.map(le=>a.jsx("option",{value:le.id,children:le.name},le.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Scheduled Date"}),a.jsx("input",{type:"date",value:A.scheduledDate,onChange:le=>de({...A,scheduledDate:le.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Notes"}),a.jsx("textarea",{value:A.notes,onChange:le=>de({...A,notes:le.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",rows:2,placeholder:"Enter any notes"})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsx("label",{className:"text-sm font-semibold text-gray-700",children:"Products"}),a.jsxs("button",{type:"button",onClick:it,className:"text-sm text-blue-600 hover:underline flex items-center gap-1",children:[a.jsx(hr,{size:16})," Add Item"]})]}),a.jsx("div",{className:"border rounded-lg overflow-hidden",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-2 py-2 text-left",children:"#"}),a.jsx("th",{className:"px-2 py-2 text-left",children:"Product"}),a.jsx("th",{className:"px-2 py-2 text-left",children:"Type"}),a.jsx("th",{className:"px-2 py-2 text-left",children:"Qty"}),a.jsx("th",{className:"px-2 py-2 text-left",children:"Price"}),a.jsx("th",{className:"px-2 py-2 text-left",children:"Disc %"}),a.jsx("th",{className:"px-2 py-2 text-left",children:"Total"}),a.jsx("th",{className:"px-2 py-2"})]})}),a.jsx("tbody",{children:A.items.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:8,className:"px-2 py-4 text-center text-gray-400",children:"No items added"})}):A.items.map((le,Me)=>{var ee;const ut=le.productId>0&&le.defaultPrice>0&&le.unitPrice!==le.defaultPrice;return a.jsxs("tr",{className:"border-t",children:[a.jsx("td",{className:"px-2 py-2",children:Me+1}),a.jsxs("td",{className:"px-2 py-2 relative",ref:Fe===Me?$e:null,children:[a.jsx("input",{type:"text",value:Fe===Me?D[Me]??"":((ee=f.find(ve=>ve.id===le.productId))==null?void 0:ee.name)||"",onChange:ve=>{ze({...D,[Me]:ve.target.value}),ct(Me)},onFocus:()=>ct(Me),placeholder:"Search product...",className:"w-full px-2 py-1 border rounded text-sm"}),Fe===Me&&a.jsxs("div",{className:"absolute z-50 w-full bg-white border rounded shadow-lg max-h-48 overflow-y-auto mt-1",children:[f.filter(ve=>{var xe;return!A.warehouseId||((xe=ve.defaultWarehouseId)==null?void 0:xe.toString())===A.warehouseId}).filter(ve=>!D[Me]||ve.name.toLowerCase().includes((D[Me]||"").toLowerCase())).slice(0,20).map(ve=>a.jsx("div",{className:"px-3 py-2 hover:bg-blue-50 cursor-pointer text-sm",onClick:()=>{const xe=ve.id,oe=ve.baseUnit||"Piece",{price:Ie,defaultPrice:me}=et(xe,oe),ht=[...A.items];ht[Me]={...ht[Me],productId:xe,unitType:oe,unitPrice:Ie,defaultPrice:me,total:ht[Me].quantity*Ie*(1-ht[Me].discountPercent/100)},de({...A,items:ht}),ze({...D,[Me]:""}),ct(null)},children:ve.name},ve.id)),f.filter(ve=>{var xe;return!A.warehouseId||((xe=ve.defaultWarehouseId)==null?void 0:xe.toString())===A.warehouseId}).filter(ve=>!D[Me]||ve.name.toLowerCase().includes((D[Me]||"").toLowerCase())).length===0&&a.jsx("div",{className:"px-3 py-2 text-gray-400 text-sm",children:"No products found"})]})]}),a.jsx("td",{className:"px-2 py-2",children:a.jsx("select",{value:le.unitType,onChange:ve=>{const xe=ve.target.value,{price:oe,defaultPrice:Ie}=et(le.productId,xe),me=[...A.items];me[Me]={...me[Me],unitType:xe,unitPrice:oe,defaultPrice:Ie,total:me[Me].quantity*oe*(1-me[Me].discountPercent/100)},de({...A,items:me})},className:"w-full px-2 py-1 border rounded text-sm",children:(()=>{const ve=f.find(xe=>xe.id===le.productId);return ve?a.jsxs(a.Fragment,{children:[a.jsx("option",{value:ve.baseUnit,children:ve.baseUnit}),ve.secondUnit&&a.jsx("option",{value:ve.secondUnit,children:ve.secondUnit})]}):a.jsxs(a.Fragment,{children:[a.jsx("option",{value:"Piece",children:"Piece"}),a.jsx("option",{value:"Box",children:"Box"})]})})()})}),a.jsx("td",{className:"px-2 py-2",children:a.jsx("input",{type:"number",value:le.quantity,onChange:ve=>Nt(Me,"quantity",parseInt(ve.target.value)||0),className:"w-16 px-2 py-1 border rounded text-sm"})}),a.jsx("td",{className:"px-2 py-2",children:a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsxs("div",{className:"flex flex-col",children:[ut&&a.jsxs("span",{className:"text-xs text-red-500 line-through",children:["$",le.defaultPrice.toFixed(3)]}),a.jsx("input",{type:"number",step:"0.01",value:le.unitPrice,onChange:ve=>Nt(Me,"unitPrice",parseFloat(ve.target.value)||0),className:`w-20 px-2 py-1 border rounded text-sm ${ut?"border-green-500 bg-green-50":""}`})]}),ut&&a.jsx("button",{type:"button",onClick:()=>Ge(Me),className:"text-gray-400 hover:text-gray-600",title:"Reset to default price",children:a.jsx(ao,{size:14})})]})}),a.jsx("td",{className:"px-2 py-2",children:a.jsx("input",{type:"number",value:le.discountPercent,onChange:ve=>Nt(Me,"discountPercent",parseFloat(ve.target.value)||0),className:"w-16 px-2 py-1 border rounded text-sm"})}),a.jsxs("td",{className:"px-2 py-2 font-medium",children:["$",le.total.toFixed(3)]}),a.jsx("td",{className:"px-2 py-2",children:a.jsx("button",{type:"button",onClick:()=>Rt(Me),className:"text-red-500 hover:text-red-700",children:a.jsx(xr,{size:16})})})]},Me)})})]})}),a.jsxs("div",{className:"flex justify-end gap-6 mt-3 text-sm",children:[a.jsxs("span",{children:[a.jsx("strong",{children:"Subtotal:"})," $",Xe.subtotal.toFixed(3)]}),a.jsxs("span",{children:[a.jsx("strong",{children:"Discount:"})," $",A.discount.toFixed(3)]}),A.extraCharge>0&&a.jsxs("span",{className:"text-orange-600",children:[a.jsx("strong",{children:"Extra Charge:"})," +$",A.extraCharge.toFixed(3)]}),a.jsxs("span",{children:[a.jsx("strong",{children:"Tax:"})," $",A.tax.toFixed(3)]}),a.jsxs("span",{children:[a.jsx("strong",{children:"Total:"})," $",Xe.total.toFixed(3)]})]})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>{q(!1),z(null)},className:"flex-1 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:j,className:"flex-1 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 disabled:opacity-50",children:j?"Saving...":ye?"Update Order / Task":"Save Order / Task"})]})]})]})}),ge&&F&&(()=>{const le=F.items.filter(xe=>xe.discountPercent<100),Me=F.items.filter(xe=>xe.discountPercent===100),ut=le.reduce((xe,oe)=>xe+oe.total,0),ee=Me.reduce((xe,oe)=>xe+oe.quantity*(oe.defaultPrice||0),0),ve=F.total-F.subtotal;return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-3xl max-h-[90vh] overflow-hidden",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-[#003366] text-white",children:[a.jsxs("h2",{className:"text-lg font-semibold",children:["Order #",F.taskNumber]}),a.jsx("button",{onClick:()=>G(!1),children:a.jsx(yt,{size:24})})]}),a.jsxs("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-120px)] space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Type:"})," ",a.jsx("span",{className:"font-medium",children:F.type})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Customer:"})," ",a.jsx("span",{className:"font-medium",children:F.customerName||"-"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Driver:"})," ",a.jsx("span",{className:"font-medium",children:F.driverName||"-"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Van:"})," ",a.jsx("span",{className:"font-medium",children:F.vanName||"-"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Warehouse:"})," ",a.jsx("span",{className:"font-medium",children:F.warehouseName||"-"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Scheduled:"})," ",a.jsx("span",{className:"font-medium",children:F.scheduledDate.split("T")[0]})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Status:"})," ",a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${Je(F.status)}`,children:F.status})]})]}),F.notes&&a.jsxs("div",{className:"text-sm",children:[a.jsx("span",{className:"text-gray-500",children:"Notes:"})," ",F.notes]}),le.length>0&&a.jsxs("div",{children:[a.jsxs("h3",{className:"font-semibold text-gray-700 mb-2 flex items-center gap-2",children:["   (",le.length,")"]}),a.jsx("div",{className:"border rounded-lg overflow-hidden",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-blue-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-2 text-left",children:"Product"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Type"}),a.jsx("th",{className:"px-3 py-2 text-right",children:"Qty"}),a.jsx("th",{className:"px-3 py-2 text-right",children:"Price"}),a.jsx("th",{className:"px-3 py-2 text-right",children:"Total"})]})}),a.jsx("tbody",{children:le.map((xe,oe)=>{var Ie,me;return a.jsxs("tr",{className:"border-t",children:[a.jsx("td",{className:"px-3 py-2",children:xe.productName}),a.jsx("td",{className:"px-3 py-2",children:a.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${((Ie=xe.unitType)==null?void 0:Ie.toLowerCase())==="box"?"bg-orange-100 text-orange-700":"bg-gray-100 text-gray-700"}`,children:((me=xe.unitType)==null?void 0:me.toLowerCase())==="box"?"Box":"Piece"})}),a.jsx("td",{className:"px-3 py-2 text-right",children:xe.quantity}),a.jsxs("td",{className:"px-3 py-2 text-right",children:["$",xe.unitPrice.toFixed(2)]}),a.jsxs("td",{className:"px-3 py-2 text-right font-medium",children:["$",xe.total.toFixed(2)]})]},oe)})})]})})]}),Me.length>0&&a.jsxs("div",{children:[a.jsxs("h3",{className:"font-semibold text-orange-600 mb-2 flex items-center gap-2",children:["   (",Me.length,")"]}),a.jsx("div",{className:"border border-orange-200 rounded-lg overflow-hidden bg-orange-50",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-orange-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-2 text-left",children:"Product"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Type"}),a.jsx("th",{className:"px-3 py-2 text-right",children:"Qty"}),a.jsx("th",{className:"px-3 py-2 text-right",children:"Value"}),a.jsx("th",{className:"px-3 py-2 text-right",children:"Price"})]})}),a.jsx("tbody",{children:Me.map((xe,oe)=>{var Ie,me;return a.jsxs("tr",{className:"border-t border-orange-200",children:[a.jsx("td",{className:"px-3 py-2",children:xe.productName}),a.jsx("td",{className:"px-3 py-2",children:a.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${((Ie=xe.unitType)==null?void 0:Ie.toLowerCase())==="box"?"bg-orange-100 text-orange-700":"bg-gray-100 text-gray-700"}`,children:((me=xe.unitType)==null?void 0:me.toLowerCase())==="box"?"Box":"Piece"})}),a.jsx("td",{className:"px-3 py-2 text-right",children:xe.quantity}),a.jsxs("td",{className:"px-3 py-2 text-right text-gray-500 line-through",children:["$",(xe.quantity*xe.defaultPrice).toFixed(2)]}),a.jsx("td",{className:"px-3 py-2 text-right font-bold text-green-600",children:"FREE"})]},oe)})})]})})]}),a.jsxs("div",{className:"bg-gradient-to-r from-slate-800 to-slate-900 rounded-xl p-4 text-white",children:[a.jsx("h3",{className:"font-bold mb-3",children:" "}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsxs("span",{className:"opacity-80",children:[" (",le.reduce((xe,oe)=>xe+oe.quantity,0)," )"]}),a.jsxs("span",{className:"font-bold",children:["$",ut.toFixed(2)]})]}),Me.length>0&&a.jsxs("div",{className:"flex justify-between text-orange-300",children:[a.jsxs("span",{children:["  (",Me.reduce((xe,oe)=>xe+oe.quantity,0)," )"]}),a.jsxs("span",{className:"font-bold",children:[" ( $",ee.toFixed(2),")"]})]}),ve>0&&a.jsxs("div",{className:"flex justify-between text-yellow-300",children:[a.jsx("span",{children:"  "}),a.jsxs("span",{className:"font-bold",children:["+$",ve.toFixed(2)]})]})]}),a.jsxs("div",{className:"mt-3 pt-3 border-t border-white/30 flex justify-between items-center",children:[a.jsx("span",{className:"text-lg",children:"   "}),a.jsxs("span",{className:"text-2xl font-bold",children:["$",F.total.toFixed(2)]})]})]}),a.jsx("div",{className:"flex justify-end pt-4",children:a.jsx("button",{onClick:()=>G(!1),className:"px-6 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Close"})})]})]})})})(),B&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-2xl max-h-[80vh] overflow-hidden",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-blue-600 text-white",children:[a.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[a.jsx(Tr,{size:20})," Products Summary - ",_]}),a.jsx("button",{onClick:()=>{se(!1),Z("")},children:a.jsx(yt,{size:24})})]}),a.jsxs("div",{className:"p-4 overflow-y-auto max-h-[calc(80vh-120px)]",children:[a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Filter by Van"}),a.jsxs("select",{value:L,onChange:le=>Z(le.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[a.jsx("option",{value:"",children:"All Vans"}),l.map(le=>a.jsx("option",{value:le.id,children:le.name},le.id))]})]}),(()=>{const le={},Me=_;let ut=e.filter(oe=>oe.scheduledDate.split("T")[0]===Me);L&&(ut=ut.filter(oe=>{var Ie;return((Ie=oe.vanId)==null?void 0:Ie.toString())===L}));const ee=L?l.find(oe=>oe.id.toString()===L):null;ut.forEach(oe=>{oe.items.forEach(Ie=>{const me=`${Ie.productId}-${Ie.unitType}`;le[me]?le[me].quantity+=Ie.quantity:le[me]={productName:Ie.productName||`Product #${Ie.productId}`,quantity:Ie.quantity,unitType:Ie.unitType}})});const ve=Object.values(le).sort((oe,Ie)=>oe.productName.localeCompare(Ie.productName)),xe=ve.reduce((oe,Ie)=>oe+Ie.quantity,0);return ve.length===0?a.jsxs("div",{className:"text-center py-8 text-gray-500",children:[a.jsx(Tr,{size:48,className:"mx-auto mb-2 opacity-50"}),a.jsxs("p",{children:["No products found ",ee?`for ${ee.name}`:`for ${_}`]})]}):a.jsxs(a.Fragment,{children:[ee&&a.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3 mb-4",children:a.jsxs("span",{className:"font-semibold text-green-800",children:["Van: ",ee.name]})}),a.jsxs("div",{className:"bg-blue-50 rounded-lg p-3 mb-4 flex justify-between items-center",children:[a.jsxs("span",{className:"font-medium text-blue-800",children:["Total Products: ",ve.length]}),a.jsxs("span",{className:"font-bold text-blue-800",children:["Total Quantity: ",xe]})]}),a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-left px-4 py-2 text-sm font-semibold text-gray-600",children:"#"}),a.jsx("th",{className:"text-left px-4 py-2 text-sm font-semibold text-gray-600",children:"Product"}),a.jsx("th",{className:"text-left px-4 py-2 text-sm font-semibold text-gray-600",children:"Unit"}),a.jsx("th",{className:"text-right px-4 py-2 text-sm font-semibold text-gray-600",children:"Quantity"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-100",children:ve.map((oe,Ie)=>{var me,ht;return a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-2 text-sm text-gray-500",children:Ie+1}),a.jsx("td",{className:"px-4 py-2 font-medium",children:oe.productName}),a.jsx("td",{className:"px-4 py-2 text-sm text-gray-600",children:a.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${((me=oe.unitType)==null?void 0:me.toLowerCase())==="box"?"bg-orange-100 text-orange-700":"bg-gray-100 text-gray-700"}`,children:((ht=oe.unitType)==null?void 0:ht.toLowerCase())==="box"?"Box":"Piece"})}),a.jsx("td",{className:"px-4 py-2 text-right font-bold text-blue-600",children:oe.quantity})]},Ie)})})]})]})})()]}),a.jsxs("div",{className:"p-4 border-t flex justify-between",children:[a.jsxs("button",{onClick:()=>{const le=_;let Me=e.filter(Ie=>Ie.scheduledDate.split("T")[0]===le);L&&(Me=Me.filter(Ie=>{var me;return((me=Ie.vanId)==null?void 0:me.toString())===L}));const ut=L?l.find(Ie=>Ie.id.toString()===L):null,ee={};Me.forEach(Ie=>{Ie.items.forEach(me=>{const ht=`${me.productId}-${me.unitType}`;ee[ht]?ee[ht].quantity+=me.quantity:ee[ht]={productName:me.productName||`Product #${me.productId}`,quantity:me.quantity,unitType:me.unitType}})});const ve=Object.values(ee).sort((Ie,me)=>Ie.productName.localeCompare(me.productName)),xe=ve.reduce((Ie,me)=>Ie+me.quantity,0),oe=window.open("","_blank","width=600,height=800");if(!oe){alert("Please allow popups");return}oe.document.write(`
                    <!DOCTYPE html><html><head><title>Products Summary</title>
                    <style>
                      * { margin: 0; padding: 0; box-sizing: border-box; }
                      body { font-family: Arial, sans-serif; font-size: 12px; padding: 20px; }
                      .header { text-align: center; border-bottom: 2px solid #000; padding-bottom: 15px; margin-bottom: 15px; }
                      .header h1 { font-size: 18px; margin-bottom: 5px; }
                      .header p { color: #666; }
                      .van-info { background: #f0f9f0; border: 1px solid #4ade80; padding: 10px; margin-bottom: 15px; border-radius: 5px; }
                      .summary { display: flex; justify-content: space-between; background: #eff6ff; padding: 10px; margin-bottom: 15px; border-radius: 5px; }
                      table { width: 100%; border-collapse: collapse; }
                      th { background: #f3f4f6; text-align: left; padding: 8px; border-bottom: 2px solid #e5e7eb; font-size: 11px; }
                      td { padding: 8px; border-bottom: 1px solid #e5e7eb; }
                      .unit-box { background: #ffedd5; color: #c2410c; padding: 2px 6px; border-radius: 3px; font-size: 10px; }
                      .unit-piece { background: #f3f4f6; color: #374151; padding: 2px 6px; border-radius: 3px; font-size: 10px; }
                      .qty { text-align: right; font-weight: bold; color: #2563eb; }
                      .footer { text-align: center; margin-top: 20px; padding-top: 15px; border-top: 1px dashed #ccc; font-size: 10px; color: #666; }
                      @media print { body { padding: 10px; } @page { margin: 10mm; } }
                    </style></head><body>
                      <div class="header">
                        <h1>Products Summary</h1>
                        <p>Date: ${le}</p>
                      </div>
                      ${ut?`<div class="van-info"><strong>Van:</strong> ${ut.name}</div>`:""}
                      <div class="summary">
                        <span><strong>Total Products:</strong> ${ve.length}</span>
                        <span><strong>Total Quantity:</strong> ${xe}</span>
                      </div>
                      <table>
                        <thead><tr><th>#</th><th>Product</th><th>Unit</th><th style="text-align:right">Qty</th></tr></thead>
                        <tbody>
                          ${ve.map((Ie,me)=>{var ht,At;return`
                            <tr>
                              <td>${me+1}</td>
                              <td>${Ie.productName}</td>
                              <td><span class="${((ht=Ie.unitType)==null?void 0:ht.toLowerCase())==="box"?"unit-box":"unit-piece"}">${((At=Ie.unitType)==null?void 0:At.toLowerCase())==="box"?"Box":"Piece"}</span></td>
                              <td class="qty">${Ie.quantity}</td>
                            </tr>
                          `}).join("")}
                        </tbody>
                      </table>
                      <div class="footer">Printed: ${new Date().toLocaleString()}</div>
                      <script>window.onload = function() { window.print(); }<\/script>
                    </body></html>
                  `),oe.document.close()},className:"flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600",children:[a.jsx(ua,{size:18})," Print Summary"]}),a.jsx("button",{onClick:()=>{se(!1),Z("")},className:"px-6 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Close"})]})]})}),w&&a.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",onClick:()=>k(null),children:a.jsxs("div",{className:"relative max-w-2xl w-full bg-white rounded-xl overflow-hidden",onClick:le=>le.stopPropagation(),children:[a.jsxs("div",{className:"flex items-center justify-between p-3 bg-purple-600 text-white",children:[a.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[a.jsx(Br,{size:18})," Proof of Delivery"]}),a.jsx("button",{onClick:()=>k(null),children:a.jsx(yt,{size:22})})]}),a.jsx("div",{className:"p-4",children:a.jsx("img",{src:w,alt:"Proof of Delivery",className:"w-full max-h-[70vh] object-contain rounded-lg"})})]})})]})}function ive(){const[e,t]=m.useState([]),[r,s]=m.useState([]),[n,i]=m.useState(null),[l,o]=m.useState(!0),[c,u]=m.useState(null),[d,h]=m.useState("vans"),[f,x]=m.useState("today"),[p,g]=m.useState(""),[y,v]=m.useState(""),[j,b]=m.useState("");m.useEffect(()=>{w()},[]);const w=async()=>{try{o(!0);const[W,Q,H]=await Promise.all([cm.getVanCash(),cm.getOverview(),cm.getDeposits()]);t(W.data),i(Q.data),s(H.data)}catch(W){console.error("Failed to load data:",W)}finally{o(!1)}},k=async(W,Q)=>{try{u(W),await cm.updateDepositStatus(W,{status:Q}),await w()}catch(H){console.error("Failed to update deposit status:",H),alert("Failed to update deposit status")}finally{u(null)}},N=()=>{const W=new Date,Q=new Date(W.getFullYear(),W.getMonth(),W.getDate());switch(f){case"today":return Q;case"week":return new Date(Q.getTime()-7*24*60*60*1e3);case"month":return new Date(Q.getFullYear(),Q.getMonth(),1);case"year":return new Date(Q.getFullYear(),0,1);default:return null}},S=r.filter(W=>{const Q=N();return!(Q&&new Date(W.depositDate)<Q||p&&W.driverId.toString()!==p||j&&W.status!==j)}),_=e.filter(W=>{var Q;return!(y&&W.vanId.toString()!==y||p&&((Q=W.driverId)==null?void 0:Q.toString())!==p)}),O=Array.from(new Set(e.filter(W=>W.driverId).map(W=>JSON.stringify({id:W.driverId,name:W.driverName})))).map(W=>JSON.parse(W)),E=e.map(W=>({id:W.vanId,name:W.vanName})),R=_.reduce((W,Q)=>W+Q.currentBalance,0),C=S.reduce((W,Q)=>W+Q.amount,0),I=S.filter(W=>W.status==="confirmed").reduce((W,Q)=>W+Q.amount,0),ne=S.filter(W=>W.status==="pending").reduce((W,Q)=>W+Q.amount,0);return l?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx(vt,{className:"animate-spin",size:32})}):a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Van Cash Management"}),a.jsxs("button",{onClick:w,className:"flex items-center gap-2 px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600",children:[a.jsx(Mj,{size:18})," Refresh"]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-6",children:[a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-5",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-3 bg-emerald-100 rounded-xl",children:a.jsx(da,{className:"text-emerald-600",size:24})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Cash in Vans"}),a.jsxs("p",{className:"text-2xl font-bold text-emerald-600",children:["$",R.toFixed(2)]})]})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-5",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-3 bg-blue-100 rounded-xl",children:a.jsx(nx,{className:"text-blue-600",size:24})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Total Deposits"}),a.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:["$",C.toFixed(2)]})]})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-5",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-3 bg-amber-100 rounded-xl",children:a.jsx(Up,{className:"text-amber-600",size:24})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Pending Deposits"}),a.jsxs("p",{className:"text-2xl font-bold text-amber-600",children:["$",ne.toFixed(2)]})]})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-5",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-3 bg-green-100 rounded-xl",children:a.jsx(Jt,{className:"text-green-600",size:24})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Confirmed Deposits"}),a.jsxs("p",{className:"text-2xl font-bold text-green-600",children:["$",I.toFixed(2)]})]})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-5",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-3 bg-purple-100 rounded-xl",children:a.jsx(On,{className:"text-purple-600",size:24})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Active Vans"}),a.jsx("p",{className:"text-2xl font-bold text-purple-600",children:e.length})]})]})})]}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 mb-4",children:a.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(l2,{size:18,className:"text-gray-500"}),a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Filters:"})]}),a.jsxs("select",{value:f,onChange:W=>x(W.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-emerald-500",children:[a.jsx("option",{value:"today",children:"Today"}),a.jsx("option",{value:"week",children:"Last 7 Days"}),a.jsx("option",{value:"month",children:"This Month"}),a.jsx("option",{value:"year",children:"This Year"}),a.jsx("option",{value:"all",children:"All Time"})]}),a.jsxs("select",{value:p,onChange:W=>g(W.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-emerald-500",children:[a.jsx("option",{value:"",children:"All Drivers"}),O.map(W=>a.jsx("option",{value:W.id,children:W.name},W.id))]}),d==="vans"&&a.jsxs("select",{value:y,onChange:W=>v(W.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-emerald-500",children:[a.jsx("option",{value:"",children:"All Vans"}),E.map(W=>a.jsx("option",{value:W.id,children:W.name},W.id))]}),d==="deposits"&&a.jsxs("select",{value:j,onChange:W=>b(W.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-emerald-500",children:[a.jsx("option",{value:"",children:"All Status"}),a.jsx("option",{value:"pending",children:"Pending"}),a.jsx("option",{value:"confirmed",children:"Confirmed"}),a.jsx("option",{value:"rejected",children:"Rejected"})]})]})}),a.jsxs("div",{className:"flex gap-2 mb-4",children:[a.jsxs("button",{onClick:()=>h("vans"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${d==="vans"?"bg-emerald-500 text-white":"bg-white text-gray-600 hover:bg-gray-100"}`,children:["Van Cash (",_.length,")"]}),a.jsxs("button",{onClick:()=>h("deposits"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${d==="deposits"?"bg-emerald-500 text-white":"bg-white text-gray-600 hover:bg-gray-100"}`,children:["Deposits (",S.length,")",S.filter(W=>W.status==="pending").length>0&&a.jsxs("span",{className:"ml-2 px-2 py-0.5 bg-amber-500 text-white text-xs rounded-full",children:[S.filter(W=>W.status==="pending").length," pending"]})]})]}),d==="vans"&&a.jsxs("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden",children:[a.jsx("div",{className:"p-4 border-b bg-gray-50",children:a.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Van Cash Details"})}),a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Van"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Driver"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Current Cash"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Max Cash"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Usage"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Status"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Last Updated"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:_.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"px-4 py-8 text-center text-gray-500",children:"No van cash data found"})}):_.map(W=>{const Q=W.maxCash>0?W.currentBalance/W.maxCash*100:0;return a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(On,{size:18,className:"text-gray-400"}),a.jsx("span",{className:"font-medium",children:W.vanName})]})}),a.jsx("td",{className:"px-4 py-3",children:W.driverName||a.jsx("span",{className:"text-gray-400",children:"Unassigned"})}),a.jsxs("td",{className:"px-4 py-3 font-bold text-emerald-600",children:["$",W.currentBalance.toFixed(3)]}),a.jsxs("td",{className:"px-4 py-3 text-gray-600",children:["$",W.maxCash.toFixed(3)]}),a.jsx("td",{className:"px-4 py-3",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"flex-1 h-2 bg-gray-200 rounded-full overflow-hidden max-w-[100px]",children:a.jsx("div",{className:`h-full rounded-full ${Q>80?"bg-red-500":Q>50?"bg-amber-500":"bg-emerald-500"}`,style:{width:`${Math.min(Q,100)}%`}})}),a.jsxs("span",{className:"text-xs text-gray-500",children:[Q.toFixed(0),"%"]})]})}),a.jsx("td",{className:"px-4 py-3",children:W.currentBalance>W.maxCash*.8?a.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-700",children:"Needs Deposit"}):W.currentBalance>W.maxCash*.5?a.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-amber-100 text-amber-700",children:"Medium"}):a.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-emerald-100 text-emerald-700",children:"Normal"})}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:new Date(W.lastUpdated).toLocaleDateString()})]},W.vanId)})})]})]}),d==="deposits"&&a.jsxs("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden",children:[a.jsx("div",{className:"p-4 border-b bg-gray-50",children:a.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Driver Deposits"})}),a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Deposit #"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Driver"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Amount"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Type"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Date"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Status"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:S.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"px-4 py-8 text-center text-gray-500",children:"No deposits found"})}):S.map(W=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 font-medium",children:W.depositNumber}),a.jsx("td",{className:"px-4 py-3",children:W.driverName}),a.jsxs("td",{className:"px-4 py-3 font-bold text-emerald-600",children:["$",W.amount.toFixed(2)]}),a.jsx("td",{className:"px-4 py-3",children:a.jsxs("div",{className:"flex items-center gap-2",children:[W.depositType==="bank"?a.jsx(sW,{size:16,className:"text-blue-500"}):a.jsx(gl,{size:16,className:"text-amber-500"}),a.jsx("span",{className:"capitalize",children:W.depositType}),W.bankName&&a.jsxs("span",{className:"text-gray-400 text-sm",children:["(",W.bankName,")"]})]})}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:new Date(W.depositDate).toLocaleDateString()}),a.jsx("td",{className:"px-4 py-3",children:W.status==="pending"?a.jsxs("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-amber-100 text-amber-700 flex items-center gap-1 w-fit",children:[a.jsx(Up,{size:12})," Pending"]}):W.status==="confirmed"?a.jsxs("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-emerald-100 text-emerald-700 flex items-center gap-1 w-fit",children:[a.jsx(Jt,{size:12})," Confirmed"]}):a.jsxs("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-700 flex items-center gap-1 w-fit",children:[a.jsx(yt,{size:12})," Rejected"]})}),a.jsx("td",{className:"px-4 py-3",children:W.status==="pending"&&a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>k(W.id,"confirmed"),disabled:c===W.id,className:"p-2 bg-emerald-100 text-emerald-600 rounded-lg hover:bg-emerald-200 disabled:opacity-50",title:"Confirm",children:c===W.id?a.jsx(vt,{size:16,className:"animate-spin"}):a.jsx(Jt,{size:16})}),a.jsx("button",{onClick:()=>k(W.id,"rejected"),disabled:c===W.id,className:"p-2 bg-red-100 text-red-600 rounded-lg hover:bg-red-200 disabled:opacity-50",title:"Reject",children:a.jsx(yt,{size:16})})]})})]},W.id))})]})]})]})}function lve(){const e=Hd(),[t,r]=m.useState("suppliers"),[s,n]=m.useState([]),[i,l]=m.useState([]),[o,c]=m.useState([]),[u,d]=m.useState([]),[h,f]=m.useState([]),[x,p]=m.useState([]),[g,y]=m.useState([]),[v,j]=m.useState([]),[b,w]=m.useState([]),[k,N]=m.useState([]),[S,_]=m.useState(!0),[O,E]=m.useState(!1),[R,C]=m.useState("name"),[I,ne]=m.useState("asc"),[W,Q]=m.useState(""),[H,K]=m.useState(""),[q,ge]=m.useState(""),[G,B]=m.useState(""),[se,L]=m.useState(""),[Z,F]=m.useState(""),[he,ye]=m.useState(""),[z,A]=m.useState(""),[de,D]=m.useState(""),[ze,Fe]=m.useState(!1),[ct,$e]=m.useState(!1),[We,Bt]=m.useState(!1),[Ee,it]=m.useState(!1),[we,et]=m.useState(!1),[Ge,Nt]=m.useState(null),[Rt,pr]=m.useState(!1),[Zt,er]=m.useState(null),[ue,Le]=m.useState(null),[Je,Xe]=m.useState(!1),[le,Me]=m.useState(!1),[ut,ee]=m.useState(null),[ve,xe]=m.useState(!1),[oe,Ie]=m.useState(!1),[me,ht]=m.useState(null),[At,Er]=m.useState(!1),[or,Gt]=m.useState(!1),[zt,ma]=m.useState(null),[Or,_r]=m.useState(!1),[Is,Jr]=m.useState(null),[na,Os]=m.useState(!1),[gr,V]=m.useState("on_account"),[J,X]=m.useState(0),[te,re]=m.useState(""),[ae,Ne]=m.useState(!1),[Be,Se]=m.useState("new"),[Pe,pe]=m.useState(!1),[qe,lt]=m.useState(null),[ft,Ze]=m.useState([]),[dt,Ot]=m.useState([]),[Y,De]=m.useState([]),[at,st]=m.useState(!1),[Mt,Lt]=m.useState({showSummary:!0,showInvoices:!0,showPayments:!0,showProducts:!0,showPurchaseOrders:!0}),[pt,Ut]=m.useState({name:"",companyName:"",phone:"",email:"",city:"",country:"",paymentTerms:"",creditLimit:0,balance:0,creditBalance:0,notes:"",isActive:!0,isManufacturer:!1}),[qt,Ca]=m.useState({supplierId:"",paymentDate:new Date().toISOString().split("T")[0],method:"Cash",amount:0,reference:"",notes:""}),[nr,Ea]=m.useState({supplierId:"",invoiceDate:new Date().toISOString().split("T")[0],dueDate:"",shippingCost:0,otherCharges:0,reference:"",notes:""}),[Dr,Ds]=m.useState([{productId:0,warehouseId:null,unitType:"Piece",quantity:1,unitPrice:0,discountPercent:0,taxPercent:0}]),[Ue,M]=m.useState({sku:"",barcode:"",boxBarcode:"",name:"",description:"",categoryId:"",baseUnit:"Piece",secondUnit:"Box",unitsPerSecond:12,currency:"USD",defaultWarehouseId:"",retailPrice:0,wholesalePrice:0,superWholesalePrice:0,costPrice:0,boxRetailPrice:0,boxWholesalePrice:0,boxSuperWholesalePrice:0,boxCostPrice:0,quantity:0,quantityBox:0,lowStockAlert:10,lowStockAlertBox:2,isActive:!0}),[je,fe]=m.useState({supplierId:"",poDate:new Date().toISOString().split("T")[0],expectedDate:"",reference:"",notes:""}),[Ce,Qe]=m.useState([{productId:0,productName:"",quantity:1}]),[_e,Vt]=m.useState(""),[Qt,U]=m.useState(null);m.useEffect(()=>{Ke()},[]),m.useEffect(()=>{le&&Ue.unitsPerSecond>0&&M(P=>({...P,quantityBox:P.quantity*P.unitsPerSecond,boxCostPrice:parseFloat((P.costPrice/P.unitsPerSecond).toFixed(3)),boxRetailPrice:parseFloat((P.retailPrice/P.unitsPerSecond).toFixed(3)),boxWholesalePrice:parseFloat((P.wholesalePrice/P.unitsPerSecond).toFixed(3)),boxSuperWholesalePrice:parseFloat((P.superWholesalePrice/P.unitsPerSecond).toFixed(3))}))},[le,Ue.quantity,Ue.costPrice,Ue.retailPrice,Ue.wholesalePrice,Ue.superWholesalePrice,Ue.unitsPerSecond]);const Ke=async()=>{try{_(!0);const[P,ke,be,Re,kt,Sr,Ct,Pr,It]=await Promise.all([Vr.getAll(),Vr.getInvoices(),Vr.getPayments(),br.getAll(),Ks.getAll(),il.getAll(),Vr.getPurchaseOrders(),ku.getAll({activeOnly:!0}),Kc.getAll()]);l(P.data),c(ke.data),f(be.data),p(Re.data),y(kt.data),j(Sr.data||[]),n(Ct.data||[]),N(It.data||[]),w(Pr.data||[])}catch(P){console.error("Failed to load data:",P)}finally{_(!1)}},rt=async()=>{try{const P={};W&&(P.search=W),H&&(P.isActive=H==="active");const ke=await Vr.getAll(P);l(ke.data)}catch(P){console.error("Failed to load suppliers:",P)}},_t=async()=>{try{const P={};q&&(P.startDate=q),G&&(P.endDate=G),se&&(P.supplierId=se),Z&&(P.paymentStatus=Z);const ke=await Vr.getInvoices(P);c(ke.data);const be={};if(q&&(be.startDate=q),G&&(be.endDate=G),Z&&(be.paymentStatus=Z),se){const Re=i.find(kt=>kt.id===parseInt(se));if(Re!=null&&Re.isManufacturer){be.supplierId=se;const kt=await dl.getAll(be);d(kt||[])}else d([])}else{const Re=await dl.getAll(be);d(Re||[])}}catch(P){console.error("Failed to load invoices:",P)}},Fr=async P=>{pr(!0),et(!0);try{const ke=await Vr.getInvoice(P);Nt(ke.data)}catch(ke){console.error("Failed to load invoice:",ke),alert("Failed to load invoice details")}finally{pr(!1)}},Xt=async()=>{try{const P={};q&&(P.startDate=q),G&&(P.endDate=G),se&&(P.supplierId=se),he&&(P.method=he);const ke=await Vr.getPayments(P);f(ke.data)}catch(P){console.error("Failed to load payments:",P)}};m.useEffect(()=>{!S&&t==="suppliers"&&rt()},[W,H]),m.useEffect(()=>{!S&&t==="invoices"&&_t()},[q,G,se,Z]),m.useEffect(()=>{!S&&t==="payments"&&Xt()},[q,G,se,he]),m.useEffect(()=>{!S&&t==="po"&&Rr()},[q,G,se,z]);const Rr=async()=>{try{const P={};q&&(P.startDate=q),G&&(P.endDate=G),se&&(P.supplierId=se),z&&(P.status=z);const ke=await Vr.getPurchaseOrders(P);n(ke.data)}catch(P){console.error("Failed to load purchase orders:",P)}},Yt=async P=>{Er(!0),Ie(!0);try{const ke=await Vr.getPurchaseOrder(P);ht(ke.data)}catch(ke){console.error("Failed to load PO:",ke),alert("Failed to load purchase order details")}finally{Er(!1)}},gt=()=>{fe({supplierId:"",poDate:new Date().toISOString().split("T")[0],expectedDate:"",reference:"",notes:""}),Qe([{productId:0,productName:"",quantity:1}])},tr=()=>{Qe([...Ce,{productId:0,productName:"",quantity:1}])},Wr=P=>{Ce.length>1&&Qe(Ce.filter((ke,be)=>be!==P))},gn=(P,ke,be)=>{const Re=[...Ce];if(Re[P]={...Re[P],[ke]:be},ke==="productId"&&be){const kt=x.find(Sr=>Sr.id===parseInt(be));kt&&(Re[P].productName=kt.name)}Qe(Re)},kl=async P=>{var ke,be;if(P.preventDefault(),!je.supplierId||Ce.some(Re=>!Re.productId&&!Re.productName)){alert("Please select supplier and add products");return}E(!0);try{await Vr.createPurchaseOrder({supplierId:parseInt(je.supplierId),poDate:je.poDate,expectedDate:je.expectedDate||null,reference:je.reference,notes:je.notes,items:Ce.filter(Re=>Re.productId>0||Re.productName)}),xe(!1),gt(),Rr()}catch(Re){alert(((be=(ke=Re.response)==null?void 0:ke.data)==null?void 0:be.message)||"Failed to save purchase order")}finally{E(!1)}},eu=async P=>{var ke,be;if(confirm("Send this purchase order to supplier?"))try{await Vr.updatePurchaseOrderStatus(P,"sent"),Rr()}catch(Re){alert(((be=(ke=Re.response)==null?void 0:ke.data)==null?void 0:be.message)||"Failed to send PO")}},tu=async P=>{var ke,be;if(confirm("Delete this purchase order?"))try{await Vr.deletePurchaseOrder(P),Rr()}catch(Re){alert(((be=(ke=Re.response)==null?void 0:ke.data)==null?void 0:be.message)||"Failed to delete PO")}},$v=P=>{const ke=i.find(Re=>Re.id===P.supplierId),be=window.open("","_blank");be&&(be.document.write(`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Purchase Order - ${P.poNumber}</title>
        <style>
          body { font-family: Arial, sans-serif; padding: 40px; max-width: 800px; margin: 0 auto; }
          h1 { color: #003366; margin-bottom: 5px; }
          .header { display: flex; justify-content: space-between; margin-bottom: 30px; }
          .info { margin-bottom: 20px; }
          .info p { margin: 5px 0; }
          table { width: 100%; border-collapse: collapse; margin: 20px 0; }
          th, td { border: 1px solid #ddd; padding: 10px; text-align: left; }
          th { background: #f5f5f5; }
          .notes { margin-top: 30px; padding: 15px; background: #f9f9f9; border-radius: 5px; }
          @media print { body { padding: 20px; } }
        </style>
      </head>
      <body>
        <div class="header">
          <div>
            <h1>Purchase Order</h1>
            <p><strong>${P.poNumber}</strong></p>
          </div>
          <div style="text-align: right;">
            <p><strong>Date:</strong> ${new Date(P.poDate).toLocaleDateString()}</p>
            ${P.expectedDate?`<p><strong>Expected:</strong> ${new Date(P.expectedDate).toLocaleDateString()}</p>`:""}
          </div>
        </div>
        
        <div class="info">
          <h3>Supplier</h3>
          <p><strong>${(ke==null?void 0:ke.name)||P.supplierName}</strong></p>
          ${ke!=null&&ke.companyName?`<p>${ke.companyName}</p>`:""}
          ${ke!=null&&ke.phone?`<p>Phone: ${ke.phone}</p>`:""}
          ${ke!=null&&ke.email?`<p>Email: ${ke.email}</p>`:""}
        </div>
        
        <h3>Items Requested</h3>
        <table>
          <thead>
            <tr>
              <th>#</th>
              <th>Product</th>
              <th>Quantity</th>
            </tr>
          </thead>
          <tbody>
            ${P.items.map((Re,kt)=>`
              <tr>
                <td>${kt+1}</td>
                <td>${Re.productName||"Custom Product"}</td>
                <td>${Re.quantity}</td>
              </tr>
            `).join("")}
          </tbody>
        </table>
        
        ${P.notes?`<div class="notes"><strong>Notes:</strong> ${P.notes}</div>`:""}
        
        <p style="margin-top: 40px; color: #666; font-size: 12px;">
          Generated on ${new Date().toLocaleString()}
        </p>
      </body>
      </html>
    `),be.document.close(),be.print())},Ux=P=>{const ke=i.find(Ct=>Ct.id===P.supplierId);let be=`Purchase Order Export

`;be+=`PO Number,${P.poNumber}
`,be+=`Date,${new Date(P.poDate).toLocaleDateString()}
`,be+=`Supplier,${(ke==null?void 0:ke.name)||P.supplierName}
`,be+=`Status,${P.status}

`,be+=`Items
`,be+=`#,Product,Quantity
`,P.items.forEach((Ct,Pr)=>{be+=`${Pr+1},"${Ct.productName||"Custom Product"}",${Ct.quantity}
`}),P.notes&&(be+=`
Notes,"${P.notes}"
`);const Re=new Blob([be],{type:"text/csv;charset=utf-8;"}),kt=URL.createObjectURL(Re),Sr=document.createElement("a");Sr.href=kt,Sr.download=`PO-${P.poNumber}.csv`,Sr.click(),URL.revokeObjectURL(kt)},Cl=P=>{R===P?ne(I==="asc"?"desc":"asc"):(C(P),ne("asc"))},pa=[...i].sort((P,ke)=>{let be=P[R],Re=ke[R];return typeof be=="string"&&(be=be.toLowerCase()),typeof Re=="string"&&(Re=Re.toLowerCase()),be<Re?I==="asc"?-1:1:be>Re?I==="asc"?1:-1:0}),El=()=>Ut({name:"",companyName:"",phone:"",email:"",city:"",country:"",paymentTerms:"",creditLimit:0,balance:0,creditBalance:0,notes:"",isActive:!0,isManufacturer:!1}),Bv=P=>{er(P),Ut({name:P.name,companyName:P.companyName||"",phone:P.phone||"",email:P.email||"",city:P.city||"",country:P.country||"",paymentTerms:P.paymentTerms||"",creditLimit:P.creditLimit,balance:P.balance,creditBalance:P.creditBalance||0,notes:P.notes||"",isActive:P.isActive,isManufacturer:P.isManufacturer}),Fe(!0)},zv=async P=>{var ke,be;if(P.preventDefault(),!!pt.name.trim()){E(!0);try{Zt?await Vr.update(Zt.id,pt):await Vr.create(pt),Fe(!1),El(),er(null),rt()}catch(Re){alert(((be=(ke=Re.response)==null?void 0:ke.data)==null?void 0:be.message)||"Failed to save supplier")}finally{E(!1)}}},Uv=async P=>{var ke,be;if(P.preventDefault(),!(!qt.supplierId||qt.amount<=0)){E(!0);try{await Vr.createPayment({...qt,supplierId:parseInt(qt.supplierId)}),$e(!1),Ca({supplierId:"",paymentDate:new Date().toISOString().split("T")[0],method:"Cash",amount:0,reference:"",notes:""}),Xt(),rt()}catch(Re){alert(((be=(ke=Re.response)==null?void 0:ke.data)==null?void 0:be.message)||"Failed to save payment")}finally{E(!1)}}},[yn,Co]=m.useState({paymentDate:new Date().toISOString().split("T")[0],method:"Cash",amount:0,reference:"",notes:""}),Wv=P=>{ma(P);const ke=P.total-(P.paidAmount||0);Co({paymentDate:new Date().toISOString().split("T")[0],method:"Cash",amount:ke>0?ke:0,reference:P.invoiceNumber,notes:""}),Gt(!0)},T=async P=>{var ke,be;if(P.preventDefault(),!(!zt||yn.amount<=0)){E(!0);try{await Vr.createPayment({supplierId:zt.supplierId,invoiceId:zt.id,...yn}),Gt(!1),ma(null),Xt(),_t(),rt()}catch(Re){alert(((be=(ke=Re.response)==null?void 0:ke.data)==null?void 0:be.message)||"Failed to settle payment")}finally{E(!1)}}},[Ae,nt]=m.useState({paymentDate:"",method:"Cash",amount:0,reference:"",notes:""}),Pt=P=>{Jr(P),nt({paymentDate:P.paymentDate.split("T")[0],method:P.method,amount:P.amount,reference:P.reference||"",notes:P.notes||""}),_r(!0)},fr=async P=>{var ke,be;if(P.preventDefault(),!(!Is||Ae.amount<=0)){E(!0);try{await Vr.updatePayment(Is.id,Ae),_r(!1),Jr(null),Xt(),_t(),rt()}catch(Re){alert(((be=(ke=Re.response)==null?void 0:ke.data)==null?void 0:be.message)||"Failed to update payment")}finally{E(!1)}}},Dt=async P=>{var ke,be;if(confirm("Are you sure you want to delete this payment?"))try{await Vr.deletePayment(P),Xt(),_t(),rt()}catch(Re){alert(((be=(ke=Re.response)==null?void 0:ke.data)==null?void 0:be.message)||"Failed to delete payment")}},ls=()=>{Ea({supplierId:"",invoiceDate:new Date().toISOString().split("T")[0],dueDate:"",shippingCost:0,otherCharges:0,reference:"",notes:""}),Ds([{productId:0,warehouseId:null,unitType:"Piece",quantity:1,unitPrice:0,discountPercent:0,taxPercent:0}])},Pl=()=>{Ds([...Dr,{productId:0,warehouseId:null,unitType:"Piece",quantity:1,unitPrice:0,discountPercent:0,taxPercent:0}])},Yi=P=>{Dr.length>1&&Ds(Dr.filter((ke,be)=>be!==P))},ga=(P,ke,be)=>{const Re=[...Dr];if(Re[P]={...Re[P],[ke]:be},ke==="productId"&&be){const kt=x.find(Sr=>Sr.id===parseInt(be));kt&&(Re[P].unitPrice=kt.costPrice,Re[P].warehouseId=kt.defaultWarehouseId||null,Re[P].unitType=kt.baseUnit||"Piece")}if(ke==="unitType"&&be){const kt=x.find(Sr=>Sr.id===Re[P].productId);if(kt){const Sr=Re[P].quantity;be===kt.baseUnit?(Re[P].unitPrice=kt.costPrice,kt.unitsPerSecond>0&&(Re[P].quantity=Math.floor(Sr/kt.unitsPerSecond)||1)):be===kt.secondUnit&&(Re[P].unitPrice=kt.unitsPerSecond>0?parseFloat((kt.costPrice/kt.unitsPerSecond).toFixed(4)):kt.boxCostPrice||0,kt.unitsPerSecond>0&&(Re[P].quantity=Sr*kt.unitsPerSecond))}}Ds(Re)},za=P=>{const ke=P.quantity*P.unitPrice,be=ke*(P.discountPercent/100),Re=ke-be,kt=Re*(P.taxPercent/100);return Re+kt},ru=()=>Dr.reduce((P,ke)=>P+za(ke),0),ki=()=>ru()+nr.shippingCost+nr.otherCharges,Tt=async P=>{if(P.preventDefault(),!nr.supplierId||Dr.some(ke=>!ke.productId)){alert("Please select supplier and products");return}V("on_account"),X(ki()),Os(!0)},Vv=async()=>{var P,ke;E(!0);try{const be=await Vr.createInvoice({supplierId:parseInt(nr.supplierId),invoiceDate:nr.invoiceDate,dueDate:nr.dueDate||null,shippingCost:nr.shippingCost,otherCharges:nr.otherCharges,reference:nr.reference,notes:nr.notes,useCredit:gr==="on_account",items:Dr.filter(kt=>kt.productId>0)}),Re=gr==="cash"?ki():gr==="split"?J:0;Re>0&&await Vr.createPayment({supplierId:parseInt(nr.supplierId),invoiceId:be.data.id,paymentDate:nr.invoiceDate,method:"Cash",amount:Re,reference:nr.reference,notes:`Payment for invoice - ${gr==="cash"?"Full Cash":"Split Payment"}`}),Os(!1),Bt(!1),ls(),_t(),Xt(),rt()}catch(be){alert(((ke=(P=be.response)==null?void 0:P.data)==null?void 0:ke.message)||"Failed to save invoice")}finally{E(!1)}},au=()=>{M({sku:"",barcode:"",boxBarcode:"",name:"",description:"",categoryId:"",baseUnit:"Piece",secondUnit:"Box",unitsPerSecond:12,currency:"USD",defaultWarehouseId:"",retailPrice:0,wholesalePrice:0,superWholesalePrice:0,costPrice:0,boxRetailPrice:0,boxWholesalePrice:0,boxSuperWholesalePrice:0,boxCostPrice:0,quantity:0,quantityBox:0,lowStockAlert:10,lowStockAlertBox:2,isActive:!0}),Xe(!1)},$L=P=>{Le(P),ee(null),au(),re(""),Ne(!0),Se("new"),it(!0)},BL=P=>{if(re(P),!P.trim())return;const ke=x.find(be=>be.barcode===P||be.boxBarcode===P||be.sku.toLowerCase()===P.toLowerCase());if(ke&&ue!==null){Hv(ke),ee(ke.id),Se("existing"),Ne(!1);return}ke&&(Hv(ke),ee(ke.id),Se("existing"))},Hv=P=>{var ke,be;M({sku:P.sku||"",barcode:P.barcode||"",boxBarcode:P.boxBarcode||"",name:P.name,description:"",categoryId:((ke=P.categoryId)==null?void 0:ke.toString())||"",baseUnit:P.baseUnit||"Piece",secondUnit:P.secondUnit||"Box",unitsPerSecond:P.unitsPerSecond||12,currency:P.currency||"USD",defaultWarehouseId:((be=P.defaultWarehouseId)==null?void 0:be.toString())||"",retailPrice:P.retailPrice||0,wholesalePrice:P.wholesalePrice||0,superWholesalePrice:P.superWholesalePrice||0,costPrice:P.costPrice||0,boxRetailPrice:P.boxRetailPrice||0,boxWholesalePrice:P.boxWholesalePrice||0,boxSuperWholesalePrice:P.boxSuperWholesalePrice||0,boxCostPrice:P.boxCostPrice||0,quantity:0,quantityBox:0,lowStockAlert:P.lowStockAlert||10,lowStockAlertBox:P.lowStockAlertBox||2,isActive:P.isActive}),Xe(!0),Me(!!P.secondUnit)},zL=P=>{const ke=x.find(be=>be.id===P);if(ke){if(ue!==null){const be=[...Dr];be[ue]={...be[ue],productId:ke.id,unitPrice:ke.costPrice,warehouseId:ke.defaultWarehouseId||null,unitType:ke.baseUnit||"Piece"},Ds(be),it(!1),Le(null),Ne(!1),re("");return}Hv(ke),ee(P),Se("existing"),Ne(!1)}},UL=()=>{au(),ee(null),Se("new"),Ne(!1)},i3=x.filter(P=>{var be,Re;if(!te.trim())return!0;const ke=te.toLowerCase();return P.name.toLowerCase().includes(ke)||P.sku.toLowerCase().includes(ke)||((be=P.barcode)==null?void 0:be.toLowerCase().includes(ke))||((Re=P.boxBarcode)==null?void 0:Re.toLowerCase().includes(ke))}),WL=(P,ke)=>{var Sr,Ct;const be=x.find(Pr=>Pr.id===ke);if(!be)return;const Re=Dr[P],kt=(Re==null?void 0:Re.quantity)||1;Le(P),ee(ke),M({sku:be.sku||"",barcode:be.barcode||"",boxBarcode:be.boxBarcode||"",name:be.name,description:"",categoryId:((Sr=be.categoryId)==null?void 0:Sr.toString())||"",baseUnit:be.baseUnit||"Piece",secondUnit:be.secondUnit||"Box",unitsPerSecond:be.unitsPerSecond||12,currency:be.currency||"USD",defaultWarehouseId:((Ct=be.defaultWarehouseId)==null?void 0:Ct.toString())||"",retailPrice:be.retailPrice||0,wholesalePrice:be.wholesalePrice||0,superWholesalePrice:be.superWholesalePrice||0,costPrice:be.costPrice||0,boxRetailPrice:be.boxRetailPrice||0,boxWholesalePrice:be.boxWholesalePrice||0,boxSuperWholesalePrice:be.boxSuperWholesalePrice||0,boxCostPrice:be.boxCostPrice||0,quantity:kt,quantityBox:0,lowStockAlert:be.lowStockAlert||10,lowStockAlertBox:be.lowStockAlertBox||2,isActive:be.isActive}),Xe(!0),Me(!!be.secondUnit),it(!0)},VL=async P=>{var ke,be;if(P.preventDefault(),!!Ue.name.trim()){E(!0);try{if(ut){if(await br.update(ut,{...Ue,categoryId:Ue.categoryId?parseInt(Ue.categoryId):null,defaultWarehouseId:Ue.defaultWarehouseId?parseInt(Ue.defaultWarehouseId):null}),p(Re=>Re.map(kt=>kt.id===ut?{...kt,name:Ue.name,sku:Ue.sku,barcode:Ue.barcode||null,boxBarcode:Ue.boxBarcode||null,categoryId:Ue.categoryId?parseInt(Ue.categoryId):null,baseUnit:Ue.baseUnit,secondUnit:Ue.secondUnit,unitsPerSecond:Ue.unitsPerSecond,currency:Ue.currency,defaultWarehouseId:Ue.defaultWarehouseId?parseInt(Ue.defaultWarehouseId):null,retailPrice:Ue.retailPrice,wholesalePrice:Ue.wholesalePrice,superWholesalePrice:Ue.superWholesalePrice,costPrice:Ue.costPrice,boxRetailPrice:Ue.boxRetailPrice,boxWholesalePrice:Ue.boxWholesalePrice,boxSuperWholesalePrice:Ue.boxSuperWholesalePrice,boxCostPrice:Ue.boxCostPrice,lowStockAlert:Ue.lowStockAlert,lowStockAlertBox:Ue.lowStockAlertBox,isActive:Ue.isActive}:kt)),ue!==null){const Re=[...Dr];Re[ue]={...Re[ue],productId:ut,unitPrice:Ue.costPrice,unitType:Ue.baseUnit,warehouseId:Ue.defaultWarehouseId?parseInt(Ue.defaultWarehouseId):null,quantity:Ue.quantity||1},Ds(Re)}}else{const kt=(await br.create({...Ue,categoryId:Ue.categoryId?parseInt(Ue.categoryId):null,defaultWarehouseId:Ue.defaultWarehouseId?parseInt(Ue.defaultWarehouseId):null})).data;if(p(Sr=>[...Sr,{id:kt.id,name:Ue.name,sku:Ue.sku,barcode:Ue.barcode||null,boxBarcode:Ue.boxBarcode||null,categoryId:Ue.categoryId?parseInt(Ue.categoryId):null,baseUnit:Ue.baseUnit,secondUnit:Ue.secondUnit,unitsPerSecond:Ue.unitsPerSecond,currency:Ue.currency,defaultWarehouseId:Ue.defaultWarehouseId?parseInt(Ue.defaultWarehouseId):null,retailPrice:Ue.retailPrice,wholesalePrice:Ue.wholesalePrice,superWholesalePrice:Ue.superWholesalePrice,costPrice:Ue.costPrice,boxRetailPrice:Ue.boxRetailPrice,boxWholesalePrice:Ue.boxWholesalePrice,boxSuperWholesalePrice:Ue.boxSuperWholesalePrice,boxCostPrice:Ue.boxCostPrice,lowStockAlert:Ue.lowStockAlert,lowStockAlertBox:Ue.lowStockAlertBox,isActive:Ue.isActive}]),ue!==null){const Sr=[...Dr];Sr[ue]={...Sr[ue],productId:kt.id,unitPrice:Ue.costPrice,unitType:Ue.baseUnit,warehouseId:Ue.defaultWarehouseId?parseInt(Ue.defaultWarehouseId):null,quantity:Ue.quantity||1},Ds(Sr)}}it(!1),au(),Le(null),ee(null)}catch(Re){alert(((be=(ke=Re.response)==null?void 0:ke.data)==null?void 0:be.message)||(ut?"Failed to update product":"Failed to create product"))}finally{E(!1)}}},HL=async P=>{lt(P),pe(!0),st(!0);try{const[ke,be,Re]=await Promise.all([Vr.getInvoices({supplierId:P.id}),Vr.getPayments({supplierId:P.id}),Vr.getPurchaseOrders({supplierId:P.id})]);Ze(ke.data),Ot(be.data),De(Re.data||[])}catch(ke){console.error("Failed to load report data:",ke)}finally{st(!1)}},Fs=P=>P.toFixed(3),K0=P=>new Date(P).toLocaleDateString(),qL=()=>{if(!qe)return;ft.forEach(It=>{});const P=ft.reduce((It,os)=>It+os.total,0),ke=ft.reduce((It,os)=>It+os.paidAmount,0),be=dt.reduce((It,os)=>It+os.amount,0),Re=Y.reduce((It,os)=>It+os.total,0),Sr=ft.filter(It=>It.paymentStatus!=="paid").reduce((It,os)=>It+(os.total-os.paidAmount),0),Ct=window.open("","_blank","width=1000,height=800");if(!Ct){alert("Please allow popups to print report");return}const Pr=`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Supplier Report - ${qe.name}</title>
        <style>
          * { margin: 0; padding: 0; box-sizing: border-box; }
          body { font-family: Arial, sans-serif; font-size: 12px; padding: 20px; }
          .header { text-align: center; margin-bottom: 20px; border-bottom: 2px solid #333; padding-bottom: 10px; }
          .header h1 { font-size: 24px; margin-bottom: 5px; }
          .header p { color: #666; }
          .supplier-info { background: #f5f5f5; padding: 15px; border-radius: 8px; margin-bottom: 20px; }
          .supplier-info h2 { font-size: 18px; margin-bottom: 10px; }
          .supplier-info .grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; }
          .supplier-info .item { }
          .supplier-info .label { font-size: 10px; color: #666; text-transform: uppercase; }
          .supplier-info .value { font-weight: bold; }
          .summary-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-bottom: 20px; }
          .summary-card { border: 1px solid #ddd; padding: 12px; border-radius: 5px; text-align: center; }
          .summary-card .label { font-size: 10px; color: #666; text-transform: uppercase; }
          .summary-card .value { font-size: 20px; font-weight: bold; margin-top: 5px; }
          .summary-card .value.green { color: #22c55e; }
          .summary-card .value.red { color: #ef4444; }
          .summary-card .value.blue { color: #3b82f6; }
          .section { margin-bottom: 20px; }
          .section h2 { font-size: 16px; margin-bottom: 10px; border-bottom: 1px solid #ddd; padding-bottom: 5px; }
          table { width: 100%; border-collapse: collapse; margin-bottom: 15px; }
          th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
          th { background: #f5f5f5; font-weight: bold; }
          .text-right { text-align: right; }
          .text-center { text-align: center; }
          .status-paid { color: #22c55e; }
          .status-unpaid { color: #ef4444; }
          .status-partial { color: #f59e0b; }
          .footer { text-align: center; margin-top: 20px; padding-top: 10px; border-top: 1px solid #ddd; color: #666; font-size: 10px; }
          @media print { body { padding: 0; } }
        </style>
      </head>
      <body>
        <div class="header">
          <h1>Supplier Report</h1>
          <p>Generated: ${new Date().toLocaleString()}</p>
        </div>
        
        <div class="supplier-info">
          <h2>${qe.name}${qe.companyName?` - ${qe.companyName}`:""}</h2>
          <div class="grid">
            <div class="item">
              <div class="label">Phone</div>
              <div class="value">${qe.phone||"-"}</div>
            </div>
            <div class="item">
              <div class="label">Email</div>
              <div class="value">${qe.email||"-"}</div>
            </div>
            <div class="item">
              <div class="label">City</div>
              <div class="value">${qe.city||"-"}</div>
            </div>
            <div class="item">
              <div class="label">Country</div>
              <div class="value">${qe.country||"-"}</div>
            </div>
            <div class="item">
              <div class="label">Payment Terms</div>
              <div class="value">${qe.paymentTerms||"-"}</div>
            </div>
            <div class="item">
              <div class="label">Credit Limit</div>
              <div class="value">${Fs(qe.creditLimit)}</div>
            </div>
          </div>
        </div>
        
        ${Mt.showSummary?`
        <div class="summary-grid">
          <div class="summary-card">
            <div class="label">Total Invoices</div>
            <div class="value blue">${Fs(P)}</div>
          </div>
          <div class="summary-card">
            <div class="label">Total Payments</div>
            <div class="value green">${Fs(be)}</div>
          </div>
          <div class="summary-card">
            <div class="label">We Owe Supplier</div>
            <div class="value red">${Fs(qe.balance)}</div>
          </div>
          ${qe.creditBalance>0?`
          <div class="summary-card">
            <div class="label">Supplier Owes Us</div>
            <div class="value blue">${Fs(qe.creditBalance)}</div>
          </div>
          `:""}
          <div class="summary-card">
            <div class="label">Purchase Orders</div>
            <div class="value">${Fs(Re)}</div>
          </div>
        </div>
        `:""}
        
        ${Mt.showPurchaseOrders&&Y.length>0?`
        <div class="section">
          <h2>Purchase Orders (${Y.length})</h2>
          <table>
            <thead>
              <tr>
                <th>PO #</th>
                <th>Date</th>
                <th>Expected</th>
                <th class="text-right">Total</th>
                <th class="text-center">Status</th>
              </tr>
            </thead>
            <tbody>
              ${Y.map(It=>`
                <tr>
                  <td>${It.poNumber}</td>
                  <td>${K0(It.poDate)}</td>
                  <td>${It.expectedDate?K0(It.expectedDate):"-"}</td>
                  <td class="text-right">${Fs(It.total)}</td>
                  <td class="text-center">${It.status}</td>
                </tr>
              `).join("")}
            </tbody>
            <tfoot>
              <tr>
                <th colspan="3">Total</th>
                <th class="text-right">${Fs(Re)}</th>
                <th></th>
              </tr>
            </tfoot>
          </table>
        </div>
        `:""}
        
        ${Mt.showInvoices&&ft.length>0?`
        <div class="section">
          <h2>Purchase Invoices (${ft.length})</h2>
          <table>
            <thead>
              <tr>
                <th>Invoice #</th>
                <th>Date</th>
                <th>Reference</th>
                <th>Due Date</th>
                <th class="text-right">Total</th>
                <th class="text-right">Paid</th>
                <th class="text-right">Balance</th>
                <th class="text-center">Status</th>
              </tr>
            </thead>
            <tbody>
              ${ft.map(It=>`
                <tr>
                  <td>${It.invoiceNumber}</td>
                  <td>${K0(It.invoiceDate)}</td>
                  <td>${It.reference||"-"}</td>
                  <td>${It.dueDate?K0(It.dueDate):"-"}</td>
                  <td class="text-right">${Fs(It.total)}</td>
                  <td class="text-right">${Fs(It.paidAmount)}</td>
                  <td class="text-right ${It.total-It.paidAmount>0?"status-unpaid":""}">${Fs(It.total-It.paidAmount)}</td>
                  <td class="text-center">
                    <span class="${It.paymentStatus==="paid"?"status-paid":It.paymentStatus==="partial"?"status-partial":"status-unpaid"}">${It.paymentStatus}</span>
                  </td>
                </tr>
              `).join("")}
            </tbody>
            <tfoot>
              <tr>
                <th colspan="3">Total</th>
                <th class="text-right">${Fs(P)}</th>
                <th class="text-right">${Fs(ke)}</th>
                <th class="text-right">${Fs(Sr)}</th>
                <th></th>
              </tr>
            </tfoot>
          </table>
        </div>
        `:""}
        
        ${Mt.showPayments&&dt.length>0?`
        <div class="section">
          <h2>Payment History (${dt.length})</h2>
          <table>
            <thead>
              <tr>
                <th>Payment #</th>
                <th>Date</th>
                <th>Method</th>
                <th class="text-right">Amount</th>
                <th>Reference</th>
                <th>Notes</th>
              </tr>
            </thead>
            <tbody>
              ${dt.map(It=>`
                <tr>
                  <td>${It.paymentNumber}</td>
                  <td>${K0(It.paymentDate)}</td>
                  <td>${It.method}</td>
                  <td class="text-right">${Fs(It.amount)}</td>
                  <td>${It.reference||"-"}</td>
                  <td>${It.notes||"-"}</td>
                </tr>
              `).join("")}
            </tbody>
            <tfoot>
              <tr>
                <th colspan="3">Total Payments</th>
                <th class="text-right">${Fs(be)}</th>
                <th colspan="2"></th>
              </tr>
            </tfoot>
          </table>
        </div>
        `:""}
        
        <div class="footer">
          <p>Catalyst Supplier Report - Confidential</p>
        </div>
      </body>
      </html>
    `;Ct.document.write(Pr),Ct.document.close(),Ct.onload=()=>{Ct.focus(),Ct.print()}};return S?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx(vt,{className:"animate-spin",size:32})}):a.jsxs("div",{children:[a.jsx("div",{className:"flex justify-between items-center mb-6",children:a.jsx("div",{children:a.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[a.jsx(On,{className:"text-blue-600"})," Suppliers & Purchases"]})})}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm",children:[a.jsx("div",{className:"border-b",children:a.jsxs("div",{className:"flex",children:[a.jsx("button",{onClick:()=>r("suppliers"),className:`px-6 py-3 font-medium text-sm ${t==="suppliers"?"border-b-2 border-blue-600 text-blue-600":"text-gray-500"}`,children:"Suppliers"}),a.jsx("button",{onClick:()=>r("po"),className:`px-6 py-3 font-medium text-sm ${t==="po"?"border-b-2 border-blue-600 text-blue-600":"text-gray-500"}`,children:"Purchase Orders"}),a.jsx("button",{onClick:()=>r("invoices"),className:`px-6 py-3 font-medium text-sm ${t==="invoices"?"border-b-2 border-blue-600 text-blue-600":"text-gray-500"}`,children:"Purchase Invoices"}),a.jsx("button",{onClick:()=>r("payments"),className:`px-6 py-3 font-medium text-sm ${t==="payments"?"border-b-2 border-blue-600 text-blue-600":"text-gray-500"}`,children:"Payments History"})]})}),a.jsxs("div",{className:"p-4",children:[t==="suppliers"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex flex-wrap gap-3 mb-4",children:[a.jsx("input",{type:"text",placeholder:"Search suppliers...",value:W,onChange:P=>Q(P.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm"}),a.jsxs("select",{value:H,onChange:P=>K(P.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[a.jsx("option",{value:"",children:"All Status"}),a.jsx("option",{value:"active",children:"Active"}),a.jsx("option",{value:"inactive",children:"Inactive"})]}),a.jsxs("button",{onClick:()=>{El(),er(null),Fe(!0)},className:"flex items-center gap-1 px-4 py-2 bg-emerald-500 text-white rounded-lg text-sm hover:bg-emerald-600",children:[a.jsx(hr,{size:16})," Add Supplier"]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsxs("th",{onClick:()=>Cl("name"),className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase cursor-pointer hover:bg-gray-100",children:["Name ",R==="name"&&(I==="asc"?"":"")]}),a.jsxs("th",{onClick:()=>Cl("phone"),className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase cursor-pointer hover:bg-gray-100",children:["Phone ",R==="phone"&&(I==="asc"?"":"")]}),a.jsxs("th",{onClick:()=>Cl("city"),className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase cursor-pointer hover:bg-gray-100",children:["City ",R==="city"&&(I==="asc"?"":"")]}),a.jsxs("th",{onClick:()=>Cl("country"),className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase cursor-pointer hover:bg-gray-100",children:["Country ",R==="country"&&(I==="asc"?"":"")]}),a.jsxs("th",{onClick:()=>Cl("balance"),className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase cursor-pointer hover:bg-gray-100",children:["We Owe ",R==="balance"&&(I==="asc"?"":"")]}),a.jsxs("th",{onClick:()=>Cl("creditBalance"),className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase cursor-pointer hover:bg-gray-100",children:["They Owe ",R==="creditBalance"&&(I==="asc"?"":"")]}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Status"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:pa.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:8,className:"px-4 py-8 text-center text-gray-500",children:"No suppliers found"})}):pa.map(P=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 font-medium",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>{L(P.id.toString()),r("invoices")},className:"p-1 text-blue-500 hover:bg-blue-50 rounded",title:"View Invoices",children:a.jsx(gs,{size:14})}),P.name,P.isManufacturer&&a.jsx("span",{className:"px-1.5 py-0.5 bg-purple-100 text-purple-700 text-xs rounded font-medium",children:"MFR"})]})}),a.jsx("td",{className:"px-4 py-3",children:P.phone||"-"}),a.jsx("td",{className:"px-4 py-3",children:P.city||"-"}),a.jsx("td",{className:"px-4 py-3",children:P.country||"-"}),a.jsx("td",{className:`px-4 py-3 font-medium ${P.balance>0?"text-red-600":""}`,children:Math.max(0,P.balance).toFixed(3)}),a.jsx("td",{className:`px-4 py-3 font-medium ${(P.creditBalance||0)+Math.abs(Math.min(0,P.balance))>0?"text-blue-600":""}`,children:((P.creditBalance||0)+Math.abs(Math.min(0,P.balance))).toFixed(3)}),a.jsx("td",{className:"px-4 py-3",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${P.isActive?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:P.isActive?"Active":"Inactive"})}),a.jsx("td",{className:"px-4 py-3",children:a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:()=>Bv(P),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",title:"Edit",children:a.jsx(js,{size:16})}),a.jsx("button",{onClick:()=>HL(P),className:"p-1 text-emerald-600 hover:bg-emerald-50 rounded",title:"Print Report",children:a.jsx(Br,{size:16})}),P.isManufacturer&&a.jsx("button",{onClick:()=>e(`/manufacturer-report/${P.id}`),className:"p-1 text-purple-600 hover:bg-purple-50 rounded",title:"Manufacturer Report",children:a.jsx(Wp,{size:16})})]})})]},P.id))})]})})]}),t==="po"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex flex-wrap gap-3 mb-4",children:[a.jsx("input",{type:"date",value:q,onChange:P=>ge(P.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm"}),a.jsx("input",{type:"date",value:G,onChange:P=>B(P.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm"}),a.jsxs("select",{value:se,onChange:P=>L(P.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[a.jsx("option",{value:"",children:"All Suppliers"}),i.map(P=>a.jsx("option",{value:P.id,children:P.name},P.id))]}),a.jsxs("select",{value:z,onChange:P=>A(P.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[a.jsx("option",{value:"",children:"All Status"}),a.jsx("option",{value:"draft",children:"Draft"}),a.jsx("option",{value:"sent",children:"Sent"}),a.jsx("option",{value:"confirmed",children:"Confirmed"}),a.jsx("option",{value:"received",children:"Received"}),a.jsx("option",{value:"cancelled",children:"Cancelled"})]}),a.jsxs("button",{onClick:()=>{gt(),xe(!0)},className:"flex items-center gap-1 px-4 py-2 bg-emerald-500 text-white rounded-lg text-sm hover:bg-emerald-600",children:[a.jsx(hr,{size:16})," Create PO"]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"PO #"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Date"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Expected"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Supplier"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Total"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Status"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:s.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"px-4 py-8 text-center text-gray-500",children:"No purchase orders found"})}):s.map(P=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 font-medium",children:P.poNumber}),a.jsx("td",{className:"px-4 py-3",children:P.poDate.split("T")[0]}),a.jsx("td",{className:"px-4 py-3",children:P.expectedDate?P.expectedDate.split("T")[0]:"-"}),a.jsx("td",{className:"px-4 py-3",children:P.supplierName}),a.jsx("td",{className:"px-4 py-3 font-medium",children:P.total.toFixed(3)}),a.jsx("td",{className:"px-4 py-3",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${P.status==="draft"?"bg-gray-100 text-gray-700":P.status==="sent"?"bg-blue-100 text-blue-700":P.status==="confirmed"?"bg-yellow-100 text-yellow-700":P.status==="received"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:P.status})}),a.jsxs("td",{className:"px-4 py-3 flex gap-1",children:[a.jsx("button",{onClick:()=>Yt(P.id),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",title:"View",children:a.jsx(gs,{size:16})}),P.status==="draft"&&a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>eu(P.id),className:"p-1 text-green-600 hover:bg-green-50 rounded",title:"Send to Supplier",children:a.jsx(Lj,{size:16})}),a.jsx("button",{onClick:()=>tu(P.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Delete",children:a.jsx(xr,{size:16})})]})]})]},P.id))})]})})]}),t==="invoices"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex flex-wrap gap-3 mb-4",children:[a.jsx("input",{type:"date",value:q,onChange:P=>ge(P.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm"}),a.jsx("input",{type:"date",value:G,onChange:P=>B(P.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm"}),a.jsxs("select",{value:se,onChange:P=>L(P.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[a.jsx("option",{value:"",children:"All Suppliers"}),i.map(P=>a.jsx("option",{value:P.id,children:P.name},P.id))]}),a.jsxs("select",{value:Z,onChange:P=>F(P.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[a.jsx("option",{value:"",children:"All Status"}),a.jsx("option",{value:"Unpaid",children:"Unpaid"}),a.jsx("option",{value:"Partial",children:"Partial"}),a.jsx("option",{value:"Paid",children:"Paid"})]}),a.jsxs("button",{onClick:()=>{ls(),Bt(!0)},className:"flex items-center gap-1 px-4 py-2 bg-emerald-500 text-white rounded-lg text-sm hover:bg-emerald-600",children:[a.jsx(hr,{size:16})," Add Invoice"]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Invoice #"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Date"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Supplier"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Total"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Paid"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Remaining"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Status"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:o.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:8,className:"px-4 py-8 text-center text-gray-500",children:"No invoices found"})}):o.map(P=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 font-medium",children:P.invoiceNumber}),a.jsx("td",{className:"px-4 py-3",children:P.invoiceDate.split("T")[0]}),a.jsx("td",{className:"px-4 py-3",children:P.supplierName}),a.jsx("td",{className:"px-4 py-3 font-medium",children:P.total.toFixed(3)}),a.jsx("td",{className:"px-4 py-3 text-green-600",children:(P.paidAmount||0).toFixed(3)}),a.jsx("td",{className:"px-4 py-3 text-red-600 font-medium",children:Math.max(0,P.total-(P.paidAmount||0)).toFixed(3)}),a.jsx("td",{className:"px-4 py-3",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${P.paymentStatus==="paid"?"bg-green-100 text-green-700":P.paymentStatus==="partial"?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:P.paymentStatus})}),a.jsxs("td",{className:"px-4 py-3 flex gap-1",children:[a.jsx("button",{onClick:()=>Fr(P.id),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",title:"View Details",children:a.jsx(gs,{size:16})}),P.paymentStatus!=="paid"&&a.jsx("button",{onClick:()=>Wv(P),className:"p-1 text-green-600 hover:bg-green-50 rounded",title:"Settle Payment",children:a.jsx(da,{size:16})})]})]},P.id))})]})}),u.length>0&&a.jsxs("div",{className:"mt-6",children:[a.jsxs("h3",{className:"text-lg font-semibold text-purple-700 mb-3 flex items-center gap-2",children:[a.jsx(Wp,{size:20}),"Raw Material Purchases"]}),a.jsx("div",{className:"overflow-x-auto border rounded-lg",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-purple-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-purple-700 uppercase",children:"Purchase #"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-purple-700 uppercase",children:"Date"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-purple-700 uppercase",children:"Total"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-purple-700 uppercase",children:"Paid"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-purple-700 uppercase",children:"Balance"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-purple-700 uppercase",children:"Status"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-purple-700 uppercase",children:"Notes"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:u.map(P=>a.jsxs("tr",{className:"hover:bg-purple-50/50",children:[a.jsx("td",{className:"px-4 py-3 font-medium text-purple-600",children:P.purchaseNumber}),a.jsx("td",{className:"px-4 py-3",children:P.purchaseDate.split("T")[0]}),a.jsx("td",{className:"px-4 py-3 font-medium",children:P.totalAmount.toFixed(3)}),a.jsx("td",{className:"px-4 py-3 text-green-600",children:(P.paidAmount||0).toFixed(3)}),a.jsx("td",{className:"px-4 py-3 text-red-600 font-medium",children:Math.max(0,P.totalAmount-(P.paidAmount||0)).toFixed(3)}),a.jsx("td",{className:"px-4 py-3",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${P.paymentStatus==="paid"?"bg-green-100 text-green-700":P.paymentStatus==="partial"?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:P.paymentStatus.toUpperCase()})}),a.jsx("td",{className:"px-4 py-3 text-gray-500 text-sm",children:P.notes||"-"})]},P.id))})]})})]})]}),t==="payments"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex flex-wrap gap-3 mb-4",children:[a.jsx("input",{type:"text",placeholder:"Search Payment #...",value:de,onChange:P=>D(P.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm"}),a.jsx("input",{type:"date",value:q,onChange:P=>ge(P.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm"}),a.jsx("input",{type:"date",value:G,onChange:P=>B(P.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm"}),a.jsxs("select",{value:se,onChange:P=>L(P.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[a.jsx("option",{value:"",children:"All Suppliers"}),i.map(P=>a.jsx("option",{value:P.id,children:P.name},P.id))]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Payment #"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Date"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Supplier"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Method"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Amount"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Reference"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:h.filter(P=>!de||P.paymentNumber.toLowerCase().includes(de.toLowerCase())).length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"px-4 py-8 text-center text-gray-500",children:"No payments found"})}):h.filter(P=>!de||P.paymentNumber.toLowerCase().includes(de.toLowerCase())).map(P=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 font-medium",children:P.paymentNumber}),a.jsx("td",{className:"px-4 py-3",children:P.paymentDate.split("T")[0]}),a.jsx("td",{className:"px-4 py-3",children:P.supplierName}),a.jsx("td",{className:"px-4 py-3",children:P.method}),a.jsx("td",{className:"px-4 py-3 font-medium text-green-600",children:P.amount.toFixed(3)}),a.jsx("td",{className:"px-4 py-3",children:P.reference||"-"}),a.jsxs("td",{className:"px-4 py-3 flex gap-1",children:[a.jsx("button",{onClick:()=>Pt(P),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",title:"Edit",children:a.jsx(js,{size:16})}),a.jsx("button",{onClick:()=>Dt(P.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Delete",children:a.jsx(xr,{size:16})})]})]},P.id))})]})})]})]})]}),ze&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-2xl max-h-[90vh] overflow-hidden",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-[#003366] text-white",children:[a.jsx("h2",{className:"text-lg font-semibold",children:Zt?"Edit Supplier":"Add Supplier"}),a.jsx("button",{onClick:()=>Fe(!1),children:a.jsx(yt,{size:24})})]}),a.jsxs("form",{onSubmit:zv,className:"p-6 space-y-4 overflow-y-auto max-h-[calc(90vh-120px)]",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Supplier Name *"}),a.jsx("input",{type:"text",value:pt.name,onChange:P=>Ut({...pt,name:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Company Name"}),a.jsx("input",{type:"text",value:pt.companyName,onChange:P=>Ut({...pt,companyName:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),a.jsx("input",{type:"text",value:pt.phone,onChange:P=>Ut({...pt,phone:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),a.jsx("input",{type:"email",value:pt.email,onChange:P=>Ut({...pt,email:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"City"}),a.jsx("input",{type:"text",value:pt.city,onChange:P=>Ut({...pt,city:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Country"}),a.jsx("input",{type:"text",value:pt.country,onChange:P=>Ut({...pt,country:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Terms"}),a.jsx("input",{type:"text",value:pt.paymentTerms,onChange:P=>Ut({...pt,paymentTerms:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"e.g. Net 30"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Credit Limit"}),a.jsx("input",{type:"number",value:pt.creditLimit,onChange:P=>Ut({...pt,creditLimit:parseFloat(P.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"We Owe Supplier"}),a.jsx("input",{type:"number",step:"0.001",value:pt.balance,onChange:P=>Ut({...pt,balance:parseFloat(P.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Supplier Owes Us"}),a.jsx("input",{type:"number",step:"0.001",value:pt.creditBalance,onChange:P=>Ut({...pt,creditBalance:parseFloat(P.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),a.jsx("textarea",{value:pt.notes,onChange:P=>Ut({...pt,notes:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",rows:2})]}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",id:"isActive",checked:pt.isActive,onChange:P=>Ut({...pt,isActive:P.target.checked}),className:"rounded"}),a.jsx("label",{htmlFor:"isActive",className:"text-sm",children:"Active"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",id:"isManufacturer",checked:pt.isManufacturer,onChange:P=>Ut({...pt,isManufacturer:P.target.checked}),className:"rounded"}),a.jsx("label",{htmlFor:"isManufacturer",className:"text-sm text-purple-700 font-medium",children:"Raw Material Manufacturer"})]})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>Fe(!1),className:"flex-1 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:O,className:"flex-1 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 disabled:opacity-50",children:O?"Saving...":"Save"})]})]})]})}),ct&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-lg",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-[#003366] text-white rounded-t-xl",children:[a.jsx("h2",{className:"text-lg font-semibold",children:"Add Supplier Payment"}),a.jsx("button",{onClick:()=>$e(!1),children:a.jsx(yt,{size:24})})]}),a.jsxs("form",{onSubmit:Uv,className:"p-6 space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Supplier *"}),a.jsxs("select",{value:qt.supplierId,onChange:P=>Ca({...qt,supplierId:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0,children:[a.jsx("option",{value:"",children:"Select Supplier"}),i.map(P=>a.jsx("option",{value:P.id,children:P.name},P.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date *"}),a.jsx("input",{type:"date",value:qt.paymentDate,onChange:P=>Ca({...qt,paymentDate:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Method"}),a.jsxs("select",{value:qt.method,onChange:P=>Ca({...qt,method:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[a.jsx("option",{value:"Cash",children:"Cash"}),a.jsx("option",{value:"Bank Transfer",children:"Bank Transfer"}),a.jsx("option",{value:"Check",children:"Check"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount *"}),a.jsx("input",{type:"number",step:"0.01",value:qt.amount,onChange:P=>Ca({...qt,amount:parseFloat(P.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reference"}),a.jsx("input",{type:"text",value:qt.reference,onChange:P=>Ca({...qt,reference:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"Check # / Transfer ID"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),a.jsx("textarea",{value:qt.notes,onChange:P=>Ca({...qt,notes:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",rows:2})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>$e(!1),className:"flex-1 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:O,className:"flex-1 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 disabled:opacity-50",children:O?"Saving...":"Save Payment"})]})]})]})}),We&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-5xl max-h-[90vh] overflow-hidden",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-[#003366] text-white",children:[a.jsx("h2",{className:"text-lg font-semibold",children:"New Purchase Invoice"}),a.jsx("button",{onClick:()=>Bt(!1),children:a.jsx(yt,{size:24})})]}),a.jsxs("form",{onSubmit:Tt,className:"p-6 space-y-4 overflow-y-auto max-h-[calc(90vh-140px)]",children:[a.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Supplier *"}),a.jsxs("select",{value:nr.supplierId,onChange:P=>Ea({...nr,supplierId:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0,children:[a.jsx("option",{value:"",children:"Select Supplier"}),i.map(P=>a.jsx("option",{value:P.id,children:P.name},P.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Invoice Date *"}),a.jsx("input",{type:"date",value:nr.invoiceDate,onChange:P=>Ea({...nr,invoiceDate:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reference"}),a.jsx("input",{type:"text",value:nr.reference,onChange:P=>Ea({...nr,reference:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"Invoice ref"})]})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsx("h6",{className:"font-medium",children:"Invoice Items"}),a.jsxs("button",{type:"button",onClick:Pl,className:"text-sm text-blue-600 hover:text-blue-800 flex items-center gap-1",children:[a.jsx(hr,{size:14})," Add Item"]})]}),a.jsx("div",{className:"border rounded-lg overflow-hidden",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-2 py-2 text-left font-medium",children:"#"}),a.jsx("th",{className:"px-2 py-2 text-left font-medium",children:"Product"}),a.jsx("th",{className:"px-2 py-2 text-left font-medium",children:"Warehouse"}),a.jsx("th",{className:"px-2 py-2 text-left font-medium",children:"Unit"}),a.jsx("th",{className:"px-2 py-2 text-left font-medium w-20",children:"Qty"}),a.jsx("th",{className:"px-2 py-2 text-left font-medium w-24",children:"Unit Price"}),a.jsx("th",{className:"px-2 py-2 text-left font-medium w-16",children:"Disc %"}),a.jsx("th",{className:"px-2 py-2 text-left font-medium w-16",children:"Tax %"}),a.jsx("th",{className:"px-2 py-2 text-left font-medium w-24",children:"Total"}),a.jsx("th",{className:"px-2 py-2 w-10"})]})}),a.jsx("tbody",{children:Dr.map((P,ke)=>{var be;return a.jsxs("tr",{className:"border-t",children:[a.jsx("td",{className:"px-2 py-2",children:ke+1}),a.jsx("td",{className:"px-2 py-2",children:a.jsxs("div",{className:"flex gap-1 items-center",children:[a.jsx("span",{className:"flex-1 px-2 py-1 text-sm min-w-[120px]",children:P.productId>0?((be=x.find(Re=>Re.id===P.productId))==null?void 0:be.name)||"Unknown":a.jsx("span",{className:"text-gray-400",children:"No product"})}),P.productId>0?a.jsx("button",{type:"button",onClick:()=>WL(ke,P.productId),className:"px-2 py-1 bg-amber-500 text-white rounded text-xs hover:bg-amber-600",title:"Edit Product",children:a.jsx(js,{size:12})}):a.jsx("button",{type:"button",onClick:()=>$L(ke),className:"px-2 py-1 bg-blue-500 text-white rounded text-xs hover:bg-blue-600",title:"Scan/Add Product",children:a.jsx(hr,{size:12})})]})}),a.jsx("td",{className:"px-2 py-2",children:a.jsxs("select",{value:P.warehouseId||"",onChange:Re=>ga(ke,"warehouseId",Re.target.value?parseInt(Re.target.value):null),className:"w-full px-2 py-1 border rounded text-sm",children:[a.jsx("option",{value:"",children:"Select"}),g.map(Re=>a.jsx("option",{value:Re.id,children:Re.name},Re.id))]})}),a.jsx("td",{className:"px-2 py-2",children:a.jsx("select",{value:P.unitType,onChange:Re=>ga(ke,"unitType",Re.target.value),className:"w-full px-2 py-1 border rounded text-sm",children:(()=>{const Re=x.find(kt=>kt.id===P.productId);return Re?a.jsxs(a.Fragment,{children:[a.jsx("option",{value:Re.baseUnit,children:Re.baseUnit}),Re.secondUnit&&Re.unitsPerSecond>0&&a.jsx("option",{value:Re.secondUnit,children:Re.secondUnit})]}):a.jsx("option",{value:"Piece",children:"Piece"})})()})}),a.jsx("td",{className:"px-2 py-2",children:a.jsx("input",{type:"number",value:P.quantity,onChange:Re=>ga(ke,"quantity",parseInt(Re.target.value)||1),className:"w-full px-2 py-1 border rounded text-sm",min:1})}),a.jsx("td",{className:"px-2 py-2",children:a.jsx("input",{type:"number",step:"0.01",value:P.unitPrice,onChange:Re=>ga(ke,"unitPrice",parseFloat(Re.target.value)||0),className:"w-full px-2 py-1 border rounded text-sm"})}),a.jsx("td",{className:"px-2 py-2",children:a.jsx("input",{type:"number",value:P.discountPercent,onChange:Re=>ga(ke,"discountPercent",parseFloat(Re.target.value)||0),className:"w-full px-2 py-1 border rounded text-sm"})}),a.jsx("td",{className:"px-2 py-2",children:a.jsx("input",{type:"number",value:P.taxPercent,onChange:Re=>ga(ke,"taxPercent",parseFloat(Re.target.value)||0),className:"w-full px-2 py-1 border rounded text-sm"})}),a.jsxs("td",{className:"px-2 py-2 font-medium",children:[(()=>{const Re=x.find(kt=>kt.id===P.productId);return(Re==null?void 0:Re.currency)||""})()," ",za(P).toFixed(3)]}),a.jsx("td",{className:"px-2 py-2",children:a.jsx("button",{type:"button",onClick:()=>Yi(ke),className:"text-red-500 hover:text-red-700",children:a.jsx(xr,{size:16})})})]},ke)})})]})})]}),a.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Shipping Cost"}),a.jsx("input",{type:"number",step:"0.01",value:nr.shippingCost,onChange:P=>Ea({...nr,shippingCost:parseFloat(P.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Other Charges"}),a.jsx("input",{type:"number",step:"0.01",value:nr.otherCharges,onChange:P=>Ea({...nr,otherCharges:parseFloat(P.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),a.jsx("input",{type:"text",value:nr.notes,onChange:P=>Ea({...nr,notes:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]})]}),a.jsx("div",{className:"flex flex-col items-end gap-2 border-t pt-4",children:(()=>{const P=k.find(Ct=>Ct.isBase),ke=(P==null?void 0:P.code)||"USD",be={};Dr.forEach(Ct=>{const Pr=x.find(os=>os.id===Ct.productId),It=(Pr==null?void 0:Pr.currency)||ke;be[It]=(be[It]||0)+za(Ct)});const Re=Object.keys(be),kt=Re.length>1;let Sr=0;return Re.forEach(Ct=>{const Pr=k.find(os=>os.code===Ct),It=(Pr==null?void 0:Pr.exchangeRate)||1;Sr+=be[Ct]/It}),Sr+=nr.shippingCost+nr.otherCharges,a.jsxs(a.Fragment,{children:[Re.map(Ct=>a.jsxs("div",{className:"text-sm font-medium",children:[kt?`Subtotal (${Ct}):`:"Subtotal:"," ",a.jsxs("span",{className:"text-gray-900",children:[Ct," ",be[Ct].toFixed(3)]})]},Ct)),a.jsxs("div",{className:"flex justify-end gap-6 text-sm font-medium",children:[a.jsxs("div",{children:["Shipping: ",a.jsx("span",{className:"text-gray-900",children:nr.shippingCost.toFixed(3)})]}),a.jsxs("div",{children:["Other: ",a.jsx("span",{className:"text-gray-900",children:nr.otherCharges.toFixed(3)})]})]}),kt&&Re.map(Ct=>a.jsxs("div",{className:"text-sm font-semibold",children:["Total (",Ct,"): ",a.jsxs("span",{className:"text-blue-600",children:[Ct," ",be[Ct].toFixed(3)]})]},`t-${Ct}`)),a.jsxs("div",{className:"text-lg font-bold",children:["Total (",ke,"): ",a.jsxs("span",{className:"text-blue-600",children:[ke," ",Sr.toFixed(3)]})]}),kt&&a.jsx("div",{className:"text-xs text-gray-400",children:Re.filter(Ct=>Ct!==ke).map(Ct=>{const Pr=k.find(It=>It.code===Ct);return`1 ${ke} = ${(Pr==null?void 0:Pr.exchangeRate)||1} ${Ct}`}).join(" | ")})]})})()}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>Bt(!1),className:"flex-1 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:O,className:"flex-1 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 disabled:opacity-50",children:O?"Saving...":"Save Invoice"})]})]})]})}),Ee&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[60]",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-3xl max-h-[90vh] overflow-hidden",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-[#003366] text-white",children:[a.jsx("h2",{className:"text-lg font-semibold",children:ae?"Find or Add Product":ut?"Edit Product":"Add New Product"}),a.jsx("button",{onClick:()=>{it(!1),Le(null),ee(null),Me(!1),Ne(!1)},children:a.jsx(yt,{size:24})})]}),ae&&a.jsxs("div",{className:"p-4 border-b bg-blue-50",children:[a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Scan Barcode or Enter Item Code"}),a.jsxs("div",{className:"relative",children:[a.jsx(Oo,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),a.jsx("input",{type:"text",value:te,onChange:P=>BL(P.target.value),placeholder:"Scan barcode or enter SKU...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg",autoFocus:!0})]})]}),te&&i3.length>0&&a.jsxs("div",{className:"mb-3",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Or Select Existing Product"}),a.jsx("div",{className:"max-h-40 overflow-y-auto border border-gray-200 rounded-lg bg-white",children:i3.slice(0,10).map(P=>a.jsxs("button",{type:"button",onClick:()=>zL(P.id),className:"w-full px-3 py-2 text-left hover:bg-blue-50 border-b last:border-b-0 flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-sm",children:P.name}),a.jsxs("div",{className:"text-xs text-gray-500",children:["SKU: ",P.sku," ",P.barcode&&`| Barcode: ${P.barcode}`]})]}),a.jsx("div",{className:"text-right text-sm",children:a.jsxs("div",{className:"text-green-600",children:["$",P.costPrice.toFixed(3)]})})]},P.id))})]}),a.jsx("div",{className:"flex gap-2",children:a.jsxs("button",{type:"button",onClick:UL,className:"flex-1 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 flex items-center justify-center gap-2",children:[a.jsx(hr,{size:18}),"Create New Product"]})}),Be==="existing"&&ut&&a.jsxs("div",{className:"mt-3 p-3 bg-green-50 border border-green-200 rounded-lg",children:[a.jsxs("div",{className:"flex items-center gap-2 text-green-700",children:[a.jsx(Jt,{size:18}),a.jsx("span",{className:"font-medium",children:"Product found! You can edit details below."})]}),a.jsx("button",{type:"button",onClick:()=>Ne(!1),className:"mt-2 w-full py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Continue to Edit Product"})]})]}),a.jsxs("form",{onSubmit:VL,className:"p-6 space-y-4 overflow-y-auto max-h-[calc(90vh-120px)]",children:[!ae&&a.jsxs("button",{type:"button",onClick:()=>{Ne(!0),re("")},className:"text-sm text-blue-600 hover:underline flex items-center gap-1 mb-2",children:[a.jsx(Na,{size:14}),"Search for existing product"]}),a.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50/50 space-y-4",children:[a.jsx("div",{className:"text-sm font-semibold text-gray-700",children:"Public Info"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Product Name *"}),a.jsx("input",{type:"text",value:Ue.name,onChange:P=>M({...Ue,name:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white",placeholder:"Enter product name",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Category"}),a.jsxs("select",{value:Ue.categoryId,onChange:P=>M({...Ue,categoryId:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white",children:[a.jsx("option",{value:"",children:"Select Category"}),v.map(P=>a.jsx("option",{value:P.id,children:P.name},P.id))]})]})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Warehouse"}),a.jsxs("select",{value:Ue.defaultWarehouseId,onChange:P=>M({...Ue,defaultWarehouseId:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white",children:[a.jsx("option",{value:"",children:"Select Warehouse"}),g.map(P=>a.jsx("option",{value:P.id,children:P.name},P.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Currency"}),a.jsx("select",{value:Ue.currency,onChange:P=>M({...Ue,currency:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white",children:k.filter(P=>P.isActive).length>0?k.filter(P=>P.isActive).map(P=>a.jsx("option",{value:P.code,children:P.code},P.id)):a.jsxs(a.Fragment,{children:[a.jsx("option",{value:"USD",children:"USD"}),a.jsx("option",{value:"LBP",children:"LBP"}),a.jsx("option",{value:"EUR",children:"EUR"})]})})]}),a.jsx("div",{className:"flex items-end",children:a.jsxs("div",{className:"flex items-center gap-2 w-full px-3 py-2 border border-gray-300 rounded-lg bg-white",children:[a.jsx("input",{type:"checkbox",id:"productActive",checked:Ue.isActive,onChange:P=>M({...Ue,isActive:P.target.checked}),className:"rounded"}),a.jsx("label",{htmlFor:"productActive",className:"text-sm font-semibold text-gray-700",children:"Active"})]})})]})]}),a.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50/50 space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("div",{className:"text-sm font-semibold text-gray-700",children:"First Unit Configuration"}),a.jsx("button",{type:"button",onClick:()=>{M(le?{...Ue,secondUnit:"",unitsPerSecond:0,boxBarcode:"",boxRetailPrice:0,boxWholesalePrice:0,boxSuperWholesalePrice:0,boxCostPrice:0,lowStockAlertBox:0}:{...Ue,secondUnit:"Box",unitsPerSecond:0}),Me(!le)},className:`px-3 py-1.5 text-sm border rounded-lg flex items-center gap-2 transition-colors ${le?"border-red-300 text-red-600 hover:bg-red-50":"border-blue-300 text-blue-600 hover:bg-blue-50"}`,children:le?a.jsxs(a.Fragment,{children:[a.jsx(yt,{size:14})," Remove Second Unit"]}):a.jsxs(a.Fragment,{children:[a.jsx(hr,{size:14})," Add Second Unit"]})})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"SKU *"}),a.jsx("input",{type:"text",value:Ue.sku,onChange:P=>M({...Ue,sku:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white",placeholder:"Enter SKU",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Barcode"}),a.jsx("input",{type:"text",value:Ue.barcode,onChange:P=>M({...Ue,barcode:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white",placeholder:"Enter barcode"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Unit"}),a.jsx("select",{value:Ue.baseUnit,onChange:P=>M({...Ue,baseUnit:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white",children:b.length>0?b.map(P=>a.jsx("option",{value:P.name,children:P.name},P.id)):a.jsxs(a.Fragment,{children:[a.jsx("option",{value:"Piece",children:"Piece"}),a.jsx("option",{value:"Box",children:"Box"}),a.jsx("option",{value:"Kg",children:"Kg"})]})})]})]}),a.jsxs("div",{className:"grid grid-cols-6 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Quantity"}),a.jsx("input",{type:"number",min:"0",value:Ue.quantity,onChange:P=>M({...Ue,quantity:parseInt(P.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white",placeholder:"0"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Cost Price"}),a.jsx("input",{type:"number",step:"0.01",value:Ue.costPrice,onChange:P=>M({...Ue,costPrice:parseFloat(P.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Retail Price"}),a.jsx("input",{type:"number",step:"0.01",value:Ue.retailPrice,onChange:P=>M({...Ue,retailPrice:parseFloat(P.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Wholesale"}),a.jsx("input",{type:"number",step:"0.01",value:Ue.wholesalePrice,onChange:P=>M({...Ue,wholesalePrice:parseFloat(P.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Super Wholesale"}),a.jsx("input",{type:"number",step:"0.01",value:Ue.superWholesalePrice,onChange:P=>M({...Ue,superWholesalePrice:parseFloat(P.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Min Stock"}),a.jsx("input",{type:"number",min:"0",value:Ue.lowStockAlert,onChange:P=>M({...Ue,lowStockAlert:parseInt(P.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white",placeholder:"0"})]})]})]}),le&&a.jsxs("div",{className:"border border-blue-200 rounded-lg p-4 bg-blue-50/50 space-y-4",children:[a.jsx("div",{className:"text-sm font-semibold text-blue-700",children:"Second Unit Configuration"}),a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:["1 ",Ue.baseUnit," = X ",Ue.secondUnit||"Piece","s"]}),a.jsx("input",{type:"number",min:"1",value:Ue.unitsPerSecond,onChange:P=>M({...Ue,unitsPerSecond:parseInt(P.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white",placeholder:"e.g. 12"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Barcode"}),a.jsx("input",{type:"text",value:Ue.boxBarcode,onChange:P=>M({...Ue,boxBarcode:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white",placeholder:"Optional"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Unit"}),a.jsx("select",{value:Ue.secondUnit,onChange:P=>M({...Ue,secondUnit:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white",children:b.length>0?b.map(P=>a.jsx("option",{value:P.name,children:P.name},P.id)):a.jsxs(a.Fragment,{children:[a.jsx("option",{value:"Box",children:"Box"}),a.jsx("option",{value:"Carton",children:"Carton"}),a.jsx("option",{value:"Pack",children:"Pack"})]})})]})]}),a.jsxs("div",{className:"grid grid-cols-6 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Quantity"}),a.jsx("input",{type:"number",min:"0",value:Ue.quantityBox,onChange:P=>M({...Ue,quantityBox:parseInt(P.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white",placeholder:"0"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Cost Price"}),a.jsx("input",{type:"number",step:"0.01",min:"0",value:Ue.boxCostPrice,onChange:P=>M({...Ue,boxCostPrice:parseFloat(P.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Retail Price"}),a.jsx("input",{type:"number",step:"0.01",min:"0",value:Ue.boxRetailPrice,onChange:P=>M({...Ue,boxRetailPrice:parseFloat(P.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Wholesale"}),a.jsx("input",{type:"number",step:"0.01",min:"0",value:Ue.boxWholesalePrice,onChange:P=>M({...Ue,boxWholesalePrice:parseFloat(P.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Super Wholesale"}),a.jsx("input",{type:"number",step:"0.01",min:"0",value:Ue.boxSuperWholesalePrice,onChange:P=>M({...Ue,boxSuperWholesalePrice:parseFloat(P.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Min Stock"}),a.jsx("input",{type:"number",min:"0",value:Ue.lowStockAlertBox,onChange:P=>M({...Ue,lowStockAlertBox:parseInt(P.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white",placeholder:"0"})]})]})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>{it(!1),Le(null),ee(null),Me(!1)},className:"flex-1 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:O,className:"flex-1 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 disabled:opacity-50",children:O?"Saving...":ut?"Update":"Save"})]})]})]})}),we&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-4xl max-h-[90vh] overflow-hidden",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-blue-600 text-white",children:[a.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[a.jsx(gs,{size:20})," Invoice Details"]}),a.jsx("button",{onClick:()=>{et(!1),Nt(null)},children:a.jsx(yt,{size:24})})]}),a.jsxs("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-80px)]",children:[Rt?a.jsx("div",{className:"flex items-center justify-center py-12",children:a.jsx(vt,{className:"animate-spin",size:32})}):Ge?a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[a.jsx("div",{className:"text-xs text-gray-500",children:"Invoice #"}),a.jsx("div",{className:"font-semibold",children:Ge.invoiceNumber})]}),a.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[a.jsx("div",{className:"text-xs text-gray-500",children:"Supplier"}),a.jsx("div",{className:"font-semibold",children:Ge.supplierName})]}),a.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[a.jsx("div",{className:"text-xs text-gray-500",children:"Date"}),a.jsx("div",{className:"font-semibold",children:Ge.invoiceDate.split("T")[0]})]}),a.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[a.jsx("div",{className:"text-xs text-gray-500",children:"Status"}),a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${Ge.paymentStatus==="paid"?"bg-green-100 text-green-700":Ge.paymentStatus==="partial"?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:Ge.paymentStatus})]})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold mb-2",children:"Items"}),a.jsx("div",{className:"border rounded-lg overflow-hidden",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-600",children:"Product"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-600",children:"Warehouse"}),a.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-600",children:"Qty"}),a.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-600",children:"Unit Price"}),a.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-600",children:"Discount"}),a.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-600",children:"Tax"}),a.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-600",children:"Total"})]})}),a.jsx("tbody",{className:"divide-y",children:Ge.items.map((P,ke)=>{const be=x.find(kt=>kt.id===P.productId),Re=(be==null?void 0:be.currency)||"";return a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsxs("td",{className:"px-4 py-2",children:[a.jsx("div",{className:"font-medium",children:P.productName}),a.jsx("div",{className:"text-xs text-gray-500",children:P.productSku})]}),a.jsx("td",{className:"px-4 py-2 text-gray-500",children:P.warehouseName||"-"}),a.jsx("td",{className:"px-4 py-2 text-right",children:P.quantity}),a.jsxs("td",{className:"px-4 py-2 text-right",children:[Re," ",P.unitPrice.toFixed(3)]}),a.jsx("td",{className:"px-4 py-2 text-right text-orange-600",children:P.discountAmount.toFixed(3)}),a.jsx("td",{className:"px-4 py-2 text-right text-blue-600",children:P.taxAmount.toFixed(3)}),a.jsxs("td",{className:"px-4 py-2 text-right font-medium",children:[Re," ",P.lineTotal.toFixed(3)]})]},ke)})})]})})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx("div",{className:"w-80 space-y-2",children:(()=>{const P=k.find(Ct=>Ct.isBase),ke=(P==null?void 0:P.code)||"USD",be={};Ge.items.forEach(Ct=>{const Pr=x.find(os=>os.id===Ct.productId),It=(Pr==null?void 0:Pr.currency)||ke;be[It]=(be[It]||0)+Ct.lineTotal});const Re=Object.keys(be),kt=Re.length>1;let Sr=0;return Re.forEach(Ct=>{const Pr=k.find(os=>os.code===Ct),It=(Pr==null?void 0:Pr.exchangeRate)||1;Sr+=be[Ct]/It}),a.jsxs(a.Fragment,{children:[Re.map(Ct=>a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-gray-500",children:kt?`Subtotal (${Ct}):`:"Subtotal:"}),a.jsxs("span",{children:[Ct," ",be[Ct].toFixed(3)]})]},Ct)),Ge.discountAmount>0&&a.jsxs("div",{className:"flex justify-between text-sm text-orange-600",children:[a.jsx("span",{children:"Discount:"}),a.jsxs("span",{children:["-",Ge.discountAmount.toFixed(3)]})]}),Ge.taxAmount>0&&a.jsxs("div",{className:"flex justify-between text-sm text-blue-600",children:[a.jsx("span",{children:"Tax:"}),a.jsxs("span",{children:["+",Ge.taxAmount.toFixed(3)]})]}),Ge.shippingAmount>0&&a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-gray-500",children:"Shipping:"}),a.jsxs("span",{children:["+",Ge.shippingAmount.toFixed(3)]})]}),kt&&Re.map(Ct=>a.jsxs("div",{className:"flex justify-between font-semibold border-t pt-1",children:[a.jsxs("span",{children:["Total (",Ct,"):"]}),a.jsxs("span",{className:"text-green-600",children:[Ct," ",be[Ct].toFixed(3)]})]},`total-${Ct}`)),a.jsxs("div",{className:`flex justify-between font-bold text-lg ${kt?"border-t pt-2 mt-1":"border-t pt-2"}`,children:[a.jsxs("span",{children:["Total (",ke,"):"]}),a.jsxs("span",{className:"text-green-600",children:[ke," ",Sr.toFixed(3)]})]}),kt&&a.jsx("div",{className:"text-xs text-gray-400 text-right",children:Re.filter(Ct=>Ct!==ke).map(Ct=>{const Pr=k.find(It=>It.code===Ct);return`1 ${ke} = ${(Pr==null?void 0:Pr.exchangeRate)||1} ${Ct}`}).join(" | ")}),a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-gray-500",children:"Paid:"}),a.jsxs("span",{children:[ke," ",Ge.paidAmount.toFixed(3)]})]}),a.jsxs("div",{className:"flex justify-between text-sm font-medium",children:[a.jsx("span",{className:"text-gray-500",children:"Balance Due:"}),a.jsxs("span",{className:Ge.totalAmount-Ge.paidAmount>0?"text-red-600":"text-green-600",children:[ke," ",Math.max(0,Ge.totalAmount-Ge.paidAmount).toFixed(3)]})]})]})})()})}),(Ge.reference||Ge.notes)&&a.jsxs("div",{className:"border-t pt-4",children:[Ge.reference&&a.jsxs("div",{className:"text-sm",children:[a.jsx("span",{className:"text-gray-500",children:"Reference:"})," ",Ge.reference]}),Ge.notes&&a.jsxs("div",{className:"text-sm",children:[a.jsx("span",{className:"text-gray-500",children:"Notes:"})," ",Ge.notes]})]})]}):a.jsx("div",{className:"text-center py-12 text-gray-500",children:"No invoice data"}),a.jsx("div",{className:"flex justify-end pt-4 mt-4 border-t",children:a.jsx("button",{onClick:()=>{et(!1),Nt(null)},className:"px-6 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Close"})})]})]})}),ve&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-4xl max-h-[90vh] flex flex-col",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-[#003366] text-white rounded-t-xl",children:[a.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[a.jsx(Br,{size:20})," New Purchase Order"]}),a.jsx("button",{onClick:()=>xe(!1),children:a.jsx(yt,{size:24})})]}),a.jsxs("form",{onSubmit:kl,className:"p-6 space-y-4 overflow-y-auto max-h-[calc(90vh-140px)]",children:[a.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Supplier *"}),a.jsxs("select",{value:je.supplierId,onChange:P=>fe({...je,supplierId:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0,children:[a.jsx("option",{value:"",children:"Select Supplier"}),i.map(P=>a.jsx("option",{value:P.id,children:P.name},P.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"PO Date *"}),a.jsx("input",{type:"date",value:je.poDate,onChange:P=>fe({...je,poDate:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reference"}),a.jsx("input",{type:"text",value:je.reference,onChange:P=>fe({...je,reference:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsx("h6",{className:"font-medium",children:"Order Items"}),a.jsxs("button",{type:"button",onClick:tr,className:"text-sm text-blue-600 hover:text-blue-800 flex items-center gap-1",children:[a.jsx(hr,{size:14})," Add Item"]})]}),a.jsx("div",{className:"border rounded-lg",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-2 py-2 text-left font-medium",children:"#"}),a.jsx("th",{className:"px-2 py-2 text-left font-medium",children:"Product (search by name/barcode)"}),a.jsx("th",{className:"px-2 py-2 text-left font-medium w-24",children:"Qty"}),a.jsx("th",{className:"px-2 py-2 w-10"})]})}),a.jsx("tbody",{children:Ce.map((P,ke)=>a.jsxs("tr",{className:"border-t",children:[a.jsx("td",{className:"px-2 py-2",children:ke+1}),a.jsx("td",{className:"px-2 py-2",children:a.jsxs("div",{className:"relative",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Na,{size:14,className:"text-gray-400"}),a.jsx("input",{type:"text",value:Qt===ke?_e:P.productName||"",onChange:be=>{Vt(be.target.value),U(ke),be.target.value||(gn(ke,"productId",0),gn(ke,"productName",""))},onFocus:()=>{U(ke),Vt(P.productName||"")},onBlur:()=>setTimeout(()=>U(null),200),placeholder:"Search by name or barcode...",className:"flex-1 px-2 py-1 border rounded text-sm w-full"})]}),Qt===ke&&_e&&a.jsxs("div",{className:"absolute z-50 w-full bg-white border rounded-lg shadow-lg mt-1 max-h-48 overflow-y-auto",children:[x.filter(be=>be.name.toLowerCase().includes(_e.toLowerCase())||be.barcode&&be.barcode.includes(_e)||be.boxBarcode&&be.boxBarcode.includes(_e)||be.sku&&be.sku.toLowerCase().includes(_e.toLowerCase())).slice(0,10).map(be=>a.jsxs("div",{className:"px-3 py-2 hover:bg-blue-50 cursor-pointer text-sm border-b last:border-b-0",onMouseDown:()=>{gn(ke,"productId",be.id),gn(ke,"productName",be.name),Vt(""),U(null)},children:[a.jsx("div",{className:"font-medium",children:be.name}),a.jsxs("div",{className:"text-xs text-gray-500",children:["SKU: ",be.sku," ",be.barcode&&`| Barcode: ${be.barcode}`]})]},be.id)),x.filter(be=>be.name.toLowerCase().includes(_e.toLowerCase())||be.barcode&&be.barcode.includes(_e)||be.boxBarcode&&be.boxBarcode.includes(_e)||be.sku&&be.sku.toLowerCase().includes(_e.toLowerCase())).length===0&&a.jsxs("div",{className:"px-3 py-2 text-sm text-gray-600 cursor-pointer hover:bg-gray-50",onMouseDown:()=>{gn(ke,"productId",0),gn(ke,"productName",_e),Vt(""),U(null)},children:[a.jsx("span",{className:"text-blue-600",children:"+ Add as custom: "}),'"',_e,'"']})]})]})}),a.jsx("td",{className:"px-2 py-2",children:a.jsx("input",{type:"number",value:P.quantity,onChange:be=>gn(ke,"quantity",parseInt(be.target.value)||1),className:"w-full px-2 py-1 border rounded text-sm",min:1})}),a.jsx("td",{className:"px-2 py-2",children:a.jsx("button",{type:"button",onClick:()=>Wr(ke),className:"text-red-500 hover:text-red-700",children:a.jsx(xr,{size:16})})})]},ke))})]})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),a.jsx("textarea",{value:je.notes,onChange:P=>fe({...je,notes:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",rows:2,placeholder:"Additional notes for the supplier..."})]}),a.jsx("div",{className:"flex justify-end text-sm text-gray-500 border-t pt-4",children:a.jsxs("span",{children:["Total Items: ",Ce.filter(P=>P.productId>0||P.productName).length]})}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>xe(!1),className:"flex-1 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:O,className:"flex-1 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 disabled:opacity-50",children:O?"Saving...":"Create Purchase Order"})]})]})]})}),oe&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-4xl max-h-[90vh] overflow-hidden",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-blue-600 text-white",children:[a.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[a.jsx(Br,{size:20})," Purchase Order Details"]}),a.jsx("button",{onClick:()=>{Ie(!1),ht(null)},children:a.jsx(yt,{size:24})})]}),a.jsxs("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-80px)]",children:[At?a.jsx("div",{className:"flex items-center justify-center py-12",children:a.jsx(vt,{className:"animate-spin",size:32})}):me?a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[a.jsx("div",{className:"text-xs text-gray-500",children:"PO #"}),a.jsx("div",{className:"font-semibold",children:me.poNumber})]}),a.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[a.jsx("div",{className:"text-xs text-gray-500",children:"Supplier"}),a.jsx("div",{className:"font-semibold",children:me.supplierName}),me.supplierEmail&&a.jsx("div",{className:"text-xs text-gray-500",children:me.supplierEmail})]}),a.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[a.jsx("div",{className:"text-xs text-gray-500",children:"Date"}),a.jsx("div",{className:"font-semibold",children:me.poDate.split("T")[0]})]}),a.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[a.jsx("div",{className:"text-xs text-gray-500",children:"Status"}),a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${me.status==="draft"?"bg-gray-100 text-gray-700":me.status==="sent"?"bg-blue-100 text-blue-700":me.status==="confirmed"?"bg-yellow-100 text-yellow-700":me.status==="received"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:me.status})]})]}),me.expectedDate&&a.jsxs("div",{className:"text-sm text-gray-600",children:[a.jsx("span",{className:"font-medium",children:"Expected Delivery:"})," ",me.expectedDate.split("T")[0]]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold mb-2",children:"Items Requested"}),a.jsx("div",{className:"border rounded-lg overflow-hidden",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-600",children:"#"}),a.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-600",children:"Product"}),a.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-600",children:"Quantity"})]})}),a.jsx("tbody",{className:"divide-y",children:me.items.map((P,ke)=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-2 text-gray-500",children:ke+1}),a.jsxs("td",{className:"px-4 py-2",children:[a.jsx("div",{className:"font-medium",children:P.productName}),P.productSku&&a.jsx("div",{className:"text-xs text-gray-500",children:P.productSku})]}),a.jsx("td",{className:"px-4 py-2 text-right font-medium",children:P.quantity})]},ke))})]})})]}),a.jsx("div",{className:"flex justify-end text-sm text-gray-500",children:a.jsxs("span",{children:["Total Items: ",me.items.length]})}),(me.reference||me.notes)&&a.jsxs("div",{className:"border-t pt-4",children:[me.reference&&a.jsxs("div",{className:"text-sm",children:[a.jsx("span",{className:"text-gray-500",children:"Reference:"})," ",me.reference]}),me.notes&&a.jsxs("div",{className:"text-sm",children:[a.jsx("span",{className:"text-gray-500",children:"Notes:"})," ",me.notes]})]}),(me.sentAt||me.confirmedAt||me.receivedAt)&&a.jsxs("div",{className:"border-t pt-4 text-sm text-gray-500",children:[me.sentAt&&a.jsxs("div",{children:["Sent: ",new Date(me.sentAt).toLocaleString()]}),me.confirmedAt&&a.jsxs("div",{children:["Confirmed: ",new Date(me.confirmedAt).toLocaleString()]}),me.receivedAt&&a.jsxs("div",{children:["Received: ",new Date(me.receivedAt).toLocaleString()]})]})]}):a.jsx("div",{className:"text-center py-12 text-gray-500",children:"No PO data"}),a.jsxs("div",{className:"flex justify-between pt-4 mt-4 border-t",children:[a.jsx("div",{className:"flex gap-2",children:me&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{onClick:()=>$v(me),className:"flex items-center gap-2 px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600",children:[a.jsx(nx,{size:16})," PDF"]}),a.jsxs("button",{onClick:()=>Ux(me),className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:[a.jsx(X6,{size:16})," Excel"]})]})}),a.jsx("button",{onClick:()=>{Ie(!1),ht(null)},className:"px-6 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Close"})]})]})]})}),or&&zt&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-md",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-[#003366] text-white",children:[a.jsx("h2",{className:"text-lg font-semibold",children:"Settle Payment"}),a.jsx("button",{onClick:()=>{Gt(!1),ma(null)},children:a.jsx(yt,{size:24})})]}),a.jsxs("form",{onSubmit:T,className:"p-6 space-y-4",children:[a.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg space-y-2",children:[a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-gray-500",children:"Invoice:"}),a.jsx("span",{className:"font-medium",children:zt.invoiceNumber})]}),a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-gray-500",children:"Supplier:"}),a.jsx("span",{children:zt.supplierName})]}),a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-gray-500",children:"Total Amount:"}),a.jsx("span",{className:"font-medium",children:zt.total.toFixed(3)})]}),a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-gray-500",children:"Paid Amount:"}),a.jsx("span",{className:"text-green-600",children:(zt.paidAmount||0).toFixed(3)})]}),a.jsxs("div",{className:"flex justify-between text-sm font-semibold border-t pt-2",children:[a.jsx("span",{children:"Remaining:"}),a.jsx("span",{className:"text-red-600",children:Math.max(0,zt.total-(zt.paidAmount||0)).toFixed(3)})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Date *"}),a.jsx("input",{type:"date",value:yn.paymentDate,onChange:P=>Co({...yn,paymentDate:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Method *"}),a.jsxs("select",{value:yn.method,onChange:P=>Co({...yn,method:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[a.jsx("option",{value:"Cash",children:"Cash"}),a.jsx("option",{value:"Bank Transfer",children:"Bank Transfer"}),a.jsx("option",{value:"Check",children:"Check"}),a.jsx("option",{value:"Credit Card",children:"Credit Card"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount *"}),a.jsx("input",{type:"number",step:"0.01",value:yn.amount,onChange:P=>Co({...yn,amount:parseFloat(P.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reference"}),a.jsx("input",{type:"text",value:yn.reference,onChange:P=>Co({...yn,reference:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),a.jsx("textarea",{value:yn.notes,onChange:P=>Co({...yn,notes:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",rows:2})]}),a.jsxs("div",{className:"flex gap-3 pt-2",children:[a.jsx("button",{type:"button",onClick:()=>{Gt(!1),ma(null)},className:"flex-1 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:O,className:"flex-1 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 disabled:opacity-50",children:O?a.jsx(vt,{className:"animate-spin mx-auto",size:20}):"Pay Now"})]})]})]})}),Or&&Is&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-md",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-[#003366] text-white",children:[a.jsx("h2",{className:"text-lg font-semibold",children:"Edit Payment"}),a.jsx("button",{onClick:()=>{_r(!1),Jr(null)},children:a.jsx(yt,{size:24})})]}),a.jsxs("form",{onSubmit:fr,className:"p-6 space-y-4",children:[a.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg space-y-2",children:[a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-gray-500",children:"Payment #:"}),a.jsx("span",{className:"font-medium",children:Is.paymentNumber})]}),a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-gray-500",children:"Supplier:"}),a.jsx("span",{children:Is.supplierName})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Date *"}),a.jsx("input",{type:"date",value:Ae.paymentDate,onChange:P=>nt({...Ae,paymentDate:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Method *"}),a.jsxs("select",{value:Ae.method,onChange:P=>nt({...Ae,method:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[a.jsx("option",{value:"Cash",children:"Cash"}),a.jsx("option",{value:"Bank Transfer",children:"Bank Transfer"}),a.jsx("option",{value:"Check",children:"Check"}),a.jsx("option",{value:"Credit Card",children:"Credit Card"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount *"}),a.jsx("input",{type:"number",step:"0.01",value:Ae.amount,onChange:P=>nt({...Ae,amount:parseFloat(P.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reference"}),a.jsx("input",{type:"text",value:Ae.reference,onChange:P=>nt({...Ae,reference:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),a.jsx("textarea",{value:Ae.notes,onChange:P=>nt({...Ae,notes:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",rows:2})]}),a.jsxs("div",{className:"flex gap-3 pt-2",children:[a.jsx("button",{type:"button",onClick:()=>{_r(!1),Jr(null)},className:"flex-1 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:O,className:"flex-1 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50",children:O?a.jsx(vt,{className:"animate-spin mx-auto",size:20}):"Update"})]})]})]})}),Pe&&qe&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-lg w-full mx-4 max-h-[90vh] overflow-auto",children:[a.jsx("div",{className:"p-6 border-b",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Br,{size:24,className:"text-emerald-600"}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-bold",children:"Supplier Report"}),a.jsx("p",{className:"text-sm text-gray-500",children:qe.name})]})]}),a.jsx("button",{onClick:()=>pe(!1),className:"p-2 hover:bg-gray-100 rounded-lg",children:a.jsx(yt,{size:20})})]})}),a.jsx("div",{className:"p-6 space-y-4",children:at?a.jsxs("div",{className:"flex items-center justify-center py-8",children:[a.jsx(vt,{className:"animate-spin",size:32}),a.jsx("span",{className:"ml-2",children:"Loading report data..."})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:a.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Invoices:"}),a.jsx("span",{className:"ml-2 font-medium",children:ft.length})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Payments:"}),a.jsx("span",{className:"ml-2 font-medium",children:dt.length})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Purchase Orders:"}),a.jsx("span",{className:"ml-2 font-medium",children:Y.length})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"We Owe:"}),a.jsx("span",{className:`ml-2 font-medium ${qe.balance>0?"text-red-600":"text-green-600"}`,children:qe.balance.toFixed(3)})]}),qe.creditBalance>0&&a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"They Owe Us:"}),a.jsx("span",{className:"ml-2 font-medium text-blue-600",children:qe.creditBalance.toFixed(3)})]})]})}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("h3",{className:"font-medium text-gray-700",children:"Include in Report:"}),a.jsxs("label",{className:"flex items-center gap-3 p-3 bg-white border rounded-lg cursor-pointer hover:bg-gray-50",children:[a.jsx("input",{type:"checkbox",checked:Mt.showSummary,onChange:P=>Lt({...Mt,showSummary:P.target.checked}),className:"w-5 h-5 text-emerald-600 rounded"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-medium",children:"Summary"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Total invoices, payments, balance"})]}),Mt.showSummary&&a.jsx(Jt,{size:18,className:"text-emerald-600"})]}),a.jsxs("label",{className:"flex items-center gap-3 p-3 bg-white border rounded-lg cursor-pointer hover:bg-gray-50",children:[a.jsx("input",{type:"checkbox",checked:Mt.showPurchaseOrders,onChange:P=>Lt({...Mt,showPurchaseOrders:P.target.checked}),className:"w-5 h-5 text-emerald-600 rounded"}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("p",{className:"font-medium",children:["Purchase Orders (",Y.length,")"]}),a.jsx("p",{className:"text-sm text-gray-500",children:"All purchase orders"})]}),Mt.showPurchaseOrders&&a.jsx(Jt,{size:18,className:"text-emerald-600"})]}),a.jsxs("label",{className:"flex items-center gap-3 p-3 bg-white border rounded-lg cursor-pointer hover:bg-gray-50",children:[a.jsx("input",{type:"checkbox",checked:Mt.showInvoices,onChange:P=>Lt({...Mt,showInvoices:P.target.checked}),className:"w-5 h-5 text-emerald-600 rounded"}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("p",{className:"font-medium",children:["Purchase Invoices (",ft.length,")"]}),a.jsx("p",{className:"text-sm text-gray-500",children:"All purchase invoices with status"})]}),Mt.showInvoices&&a.jsx(Jt,{size:18,className:"text-emerald-600"})]}),a.jsxs("label",{className:"flex items-center gap-3 p-3 bg-white border rounded-lg cursor-pointer hover:bg-gray-50",children:[a.jsx("input",{type:"checkbox",checked:Mt.showPayments,onChange:P=>Lt({...Mt,showPayments:P.target.checked}),className:"w-5 h-5 text-emerald-600 rounded"}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("p",{className:"font-medium",children:["Payment History (",dt.length,")"]}),a.jsx("p",{className:"text-sm text-gray-500",children:"All payments made to supplier"})]}),Mt.showPayments&&a.jsx(Jt,{size:18,className:"text-emerald-600"})]})]})]})}),a.jsxs("div",{className:"p-6 border-t bg-gray-50 flex gap-3",children:[a.jsx("button",{onClick:()=>pe(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-100",children:"Cancel"}),a.jsxs("button",{onClick:()=>{qL(),pe(!1)},disabled:at,className:"flex-1 px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 disabled:opacity-50 flex items-center justify-center gap-2",children:[a.jsx(ua,{size:18}),"Print Report"]})]})]})}),na&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[60]",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-md overflow-hidden",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-[#003366] text-white",children:[a.jsx("h2",{className:"text-lg font-semibold",children:"Select Payment Method"}),a.jsx("button",{onClick:()=>Os(!1),children:a.jsx(yt,{size:24})})]}),a.jsxs("div",{className:"p-6 space-y-4",children:[a.jsxs("div",{className:"text-center mb-4",children:[a.jsx("p",{className:"text-gray-600",children:"Invoice Total"}),a.jsx("p",{className:"text-3xl font-bold text-[#003366]",children:ki().toFixed(2)})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("label",{className:`flex items-center gap-3 p-4 border-2 rounded-lg cursor-pointer transition-all ${gr==="cash"?"border-green-500 bg-green-50":"border-gray-200 hover:border-gray-300"}`,children:[a.jsx("input",{type:"radio",name:"paymentMethod",checked:gr==="cash",onChange:()=>V("cash"),className:"w-5 h-5 text-green-600"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-semibold text-gray-800",children:"Cash"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Pay full amount now"})]}),a.jsx(da,{size:24,className:gr==="cash"?"text-green-600":"text-gray-400"})]}),a.jsxs("label",{className:`flex items-center gap-3 p-4 border-2 rounded-lg cursor-pointer transition-all ${gr==="on_account"?"border-orange-500 bg-orange-50":"border-gray-200 hover:border-gray-300"}`,children:[a.jsx("input",{type:"radio",name:"paymentMethod",checked:gr==="on_account",onChange:()=>V("on_account"),className:"w-5 h-5 text-orange-600"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-semibold text-gray-800",children:"On Account"}),a.jsx("p",{className:"text-sm text-gray-500",children:(()=>{const P=i.find(Re=>Re.id===parseInt(nr.supplierId)),ke=(P==null?void 0:P.creditBalance)||0,be=ki();if(ke>0){const Re=Math.min(ke,be),kt=be-Re;return`Use ${Re.toFixed(3)} credit${kt>0?`, ${kt.toFixed(3)} to balance`:" (fully paid)"}`}return"Add to supplier balance"})()})]}),a.jsx(Br,{size:24,className:gr==="on_account"?"text-orange-600":"text-gray-400"})]}),a.jsxs("label",{className:`flex items-center gap-3 p-4 border-2 rounded-lg cursor-pointer transition-all ${gr==="split"?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[a.jsx("input",{type:"radio",name:"paymentMethod",checked:gr==="split",onChange:()=>V("split"),className:"w-5 h-5 text-blue-600"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-semibold text-gray-800",children:"Split"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Pay partial cash, rest on account"})]}),a.jsx("div",{className:`px-2 py-1 rounded text-xs font-medium ${gr==="split"?"bg-blue-600 text-white":"bg-gray-200 text-gray-600"}`,children:"50/50"})]})]}),gr==="split"&&a.jsxs("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cash Amount"}),a.jsx("input",{type:"number",step:"0.01",value:J,onChange:P=>X(Math.min(parseFloat(P.target.value)||0,ki())),max:ki(),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-gray-600",children:"On Account:"}),a.jsxs("span",{className:"font-semibold text-orange-600",children:["$",(ki()-J).toFixed(2)]})]})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>Os(!1),className:"flex-1 py-3 border border-gray-300 rounded-lg hover:bg-gray-50 font-medium",children:"Cancel"}),a.jsxs("button",{type:"button",onClick:Vv,disabled:O,className:"flex-1 py-3 bg-[#003366] text-white rounded-lg hover:bg-[#002244] disabled:opacity-50 font-medium flex items-center justify-center gap-2",children:[O?a.jsx(vt,{size:18,className:"animate-spin"}):a.jsx(Jt,{size:18}),O?"Saving...":"Confirm & Save"]})]})]})]})})]})}function ove(){const[e,t]=m.useState("expenses"),[r,s]=m.useState([]),[n,i]=m.useState([]),[l,o]=m.useState([]),[c,u]=m.useState(!0),[d,h]=m.useState(!1),[f,x]=m.useState(""),[p,g]=m.useState(""),[y,v]=m.useState(""),[j,b]=m.useState(""),[w,k]=m.useState(!1),[N,S]=m.useState(!1),[_,O]=m.useState(null),[E,R]=m.useState({categoryId:"",vanId:"",amount:0,expenseDate:new Date().toISOString().split("T")[0],description:"",receiptUrl:""}),[C,I]=m.useState({name:"",description:"",isDefault:!1,isActive:!0});m.useEffect(()=>{ne()},[]);const ne=async()=>{try{u(!0);const[L,Z,F]=await Promise.all([Pi.getAll(),Pi.getCategories(),rn.getAll()]);s(L.data),i(Z.data),o(F.data.map(he=>({id:he.id,name:he.name})))}catch(L){console.error("Failed to load data:",L)}finally{u(!1)}},W=async()=>{try{const L={};f&&(L.startDate=f),p&&(L.endDate=p),y&&(L.vanId=y),j&&(L.categoryId=j);const Z=await Pi.getAll(L);s(Z.data)}catch(L){console.error("Failed to load expenses:",L)}};m.useEffect(()=>{c||W()},[f,p,y,j]);const Q=()=>R({categoryId:"",vanId:"",amount:0,expenseDate:new Date().toISOString().split("T")[0],description:"",receiptUrl:""}),H=()=>I({name:"",description:"",isDefault:!1,isActive:!0}),K=async L=>{var Z,F;L.preventDefault(),h(!0);try{await Pi.create({...E,categoryId:E.categoryId?parseInt(E.categoryId):null,vanId:E.vanId?parseInt(E.vanId):null}),k(!1),Q(),W()}catch(he){alert(((F=(Z=he.response)==null?void 0:Z.data)==null?void 0:F.message)||"Failed to save expense")}finally{h(!1)}},q=async L=>{var Z,F;if(confirm("Delete this expense?"))try{await Pi.delete(L),W()}catch(he){alert(((F=(Z=he.response)==null?void 0:Z.data)==null?void 0:F.message)||"Failed to delete")}},ge=()=>{const L=r.filter(ye=>!(y&&ye.vanId!==parseInt(y)||j&&ye.categoryId!==parseInt(j))),Z=L.reduce((ye,z)=>ye+z.amount,0),F=L.reduce((ye,z)=>{const A=z.categoryName||"Uncategorized";return ye[A]=(ye[A]||0)+z.amount,ye},{}),he=window.open("","_blank");if(!he){alert("Please allow popups to print report");return}he.document.write(`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Expenses Report</title>
        <style>
          body { font-family: Arial, sans-serif; font-size: 12px; padding: 20px; }
          .header { text-align: center; margin-bottom: 20px; border-bottom: 2px solid #333; padding-bottom: 10px; }
          .header h1 { margin: 0; font-size: 24px; }
          .summary { display: flex; gap: 20px; margin-bottom: 20px; }
          .summary-card { flex: 1; border: 1px solid #ddd; padding: 15px; border-radius: 8px; text-align: center; }
          .summary-card .value { font-size: 24px; font-weight: bold; color: #2563eb; }
          .summary-card .label { font-size: 12px; color: #666; }
          .by-category { margin-bottom: 20px; }
          .by-category h3 { margin-bottom: 10px; }
          .cat-row { display: flex; justify-content: space-between; padding: 5px 0; border-bottom: 1px solid #eee; }
          table { width: 100%; border-collapse: collapse; }
          th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
          th { background: #f5f5f5; }
          .text-right { text-align: right; }
          .footer { margin-top: 20px; text-align: center; font-size: 10px; color: #666; }
        </style>
      </head>
      <body>
        <div class="header">
          <h1>Expenses Report</h1>
          <p>${f&&p?`${f} to ${p}`:"All Time"}</p>
        </div>
        
        <div class="summary">
          <div class="summary-card">
            <div class="value">${L.length}</div>
            <div class="label">Total Expenses</div>
          </div>
          <div class="summary-card">
            <div class="value">$${Z.toFixed(3)}</div>
            <div class="label">Total Amount</div>
          </div>
        </div>

        <div class="by-category">
          <h3>By Category</h3>
          ${Object.entries(F).map(([ye,z])=>`
            <div class="cat-row">
              <span>${ye}</span>
              <span>$${z.toFixed(3)}</span>
            </div>
          `).join("")}
        </div>

        <table>
          <thead>
            <tr>
              <th>Date</th>
              <th>Category</th>
              <th>Van</th>
              <th>Description</th>
              <th class="text-right">Amount</th>
            </tr>
          </thead>
          <tbody>
            ${L.map(ye=>`
              <tr>
                <td>${new Date(ye.expenseDate).toLocaleDateString()}</td>
                <td>${ye.categoryName||"-"}</td>
                <td>${ye.vanName||"-"}</td>
                <td>${ye.description||"-"}</td>
                <td class="text-right">$${ye.amount.toFixed(3)}</td>
              </tr>
            `).join("")}
          </tbody>
          <tfoot>
            <tr>
              <th colspan="4">Total</th>
              <th class="text-right">$${Z.toFixed(3)}</th>
            </tr>
          </tfoot>
        </table>

        <div class="footer">
          <p>Generated: ${new Date().toLocaleString()}</p>
        </div>
      </body>
      </html>
    `),he.document.close(),he.print()},G=L=>{O(L),I({name:L.name,description:L.description||"",isDefault:L.isDefault,isActive:L.isActive}),S(!0)},B=async L=>{var Z,F;if(L.preventDefault(),!!C.name.trim()){h(!0);try{_?await Pi.updateCategory(_.id,C):await Pi.createCategory(C),S(!1),H(),O(null);const he=await Pi.getCategories();i(he.data)}catch(he){alert(((F=(Z=he.response)==null?void 0:Z.data)==null?void 0:F.message)||"Failed to save category")}finally{h(!1)}}},se=async L=>{var Z,F;if(confirm("Delete this category?"))try{await Pi.deleteCategory(L);const he=await Pi.getCategories();i(he.data)}catch(he){alert(((F=(Z=he.response)==null?void 0:Z.data)==null?void 0:F.message)||"Failed to delete")}};return c?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx(vt,{className:"animate-spin",size:32})}):a.jsxs("div",{children:[a.jsx("div",{className:"flex justify-between items-center mb-6",children:a.jsx("div",{children:a.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[a.jsx(Yo,{className:"text-blue-600"})," Expenses"]})})}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm",children:[a.jsx("div",{className:"border-b",children:a.jsxs("div",{className:"flex",children:[a.jsx("button",{onClick:()=>t("expenses"),className:`px-6 py-3 font-medium text-sm ${e==="expenses"?"border-b-2 border-blue-600 text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Expenses"}),a.jsx("button",{onClick:()=>t("categories"),className:`px-6 py-3 font-medium text-sm ${e==="categories"?"border-b-2 border-blue-600 text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Categories"})]})}),a.jsxs("div",{className:"p-4",children:[e==="expenses"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex flex-wrap gap-3 mb-4",children:[a.jsx("input",{type:"date",value:f,onChange:L=>x(L.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm"}),a.jsx("input",{type:"date",value:p,onChange:L=>g(L.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm"}),a.jsxs("select",{value:y,onChange:L=>v(L.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[a.jsx("option",{value:"",children:"All Vans"}),l.map(L=>a.jsx("option",{value:L.id,children:L.name},L.id))]}),a.jsxs("select",{value:j,onChange:L=>b(L.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[a.jsx("option",{value:"",children:"All Types"}),n.filter(L=>L.isActive).map(L=>a.jsx("option",{value:L.id,children:L.name},L.id))]}),a.jsxs("button",{onClick:()=>{Q(),k(!0)},className:"flex items-center gap-1 px-4 py-2 bg-emerald-500 text-white rounded-lg text-sm hover:bg-emerald-600",children:[a.jsx(hr,{size:16})," Add Expense"]}),a.jsxs("button",{onClick:ge,className:"flex items-center gap-1 px-4 py-2 bg-blue-500 text-white rounded-lg text-sm hover:bg-blue-600",children:[a.jsx(ua,{size:16})," Print Report"]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Date"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Type"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Van"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Amount"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Description"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:r.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:6,className:"px-4 py-8 text-center text-gray-500",children:"No expenses found"})}):r.map(L=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3",children:L.expenseDate.split("T")[0]}),a.jsx("td",{className:"px-4 py-3 font-medium",children:L.categoryName||"General"}),a.jsx("td",{className:"px-4 py-3",children:L.vanName||"-"}),a.jsxs("td",{className:"px-4 py-3 font-medium text-red-600",children:["$",L.amount.toFixed(3)]}),a.jsx("td",{className:"px-4 py-3 text-gray-500",children:L.description||"-"}),a.jsx("td",{className:"px-4 py-3",children:a.jsx("button",{onClick:()=>q(L.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",children:a.jsx(xr,{size:16})})})]},L.id))})]})})]}),e==="categories"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsxs("span",{className:"text-sm text-gray-500",children:[n.length," categories"]}),a.jsxs("button",{onClick:()=>{H(),O(null),S(!0)},className:"flex items-center gap-1 px-4 py-2 bg-emerald-500 text-white rounded-lg text-sm hover:bg-emerald-600",children:[a.jsx(hr,{size:16})," Add Category"]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Name"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Description"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Default"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Active"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:n.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:5,className:"px-4 py-8 text-center text-gray-500",children:"No categories"})}):n.map(L=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 font-medium",children:L.name}),a.jsx("td",{className:"px-4 py-3 text-gray-500 text-sm",children:L.description||"-"}),a.jsx("td",{className:"px-4 py-3",children:L.isDefault?a.jsx("span",{className:"px-2 py-1 bg-gray-200 text-gray-700 rounded text-xs",children:"Yes"}):a.jsx("span",{className:"text-gray-400 text-xs",children:"No"})}),a.jsx("td",{className:"px-4 py-3",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${L.isActive?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:L.isActive?"Active":"Inactive"})}),a.jsx("td",{className:"px-4 py-3",children:a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:()=>G(L),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",children:a.jsx(js,{size:16})}),a.jsx("button",{onClick:()=>se(L.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",children:a.jsx(xr,{size:16})})]})})]},L.id))})]})})]})]})]}),w&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-lg",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-[#003366] text-white rounded-t-xl",children:[a.jsx("h2",{className:"text-lg font-semibold",children:"Add Expense"}),a.jsx("button",{onClick:()=>k(!1),children:a.jsx(yt,{size:24})})]}),a.jsxs("form",{onSubmit:K,className:"p-6 space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),a.jsxs("select",{value:E.categoryId,onChange:L=>R({...E,categoryId:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[a.jsx("option",{value:"",children:"General"}),n.filter(L=>L.isActive).map(L=>a.jsx("option",{value:L.id,children:L.name},L.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Van (optional)"}),a.jsxs("select",{value:E.vanId,onChange:L=>R({...E,vanId:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[a.jsx("option",{value:"",children:"Not linked"}),l.map(L=>a.jsx("option",{value:L.id,children:L.name},L.id))]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount *"}),a.jsx("input",{type:"number",step:"0.01",value:E.amount,onChange:L=>R({...E,amount:parseFloat(L.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date *"}),a.jsx("input",{type:"date",value:E.expenseDate,onChange:L=>R({...E,expenseDate:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),a.jsx("input",{type:"text",value:E.description,onChange:L=>R({...E,description:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"Enter description"})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>k(!1),className:"flex-1 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:d,className:"flex-1 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 disabled:opacity-50",children:d?"Saving...":"Save"})]})]})]})}),N&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-md",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-[#003366] text-white rounded-t-xl",children:[a.jsx("h2",{className:"text-lg font-semibold",children:_?"Edit Category":"New Expense Category"}),a.jsx("button",{onClick:()=>S(!1),children:a.jsx(yt,{size:24})})]}),a.jsxs("form",{onSubmit:B,className:"p-6 space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category Name *"}),a.jsx("input",{type:"text",value:C.name,onChange:L=>I({...C,name:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"e.g. Office Supplies",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),a.jsx("textarea",{value:C.description,onChange:L=>I({...C,description:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",rows:2,placeholder:"Short description"})]}),a.jsxs("div",{className:"flex gap-4",children:[a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",checked:C.isDefault,onChange:L=>I({...C,isDefault:L.target.checked}),className:"rounded"}),a.jsx("span",{className:"text-sm",children:"Default category"})]}),a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",checked:C.isActive,onChange:L=>I({...C,isActive:L.target.checked}),className:"rounded"}),a.jsx("span",{className:"text-sm",children:"Active"})]})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>S(!1),className:"flex-1 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:d,className:"flex-1 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 disabled:opacity-50",children:d?"Saving...":"Save"})]})]})]})})]})}function cve(){var S,_,O,E,R,C;const[e,t]=m.useState(""),[r,s]=m.useState(new Date().toISOString().split("T")[0]),[n,i]=m.useState(new Date().toISOString().split("T")[0]),[l,o]=m.useState(null),[c,u]=m.useState(null),[d,h]=m.useState(!1),[f,x]=m.useState([]),[p,g]=m.useState(""),[y,v]=m.useState([]),j=[{id:"vanPerformance",name:"Van Performance",icon:On,description:"Sales and activity per van"},{id:"sales",name:"Sales Report",icon:da,description:"Summary of all orders and sales"},{id:"collections",name:"Collections Report",icon:Tr,description:"Summary of all cash collections"},{id:"stock",name:"Stock Report",icon:Tr,description:"Current inventory levels"},{id:"expenses",name:"Expenses Report",icon:hn,description:"Summary of all expenses"},{id:"driver",name:"Driver Performance",icon:so,description:"Driver activity and performance"}];m.useEffect(()=>{b(),w()},[]);const b=async()=>{try{const I=await _o.getDashboard();o(I)}catch(I){console.error("Failed to load dashboard:",I)}},w=async()=>{try{const I=await rn.getAll();x(I.data.map(ne=>({id:ne.id,name:ne.name,driverName:ne.driverName})))}catch(I){console.error("Failed to load vans:",I)}},k=async()=>{if(!(!e||!r||!n)){h(!0);try{let I;switch(e){case"vanPerformance":I=await _o.getVanPerformance(r,n,p?parseInt(p):void 0),v(I.vans||[]);break;case"sales":I=await _o.getSales(r,n);break;case"collections":I=await _o.getCollections(r,n);break;case"stock":I=await _o.getStock();break;case"expenses":I=await _o.getExpenses(r,n);break;case"driver":I=await _o.getDriverPerformance(r,n);break}u(I)}catch(I){console.error("Failed to generate report:",I)}finally{h(!1)}}},N=I=>`$${I.toFixed(3)}`;return a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Reports"}),l&&a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-2 bg-emerald-100 rounded-lg",children:a.jsx(da,{className:"text-emerald-600",size:20})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500",children:"Today Sales"}),a.jsx("p",{className:"text-lg font-bold text-gray-900",children:N(l.todaySales)})]})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:a.jsx(hn,{className:"text-blue-600",size:20})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500",children:"Month Sales"}),a.jsx("p",{className:"text-lg font-bold text-gray-900",children:N(l.monthSales)})]})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-2 bg-orange-100 rounded-lg",children:a.jsx(Tr,{className:"text-orange-600",size:20})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500",children:"Outstanding Debt"}),a.jsx("p",{className:"text-lg font-bold text-gray-900",children:N(l.totalOutstandingDebt)})]})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:a.jsx(so,{className:"text-purple-600",size:20})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500",children:"Active Drivers"}),a.jsx("p",{className:"text-lg font-bold text-gray-900",children:l.activeDrivers})]})]})})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[a.jsx("div",{className:"lg:col-span-1",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4",children:[a.jsx("h2",{className:"font-semibold text-gray-900 mb-4",children:"Select Report"}),a.jsx("div",{className:"space-y-2",children:j.map(I=>a.jsx("button",{onClick:()=>{t(I.id),u(null)},className:`w-full text-left px-4 py-3 rounded-lg transition ${e===I.id?"bg-emerald-50 border-2 border-emerald-500":"bg-gray-50 hover:bg-gray-100"}`,children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Br,{size:20,className:e===I.id?"text-emerald-500":"text-gray-400"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-900",children:I.name}),a.jsx("p",{className:"text-xs text-gray-500",children:I.description})]})]})},I.id))})]})}),a.jsxs("div",{className:"lg:col-span-2",children:[a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[a.jsx("h2",{className:"font-semibold text-gray-900 mb-4",children:"Filters"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date"}),a.jsx("input",{type:"date",value:r,onChange:I=>s(I.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date"}),a.jsx("input",{type:"date",value:n,onChange:I=>i(I.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]})]}),e==="vanPerformance"&&a.jsxs("div",{className:"mb-6",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Filter by Van"}),a.jsxs("select",{value:p,onChange:I=>g(I.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[a.jsx("option",{value:"",children:"All Vans"}),f.map(I=>a.jsxs("option",{value:I.id,children:[I.name," ",I.driverName?`(${I.driverName})`:""]},I.id))]})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsxs("button",{onClick:k,disabled:!e||d,className:"flex items-center gap-2 px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 disabled:opacity-50",children:[d?a.jsx(vt,{size:18,className:"animate-spin"}):a.jsx(Br,{size:18}),"Generate Report"]}),a.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:[a.jsx(nx,{size:18})," Export"]}),a.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:[a.jsx(ua,{size:18})," Print"]})]})]}),c&&a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 mt-6",children:[a.jsx("h2",{className:"font-semibold text-gray-900 mb-4",children:(S=j.find(I=>I.id===e))==null?void 0:S.name}),e==="sales"&&a.jsxs("div",{children:[a.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 text-center",children:[a.jsx("p",{className:"text-2xl font-bold text-emerald-600",children:N(c.totalSales)}),a.jsx("p",{className:"text-sm text-gray-500",children:"Total Sales"})]}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 text-center",children:[a.jsx("p",{className:"text-2xl font-bold text-blue-600",children:c.totalOrders}),a.jsx("p",{className:"text-sm text-gray-500",children:"Orders"})]}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 text-center",children:[a.jsx("p",{className:"text-2xl font-bold text-purple-600",children:N(c.averageOrderValue)}),a.jsx("p",{className:"text-sm text-gray-500",children:"Avg Order Value"})]})]}),((_=c.topProducts)==null?void 0:_.length)>0&&a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium text-gray-700 mb-2",children:"Top Products"}),a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-left p-2",children:"Product"}),a.jsx("th",{className:"text-right p-2",children:"Qty Sold"}),a.jsx("th",{className:"text-right p-2",children:"Revenue"})]})}),a.jsx("tbody",{children:c.topProducts.map((I,ne)=>a.jsxs("tr",{className:"border-b",children:[a.jsxs("td",{className:"p-2",children:[a.jsx("div",{children:I.productName}),I.variantName&&a.jsx("span",{className:"inline-block mt-0.5 px-1.5 py-0.5 bg-purple-100 text-purple-700 rounded text-[10px] font-medium",children:I.variantName})]}),a.jsx("td",{className:"text-right p-2",children:I.quantitySold}),a.jsx("td",{className:"text-right p-2",children:N(I.totalRevenue)})]},`${I.productId}-${I.variantId??"base"}-${ne}`))})]})]})]}),e==="collections"&&a.jsxs("div",{children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 text-center",children:[a.jsx("p",{className:"text-2xl font-bold text-emerald-600",children:N(c.totalAmount)}),a.jsx("p",{className:"text-sm text-gray-500",children:"Total Collected"})]}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 text-center",children:[a.jsx("p",{className:"text-2xl font-bold text-blue-600",children:c.totalCollections}),a.jsx("p",{className:"text-sm text-gray-500",children:"Collections"})]})]}),((O=c.byDriver)==null?void 0:O.length)>0&&a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium text-gray-700 mb-2",children:"By Driver"}),a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-left p-2",children:"Driver"}),a.jsx("th",{className:"text-right p-2",children:"Count"}),a.jsx("th",{className:"text-right p-2",children:"Amount"})]})}),a.jsx("tbody",{children:c.byDriver.map(I=>a.jsxs("tr",{className:"border-b",children:[a.jsx("td",{className:"p-2",children:I.driverName}),a.jsx("td",{className:"text-right p-2",children:I.count}),a.jsx("td",{className:"text-right p-2",children:N(I.amount)})]},I.driverId))})]})]})]}),e==="stock"&&a.jsxs("div",{children:[a.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 text-center",children:[a.jsx("p",{className:"text-2xl font-bold text-emerald-600",children:c.totalProducts}),a.jsx("p",{className:"text-sm text-gray-500",children:"Total Products"})]}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 text-center",children:[a.jsx("p",{className:"text-2xl font-bold text-blue-600",children:N(c.totalWarehouseValue)}),a.jsx("p",{className:"text-sm text-gray-500",children:"Warehouse Value"})]}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 text-center",children:[a.jsx("p",{className:"text-2xl font-bold text-red-600",children:c.lowStockCount}),a.jsx("p",{className:"text-sm text-gray-500",children:"Low Stock Items"})]})]}),((E=c.lowStockProducts)==null?void 0:E.length)>0&&a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium text-gray-700 mb-2",children:"Low Stock Alert"}),a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-left p-2",children:"Product"}),a.jsx("th",{className:"text-right p-2",children:"Warehouse"}),a.jsx("th",{className:"text-right p-2",children:"Vans"}),a.jsx("th",{className:"text-right p-2",children:"Total"})]})}),a.jsx("tbody",{children:c.lowStockProducts.map(I=>a.jsxs("tr",{className:"border-b",children:[a.jsx("td",{className:"p-2",children:I.productName}),a.jsx("td",{className:"text-right p-2",children:I.warehouseStock}),a.jsx("td",{className:"text-right p-2",children:I.vanStock}),a.jsx("td",{className:"text-right p-2 font-medium text-red-600",children:I.totalStock})]},I.productId))})]})]})]}),e==="expenses"&&a.jsxs("div",{children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 text-center",children:[a.jsx("p",{className:"text-2xl font-bold text-red-600",children:N(c.totalAmount)}),a.jsx("p",{className:"text-sm text-gray-500",children:"Total Expenses"})]}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 text-center",children:[a.jsx("p",{className:"text-2xl font-bold text-blue-600",children:c.totalExpenses}),a.jsx("p",{className:"text-sm text-gray-500",children:"Transactions"})]})]}),((R=c.byCategory)==null?void 0:R.length)>0&&a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium text-gray-700 mb-2",children:"By Category"}),a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-left p-2",children:"Category"}),a.jsx("th",{className:"text-right p-2",children:"Count"}),a.jsx("th",{className:"text-right p-2",children:"Amount"})]})}),a.jsx("tbody",{children:c.byCategory.map((I,ne)=>a.jsxs("tr",{className:"border-b",children:[a.jsx("td",{className:"p-2",children:I.categoryName}),a.jsx("td",{className:"text-right p-2",children:I.count}),a.jsx("td",{className:"text-right p-2",children:N(I.amount)})]},ne))})]})]})]}),e==="vanPerformance"&&a.jsxs("div",{children:[a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[a.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 text-center",children:[a.jsx("p",{className:"text-2xl font-bold text-blue-600",children:c.totalVans}),a.jsx("p",{className:"text-sm text-gray-500",children:"Total Vans"})]}),a.jsxs("div",{className:"bg-emerald-50 rounded-lg p-4 text-center",children:[a.jsx("p",{className:"text-2xl font-bold text-emerald-600",children:N(y.reduce((I,ne)=>I+ne.totalSales,0))}),a.jsx("p",{className:"text-sm text-gray-500",children:"Total Sales"})]}),a.jsxs("div",{className:"bg-purple-50 rounded-lg p-4 text-center",children:[a.jsx("p",{className:"text-2xl font-bold text-purple-600",children:y.reduce((I,ne)=>I+ne.totalOrders,0)}),a.jsx("p",{className:"text-sm text-gray-500",children:"Total Orders"})]}),a.jsxs("div",{className:"bg-orange-50 rounded-lg p-4 text-center",children:[a.jsx("p",{className:"text-2xl font-bold text-orange-600",children:N(y.reduce((I,ne)=>I+ne.currentCash,0))}),a.jsx("p",{className:"text-sm text-gray-500",children:"Cash in Vans"})]})]}),y.length>0?a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-left p-3 font-semibold",children:"Van"}),a.jsx("th",{className:"text-left p-3 font-semibold",children:"Driver"}),a.jsx("th",{className:"text-right p-3 font-semibold",children:"Orders"}),a.jsx("th",{className:"text-right p-3 font-semibold",children:"Sales"}),a.jsx("th",{className:"text-right p-3 font-semibold",children:"Collections"}),a.jsx("th",{className:"text-right p-3 font-semibold",children:"Deposits"}),a.jsx("th",{className:"text-right p-3 font-semibold",children:"Current Cash"})]})}),a.jsx("tbody",{children:y.map(I=>a.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[a.jsx("td",{className:"p-3 font-medium",children:I.vanName}),a.jsx("td",{className:"p-3",children:I.driverName}),a.jsx("td",{className:"text-right p-3",children:I.totalOrders}),a.jsx("td",{className:"text-right p-3 font-medium text-emerald-600",children:N(I.totalSales)}),a.jsx("td",{className:"text-right p-3 text-blue-600",children:N(I.cashCollected)}),a.jsxs("td",{className:"text-right p-3 text-red-600",children:["-",N(I.deposits)]}),a.jsx("td",{className:"text-right p-3 font-bold",children:N(I.currentCash)})]},I.vanId))})]})}):a.jsxs("div",{className:"text-center py-8 text-gray-500",children:[a.jsx(On,{size:48,className:"mx-auto mb-4 text-gray-300"}),a.jsx("p",{children:"No van performance data for the selected period"})]})]}),e==="driver"&&a.jsxs("div",{children:[a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 text-center mb-6",children:[a.jsx("p",{className:"text-2xl font-bold text-emerald-600",children:c.totalDrivers}),a.jsx("p",{className:"text-sm text-gray-500",children:"Drivers"})]}),((C=c.drivers)==null?void 0:C.length)>0&&a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-left p-2",children:"Driver"}),a.jsx("th",{className:"text-right p-2",children:"Orders"}),a.jsx("th",{className:"text-right p-2",children:"Sales"}),a.jsx("th",{className:"text-right p-2",children:"Collections"}),a.jsx("th",{className:"text-right p-2",children:"Shifts"})]})}),a.jsx("tbody",{children:c.drivers.map(I=>a.jsxs("tr",{className:"border-b",children:[a.jsx("td",{className:"p-2",children:I.driverName}),a.jsx("td",{className:"text-right p-2",children:I.totalOrders}),a.jsx("td",{className:"text-right p-2",children:N(I.totalSales)}),a.jsx("td",{className:"text-right p-2",children:N(I.totalCollections)}),a.jsx("td",{className:"text-right p-2",children:I.shiftsWorked})]},I.driverId))})]})]})]}),!c&&e&&a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6 mt-6",children:a.jsxs("div",{className:"bg-gray-50 rounded-lg p-8 text-center text-gray-500",children:[a.jsx(Br,{size:48,className:"mx-auto mb-4 text-gray-300"}),a.jsx("p",{children:'Select date range and click "Generate Report" to view data'})]})})]})]})]})}const S_=["#10b981","#3b82f6","#f59e0b","#ef4444","#8b5cf6","#ec4899","#06b6d4","#84cc16"];function dve(){const[e,t]=m.useState(!0),[r,s]=m.useState(null),[n,i]=m.useState([]),[l,o]=m.useState(""),c=m.useRef(null),u=()=>{if(!c.current)return;const f=window.open("","_blank");f&&(f.document.write(`
      <html>
        <head>
          <title>Inventory Valuation Report</title>
          <style>
            body { font-family: Arial, sans-serif; padding: 20px; }
            h1 { color: #1f2937; border-bottom: 2px solid #10b981; padding-bottom: 10px; }
            .header { display: flex; justify-content: space-between; margin-bottom: 20px; }
            .summary-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; margin-bottom: 30px; }
            .summary-card { border: 1px solid #e5e7eb; border-radius: 8px; padding: 15px; }
            .summary-card h3 { color: #6b7280; font-size: 12px; margin: 0 0 5px 0; }
            .summary-card p { font-size: 24px; font-weight: bold; margin: 0; }
            .green { color: #10b981; }
            .blue { color: #3b82f6; }
            .amber { color: #f59e0b; }
            table { width: 100%; border-collapse: collapse; margin-top: 20px; }
            th { background: #f3f4f6; padding: 10px; text-align: left; font-size: 11px; text-transform: uppercase; }
            td { padding: 10px; border-bottom: 1px solid #e5e7eb; font-size: 13px; }
            .text-right { text-align: right; }
            .footer { margin-top: 30px; text-align: center; color: #9ca3af; font-size: 12px; }
            @media print { body { -webkit-print-color-adjust: exact; } }
          </style>
        </head>
        <body>
          <div class="header">
            <h1> Inventory Valuation Report</h1>
            <p>Generated: ${new Date().toLocaleDateString()} ${new Date().toLocaleTimeString()}</p>
          </div>
          <div class="summary-grid">
            <div class="summary-card">
              <h3>Total Inventory Value (Cost)</h3>
              <p class="green">$${r==null?void 0:r.totalInventoryValue.toLocaleString(void 0,{minimumFractionDigits:2})}</p>
            </div>
            <div class="summary-card">
              <h3>Total Retail Value</h3>
              <p class="blue">$${r==null?void 0:r.totalRetailValue.toLocaleString(void 0,{minimumFractionDigits:2})}</p>
            </div>
            <div class="summary-card">
              <h3>Potential Profit</h3>
              <p class="green">$${r==null?void 0:r.potentialProfit.toLocaleString(void 0,{minimumFractionDigits:2})}</p>
            </div>
            <div class="summary-card">
              <h3>Total Products / Quantity</h3>
              <p>${r==null?void 0:r.totalProducts} / ${r==null?void 0:r.totalQuantity.toLocaleString()} units</p>
            </div>
          </div>
          <h2>Inventory Details</h2>
          <table>
            <thead>
              <tr>
                <th>Product</th>
                <th>SKU</th>
                <th>Warehouse</th>
                <th class="text-right">Qty</th>
                <th class="text-right">Unit Cost</th>
                <th class="text-right">Total Value</th>
                <th class="text-right">Retail Value</th>
              </tr>
            </thead>
            <tbody>
              ${r==null?void 0:r.items.map(x=>`
                <tr>
                  <td>${x.productName}</td>
                  <td>${x.productSku}</td>
                  <td>${x.warehouseName}</td>
                  <td class="text-right">${x.quantity.toLocaleString()}</td>
                  <td class="text-right">$${x.unitCost.toFixed(3)}</td>
                  <td class="text-right">$${x.totalValue.toFixed(3)}</td>
                  <td class="text-right">$${x.totalRetailValue.toFixed(3)}</td>
                </tr>
              `).join("")}
            </tbody>
          </table>
          <div class="footer">
            <p>Company Inventory Management System</p>
          </div>
        </body>
      </html>
    `),f.document.close(),f.print())},d=async()=>{t(!0);try{const[h,f]=await Promise.all([br.getValuation(l?{warehouseId:l}:{}),Ks.getAll()]);s(h.data),i(f.data)}catch(h){console.error("Failed to load valuation data:",h)}finally{t(!1)}};return m.useEffect(()=>{d()},[l]),e?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx(Mj,{className:"w-8 h-8 animate-spin text-emerald-500"})}):a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Inventory Valuation"}),a.jsxs("div",{className:"flex gap-3 items-end",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Warehouse"}),a.jsxs("select",{value:l,onChange:h=>o(h.target.value?parseInt(h.target.value):""),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm min-w-[150px]",children:[a.jsx("option",{value:"",children:"All Warehouses"}),n.map(h=>a.jsx("option",{value:h.id,children:h.name},h.id))]})]}),a.jsxs("button",{onClick:d,className:"px-4 py-2 bg-emerald-500 text-white rounded-lg text-sm hover:bg-emerald-600 flex items-center gap-2",children:[a.jsx(Mj,{className:"w-4 h-4"}),"Refresh"]}),a.jsxs("button",{onClick:u,className:"px-4 py-2 bg-blue-600 text-white rounded-lg text-sm hover:bg-blue-700 flex items-center gap-2",children:[a.jsx(ua,{className:"w-4 h-4"}),"Print Report"]})]})]}),a.jsxs("div",{ref:c,children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6",children:[a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"text-gray-500 text-sm mb-1",children:"Total Inventory Value"}),a.jsx(Tr,{className:"w-5 h-5 text-emerald-500"})]}),a.jsxs("p",{className:"text-3xl font-bold text-emerald-600",children:["$",(r==null?void 0:r.totalInventoryValue.toLocaleString(void 0,{minimumFractionDigits:2}))||"0.00"]}),a.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[(r==null?void 0:r.totalProducts)||0," products"]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"text-gray-500 text-sm mb-1",children:"Total Retail Value"}),a.jsx(hn,{className:"w-5 h-5 text-blue-500"})]}),a.jsxs("p",{className:"text-3xl font-bold text-blue-600",children:["$",(r==null?void 0:r.totalRetailValue.toLocaleString(void 0,{minimumFractionDigits:2}))||"0.00"]}),a.jsxs("p",{className:"text-xs text-green-500 mt-1",children:["+$",(r==null?void 0:r.potentialProfit.toLocaleString(void 0,{minimumFractionDigits:2}))||"0.00"," potential profit"]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"text-gray-500 text-sm mb-1",children:"Highest Value"}),a.jsx(hn,{className:"w-5 h-5 text-emerald-500"})]}),a.jsx("p",{className:"text-xl font-bold text-gray-900 truncate",children:(r==null?void 0:r.highestValueProduct)||"N/A"}),a.jsxs("p",{className:"text-sm text-emerald-600",children:["$",(r==null?void 0:r.highestValueAmount.toLocaleString(void 0,{minimumFractionDigits:2}))||"0.00"]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"text-gray-500 text-sm mb-1",children:"Slow Moving"}),a.jsx(c0,{className:"w-5 h-5 text-amber-500"})]}),a.jsx("p",{className:"text-3xl font-bold text-amber-600",children:(r==null?void 0:r.slowMovingCount)||0}),a.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"No sales in 30 days"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(q6,{className:"w-5 h-5 text-emerald-600"}),a.jsx("h3",{className:"font-semibold text-gray-900",children:"Value by Warehouse"})]}),a.jsx("div",{className:"h-[280px]",children:a.jsx(md,{width:"100%",height:"100%",children:a.jsxs(LL,{children:[a.jsx(Xk,{data:(()=>{const h={};return r==null||r.items.forEach(f=>{h[f.warehouseName]=(h[f.warehouseName]||0)+f.totalValue}),Object.entries(h).map(([f,x])=>({name:f,value:x}))})(),cx:"50%",cy:"50%",innerRadius:60,outerRadius:100,paddingAngle:3,dataKey:"value",label:h=>`${h.name}: $${(h.value/1e3).toFixed(1)}k`,children:(()=>{const h={};return r==null||r.items.forEach(f=>{h[f.warehouseName]=(h[f.warehouseName]||0)+f.totalValue}),Object.keys(h).map((f,x)=>a.jsx($d,{fill:S_[x%S_.length]},`cell-${x}`))})()}),a.jsx(yd,{formatter:h=>`$${h.toLocaleString(void 0,{minimumFractionDigits:2})}`})]})})})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(qi,{className:"w-5 h-5 text-blue-600"}),a.jsx("h3",{className:"font-semibold text-gray-900",children:"Top 10 Products by Value"})]}),a.jsx("div",{className:"h-[280px]",children:a.jsx(md,{width:"100%",height:"100%",children:a.jsxs(Yw,{data:r==null?void 0:r.items.sort((h,f)=>f.totalValue-h.totalValue).slice(0,10).map(h=>({name:h.productName.length>15?h.productName.substring(0,15)+"...":h.productName,value:h.totalValue,retail:h.totalRetailValue})),layout:"vertical",margin:{left:10,right:30},children:[a.jsx(N0,{type:"number",tickFormatter:h=>`$${(h/1e3).toFixed(0)}k`}),a.jsx(S0,{dataKey:"name",type:"category",width:100,tick:{fontSize:11}}),a.jsx(yd,{formatter:h=>`$${h.toLocaleString(void 0,{minimumFractionDigits:2})}`}),a.jsx(qg,{dataKey:"value",name:"Cost Value",fill:"#10b981",radius:[0,4,4,0]})]})})})]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 mb-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(da,{className:"w-5 h-5 text-emerald-600"}),a.jsx("h3",{className:"font-semibold text-gray-900",children:"Cost vs Retail Value Comparison"})]}),a.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx("span",{className:"w-3 h-3 bg-emerald-500 rounded"})," Cost Value"]}),a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx("span",{className:"w-3 h-3 bg-blue-500 rounded"})," Retail Value"]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-8",children:[a.jsxs("div",{className:"text-center",children:[a.jsxs("p",{className:"text-4xl font-bold text-emerald-600",children:["$",r==null?void 0:r.totalInventoryValue.toLocaleString(void 0,{minimumFractionDigits:2})]}),a.jsx("p",{className:"text-gray-500 mt-1",children:"Total Cost Value"}),a.jsx("div",{className:"h-3 bg-emerald-500 rounded-full mt-3"})]}),a.jsxs("div",{className:"text-center",children:[a.jsxs("p",{className:"text-4xl font-bold text-blue-600",children:["$",r==null?void 0:r.totalRetailValue.toLocaleString(void 0,{minimumFractionDigits:2})]}),a.jsx("p",{className:"text-gray-500 mt-1",children:"Total Retail Value"}),a.jsx("div",{className:"h-3 bg-blue-500 rounded-full mt-3"})]})]}),a.jsxs("div",{className:"mt-6 p-4 bg-green-50 rounded-lg text-center",children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Potential Profit Margin"}),a.jsxs("p",{className:"text-3xl font-bold text-green-600",children:["$",r==null?void 0:r.potentialProfit.toLocaleString(void 0,{minimumFractionDigits:2}),a.jsxs("span",{className:"text-lg ml-2",children:["(",r&&r.totalInventoryValue>0?(r.potentialProfit/r.totalInventoryValue*100).toFixed(1):0,"%)"]})]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden",children:[a.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[a.jsx("h2",{className:"font-semibold text-gray-900",children:"Inventory Details"}),a.jsxs("p",{className:"text-sm text-gray-500",children:["Total quantity: ",(r==null?void 0:r.totalQuantity.toLocaleString())||0," units"]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Product"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"SKU"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Warehouse"}),a.jsx("th",{className:"px-6 py-3 text-right text-xs font-semibold text-gray-600 uppercase",children:"Quantity"}),a.jsx("th",{className:"px-6 py-3 text-right text-xs font-semibold text-gray-600 uppercase",children:"Unit Cost"}),a.jsx("th",{className:"px-6 py-3 text-right text-xs font-semibold text-gray-600 uppercase",children:"Total Value"}),a.jsx("th",{className:"px-6 py-3 text-right text-xs font-semibold text-gray-600 uppercase",children:"Retail Value"}),a.jsx("th",{className:"px-6 py-3 text-center text-xs font-semibold text-gray-600 uppercase",children:"Activity (30d)"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:(r==null?void 0:r.items.length)===0?a.jsx("tr",{children:a.jsx("td",{colSpan:8,className:"px-6 py-12 text-center text-gray-500",children:"No inventory data available"})}):r==null?void 0:r.items.map(h=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsxs("td",{className:"px-6 py-4",children:[a.jsx("div",{className:"font-medium text-gray-900",children:h.productName}),h.categoryName&&a.jsx("div",{className:"text-xs text-gray-500",children:h.categoryName})]}),a.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:h.productSku}),a.jsx("td",{className:"px-6 py-4 text-sm",children:h.warehouseName}),a.jsx("td",{className:"px-6 py-4 text-right font-medium",children:h.quantity.toLocaleString()}),a.jsxs("td",{className:"px-6 py-4 text-right text-gray-600",children:["$",h.unitCost.toLocaleString(void 0,{minimumFractionDigits:2})]}),a.jsxs("td",{className:"px-6 py-4 text-right font-medium text-emerald-600",children:["$",h.totalValue.toLocaleString(void 0,{minimumFractionDigits:2})]}),a.jsxs("td",{className:"px-6 py-4 text-right text-blue-600",children:["$",h.totalRetailValue.toLocaleString(void 0,{minimumFractionDigits:2})]}),a.jsx("td",{className:"px-6 py-4 text-center",children:h.salesActivity>0?a.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[h.salesActivity," sold"]}):a.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-amber-100 text-amber-800",children:"No sales"})})]},h.id))})]})})]})]})]})}function uve(){const[e,t]=m.useState("fifo"),[r,s]=m.useState(20),[n,i]=m.useState(10),[l,o]=m.useState(!0),[c,u]=m.useState(!0),[d,h]=m.useState(!1);m.useEffect(()=>{f()},[]);const f=async()=>{try{u(!0);const p=await ie.get("/inventorysettings");t(p.data.valuationMethod||"fifo"),s(p.data.costSpikeThreshold||20),i(p.data.lowMarginThreshold||10),o(p.data.enableCostAlerts??!0)}catch(p){console.error("Failed to load settings:",p)}finally{u(!1)}},x=async()=>{try{h(!0),await ie.put("/inventorysettings",{valuationMethod:e,costSpikeThreshold:r,lowMarginThreshold:n,enableCostAlerts:l}),alert("Settings saved successfully!")}catch(p){console.error("Failed to save settings:",p),alert("Failed to save settings")}finally{h(!1)}};return c?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx(vt,{className:"animate-spin",size:32})}):a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Inventory Settings"}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6 max-w-2xl",children:a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Valuation Method"}),a.jsxs("select",{value:e,onChange:p=>t(p.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[a.jsx("option",{value:"fifo",children:"FIFO (First In, First Out)"}),a.jsx("option",{value:"lifo",children:"LIFO (Last In, First Out)"}),a.jsx("option",{value:"weighted_average",children:"Weighted Average"})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Method used to calculate inventory cost"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cost Spike Threshold (%)"}),a.jsx("input",{type:"number",value:r,onChange:p=>s(Number(p.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Alert when cost increases by this percentage"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Low Margin Threshold (%)"}),a.jsx("input",{type:"number",value:n,onChange:p=>i(Number(p.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Alert when profit margin falls below this percentage"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",id:"costAlerts",checked:l,onChange:p=>o(p.target.checked),className:"rounded"}),a.jsx("label",{htmlFor:"costAlerts",className:"text-sm font-medium text-gray-700",children:"Enable Cost Alerts"})]}),a.jsx("div",{className:"pt-4",children:a.jsxs("button",{onClick:x,disabled:d,className:"px-6 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 disabled:opacity-50 flex items-center gap-2",children:[d&&a.jsx(vt,{className:"animate-spin",size:16}),d?"Saving...":"Save Settings"]})})]})})]})}function hve(){const[e,t]=m.useState([]),[r,s]=m.useState(!0),[n,i]=m.useState(!1),[l,o]=m.useState(!1),[c,u]=m.useState(null),[d,h]=m.useState({code:"",name:"",symbol:"",exchangeRate:1,isBase:!1,isActive:!0});m.useEffect(()=>{f()},[]);const f=async()=>{try{s(!0);const v=await Kc.getAll();t(v.data)}catch(v){console.error("Failed to load currencies:",v)}finally{s(!1)}},x=()=>h({code:"",name:"",symbol:"",exchangeRate:1,isBase:!1,isActive:!0}),p=v=>{u(v),h({code:v.code,name:v.name,symbol:v.symbol,exchangeRate:v.exchangeRate,isBase:v.isBase,isActive:v.isActive}),o(!0)},g=async v=>{var j,b;if(v.preventDefault(),!(!d.code.trim()||!d.name.trim())){i(!0);try{c?await Kc.update(c.id,d):await Kc.create(d),o(!1),x(),u(null),f()}catch(w){alert(((b=(j=w.response)==null?void 0:j.data)==null?void 0:b.message)||"Failed to save currency")}finally{i(!1)}}},y=async v=>{var j,b;if(confirm("Are you sure you want to delete this currency?"))try{await Kc.delete(v),f()}catch(w){alert(((b=(j=w.response)==null?void 0:j.data)==null?void 0:b.message)||"Failed to delete currency")}};return r?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx(vt,{className:"animate-spin",size:32})}):a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsxs("div",{children:[a.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[a.jsx(Q6,{className:"text-blue-600"})," Currencies"]}),a.jsx("p",{className:"text-gray-500 text-sm",children:"Manage currencies and exchange rates"})]}),a.jsxs("button",{onClick:()=>{x(),u(null),o(!0)},className:"flex items-center gap-2 px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600",children:[a.jsx(hr,{size:20})," Add Currency"]})]}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Code"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Name"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Symbol"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Exchange Rate"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Base"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Status"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:e.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"px-4 py-8 text-center text-gray-500",children:"No currencies found"})}):e.map(v=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 font-medium",children:v.code}),a.jsx("td",{className:"px-4 py-3",children:v.name}),a.jsx("td",{className:"px-4 py-3 text-lg font-medium",children:v.symbol}),a.jsx("td",{className:"px-4 py-3",children:v.exchangeRate.toFixed(4)}),a.jsx("td",{className:"px-4 py-3",children:v.isBase?a.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-700 rounded-full text-xs font-medium",children:"Yes"}):a.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-500 rounded-full text-xs",children:"No"})}),a.jsx("td",{className:"px-4 py-3",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${v.isActive?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:v.isActive?"Active":"Inactive"})}),a.jsx("td",{className:"px-4 py-3",children:a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:()=>p(v),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",title:"Edit",children:a.jsx(js,{size:16})}),!v.isBase&&a.jsx("button",{onClick:()=>y(v.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Delete",children:a.jsx(xr,{size:16})})]})})]},v.id))})]})}),l&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-lg",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-[#003366] text-white rounded-t-xl",children:[a.jsx("h2",{className:"text-lg font-semibold",children:c?"Edit Currency":"Add Currency"}),a.jsx("button",{onClick:()=>o(!1),children:a.jsx(yt,{size:24})})]}),a.jsxs("form",{onSubmit:g,className:"p-6 space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Code *"}),a.jsx("input",{type:"text",value:d.code,onChange:v=>h({...d,code:v.target.value.toUpperCase()}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"USD",maxLength:10,required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name *"}),a.jsx("input",{type:"text",value:d.name,onChange:v=>h({...d,name:v.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"US Dollar",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Symbol *"}),a.jsx("input",{type:"text",value:d.symbol,onChange:v=>h({...d,symbol:v.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"$",maxLength:10,required:!0})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Exchange Rate *"}),a.jsx("input",{type:"number",step:"0.0001",value:d.exchangeRate,onChange:v=>h({...d,exchangeRate:parseFloat(v.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0})]}),a.jsx("div",{className:"flex items-end pb-2",children:a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",checked:d.isBase,onChange:v=>h({...d,isBase:v.target.checked}),className:"rounded"}),a.jsx("span",{className:"text-sm",children:"Is Base Currency"})]})})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",id:"isActive",checked:d.isActive,onChange:v=>h({...d,isActive:v.target.checked}),className:"rounded"}),a.jsx("label",{htmlFor:"isActive",className:"text-sm",children:"Active"})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>o(!1),className:"flex-1 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:n,className:"flex-1 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 disabled:opacity-50",children:n?"Saving...":"Save"})]})]})]})})]})}function fve(){const[e,t]=m.useState([]),[r,s]=m.useState([]),[n,i]=m.useState(!0),[l,o]=m.useState(!1),[c,u]=m.useState(!1),[d,h]=m.useState(!1),[f,x]=m.useState(!1),[p,g]=m.useState(null),[y,v]=m.useState(null),[j,b]=m.useState({name:"",description:"",imageUrl:"",isActive:!0}),[w,k]=m.useState({name:"",description:"",imageUrl:"",isActive:!0}),[N,S]=m.useState(!1),_=m.useRef(null),O=m.useRef(null),E=async(G,B)=>{const se=new FormData;se.append("image",B);try{return(await ie.post(`/categories/${G}/upload-image`,se,{headers:{"Content-Type":"multipart/form-data"}})).data.imageUrl}catch(L){return console.error("Image upload failed:",L),null}};m.useEffect(()=>{R()},[]);const R=async()=>{try{i(!0);const G=await il.getAll({parentOnly:!0});t(G.data)}catch(G){console.error("Failed to load categories:",G)}finally{i(!1)}},C=async G=>{try{const B=await il.getSubcategories(G);s(B.data)}catch(B){console.error("Failed to load subcategories:",B),s([])}},I=()=>b({name:"",description:"",imageUrl:"",isActive:!0}),ne=()=>k({name:"",description:"",imageUrl:"",isActive:!0}),W=G=>{g(G),b({name:G.name,description:G.description||"",imageUrl:G.imageUrl||"",isActive:G.isActive}),u(!0)},Q=async G=>{v(G),await C(G.id),h(!0)},H=async G=>{var B,se,L,Z;if(G.preventDefault(),!!j.name.trim()){o(!0);try{if(p)await il.update(p.id,j);else{const F=await il.create({...j,imageUrl:""}),he=(B=_.current)==null?void 0:B._pendingFile;he&&((se=F.data)!=null&&se.id)&&(await E(F.data.id,he),_.current._pendingFile=null)}u(!1),I(),g(null),R()}catch(F){alert(((Z=(L=F.response)==null?void 0:L.data)==null?void 0:Z.message)||"Failed to save category")}finally{o(!1)}}},K=async G=>{var B,se;if(G.preventDefault(),!(!w.name.trim()||!y)){o(!0);try{await il.create({...w,parentId:y.id}),x(!1),ne(),C(y.id),R()}catch(L){alert(((se=(B=L.response)==null?void 0:B.data)==null?void 0:se.message)||"Failed to save subcategory")}finally{o(!1)}}},q=async G=>{var B,se;if(confirm("Are you sure you want to delete this category?"))try{await il.delete(G),R()}catch(L){alert(((se=(B=L.response)==null?void 0:B.data)==null?void 0:se.message)||"Failed to delete category")}},ge=async G=>{var B,se;if(confirm("Are you sure you want to delete this subcategory?"))try{await il.delete(G),y&&C(y.id),R()}catch(L){alert(((se=(B=L.response)==null?void 0:B.data)==null?void 0:se.message)||"Failed to delete subcategory")}};return n?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx(vt,{className:"animate-spin",size:32})}):a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsxs("div",{children:[a.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[a.jsx(xf,{className:"text-blue-600"})," Categories"]}),a.jsx("p",{className:"text-gray-500 text-sm",children:"Manage product categories and subcategories"})]}),a.jsxs("button",{onClick:()=>{I(),g(null),u(!0)},className:"flex items-center gap-2 px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600",children:[a.jsx(hr,{size:20})," Add Category"]})]}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Category"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Image"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Subcategories"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Status"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:e.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:5,className:"px-4 py-8 text-center text-gray-500",children:"No categories found"})}):e.map(G=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 font-medium",children:G.name}),a.jsx("td",{className:"px-4 py-3",children:G.imageUrl?a.jsx("img",{src:G.imageUrl,alt:G.name,className:"w-10 h-10 rounded object-cover"}):a.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded flex items-center justify-center text-gray-400",children:a.jsx(xf,{size:20})})}),a.jsx("td",{className:"px-4 py-3",children:G.subcategoryCount}),a.jsx("td",{className:"px-4 py-3",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${G.isActive?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:G.isActive?"Active":"Inactive"})}),a.jsx("td",{className:"px-4 py-3",children:a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:()=>W(G),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",title:"Edit",children:a.jsx(js,{size:16})}),a.jsx("button",{onClick:()=>Q(G),className:"p-1 text-indigo-600 hover:bg-indigo-50 rounded",title:"View Subcategories",children:a.jsx(gs,{size:16})}),a.jsx("button",{onClick:()=>q(G.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Delete",children:a.jsx(xr,{size:16})})]})})]},G.id))})]})}),c&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-lg",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-[#003366] text-white rounded-t-xl",children:[a.jsx("h2",{className:"text-lg font-semibold",children:p?"Edit Category":"Add Category"}),a.jsx("button",{onClick:()=>u(!1),children:a.jsx(yt,{size:24})})]}),a.jsxs("form",{onSubmit:H,className:"p-6 space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"col-span-2 md:col-span-1",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category Name *"}),a.jsx("input",{type:"text",value:j.name,onChange:G=>b({...j,name:G.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0})]}),a.jsxs("div",{className:"col-span-2 md:col-span-1",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category Image"}),a.jsxs("div",{className:"flex items-center gap-3",children:[j.imageUrl?a.jsx("img",{src:j.imageUrl,alt:"",className:"w-12 h-12 rounded object-cover border"}):a.jsx("div",{className:"w-12 h-12 border-2 border-dashed border-gray-300 rounded flex items-center justify-center bg-gray-50",children:a.jsx(Rj,{size:20,className:"text-gray-400"})}),a.jsxs("button",{type:"button",onClick:()=>{var G;return(G=_.current)==null?void 0:G.click()},disabled:N,className:"flex items-center gap-1 px-3 py-1.5 text-sm border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50",children:[N?a.jsx(vt,{size:14,className:"animate-spin"}):a.jsx(d0,{size:14}),N?"Uploading...":"Upload"]}),a.jsx("input",{type:"file",ref:_,accept:"image/*",className:"hidden",onChange:async G=>{var se;const B=(se=G.target.files)==null?void 0:se[0];if(B){if(!B.type.startsWith("image/")){alert("Please select an image file");return}if(B.size>5*1024*1024){alert("Image size must be less than 5MB");return}if(p){S(!0);const L=await E(p.id,B);S(!1),L?b(Z=>({...Z,imageUrl:L})):alert("Failed to upload image")}else b(L=>({...L,imageUrl:URL.createObjectURL(B)})),_.current._pendingFile=B}}})]})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",id:"isActive",checked:j.isActive,onChange:G=>b({...j,isActive:G.target.checked}),className:"rounded"}),a.jsx("label",{htmlFor:"isActive",className:"text-sm",children:"Active"})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>u(!1),className:"flex-1 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:l,className:"flex-1 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 disabled:opacity-50",children:l?"Saving...":"Save"})]})]})]})}),d&&y&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-3xl max-h-[90vh] overflow-hidden",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-[#003366] text-white",children:[a.jsxs("h2",{className:"text-lg font-semibold",children:["Subcategories - ",y.name]}),a.jsx("button",{onClick:()=>h(!1),children:a.jsx(yt,{size:24})})]}),a.jsxs("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-120px)]",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h6",{className:"font-medium",children:"List of Subcategories"}),a.jsxs("button",{onClick:()=>{ne(),x(!0)},className:"flex items-center gap-1 px-3 py-1.5 bg-emerald-500 text-white rounded-lg text-sm hover:bg-emerald-600",children:[a.jsx(hr,{size:16})," Add Subcategory"]})]}),a.jsx("div",{className:"border rounded-lg overflow-hidden",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-2 text-left",children:"Subcategory"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Image"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Status"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"Actions"})]})}),a.jsx("tbody",{children:r.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:4,className:"px-3 py-6 text-center text-gray-500",children:"No subcategories"})}):r.map(G=>a.jsxs("tr",{className:"border-t",children:[a.jsx("td",{className:"px-3 py-2 font-medium",children:G.name}),a.jsx("td",{className:"px-3 py-2",children:G.imageUrl?a.jsx("img",{src:G.imageUrl,alt:G.name,className:"w-8 h-8 rounded object-cover"}):"-"}),a.jsx("td",{className:"px-3 py-2",children:a.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${G.isActive?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:G.isActive?"Active":"Inactive"})}),a.jsx("td",{className:"px-3 py-2",children:a.jsx("button",{onClick:()=>ge(G.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Delete",children:a.jsx(xr,{size:14})})})]},G.id))})]})}),a.jsx("div",{className:"flex justify-end pt-4",children:a.jsx("button",{onClick:()=>h(!1),className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Close"})})]})]})}),f&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[60]",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-lg",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-[#003366] text-white rounded-t-xl",children:[a.jsx("h2",{className:"text-lg font-semibold",children:"Add Subcategory"}),a.jsx("button",{onClick:()=>x(!1),children:a.jsx(yt,{size:24})})]}),a.jsxs("form",{onSubmit:K,className:"p-6 space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"col-span-2 md:col-span-1",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subcategory Name *"}),a.jsx("input",{type:"text",value:w.name,onChange:G=>k({...w,name:G.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0})]}),a.jsxs("div",{className:"col-span-2 md:col-span-1",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subcategory Image"}),a.jsxs("div",{className:"flex items-center gap-3",children:[w.imageUrl?a.jsx("img",{src:w.imageUrl,alt:"",className:"w-12 h-12 rounded object-cover border"}):a.jsx("div",{className:"w-12 h-12 border-2 border-dashed border-gray-300 rounded flex items-center justify-center bg-gray-50",children:a.jsx(Rj,{size:20,className:"text-gray-400"})}),a.jsxs("button",{type:"button",onClick:()=>{var G;return(G=O.current)==null?void 0:G.click()},disabled:N,className:"flex items-center gap-1 px-3 py-1.5 text-sm border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50",children:[N?a.jsx(vt,{size:14,className:"animate-spin"}):a.jsx(d0,{size:14}),N?"Uploading...":"Upload"]}),a.jsx("input",{type:"file",ref:O,accept:"image/*",className:"hidden",onChange:async G=>{var se;const B=(se=G.target.files)==null?void 0:se[0];if(B){if(!B.type.startsWith("image/")){alert("Please select an image file");return}if(B.size>5*1024*1024){alert("Image size must be less than 5MB");return}k(L=>({...L,imageUrl:URL.createObjectURL(B)})),O.current._pendingFile=B}}})]})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",id:"subcatActive",checked:w.isActive,onChange:G=>k({...w,isActive:G.target.checked}),className:"rounded"}),a.jsx("label",{htmlFor:"subcatActive",className:"text-sm",children:"Active"})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>x(!1),className:"flex-1 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:l,className:"flex-1 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 disabled:opacity-50",children:l?"Saving...":"Save"})]})]})]})})]})}function xve(){const[e,t]=m.useState(""),[r,s]=m.useState(""),[n,i]=m.useState(""),[l,o]=m.useState("1"),[c,u]=m.useState(!1),[d,h]=m.useState("$"),[,f]=m.useState(!0),[x,p]=m.useState(!1);m.useEffect(()=>{g()},[]);const g=async()=>{try{const j=(await Bp.get()).data;t(j.name||""),s(j.phone||""),i(j.address||""),o(String(j.exchangeRate??1)),u(j.showSecondaryPrice??!1),h(j.currencySymbol||"$")}catch(v){console.error("Failed to load settings:",v)}finally{f(!1)}},y=async()=>{p(!0);try{await Bp.update({name:e,phone:r,address:n,exchangeRate:parseFloat(l)||1,showSecondaryPrice:c,currencySymbol:d}),alert("Settings saved successfully!")}catch(v){console.error("Failed to save settings:",v),alert("Failed to save settings")}finally{p(!1)}};return a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Company Settings"}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6 max-w-2xl",children:a.jsxs("form",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Company Name"}),a.jsx("input",{type:"text",value:e,onChange:v=>t(v.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),a.jsx("input",{type:"text",value:r,onChange:v=>s(v.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),a.jsx("textarea",{value:n,onChange:v=>i(v.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",rows:2})]}),a.jsx("hr",{className:"border-gray-200"}),a.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Pricing & Currency"}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Primary Currency Symbol"}),a.jsx("input",{type:"text",value:d,onChange:v=>h(v.target.value),placeholder:"$",className:"w-32 px-3 py-2 border border-gray-300 rounded-lg"})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("input",{type:"checkbox",id:"showSecondaryPrice",checked:c,onChange:v=>u(v.target.checked),className:"w-4 h-4 text-emerald-600 rounded border-gray-300"}),a.jsx("label",{htmlFor:"showSecondaryPrice",className:"text-sm font-medium text-gray-700",children:"Show Secondary Price in POS"})]}),c&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Exchange Rate"}),a.jsx("input",{type:"number",step:"0.01",value:l,onChange:v=>o(v.target.value),className:"w-48 px-3 py-2 border border-gray-300 rounded-lg"}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Secondary price = Unit price  ",l||"1"]})]}),a.jsx("hr",{className:"border-gray-200"}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Company Logo"}),a.jsxs("div",{className:"mt-1 flex items-center gap-4",children:[a.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-lg flex items-center justify-center",children:a.jsx(d0,{size:32,className:"text-gray-400"})}),a.jsx("button",{type:"button",className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Upload Logo"})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Used on invoices and reports"})]}),a.jsx("div",{className:"pt-4",children:a.jsx("button",{type:"button",onClick:y,disabled:x,className:"px-6 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 disabled:opacity-50",children:x?"Saving...":"Save Settings"})})]})})]})}function mve(){const[e,t]=m.useState([]),[r,s]=m.useState(!0),[n,i]=m.useState(!1),[l,o]=m.useState(!1),[c,u]=m.useState(!1),[d,h]=m.useState(null),[f,x]=m.useState({name:"",permissions:{}});m.useEffect(()=>{p()},[]);const p=async()=>{try{s(!0);const E=await vh.getAll();t(E.data)}catch(E){console.error("Failed to load roles:",E)}finally{s(!1)}},g=()=>{x({name:"",permissions:{}})},y=async E=>{var R,C;E.preventDefault(),i(!0);try{await vh.create({name:f.name,permissions:JSON.stringify(f.permissions)}),o(!1),g(),p()}catch(I){alert(((C=(R=I.response)==null?void 0:R.data)==null?void 0:C.message)||"Failed to create role")}finally{i(!1)}},v=E=>{h(E),x({name:E.name,permissions:E.permissions?JSON.parse(E.permissions):{}}),u(!0)},j=async E=>{var R,C;if(E.preventDefault(),!!d){i(!0);try{await vh.update(d.id,{name:f.name,permissions:JSON.stringify(f.permissions)}),u(!1),g(),p()}catch(I){alert(((C=(R=I.response)==null?void 0:R.data)==null?void 0:C.message)||"Failed to update role")}finally{i(!1)}}},b=async E=>{var R,C;if(confirm("Are you sure you want to delete this role?"))try{await vh.delete(E),p()}catch(I){alert(((C=(R=I.response)==null?void 0:R.data)==null?void 0:C.message)||"Failed to delete role")}},w=E=>{x({...f,permissions:{...f.permissions,[E]:!f.permissions[E]}})},k=E=>{const R=E.items.every(I=>f.permissions[I]),C={...f.permissions};E.items.forEach(I=>{C[I]=!R}),x({...f,permissions:C})},N=()=>{const E=O.flatMap(I=>I.items),R=E.every(I=>f.permissions[I]),C={};E.forEach(I=>{C[I]=!R}),x({...f,permissions:C})},S=E=>E.items.every(R=>f.permissions[R]),_=()=>O.flatMap(E=>E.items).every(E=>f.permissions[E]),O=[{group:"Dashboard",items:["View dashboard","View statistics","View charts"]},{group:"Employees",items:["View employees","Create employees","Edit employees","Delete employees","Manage employee payments"]},{group:"Attendance",items:["View attendance","Create attendance","Edit attendance","Delete attendance"]},{group:"Roles",items:["View roles","Create roles","Edit roles","Delete roles"]},{group:"Vans",items:["View vans","Create vans","Edit vans","Delete vans","View van stock","Load van stock","Unload van stock"]},{group:"Warehouses",items:["View warehouses","Create warehouses","Edit warehouses","Delete warehouses","View warehouse stock","Adjust inventory"]},{group:"Products",items:["View products","Create products","Edit products","Delete products","Manage cost history"]},{group:"Categories",items:["View categories","Create categories","Edit categories","Delete categories"]},{group:"Units",items:["View units","Create units","Edit units","Delete units"]},{group:"Inventory",items:["View inventory valuation","Edit inventory settings","Adjust stock levels"]},{group:"Customers",items:["View customers","Create customers","Edit customers","Delete customers","View balances","Edit credit limit","Manage special prices"]},{group:"Leads",items:["View leads","Create leads","Edit leads","Convert leads","Reject leads","Delete leads"]},{group:"Orders & Tasks",items:["View orders","Create orders","Edit orders","Cancel orders","Delete orders","View tasks","Create tasks","Edit tasks","Delete tasks","Update task status"]},{group:"Quotes",items:["View quotes","Create quotes","Edit quotes","Delete quotes","Convert quotes to orders"]},{group:"Direct Sales",items:["View direct sales","Create direct sales"]},{group:"Returns",items:["View returns","Create returns","Approve returns","Reject returns","Process returns"]},{group:"Suppliers",items:["View suppliers","Create suppliers","Edit suppliers","Delete suppliers","View invoices","Create invoices","Manage payments"]},{group:"Expenses",items:["View expenses","Create expenses","Edit expenses","Delete expenses","Manage expense categories"]},{group:"Cash Management",items:["View collections","Create collections","View deposits","Create deposits","Approve deposits","Reject deposits","View van cash"]},{group:"Currencies",items:["View currencies","Create currencies","Edit currencies","Delete currencies"]},{group:"Reports",items:["View deep report","View sales report","View collections report","View stock report","View expenses report","View driver performance","View customer statements","View van performance"]},{group:"Settings",items:["View settings","Edit company settings","Manage roles & permissions"]}];return r?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx(vt,{className:"animate-spin",size:32})}):a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Roles & Permissions"}),a.jsx(qr,{permission:Ve.CREATE_ROLES,children:a.jsxs("button",{onClick:()=>{g(),o(!0)},className:"flex items-center gap-2 px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600",children:[a.jsx(hr,{size:20})," Add Role"]})})]}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Role Name"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Description"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Employees"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Type"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:e.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:5,className:"px-6 py-8 text-center text-gray-500",children:"No roles found"})}):e.map(E=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-6 py-4 font-medium",children:E.name}),a.jsx("td",{className:"px-6 py-4 text-gray-500",children:E.description||"-"}),a.jsx("td",{className:"px-6 py-4",children:E.employeeCount}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${E.isSystem?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"}`,children:E.isSystem?"System":"Custom"})}),a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"flex gap-2",children:[a.jsx(qr,{permission:Ve.EDIT_ROLES,children:a.jsx("button",{onClick:()=>v(E),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",children:a.jsx(js,{size:16})})}),a.jsx(qr,{permission:Ve.DELETE_ROLES,children:!E.isSystem&&a.jsx("button",{onClick:()=>b(E.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",children:a.jsx(xr,{size:16})})})]})})]},E.id))})]})}),(l||c)&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-2xl max-h-[90vh] overflow-hidden",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-[#003366] text-white",children:[a.jsx("h2",{className:"text-lg font-semibold",children:c?"Edit Role":"Add Role"}),a.jsx("button",{onClick:()=>{o(!1),u(!1)},children:a.jsx(yt,{size:24})})]}),a.jsx("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-120px)]",children:a.jsxs("form",{onSubmit:c?j:y,className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role Name *"}),a.jsx("input",{type:"text",required:!0,value:f.name,onChange:E=>x({...f,name:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"Enter role name"})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h3",{className:"font-semibold text-gray-900",children:"Permissions"}),a.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-blue-600 cursor-pointer",children:[a.jsx("input",{type:"checkbox",className:"rounded",checked:_(),onChange:N}),a.jsx("span",{children:"Select All"})]})]}),a.jsx("div",{className:"space-y-4",children:O.map(E=>a.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("h4",{className:"font-medium text-gray-700",children:E.group}),a.jsxs("label",{className:"flex items-center gap-1 text-xs text-gray-500 cursor-pointer",children:[a.jsx("input",{type:"checkbox",className:"rounded",checked:S(E),onChange:()=>k(E)}),a.jsx("span",{children:"All"})]})]}),a.jsx("div",{className:"grid grid-cols-2 gap-2",children:E.items.map(R=>a.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[a.jsx("input",{type:"checkbox",className:"rounded",checked:!!f.permissions[R],onChange:()=>w(R)}),a.jsx("span",{children:R})]},R))})]},E.group))})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>{o(!1),u(!1)},className:"flex-1 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:n,className:"flex-1 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 disabled:opacity-50",children:n?"Saving...":"Save"})]})]})})]})})]})}const rl={new:"#3b82f6",contacted:"#f59e0b",qualified:"#10b981",converted:"#22c55e",rejected:"#ef4444"},k_={new:"New",contacted:"Contacted",qualified:"Qualified",converted:"Converted",rejected:"Rejected"};function pve(){const[e,t]=m.useState([]),[r,s]=m.useState(null),[n,i]=m.useState(!0),[l,o]=m.useState(null),[c,u]=m.useState(""),[d,h]=m.useState(""),[f,x]=m.useState(!1),[p,g]=m.useState(!1),[y,v]=m.useState(!1),[j,b]=m.useState("list");m.useEffect(()=>{w()},[c]);const w=async()=>{try{i(!0);const[W,Q]=await Promise.all([dm.getAll({status:c||void 0,search:d||void 0}),dm.getSummary()]);t(W),s(Q)}catch(W){console.error("Failed to load leads:",W)}finally{i(!1)}},k=async()=>{if(l){v(!0);try{await dm.convert(l.id,{customerType:"Retail",creditLimit:0}),x(!1),o(null),w()}catch(W){console.error("Failed to convert lead:",W)}finally{v(!1)}}},N=async W=>{if(confirm("Are you sure you want to reject this lead?"))try{await dm.reject(W,"Not qualified"),w()}catch(Q){console.error("Failed to reject lead:",Q)}},S=W=>{switch(W){case"new":return"bg-blue-100 text-blue-800 border-blue-200";case"contacted":return"bg-amber-100 text-amber-800 border-amber-200";case"qualified":return"bg-emerald-100 text-emerald-800 border-emerald-200";case"converted":return"bg-green-100 text-green-800 border-green-200";case"rejected":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},_=r?[{name:"New",value:r.newLeads,color:rl.new},{name:"Contacted",value:r.contactedLeads,color:rl.contacted},{name:"Qualified",value:r.qualifiedLeads,color:rl.qualified},{name:"Converted",value:r.convertedLeads,color:rl.converted},{name:"Rejected",value:r.rejectedLeads,color:rl.rejected}].filter(W=>W.value>0):[],O=r&&r.totalLeads>0?(r.convertedLeads/r.totalLeads*100).toFixed(1):"0",E=r&&r.totalLeads>0?((r.qualifiedLeads+r.convertedLeads)/r.totalLeads*100).toFixed(1):"0",R=r?[{name:"New",count:r.newLeads,fill:rl.new},{name:"Contacted",count:r.contactedLeads,fill:rl.contacted},{name:"Qualified",count:r.qualifiedLeads,fill:rl.qualified},{name:"Converted",count:r.convertedLeads,fill:rl.converted},{name:"Rejected",count:r.rejectedLeads,fill:rl.rejected}]:[],C=e.reduce((W,Q)=>{const H=Q.area||Q.city||"Unknown";return W[H]=(W[H]||0)+1,W},{}),I=Object.entries(C).map(([W,Q])=>({name:W,count:Q})).sort((W,Q)=>Q.count-W.count).slice(0,8),ne=()=>{const W=window.open("","_blank","width=1000,height=800");if(!W){alert("Please allow popups to print report");return}const Q=`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Leads Report - ${new Date().toLocaleDateString()}</title>
        <style>
          * { margin: 0; padding: 0; box-sizing: border-box; }
          body { font-family: Arial, sans-serif; font-size: 12px; padding: 30px; color: #333; }
          .header { text-align: center; margin-bottom: 30px; padding-bottom: 20px; border-bottom: 3px solid #10b981; }
          .header h1 { font-size: 28px; color: #10b981; margin-bottom: 5px; }
          .header p { color: #666; font-size: 14px; }
          .summary-section { margin-bottom: 30px; }
          .summary-section h2 { font-size: 18px; color: #333; margin-bottom: 15px; padding-bottom: 8px; border-bottom: 2px solid #e5e7eb; }
          .kpi-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 15px; margin-bottom: 25px; }
          .kpi-card { background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%); border: 1px solid #e2e8f0; border-radius: 10px; padding: 20px; text-align: center; }
          .kpi-card .value { font-size: 32px; font-weight: bold; margin-bottom: 5px; }
          .kpi-card .label { font-size: 11px; color: #64748b; text-transform: uppercase; letter-spacing: 0.5px; }
          .kpi-card.blue .value { color: #3b82f6; }
          .kpi-card.amber .value { color: #f59e0b; }
          .kpi-card.emerald .value { color: #10b981; }
          .kpi-card.green .value { color: #22c55e; }
          .kpi-card.red .value { color: #ef4444; }
          .metrics-row { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 25px; }
          .metric-box { background: #f8fafc; border-radius: 10px; padding: 20px; text-align: center; border: 1px solid #e2e8f0; }
          .metric-box .big-value { font-size: 42px; font-weight: bold; color: #10b981; }
          .metric-box .label { font-size: 12px; color: #64748b; margin-top: 5px; }
          table { width: 100%; border-collapse: collapse; margin-top: 20px; }
          th, td { border: 1px solid #e2e8f0; padding: 12px 10px; text-align: left; }
          th { background: #f8fafc; font-weight: 600; color: #374151; text-transform: uppercase; font-size: 10px; letter-spacing: 0.5px; }
          tr:nth-child(even) { background: #fafafa; }
          .status-badge { display: inline-block; padding: 4px 10px; border-radius: 12px; font-size: 10px; font-weight: 600; text-transform: uppercase; }
          .status-new { background: #dbeafe; color: #1d4ed8; }
          .status-contacted { background: #fef3c7; color: #b45309; }
          .status-qualified { background: #d1fae5; color: #047857; }
          .status-converted { background: #dcfce7; color: #15803d; }
          .status-rejected { background: #fee2e2; color: #b91c1c; }
          .footer { margin-top: 40px; padding-top: 20px; border-top: 2px solid #e5e7eb; text-align: center; color: #9ca3af; font-size: 11px; }
          @media print { body { padding: 15px; } .kpi-card { break-inside: avoid; } }
        </style>
      </head>
      <body>
        <div class="header">
          <h1> Leads Performance Report</h1>
          <p>Generated on ${new Date().toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}</p>
        </div>

        <div class="summary-section">
          <h2>Lead Pipeline Overview</h2>
          <div class="kpi-grid">
            <div class="kpi-card blue">
              <div class="value">${(r==null?void 0:r.newLeads)||0}</div>
              <div class="label">New Leads</div>
            </div>
            <div class="kpi-card amber">
              <div class="value">${(r==null?void 0:r.contactedLeads)||0}</div>
              <div class="label">Contacted</div>
            </div>
            <div class="kpi-card emerald">
              <div class="value">${(r==null?void 0:r.qualifiedLeads)||0}</div>
              <div class="label">Qualified</div>
            </div>
            <div class="kpi-card green">
              <div class="value">${(r==null?void 0:r.convertedLeads)||0}</div>
              <div class="label">Converted</div>
            </div>
            <div class="kpi-card red">
              <div class="value">${(r==null?void 0:r.rejectedLeads)||0}</div>
              <div class="label">Rejected</div>
            </div>
          </div>

          <div class="metrics-row">
            <div class="metric-box">
              <div class="big-value">${(r==null?void 0:r.totalLeads)||0}</div>
              <div class="label">Total Leads</div>
            </div>
            <div class="metric-box">
              <div class="big-value">${O}%</div>
              <div class="label">Conversion Rate</div>
            </div>
            <div class="metric-box">
              <div class="big-value">${E}%</div>
              <div class="label">Qualification Rate</div>
            </div>
          </div>
        </div>

        <div class="summary-section">
          <h2>All Leads (${e.length})</h2>
          <table>
            <thead>
              <tr>
                <th>#</th>
                <th>Name</th>
                <th>Shop/Business</th>
                <th>Phone</th>
                <th>Location</th>
                <th>Captured By</th>
                <th>Date</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody>
              ${e.map((H,K)=>`
                <tr>
                  <td>${K+1}</td>
                  <td><strong>${H.name}</strong></td>
                  <td>${H.shopName||"-"}</td>
                  <td>${H.phone||"-"}</td>
                  <td>${H.area||H.city||H.address||"-"}</td>
                  <td>${H.capturedBy||"-"}</td>
                  <td>${new Date(H.createdAt).toLocaleDateString()}</td>
                  <td><span class="status-badge status-${H.status}">${H.status}</span></td>
                </tr>
              `).join("")}
            </tbody>
          </table>
        </div>

        <div class="footer">
          <p>Catalyst Lead Management System  Confidential Report</p>
        </div>
      </body>
      </html>
    `;W.document.write(Q),W.document.close(),setTimeout(()=>W.print(),500)};return a.jsxs("div",{className:"p-6 bg-gray-50 min-h-screen",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Lead Management"}),a.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Track and manage your sales pipeline"})]}),a.jsxs("button",{onClick:ne,className:"flex items-center gap-2 px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 shadow-sm",children:[a.jsx(ua,{size:18}),"Print Report"]})]}),r&&a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-5 border-l-4 border-blue-500",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-3xl font-bold text-blue-600",children:r.newLeads}),a.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"New Leads"})]}),a.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:a.jsx(Ed,{size:24,className:"text-blue-600"})})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-5 border-l-4 border-green-500",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-3xl font-bold text-green-600",children:r.convertedLeads}),a.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Converted"})]}),a.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center",children:a.jsx(JU,{size:24,className:"text-green-600"})})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-5 border-l-4 border-red-500",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-3xl font-bold text-red-600",children:r.rejectedLeads}),a.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Rejected"})]}),a.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center",children:a.jsx(Dj,{size:24,className:"text-red-600"})})]})}),a.jsx("div",{className:"bg-gradient-to-br from-emerald-500 to-emerald-600 rounded-xl shadow-sm p-5 text-white",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("p",{className:"text-3xl font-bold",children:[O,"%"]}),a.jsx("p",{className:"text-sm text-emerald-100 mt-1",children:"Conversion Rate"})]}),a.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-full flex items-center justify-center",children:a.jsx(hn,{size:24,className:"text-white"})})]})})]}),a.jsxs("div",{className:"flex gap-2 mb-6",children:[a.jsxs("button",{onClick:()=>b("list"),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-colors ${j==="list"?"bg-emerald-600 text-white":"bg-white text-gray-600 hover:bg-gray-50"}`,children:[a.jsx(so,{size:18}),"Lead List"]}),a.jsxs("button",{onClick:()=>b("analytics"),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-colors ${j==="analytics"?"bg-emerald-600 text-white":"bg-white text-gray-600 hover:bg-gray-50"}`,children:[a.jsx(qi,{size:18}),"Analytics"]})]}),j==="analytics"?a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[a.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[a.jsx(q6,{size:20,className:"text-emerald-600"}),"Lead Pipeline Distribution"]}),a.jsx("div",{className:"h-[300px]",children:a.jsx(md,{width:"100%",height:"100%",children:a.jsxs(LL,{children:[a.jsx(Xk,{data:_,cx:"50%",cy:"50%",innerRadius:60,outerRadius:100,paddingAngle:3,dataKey:"value",label:W=>`${W.name||""} ${((W.percent||0)*100).toFixed(0)}%`,children:_.map((W,Q)=>a.jsx($d,{fill:W.color},`cell-${Q}`))}),a.jsx(yd,{})]})})})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[a.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[a.jsx(qi,{size:20,className:"text-emerald-600"}),"Leads by Status"]}),a.jsx("div",{className:"h-[300px]",children:a.jsx(md,{width:"100%",height:"100%",children:a.jsxs(Yw,{data:R,layout:"vertical",children:[a.jsx(Wf,{strokeDasharray:"3 3"}),a.jsx(N0,{type:"number"}),a.jsx(S0,{dataKey:"name",type:"category",width:80}),a.jsx(yd,{}),a.jsx(qg,{dataKey:"count",radius:[0,4,4,0],children:R.map((W,Q)=>a.jsx($d,{fill:W.fill},`cell-${Q}`))})]})})})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 lg:col-span-2",children:[a.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[a.jsx(dc,{size:20,className:"text-emerald-600"}),"Leads by Location"]}),a.jsx("div",{className:"h-[250px]",children:a.jsx(md,{width:"100%",height:"100%",children:a.jsxs(Yw,{data:I,children:[a.jsx(Wf,{strokeDasharray:"3 3"}),a.jsx(N0,{dataKey:"name"}),a.jsx(S0,{}),a.jsx(yd,{}),a.jsx(qg,{dataKey:"count",fill:"#10b981",radius:[4,4,0,0]})]})})})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 lg:col-span-2",children:[a.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Performance Metrics"}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6",children:[a.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[a.jsx("p",{className:"text-4xl font-bold text-gray-800",children:(r==null?void 0:r.totalLeads)||0}),a.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Total Leads"})]}),a.jsxs("div",{className:"text-center p-4 bg-emerald-50 rounded-lg",children:[a.jsxs("p",{className:"text-4xl font-bold text-emerald-600",children:[O,"%"]}),a.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Conversion Rate"})]}),a.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[a.jsxs("p",{className:"text-4xl font-bold text-blue-600",children:[E,"%"]}),a.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Qualification Rate"})]}),a.jsxs("div",{className:"text-center p-4 bg-amber-50 rounded-lg",children:[a.jsxs("p",{className:"text-4xl font-bold text-amber-600",children:[r&&r.totalLeads>0?(r.rejectedLeads/r.totalLeads*100).toFixed(1):"0","%"]}),a.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Rejection Rate"})]})]})]})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 mb-6",children:a.jsxs("div",{className:"flex flex-wrap gap-4",children:[a.jsx("div",{className:"flex-1 min-w-[250px]",children:a.jsxs("div",{className:"relative",children:[a.jsx(Na,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:20}),a.jsx("input",{type:"text",placeholder:"Search by name, shop, phone or location...",value:d,onChange:W=>h(W.target.value),onKeyDown:W=>W.key==="Enter"&&w(),className:"w-full pl-10 pr-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"})]})}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(l2,{size:20,className:"text-gray-400"}),a.jsxs("select",{value:c,onChange:W=>u(W.target.value),className:"px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500",children:[a.jsx("option",{value:"",children:"All Status"}),a.jsx("option",{value:"new",children:"New"}),a.jsx("option",{value:"contacted",children:"Contacted"}),a.jsx("option",{value:"qualified",children:"Qualified"}),a.jsx("option",{value:"converted",children:"Converted"}),a.jsx("option",{value:"rejected",children:"Rejected"})]})]}),a.jsx("button",{onClick:w,className:"px-4 py-2.5 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200",children:"Apply Filters"})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden",children:n?a.jsxs("div",{className:"p-12 text-center",children:[a.jsx(vt,{className:"animate-spin mx-auto text-emerald-500",size:40}),a.jsx("p",{className:"text-gray-500 mt-4",children:"Loading leads..."})]}):e.length===0?a.jsxs("div",{className:"p-12 text-center text-gray-500",children:[a.jsx(Ed,{size:56,className:"mx-auto mb-4 text-gray-300"}),a.jsx("p",{className:"text-lg font-medium",children:"No leads found"}),a.jsx("p",{className:"text-sm mt-1",children:"Leads captured from the mobile app will appear here"})]}):a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50 border-b",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-left px-6 py-4 text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Lead Info"}),a.jsx("th",{className:"text-left px-6 py-4 text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Contact"}),a.jsx("th",{className:"text-left px-6 py-4 text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Location"}),a.jsx("th",{className:"text-left px-6 py-4 text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Source"}),a.jsx("th",{className:"text-left px-6 py-4 text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Status"}),a.jsx("th",{className:"text-center px-6 py-4 text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-100",children:e.map(W=>a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-11 h-11 bg-gradient-to-br from-emerald-400 to-emerald-600 rounded-full flex items-center justify-center text-white font-semibold shadow-sm",children:W.name.charAt(0).toUpperCase()}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-gray-900",children:W.name}),W.shopName&&a.jsx("p",{className:"text-sm text-gray-500",children:W.shopName}),W.businessType&&a.jsx("p",{className:"text-xs text-gray-400",children:W.businessType})]})]})}),a.jsxs("td",{className:"px-6 py-4",children:[W.phone&&a.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[a.jsx(Vp,{size:14,className:"text-gray-400"}),W.phone]}),W.email&&a.jsx("div",{className:"text-xs text-gray-400 mt-1",children:W.email})]}),a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[a.jsx(dc,{size:14,className:"text-gray-400"}),a.jsx("span",{children:W.area||W.city||W.address||"-"})]})}),a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"text-sm",children:[a.jsx("p",{className:"text-gray-700",children:W.capturedBy||"-"}),a.jsxs("p",{className:"text-xs text-gray-400 flex items-center gap-1 mt-1",children:[a.jsx(ro,{size:12}),new Date(W.createdAt).toLocaleDateString()]})]})}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("span",{className:`px-3 py-1.5 text-xs font-semibold rounded-full border ${S(W.status)}`,children:k_[W.status]||W.status})}),a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"flex justify-center gap-1",children:[a.jsx("button",{onClick:()=>{o(W),g(!0)},className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg",title:"View Details",children:a.jsx(gs,{size:18})}),W.status!=="converted"&&W.status!=="rejected"&&a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>{o(W),x(!0)},className:"p-2 text-emerald-600 hover:bg-emerald-50 rounded-lg",title:"Convert to Customer",children:a.jsx(QU,{size:18})}),a.jsx("button",{onClick:()=>N(W.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",title:"Reject Lead",children:a.jsx(Dj,{size:18})})]}),W.status==="converted"&&a.jsx("span",{className:"p-2 text-green-600",children:a.jsx(o0,{size:18})})]})})]},W.id))})]})})]}),p&&l&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-lg mx-4 max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex justify-between items-start mb-6",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-emerald-400 to-emerald-600 rounded-full flex items-center justify-center text-white text-xl font-semibold",children:l.name.charAt(0).toUpperCase()}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-semibold",children:l.name}),l.shopName&&a.jsx("p",{className:"text-gray-500",children:l.shopName})]})]}),a.jsx("span",{className:`px-3 py-1 text-xs font-semibold rounded-full border ${S(l.status)}`,children:k_[l.status]||l.status})]}),a.jsxs("div",{className:"space-y-4",children:[l.phone&&a.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[a.jsx(Vp,{size:18,className:"text-gray-400"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500",children:"Phone"}),a.jsx("p",{className:"font-medium",children:l.phone})]})]}),l.email&&a.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[a.jsx(t4,{size:18,className:"text-gray-400"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500",children:"Email"}),a.jsx("p",{className:"font-medium",children:l.email})]})]}),(l.address||l.area||l.city)&&a.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[a.jsx(dc,{size:18,className:"text-gray-400"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500",children:"Location"}),a.jsx("p",{className:"font-medium",children:[l.address,l.area,l.city].filter(Boolean).join(", ")})]})]}),l.businessType&&a.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[a.jsx(t4,{size:18,className:"text-gray-400"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500",children:"Business Type"}),a.jsx("p",{className:"font-medium",children:l.businessType})]})]}),l.estimatedPotential&&a.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[a.jsx(hn,{size:18,className:"text-gray-400"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500",children:"Estimated Potential"}),a.jsx("p",{className:"font-medium",children:l.estimatedPotential})]})]}),l.notes&&a.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[a.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Notes"}),a.jsx("p",{className:"text-sm text-gray-700",children:l.notes})]}),a.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[a.jsx(ro,{size:18,className:"text-gray-400"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500",children:"Captured"}),a.jsxs("p",{className:"font-medium",children:[new Date(l.createdAt).toLocaleDateString()," by ",l.capturedBy||"Unknown"]})]})]})]}),a.jsxs("div",{className:"flex gap-3 mt-6",children:[a.jsx("button",{onClick:()=>g(!1),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Close"}),l.status!=="converted"&&l.status!=="rejected"&&a.jsx("button",{onClick:()=>{g(!1),x(!0)},className:"flex-1 px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600",children:"Convert to Customer"})]})]})}),f&&l&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md mx-4",children:[a.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Convert Lead to Customer"}),a.jsxs("div",{className:"space-y-4 mb-6",children:[a.jsxs("div",{className:"flex items-center gap-3 p-4 bg-emerald-50 rounded-lg border border-emerald-100",children:[a.jsx("div",{className:"w-12 h-12 bg-emerald-500 rounded-full flex items-center justify-center text-white font-semibold",children:l.name.charAt(0).toUpperCase()}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-gray-900",children:l.name}),l.shopName&&a.jsx("p",{className:"text-sm text-gray-500",children:l.shopName})]})]}),a.jsx("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-100",children:a.jsxs("p",{className:"text-sm text-blue-800",children:[a.jsx("strong",{children:"Note:"})," This will create a new customer record with all the lead's information including contact details and location."]})})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:()=>x(!1),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{onClick:k,disabled:y,className:"flex-1 px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 disabled:opacity-50 flex items-center justify-center gap-2",children:y?a.jsxs(a.Fragment,{children:[a.jsx(vt,{size:18,className:"animate-spin"}),"Converting..."]}):a.jsxs(a.Fragment,{children:[a.jsx(o0,{size:18}),"Convert"]})})]})]})})]})}function gve(){const[e,t]=m.useState([]),[r,s]=m.useState(!0),[n,i]=m.useState(!1),[l,o]=m.useState(!1),[c,u]=m.useState(null),[d,h]=m.useState({name:"",symbol:"",isBase:!1});m.useEffect(()=>{f()},[]);const f=async()=>{try{s(!0);const v=await ku.getAll();t(v.data)}catch(v){console.error("Failed to load units:",v)}finally{s(!1)}},x=()=>h({name:"",symbol:"",isBase:!1}),p=v=>{u(v),h({name:v.name,symbol:v.symbol||"",isBase:v.isBase}),o(!0)},g=async v=>{var j,b;if(v.preventDefault(),!!d.name.trim()){i(!0);try{c?await ku.update(c.id,d):await ku.create(d),o(!1),x(),u(null),f()}catch(w){alert(((b=(j=w.response)==null?void 0:j.data)==null?void 0:b.message)||"Failed to save unit")}finally{i(!1)}}},y=async v=>{var j,b;if(confirm("Are you sure you want to delete this unit?"))try{await ku.delete(v),f()}catch(w){alert(((b=(j=w.response)==null?void 0:j.data)==null?void 0:b.message)||"Failed to delete unit")}};return r?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx(vt,{className:"animate-spin",size:32})}):a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsxs("div",{children:[a.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[a.jsx(J6,{className:"text-blue-600"})," Units"]}),a.jsx("p",{className:"text-gray-500 text-sm",children:"Manage product measurement units"})]}),a.jsxs("button",{onClick:()=>{x(),u(null),o(!0)},className:"flex items-center gap-2 px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600",children:[a.jsx(hr,{size:20})," Add Unit"]})]}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Name"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Symbol"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Base Unit"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:e.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:4,className:"px-4 py-8 text-center text-gray-500",children:"No units found"})}):e.map(v=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 font-medium",children:v.name}),a.jsx("td",{className:"px-4 py-3 text-gray-500",children:v.symbol||"-"}),a.jsx("td",{className:"px-4 py-3",children:v.isBase&&a.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-700",children:"Base"})}),a.jsx("td",{className:"px-4 py-3",children:a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:()=>p(v),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",title:"Edit",children:a.jsx(js,{size:16})}),a.jsx("button",{onClick:()=>y(v.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Delete",children:a.jsx(xr,{size:16})})]})})]},v.id))})]})}),l&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-md",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-[#003366] text-white rounded-t-xl",children:[a.jsx("h2",{className:"text-lg font-semibold",children:c?"Edit Unit":"Add Unit"}),a.jsx("button",{onClick:()=>o(!1),children:a.jsx(yt,{size:24})})]}),a.jsxs("form",{onSubmit:g,className:"p-6 space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Unit Name *"}),a.jsx("input",{type:"text",value:d.name,onChange:v=>h({...d,name:v.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"e.g. Piece, Box, Kg",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Symbol"}),a.jsx("input",{type:"text",value:d.symbol,onChange:v=>h({...d,symbol:v.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"e.g. pc, box, kg"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",id:"isBase",checked:d.isBase,onChange:v=>h({...d,isBase:v.target.checked}),className:"rounded"}),a.jsx("label",{htmlFor:"isBase",className:"text-sm",children:"Base Unit"})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>o(!1),className:"flex-1 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:n,className:"flex-1 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 disabled:opacity-50",children:n?"Saving...":"Save"})]})]})]})})]})}function yve(){const[e,t]=m.useState([]),[r,s]=m.useState([]),[n,i]=m.useState(!0),[l,o]=m.useState(""),[c,u]=m.useState(null),[d,h]=m.useState(!1),[f,x]=m.useState(!1),[p,g]=m.useState(!1),[y,v]=m.useState({warehouseId:0,issueCredit:!0});m.useEffect(()=>{j()},[l]);const j=async()=>{try{i(!0);const[I,ne]=await Promise.all([ah.getAll({status:l||void 0}),Ks.getAll()]);t(I),s(ne.data||ne)}catch(I){console.error("Failed to load returns:",I)}finally{i(!1)}},b=async I=>{try{const ne=await ah.getById(I);u(ne),h(!0)}catch(ne){console.error("Failed to load return details:",ne)}},w=async I=>{try{await ah.approve(I),j(),h(!1)}catch(ne){console.error("Failed to approve return:",ne)}},k=async I=>{if(confirm("Are you sure you want to reject this return?"))try{await ah.reject(I,"Rejected by manager"),j(),h(!1)}catch(ne){console.error("Failed to reject return:",ne)}},N=I=>{var ne;u(I),v({warehouseId:((ne=r[0])==null?void 0:ne.id)||0,issueCredit:!0}),x(!0)},S=async()=>{if(c){g(!0);try{await ah.process(c.id,{returnToVan:!1,warehouseId:y.warehouseId,issueCredit:y.issueCredit}),x(!1),h(!1),j()}catch(I){console.error("Failed to process return:",I)}finally{g(!1)}}},_=I=>{const ne=window.open("","_blank","width=800,height=600");if(!ne)return;const W=`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Return ${I.returnNumber}</title>
        <style>
          body { font-family: Arial, sans-serif; padding: 30px; }
          .header { text-align: center; border-bottom: 2px solid #10b981; padding-bottom: 20px; margin-bottom: 20px; }
          .header h1 { color: #10b981; margin: 0; }
          .info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px; }
          .info-box { background: #f9fafb; padding: 15px; border-radius: 8px; }
          .info-box label { font-size: 12px; color: #6b7280; }
          .info-box p { margin: 5px 0 0; font-weight: bold; }
          table { width: 100%; border-collapse: collapse; margin-top: 20px; }
          th, td { border: 1px solid #e5e7eb; padding: 10px; text-align: left; }
          th { background: #f3f4f6; }
          .total-row { font-weight: bold; background: #f0fdf4; }
          .status { display: inline-block; padding: 4px 12px; border-radius: 20px; font-size: 12px; }
          .status-pending { background: #fef3c7; color: #92400e; }
          .status-approved { background: #dbeafe; color: #1e40af; }
          .status-processed { background: #dcfce7; color: #166534; }
          .footer { margin-top: 40px; text-align: center; color: #9ca3af; font-size: 12px; }
        </style>
      </head>
      <body>
        <div class="header">
          <h1>Return Receipt</h1>
          <p>${I.returnNumber}</p>
        </div>
        <div class="info-grid">
          <div class="info-box">
            <label>Customer</label>
            <p>${I.customerName}</p>
          </div>
          <div class="info-box">
            <label>Date</label>
            <p>${R(I.returnDate)}</p>
          </div>
          <div class="info-box">
            <label>Status</label>
            <p><span class="status status-${I.status}">${I.status.toUpperCase()}</span></p>
          </div>
          <div class="info-box">
            <label>Driver</label>
            <p>${I.driverName||"N/A"}</p>
          </div>
        </div>
        ${I.reason?`<p><strong>Reason:</strong> ${I.reason}</p>`:""}
        <table>
          <thead>
            <tr>
              <th>Product</th>
              <th>SKU</th>
              <th style="text-align:right">Qty</th>
              <th style="text-align:right">Price</th>
              <th style="text-align:right">Total</th>
            </tr>
          </thead>
          <tbody>
            ${I.items.map(Q=>`
              <tr>
                <td>${Q.productName}</td>
                <td>${Q.productSku}</td>
                <td style="text-align:right">${Q.quantity}</td>
                <td style="text-align:right">${E(Q.unitPrice)}</td>
                <td style="text-align:right">${E(Q.lineTotal)}</td>
              </tr>
            `).join("")}
            <tr class="total-row">
              <td colspan="4" style="text-align:right">Total:</td>
              <td style="text-align:right">${E(I.totalAmount)}</td>
            </tr>
          </tbody>
        </table>
        <div class="footer">
          <p>Catalyst Return Management System</p>
        </div>
      </body>
      </html>
    `;ne.document.write(W),ne.document.close(),setTimeout(()=>ne.print(),300)},O=I=>{switch(I){case"pending":return"bg-yellow-100 text-yellow-800";case"approved":return"bg-blue-100 text-blue-800";case"rejected":return"bg-red-100 text-red-800";case"processed":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},E=I=>`$${I.toFixed(3)}`,R=I=>new Date(I).toLocaleDateString(),C={pending:e.filter(I=>I.status==="pending").length,approved:e.filter(I=>I.status==="approved").length,processed:e.filter(I=>I.status==="processed").length,totalValue:e.filter(I=>I.status!=="rejected").reduce((I,ne)=>I+ne.totalAmount,0)};return a.jsxs("div",{children:[a.jsx("div",{className:"flex justify-between items-center mb-6",children:a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Returns"})}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:a.jsx(ao,{className:"text-yellow-600",size:20})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:C.pending}),a.jsx("p",{className:"text-sm text-gray-500",children:"Pending"})]})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:a.jsx(Jt,{className:"text-blue-600",size:20})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:C.approved}),a.jsx("p",{className:"text-sm text-gray-500",children:"Approved"})]})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:a.jsx(Tr,{className:"text-green-600",size:20})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:C.processed}),a.jsx("p",{className:"text-sm text-gray-500",children:"Processed"})]})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-2 bg-emerald-100 rounded-lg",children:a.jsx(da,{className:"text-emerald-600",size:20})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:E(C.totalValue)}),a.jsx("p",{className:"text-sm text-gray-500",children:"Total Value"})]})]})})]}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 mb-6",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Status:"}),a.jsx("div",{className:"flex gap-2",children:["","pending","approved","processed","rejected"].map(I=>a.jsx("button",{onClick:()=>o(I),className:`px-3 py-1 text-sm rounded-full ${l===I?"bg-emerald-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:I||"All"},I))})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden",children:n?a.jsx("div",{className:"p-8 text-center",children:a.jsx(vt,{className:"animate-spin mx-auto text-gray-400",size:32})}):e.length===0?a.jsxs("div",{className:"p-8 text-center text-gray-500",children:[a.jsx(ao,{size:48,className:"mx-auto mb-4 text-gray-300"}),a.jsx("p",{children:"No returns found"})]}):a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-left px-6 py-3 text-xs font-medium text-gray-500 uppercase",children:"Return #"}),a.jsx("th",{className:"text-left px-6 py-3 text-xs font-medium text-gray-500 uppercase",children:"Customer"}),a.jsx("th",{className:"text-left px-6 py-3 text-xs font-medium text-gray-500 uppercase",children:"Driver"}),a.jsx("th",{className:"text-left px-6 py-3 text-xs font-medium text-gray-500 uppercase",children:"Date"}),a.jsx("th",{className:"text-right px-6 py-3 text-xs font-medium text-gray-500 uppercase",children:"Amount"}),a.jsx("th",{className:"text-center px-6 py-3 text-xs font-medium text-gray-500 uppercase",children:"Items"}),a.jsx("th",{className:"text-left px-6 py-3 text-xs font-medium text-gray-500 uppercase",children:"Status"}),a.jsx("th",{className:"text-right px-6 py-3 text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:e.map(I=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-6 py-4 font-medium text-gray-900",children:I.returnNumber}),a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Sy,{size:16,className:"text-gray-400"}),I.customerName]})}),a.jsx("td",{className:"px-6 py-4 text-gray-600",children:I.driverName||"-"}),a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[a.jsx(ro,{size:16}),R(I.returnDate)]})}),a.jsx("td",{className:"px-6 py-4 text-right font-medium",children:E(I.totalAmount)}),a.jsx("td",{className:"px-6 py-4 text-center",children:I.itemCount}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${O(I.status)}`,children:I.status})}),a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"flex justify-end gap-2",children:[a.jsx("button",{onClick:()=>b(I.id),className:"p-2 text-gray-600 hover:bg-gray-100 rounded-lg",title:"View Details",children:a.jsx(gs,{size:18})}),I.status==="pending"&&a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>w(I.id),className:"p-2 text-emerald-600 hover:bg-emerald-50 rounded-lg",title:"Approve",children:a.jsx(Jt,{size:18})}),a.jsx("button",{onClick:()=>k(I.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",title:"Reject",children:a.jsx(yt,{size:18})})]})]})})]},I.id))})]})}),d&&c&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex justify-between items-start mb-6",children:[a.jsxs("div",{children:[a.jsxs("h2",{className:"text-lg font-semibold",children:["Return ",c.returnNumber]}),a.jsx("p",{className:"text-sm text-gray-500",children:R(c.returnDate)})]}),a.jsx("span",{className:`px-3 py-1 text-sm font-medium rounded-full ${O(c.status)}`,children:c.status})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[a.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Customer"}),a.jsx("p",{className:"font-medium",children:c.customerName})]}),a.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Driver"}),a.jsx("p",{className:"font-medium",children:c.driverName||"-"})]})]}),c.reason&&a.jsx("div",{className:"mb-6 p-4 bg-yellow-50 rounded-lg",children:a.jsxs("p",{className:"text-sm text-yellow-800",children:[a.jsx("strong",{children:"Reason:"})," ",c.reason]})}),a.jsx("h3",{className:"font-medium mb-3",children:"Items"}),a.jsxs("table",{className:"w-full text-sm mb-6",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-left p-2",children:"Product"}),a.jsx("th",{className:"text-right p-2",children:"Qty"}),a.jsx("th",{className:"text-right p-2",children:"Price"}),a.jsx("th",{className:"text-right p-2",children:"Total"})]})}),a.jsx("tbody",{children:c.items.map(I=>a.jsxs("tr",{className:"border-b",children:[a.jsxs("td",{className:"p-2",children:[a.jsx("p",{className:"font-medium",children:I.productName}),a.jsx("p",{className:"text-xs text-gray-500",children:I.productSku})]}),a.jsx("td",{className:"p-2 text-right",children:I.quantity}),a.jsx("td",{className:"p-2 text-right",children:E(I.unitPrice)}),a.jsx("td",{className:"p-2 text-right font-medium",children:E(I.lineTotal)})]},I.id))}),a.jsx("tfoot",{children:a.jsxs("tr",{className:"font-bold",children:[a.jsx("td",{colSpan:3,className:"p-2 text-right",children:"Total:"}),a.jsx("td",{className:"p-2 text-right",children:E(c.totalAmount)})]})})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:()=>h(!1),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Close"}),a.jsxs("button",{onClick:()=>_(c),className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-2",children:[a.jsx(ua,{size:18}),"Print"]}),c.status==="pending"&&a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>k(c.id),className:"px-4 py-2 border border-red-300 text-red-600 rounded-lg hover:bg-red-50",children:"Reject"}),a.jsx("button",{onClick:()=>w(c.id),className:"px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600",children:"Approve"})]}),c.status==="approved"&&a.jsx("button",{onClick:()=>N(c),className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600",children:"Process Return"})]})]})}),f&&c&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md",children:[a.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Process Return"}),a.jsxs("div",{className:"space-y-4 mb-6",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[a.jsx(gl,{size:16,className:"inline mr-1"}),"Return to Warehouse"]}),a.jsx("select",{value:y.warehouseId,onChange:I=>v({...y,warehouseId:Number(I.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:r.map(I=>a.jsx("option",{value:I.id,children:I.name},I.id))})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",id:"issueCredit",checked:y.issueCredit,onChange:I=>v({...y,issueCredit:I.target.checked}),className:"w-4 h-4 text-emerald-600 rounded"}),a.jsxs("label",{htmlFor:"issueCredit",className:"text-sm text-gray-700",children:["Credit customer's account (",E(c.totalAmount),")"]})]})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:()=>x(!1),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{onClick:S,disabled:p,className:"flex-1 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50",children:p?"Processing...":"Process"})]})]})})]})}function vve(){var it;const[e,t]=m.useState([]),[r,s]=m.useState(!0),[n,i]=m.useState(""),[l,o]=m.useState(""),[c,u]=m.useState(null),[d,h]=m.useState(null),[f,x]=m.useState(!1),[p,g]=m.useState(!1),[y,v]=m.useState(null),[j,b]=m.useState([]),[w,k]=m.useState([]),[N,S]=m.useState(null),[_,O]=m.useState(""),[E,R]=m.useState(""),[C,I]=m.useState([]),[ne,W]=m.useState(30),[Q,H]=m.useState(""),[K,q]=m.useState(""),[ge,G]=m.useState(!1);m.useEffect(()=>{B()},[n]),m.useEffect(()=>{p&&se()},[p]);const B=async()=>{try{s(!0);const[we,et]=await Promise.all([_i.getAll({status:n||void 0}),_i.getSummary()]);t(we),u(et)}catch(we){console.error("Failed to load quotes:",we)}finally{s(!1)}},se=async()=>{try{const[we,et]=await Promise.all([Ha.getAll(),ie.get("/products")]);b(we.data||we),k(et.data||[])}catch(we){console.error("Failed to load form data:",we)}},L=async we=>{try{const et=await _i.getById(we);h(et),x(!0)}catch(et){console.error("Failed to load quote:",et)}},Z=async we=>{try{const et=await _i.getById(we);v(et),S(et.customerId),I(et.items.map(Ge=>({productId:Ge.productId,productName:Ge.productName,sku:Ge.productSku,quantity:Ge.quantity,unitPrice:Ge.unitPrice,discountPercent:Ge.discountPercent}))),H(et.notes||""),q(et.terms||""),g(!0)}catch(et){console.error("Failed to load quote for edit:",et)}},F=we=>{const et=C.find(Ge=>Ge.productId===we.id);I(et?C.map(Ge=>Ge.productId===we.id?{...Ge,quantity:Ge.quantity+1}:Ge):[...C,{productId:we.id,productName:we.name,sku:we.sku,quantity:1,unitPrice:we.retailPrice,discountPercent:0}]),R("")},he=(we,et,Ge)=>{I(C.map(Nt=>Nt.productId===we?{...Nt,[et]:Ge}:Nt))},ye=we=>{I(C.filter(et=>et.productId!==we))},z=async()=>{var we,et;if(!N){alert("Please select a customer");return}if(C.length===0){alert("Please add at least one item");return}G(!0);try{const Ge={customerId:N,validUntil:new Date(Date.now()+ne*24*60*60*1e3).toISOString(),discountAmount:0,taxAmount:0,notes:Q,terms:K,items:C.map(Nt=>({productId:Nt.productId,quantity:Nt.quantity,unitPrice:Nt.unitPrice,discountPercent:Nt.discountPercent}))};y?await _i.update(y.id,Ge):await _i.create(Ge),g(!1),B()}catch(Ge){alert(((et=(we=Ge.response)==null?void 0:we.data)==null?void 0:et.error)||"Failed to save quote")}finally{G(!1)}},A=async(we,et)=>{try{await _i.updateStatus(we,et),B(),(d==null?void 0:d.id)===we&&L(we)}catch(Ge){console.error("Failed to update status:",Ge)}},de=async we=>{var et,Ge;if(confirm("Delete this quote?"))try{await _i.delete(we),B()}catch(Nt){alert(((Ge=(et=Nt.response)==null?void 0:et.data)==null?void 0:Ge.error)||"Failed to delete")}},D=we=>{const et=window.open("","_blank","width=800,height=600");if(!et)return;const Ge=`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Quote ${we.quoteNumber}</title>
        <style>
          body { font-family: Arial, sans-serif; padding: 40px; max-width: 800px; margin: 0 auto; }
          .header { text-align: center; border-bottom: 3px solid #2563eb; padding-bottom: 20px; margin-bottom: 30px; }
          .header h1 { color: #2563eb; margin: 0; font-size: 28px; }
          .header .quote-number { font-size: 18px; color: #666; margin-top: 5px; }
          .info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 30px; }
          .info-box { background: #f8fafc; padding: 20px; border-radius: 8px; border-left: 4px solid #2563eb; }
          .info-box h3 { margin: 0 0 10px; color: #374151; font-size: 14px; text-transform: uppercase; }
          .info-box p { margin: 5px 0; font-size: 14px; }
          .info-box .value { font-weight: bold; color: #111827; }
          table { width: 100%; border-collapse: collapse; margin: 20px 0; }
          th { background: #2563eb; color: white; padding: 12px; text-align: left; font-size: 12px; text-transform: uppercase; }
          td { border-bottom: 1px solid #e5e7eb; padding: 12px; font-size: 14px; }
          .text-right { text-align: right; }
          .total-row { background: #f0f9ff; font-weight: bold; }
          .total-row td { border-top: 2px solid #2563eb; }
          .validity { background: #fef3c7; padding: 15px; border-radius: 8px; margin: 20px 0; text-align: center; }
          .validity strong { color: #92400e; }
          .notes { background: #f3f4f6; padding: 15px; border-radius: 8px; margin-top: 20px; }
          .notes h4 { margin: 0 0 10px; color: #374151; }
          .footer { margin-top: 40px; text-align: center; color: #9ca3af; font-size: 12px; border-top: 1px solid #e5e7eb; padding-top: 20px; }
          .status { display: inline-block; padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: bold; }
          .status-draft { background: #f3f4f6; color: #6b7280; }
          .status-sent { background: #dbeafe; color: #1d4ed8; }
          .status-accepted { background: #dcfce7; color: #166534; }
        </style>
      </head>
      <body>
        <div class="header">
          <h1>QUOTATION</h1>
          <div class="quote-number">${we.quoteNumber}</div>
        </div>

        <div class="info-grid">
          <div class="info-box">
            <h3>Customer</h3>
            <p class="value">${we.customerName}</p>
            ${we.customerPhone?`<p>Phone: ${we.customerPhone}</p>`:""}
            ${we.customerAddress?`<p>Address: ${we.customerAddress}</p>`:""}
          </div>
          <div class="info-box">
            <h3>Quote Details</h3>
            <p>Date: <span class="value">${ct(we.quoteDate)}</span></p>
            <p>Valid Until: <span class="value">${ct(we.validUntil)}</span></p>
            <p>Status: <span class="status status-${we.status}">${we.status.toUpperCase()}</span></p>
          </div>
        </div>

        <table>
          <thead>
            <tr>
              <th>Item</th>
              <th>SKU</th>
              <th class="text-right">Qty</th>
              <th class="text-right">Unit Price</th>
              <th class="text-right">Discount</th>
              <th class="text-right">Total</th>
            </tr>
          </thead>
          <tbody>
            ${we.items.map(Nt=>`
              <tr>
                <td>${Nt.productName}</td>
                <td>${Nt.productSku}</td>
                <td class="text-right">${Nt.quantity}</td>
                <td class="text-right">${Fe(Nt.unitPrice)}</td>
                <td class="text-right">${Nt.discountPercent>0?Nt.discountPercent+"%":"-"}</td>
                <td class="text-right">${Fe(Nt.lineTotal)}</td>
              </tr>
            `).join("")}
            <tr class="total-row">
              <td colspan="5" class="text-right">Subtotal:</td>
              <td class="text-right">${Fe(we.subtotal)}</td>
            </tr>
            ${we.discountAmount>0?`
              <tr>
                <td colspan="5" class="text-right">Discount:</td>
                <td class="text-right">-${Fe(we.discountAmount)}</td>
              </tr>
            `:""}
            ${we.taxAmount>0?`
              <tr>
                <td colspan="5" class="text-right">Tax:</td>
                <td class="text-right">${Fe(we.taxAmount)}</td>
              </tr>
            `:""}
            <tr class="total-row">
              <td colspan="5" class="text-right"><strong>TOTAL:</strong></td>
              <td class="text-right"><strong>${Fe(we.totalAmount)}</strong></td>
            </tr>
          </tbody>
        </table>

        <div class="validity">
          <strong>This quote is valid until ${ct(we.validUntil)}</strong>
        </div>

        ${we.notes?`
          <div class="notes">
            <h4>Notes</h4>
            <p>${we.notes}</p>
          </div>
        `:""}

        ${we.terms?`
          <div class="notes">
            <h4>Terms & Conditions</h4>
            <p>${we.terms}</p>
          </div>
        `:""}

        <div class="footer">
          <p>Thank you for your business!</p>
          <p>Catalyst Quote Management System</p>
        </div>
      </body>
      </html>
    `;et.document.write(Ge),et.document.close(),setTimeout(()=>et.print(),300)},ze=we=>{switch(we){case"draft":return"bg-gray-100 text-gray-700";case"sent":return"bg-blue-100 text-blue-700";case"accepted":return"bg-green-100 text-green-700";case"converted":return"bg-emerald-100 text-emerald-700";case"rejected":return"bg-red-100 text-red-700";case"expired":return"bg-orange-100 text-orange-700";default:return"bg-gray-100 text-gray-700"}},Fe=we=>`$${we.toFixed(3)}`,ct=we=>new Date(we).toLocaleDateString(),$e=C.reduce((we,et)=>{const Ge=et.quantity*et.unitPrice*(1-et.discountPercent/100);return we+Ge},0),We=j.filter(we=>{var et;return we.name.toLowerCase().includes(_.toLowerCase())||((et=we.shopName)==null?void 0:et.toLowerCase().includes(_.toLowerCase()))}).slice(0,10),Bt=w.filter(we=>we.name.toLowerCase().includes(E.toLowerCase())||we.sku.toLowerCase().includes(E.toLowerCase())||we.barcode===E).slice(0,10),Ee=e.filter(we=>we.quoteNumber.toLowerCase().includes(l.toLowerCase())||we.customerName.toLowerCase().includes(l.toLowerCase()));return a.jsxs("div",{children:[a.jsx("div",{className:"flex justify-between items-center mb-6",children:a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Quotes"})}),c&&a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:a.jsx(Br,{className:"text-blue-600",size:20})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-2xl font-bold text-blue-600",children:c.totalQuotes}),a.jsx("p",{className:"text-sm text-gray-500",children:"Total Quotes"})]})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:a.jsx(Lj,{className:"text-yellow-600",size:20})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:c.sentQuotes}),a.jsx("p",{className:"text-sm text-gray-500",children:"Sent"})]})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:a.jsx(Jt,{className:"text-green-600",size:20})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-2xl font-bold text-green-600",children:c.acceptedQuotes}),a.jsx("p",{className:"text-sm text-gray-500",children:"Accepted"})]})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-2 bg-emerald-100 rounded-lg",children:a.jsx(da,{className:"text-emerald-600",size:20})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-2xl font-bold text-emerald-600",children:Fe(c.convertedValue)}),a.jsx("p",{className:"text-sm text-gray-500",children:"Converted Value"})]})]})})]}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 mb-6",children:a.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[a.jsxs("div",{className:"flex-1 relative",children:[a.jsx(Na,{size:18,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),a.jsx("input",{type:"text",value:l,onChange:we=>o(we.target.value),placeholder:"Search quotes...",className:"w-full pl-10 pr-4 py-2 border rounded-lg"})]}),a.jsxs("select",{value:n,onChange:we=>i(we.target.value),className:"px-4 py-2 border rounded-lg",children:[a.jsx("option",{value:"",children:"All Status"}),a.jsx("option",{value:"draft",children:"Draft"}),a.jsx("option",{value:"sent",children:"Sent"}),a.jsx("option",{value:"accepted",children:"Accepted"}),a.jsx("option",{value:"converted",children:"Converted"}),a.jsx("option",{value:"rejected",children:"Rejected"}),a.jsx("option",{value:"expired",children:"Expired"})]})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden",children:r?a.jsx("div",{className:"flex justify-center py-12",children:a.jsx(vt,{className:"animate-spin text-blue-600",size:32})}):Ee.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx(Br,{size:48,className:"mx-auto text-gray-300 mb-4"}),a.jsx("p",{className:"text-gray-500",children:"No quotes found"})]}):a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50 border-b",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-left p-4 font-medium text-gray-600",children:"Quote #"}),a.jsx("th",{className:"text-left p-4 font-medium text-gray-600",children:"Customer"}),a.jsx("th",{className:"text-left p-4 font-medium text-gray-600",children:"Date"}),a.jsx("th",{className:"text-left p-4 font-medium text-gray-600",children:"Valid Until"}),a.jsx("th",{className:"text-right p-4 font-medium text-gray-600",children:"Amount"}),a.jsx("th",{className:"text-center p-4 font-medium text-gray-600",children:"Status"}),a.jsx("th",{className:"text-right p-4 font-medium text-gray-600",children:"Actions"})]})}),a.jsx("tbody",{children:Ee.map(we=>a.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[a.jsx("td",{className:"p-4 font-medium",children:we.quoteNumber}),a.jsx("td",{className:"p-4",children:we.customerName}),a.jsx("td",{className:"p-4 text-gray-500",children:ct(we.quoteDate)}),a.jsx("td",{className:"p-4 text-gray-500",children:ct(we.validUntil)}),a.jsx("td",{className:"p-4 text-right font-medium",children:Fe(we.totalAmount)}),a.jsx("td",{className:"p-4 text-center",children:a.jsx("span",{className:`px-3 py-1 text-xs font-medium rounded-full ${ze(we.status)}`,children:we.status})}),a.jsx("td",{className:"p-4",children:a.jsxs("div",{className:"flex justify-end gap-1",children:[a.jsx("button",{onClick:()=>L(we.id),className:"p-2 text-gray-600 hover:bg-gray-100 rounded-lg",title:"View",children:a.jsx(gs,{size:18})}),we.status==="draft"&&a.jsx("button",{onClick:()=>Z(we.id),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg",title:"Edit",children:a.jsx(js,{size:18})}),(we.status==="draft"||we.status==="sent")&&a.jsx("button",{onClick:()=>de(we.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",title:"Delete",children:a.jsx(xr,{size:18})})]})})]},we.id))})]})}),f&&d&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-3xl max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex justify-between items-start mb-6",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-semibold",children:d.quoteNumber}),a.jsx("p",{className:"text-sm text-gray-500",children:ct(d.quoteDate)})]}),a.jsx("span",{className:`px-3 py-1 text-sm font-medium rounded-full ${ze(d.status)}`,children:d.status})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[a.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Customer"}),a.jsx("p",{className:"font-medium",children:d.customerName}),d.customerPhone&&a.jsx("p",{className:"text-sm text-gray-500",children:d.customerPhone})]}),a.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Valid Until"}),a.jsx("p",{className:"font-medium",children:ct(d.validUntil)})]})]}),a.jsx("h3",{className:"font-medium mb-3",children:"Items"}),a.jsxs("table",{className:"w-full text-sm mb-6",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-left p-2",children:"Product"}),a.jsx("th",{className:"text-right p-2",children:"Qty"}),a.jsx("th",{className:"text-right p-2",children:"Price"}),a.jsx("th",{className:"text-right p-2",children:"Discount"}),a.jsx("th",{className:"text-right p-2",children:"Total"})]})}),a.jsx("tbody",{children:d.items.map(we=>a.jsxs("tr",{className:"border-b",children:[a.jsxs("td",{className:"p-2",children:[a.jsx("p",{className:"font-medium",children:we.productName}),a.jsx("p",{className:"text-xs text-gray-500",children:we.productSku})]}),a.jsx("td",{className:"p-2 text-right",children:we.quantity}),a.jsx("td",{className:"p-2 text-right",children:Fe(we.unitPrice)}),a.jsx("td",{className:"p-2 text-right",children:we.discountPercent>0?`${we.discountPercent}%`:"-"}),a.jsx("td",{className:"p-2 text-right font-medium",children:Fe(we.lineTotal)})]},we.id))}),a.jsx("tfoot",{children:a.jsxs("tr",{className:"font-bold bg-blue-50",children:[a.jsx("td",{colSpan:4,className:"p-2 text-right",children:"Total:"}),a.jsx("td",{className:"p-2 text-right",children:Fe(d.totalAmount)})]})})]}),d.notes&&a.jsxs("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Notes"}),a.jsx("p",{children:d.notes})]}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsx("button",{onClick:()=>x(!1),className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Close"}),a.jsxs("button",{onClick:()=>D(d),className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-2",children:[a.jsx(ua,{size:18}),"Print"]}),d.status==="draft"&&a.jsxs("button",{onClick:()=>A(d.id,"sent"),className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 flex items-center gap-2",children:[a.jsx(Lj,{size:18}),"Mark as Sent"]}),d.status==="sent"&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{onClick:()=>A(d.id,"accepted"),className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 flex items-center gap-2",children:[a.jsx(Jt,{size:18}),"Accept"]}),a.jsxs("button",{onClick:()=>A(d.id,"rejected"),className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 flex items-center gap-2",children:[a.jsx(yt,{size:18}),"Reject"]})]})]})]})}),p&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-3xl max-h-[90vh] overflow-hidden flex flex-col",children:[a.jsx("div",{className:"p-6 border-b",children:a.jsx("h2",{className:"text-lg font-semibold",children:y?"Edit Quote":"Create New Quote"})}),a.jsxs("div",{className:"p-6 overflow-y-auto flex-1",children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Customer *"}),N?a.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 rounded-lg border border-blue-200",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Sy,{size:18,className:"text-blue-600"}),a.jsx("span",{className:"font-medium",children:(it=j.find(we=>we.id===N))==null?void 0:it.name})]}),a.jsx("button",{onClick:()=>S(null),className:"text-gray-500 hover:text-red-500",children:a.jsx(yt,{size:18})})]}):a.jsxs("div",{className:"relative",children:[a.jsx(Na,{size:18,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),a.jsx("input",{type:"text",value:_,onChange:we=>O(we.target.value),placeholder:"Search customers...",className:"w-full pl-10 pr-4 py-2 border rounded-lg"}),_&&We.length>0&&a.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border rounded-lg shadow-lg max-h-48 overflow-y-auto",children:We.map(we=>a.jsxs("button",{onClick:()=>{S(we.id),O("")},className:"w-full text-left px-4 py-2 hover:bg-gray-50",children:[a.jsx("p",{className:"font-medium",children:we.name}),we.shopName&&a.jsx("p",{className:"text-sm text-gray-500",children:we.shopName})]},we.id))})]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Valid for (days)"}),a.jsx("input",{type:"number",value:ne,onChange:we=>W(parseInt(we.target.value)||30),min:"1",className:"w-32 px-3 py-2 border rounded-lg"})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Add Products"}),a.jsxs("div",{className:"relative",children:[a.jsx(Na,{size:18,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),a.jsx("input",{type:"text",value:E,onChange:we=>{const et=we.target.value;if(R(et),et.length>=3){const Ge=w.find(Nt=>Nt.barcode===et||Nt.sku.toLowerCase()===et.toLowerCase());Ge&&F(Ge)}},placeholder:"Scan barcode or search products...",className:"w-full pl-10 pr-4 py-2 border rounded-lg"}),E&&Bt.length>0&&a.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border rounded-lg shadow-lg max-h-48 overflow-y-auto",children:Bt.map(we=>a.jsxs("button",{onClick:()=>F(we),className:"w-full text-left px-4 py-2 hover:bg-gray-50 flex justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:we.name}),a.jsx("p",{className:"text-sm text-gray-500",children:we.sku})]}),a.jsx("span",{className:"text-blue-600 font-medium",children:Fe(we.retailPrice)})]},we.id))})]})]}),C.length>0&&a.jsx("div",{className:"mb-4",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-left p-2",children:"Product"}),a.jsx("th",{className:"text-center p-2 w-20",children:"Qty"}),a.jsx("th",{className:"text-right p-2 w-24",children:"Price"}),a.jsx("th",{className:"text-center p-2 w-20",children:"Disc %"}),a.jsx("th",{className:"text-right p-2 w-24",children:"Total"}),a.jsx("th",{className:"w-10"})]})}),a.jsx("tbody",{children:C.map(we=>{const et=we.quantity*we.unitPrice*(1-we.discountPercent/100);return a.jsxs("tr",{className:"border-b",children:[a.jsxs("td",{className:"p-2",children:[a.jsx("p",{className:"font-medium",children:we.productName}),a.jsx("p",{className:"text-xs text-gray-500",children:we.sku})]}),a.jsx("td",{className:"p-2",children:a.jsx("input",{type:"number",min:"1",value:we.quantity,onChange:Ge=>he(we.productId,"quantity",parseFloat(Ge.target.value)||1),className:"w-full text-center border rounded px-2 py-1"})}),a.jsx("td",{className:"p-2",children:a.jsx("input",{type:"number",min:"0",step:"0.01",value:we.unitPrice,onChange:Ge=>he(we.productId,"unitPrice",parseFloat(Ge.target.value)||0),className:"w-full text-right border rounded px-2 py-1"})}),a.jsx("td",{className:"p-2",children:a.jsx("input",{type:"number",min:"0",max:"100",value:we.discountPercent,onChange:Ge=>he(we.productId,"discountPercent",parseFloat(Ge.target.value)||0),className:"w-full text-center border rounded px-2 py-1"})}),a.jsx("td",{className:"p-2 text-right font-medium",children:Fe(et)}),a.jsx("td",{className:"p-2",children:a.jsx("button",{onClick:()=>ye(we.productId),className:"text-red-500 hover:text-red-700",children:a.jsx(xr,{size:16})})})]},we.productId)})}),a.jsx("tfoot",{children:a.jsxs("tr",{className:"font-bold bg-gray-50",children:[a.jsx("td",{colSpan:4,className:"p-2 text-right",children:"Total:"}),a.jsx("td",{className:"p-2 text-right",children:Fe($e)}),a.jsx("td",{})]})})]})}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes"}),a.jsx("textarea",{value:Q,onChange:we=>H(we.target.value),placeholder:"Additional notes...",rows:3,className:"w-full px-3 py-2 border rounded-lg"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Terms & Conditions"}),a.jsx("textarea",{value:K,onChange:we=>q(we.target.value),placeholder:"Terms and conditions...",rows:3,className:"w-full px-3 py-2 border rounded-lg"})]})]})]}),a.jsxs("div",{className:"p-6 border-t bg-gray-50 flex gap-3",children:[a.jsx("button",{onClick:()=>g(!1),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-100",children:"Cancel"}),a.jsx("button",{onClick:z,disabled:ge||!N||C.length===0,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:ge?"Saving...":y?"Update Quote":"Create Quote"})]})]})})]})}const bve=[{value:"damaged",label:"Damaged"},{value:"wrong_item",label:"Wrong Item"},{value:"expired",label:"Expired"},{value:"customer_changed_mind",label:"Customer Changed Mind"},{value:"defective",label:"Defective"},{value:"other",label:"Other"}],jve=[{value:"resellable",label:"Resellable"},{value:"damaged",label:"Damaged"},{value:"opened",label:"Opened"}],wve=[{value:"back_to_stock",label:"Back to Stock"},{value:"scrap",label:"Scrap"},{value:"return_to_vendor",label:"Return to Vendor"}];function Nve(){const e=m.useRef(null),[t,r]=m.useState([]),[s,n]=m.useState([]),[i,l]=m.useState([]),[o,c]=m.useState([]),[u,d]=m.useState([]),[h,f]=m.useState([]),[x,p]=m.useState(!0),[g,y]=m.useState(""),[v,j]=m.useState(""),[b,w]=m.useState(!1),[k,N]=m.useState(!1),[S,_]=m.useState(!1),[O,E]=m.useState(""),[R,C]=m.useState(null),[I,ne]=m.useState([]),[W,Q]=m.useState(null),[H,K]=m.useState("cash"),[q,ge]=m.useState(""),[G,B]=m.useState(""),[se,L]=m.useState(!1),[Z,F]=m.useState(null),[he,ye]=m.useState(null),[z,A]=m.useState(""),[de,D]=m.useState(""),[ze,Fe]=m.useState(!1),[ct,$e]=m.useState(null),[We,Bt]=m.useState("sale"),[Ee,it]=m.useState("catalog"),[we,et]=m.useState(""),[Ge,Nt]=m.useState(!1),[Rt,pr]=m.useState(null),[Zt,er]=m.useState([]),[ue,Le]=m.useState([]),[Je,Xe]=m.useState("cash"),[le,Me]=m.useState(""),[ut,ee]=m.useState(!1),[ve,xe]=m.useState(!1),[oe,Ie]=m.useState(null),[me,ht]=m.useState(null),[At,Er]=m.useState({}),[or,Gt]=m.useState({name:"",phone:"",address:"",exchangeRate:1,showSecondaryPrice:!1,currencySymbol:"$"});m.useEffect(()=>{ma(),zt()},[]);const zt=async()=>{try{const M=await Bp.get();Gt({name:M.data.companyName||M.data.name||"",phone:M.data.phone||"",address:M.data.address||"",exchangeRate:M.data.exchangeRate??1,showSecondaryPrice:M.data.showSecondaryPrice??!1,currencySymbol:M.data.currencySymbol||"$"})}catch(M){console.error("Failed to load company settings:",M)}};m.useEffect(()=>{R&&Or()},[R]),m.useEffect(()=>{W?_r(W.id):d([])},[W]),m.useEffect(()=>{var M;if(I.length>0&&t.length>0){const je=((M=W==null?void 0:W.customerType)==null?void 0:M.toLowerCase())==="wholesale";ne(fe=>fe.map(Ce=>{const Qe=u.find(Vt=>Vt.productId===Ce.product.productId);let _e=Ce.unitPrice;return Ce.unitType==="box"?Qe!=null&&Qe.hasBoxSpecialPrice&&Qe.boxSpecialPrice!=null?_e=Qe.boxSpecialPrice:_e=je?Ce.product.boxWholesalePrice:Ce.product.boxRetailPrice:Qe!=null&&Qe.hasSpecialPrice&&Qe.specialPrice!=null?_e=Qe.specialPrice:_e=je?Ce.product.wholesalePrice:Ce.product.retailPrice,{...Ce,unitPrice:_e}}))}},[W==null?void 0:W.customerType,u]),m.useEffect(()=>{var M;!k&&!he&&((M=e.current)==null||M.focus())},[k,he]);const ma=async()=>{p(!0);try{const[M,je,fe]=await Promise.all([Ha.getAll(),Ks.getAll(),Kc.getAll()]);l(M.data),c(je.data),f(fe.data||[]),je.data.length>0&&C(je.data[0].id)}catch(M){console.error("Failed to load data:",M)}finally{p(!1)}},Or=async()=>{try{const M=await ie.get("/direct-sales/inventory",{params:{warehouseId:R}});r(M.data);const je=M.data,fe=[],Ce=new Set;for(const _e of je){const Vt=[_e.color,_e.size].filter(Boolean),Qt=Vt.length>0?Vt.join(" "):"";if(fe.push({..._e,productName:Qt?`${_e.productName} - ${Qt}`:_e.productName,variantName:Qt||null,variants:void 0}),_e.variants&&_e.variants.length>0&&!_e.variantId&&!Ce.has(_e.productId)){Ce.add(_e.productId);for(const U of _e.variants){const Ke=[U.color,U.size].filter(Boolean),rt=Ke.length>0?Ke.join(" "):`Variant ${U.id}`;fe.push({..._e,productName:`${_e.productName} - ${rt}`,variantId:U.id,variantName:rt,sku:U.sku||_e.sku,barcode:U.barcode||_e.barcode,retailPrice:U.retailPrice??_e.retailPrice,wholesalePrice:U.wholesalePrice??_e.wholesalePrice,costPrice:U.costPrice??_e.costPrice,boxRetailPrice:U.boxRetailPrice??_e.boxRetailPrice,boxWholesalePrice:U.boxWholesalePrice??_e.boxWholesalePrice,boxCostPrice:U.boxCostPrice??_e.boxCostPrice,imageUrl:U.imageUrl||_e.imageUrl,color:U.color,size:U.size,weight:U.weight,length:U.length,height:U.height,quantity:U.quantity??0,variants:void 0})}}}const Qe=new Set;n(fe.filter(_e=>{const Vt=`${_e.productId}-${_e.variantId??"main"}`;return Qe.has(Vt)?!1:(Qe.add(Vt),!0)}))}catch(M){console.error("Failed to load inventory:",M)}},_r=async M=>{try{const je=await ie.get(`/direct-sales/customer-prices/${M}`);d(je.data)}catch(je){console.error("Failed to load customer prices:",je),d([])}},Is=async()=>{var M,je;if(we.trim()){Nt(!0);try{const fe=await zp.getOrderByNumber(we.trim());pr(fe);const Ce=i.find(Qe=>Qe.id===fe.customerId);Ce&&Q(Ce),it("invoice")}catch(fe){alert(((je=(M=fe.response)==null?void 0:M.data)==null?void 0:je.error)||"Invoice not found")}finally{Nt(!1)}}},Jr=(M,je)=>{const fe=je??1;fe<=0||fe>M.returnableQty||er(Ce=>{const Qe=Ce.find(Vt=>Vt.originalOrderItemId===M.id);if(Qe){const Vt=Math.min(Qe.quantity+fe,M.returnableQty);return Ce.map(Qt=>Qt.originalOrderItemId===M.id?{...Qt,quantity:Vt,lineTotal:Vt*Qt.unitPrice-Qt.discountAmount}:Qt)}const _e=M.unitPrice-M.discountAmount/M.quantity;return[...Ce,{originalOrderItemId:M.id,productId:M.productId,productName:M.productName,productSku:M.productSku,unitType:M.unitType,quantity:fe,unitPrice:_e,discountAmount:0,lineTotal:fe*_e,reason:"customer_changed_mind",condition:"resellable",inventoryAction:"back_to_stock",maxReturnableQty:M.returnableQty}]})},na=(M,je)=>{er(fe=>fe.map(Ce=>{if(Ce.originalOrderItemId===M){const Qe=Math.max(0,Math.min(je,Ce.maxReturnableQty));return Qe===0?Ce:{...Ce,quantity:Qe,lineTotal:Qe*Ce.unitPrice}}return Ce}).filter(Ce=>Ce.quantity>0))},Os=M=>{er(je=>je.filter(fe=>fe.originalOrderItemId!==M))},gr=(M,je)=>{er(fe=>fe.map(Ce=>Ce.originalOrderItemId===M?{...Ce,...je}:Ce))},V=(M,je="piece")=>{const{price:fe}=pe(M,je);Le(Ce=>Ce.find(_e=>_e.product.productId===M.productId&&_e.unitType===je)?Ce.map(_e=>_e.product.productId===M.productId&&_e.unitType===je?{..._e,quantity:_e.quantity+1}:_e):[...Ce,{product:M,quantity:1,unitType:je,unitPrice:fe,discount:0}])},J=(M,je,fe)=>{Le(Ce=>Ce.map(Qe=>{if(Qe.product.productId===M&&Qe.unitType===je){const _e=Math.max(0,Qe.quantity+fe);return{...Qe,quantity:_e}}return Qe}).filter(Qe=>Qe.quantity>0))},X=(M,je)=>{Le(fe=>fe.filter(Ce=>!(Ce.product.productId===M&&Ce.unitType===je)))},te=Zt.reduce((M,je)=>M+je.lineTotal,0),re=ue.reduce((M,je)=>M+(je.quantity*je.unitPrice-je.discount),0),ae=re-te,Ne=async()=>{var M,je;if(!(!Rt||!R)){if(Zt.length===0&&ue.length===0){alert("Please add items to return or exchange");return}ee(!0);try{const fe=await zp.processReturnExchange({originalOrderId:Rt.id,warehouseId:R,refundMethod:ae<0?Je:null,paymentMethod:ae>0?H:null,notes:le,returnItems:Zt.map(Ce=>({productId:Ce.productId,originalOrderItemId:Ce.originalOrderItemId,unitType:Ce.unitType,quantity:Ce.quantity,unitPrice:Ce.unitPrice,discountAmount:Ce.discountAmount,lineTotal:Ce.lineTotal,reason:Ce.reason,condition:Ce.condition,inventoryAction:Ce.inventoryAction})),exchangeItems:ue.map(Ce=>({productId:Ce.product.productId,unitType:Ce.unitType,quantity:Ce.quantity,unitPrice:Ce.unitPrice,discountAmount:Ce.discount,lineTotal:Ce.quantity*Ce.unitPrice-Ce.discount}))});Ie({...fe,returnItems:[...Zt],exchangeItems:[...ue]}),xe(!0),er([]),Le([]),pr(null),et(""),Me(""),Or()}catch(fe){alert(((je=(M=fe.response)==null?void 0:M.data)==null?void 0:je.error)||"Failed to process return/exchange")}finally{ee(!1)}}},Be=()=>{pr(null),er([]),Le([]),et(""),Me(""),it("catalog")},Se=M=>{var Ce,Qe;const je=window.open("","_blank","width=400,height=700");if(!je){alert("Please allow popups to print invoice");return}const fe=`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Return/Exchange Invoice - ${M.transactionNumber}</title>
        <style>
          * { margin: 0; padding: 0; box-sizing: border-box; }
          body { font-family: 'Courier New', monospace; font-size: 12px; padding: 10px; max-width: 300px; margin: 0 auto; }
          .header { text-align: center; border-bottom: 1px dashed #000; padding-bottom: 10px; margin-bottom: 10px; }
          .header h1 { font-size: 14px; margin-bottom: 5px; }
          .header h2 { font-size: 16px; margin-bottom: 5px; }
          .header p { font-size: 10px; color: #666; }
          .info { margin-bottom: 10px; }
          .info-row { display: flex; justify-content: space-between; margin-bottom: 3px; }
          .info-row .label { color: #666; }
          .divider { border-top: 1px dashed #000; margin: 10px 0; }
          .section-title { font-weight: bold; margin-bottom: 5px; padding: 3px 0; background: #f0f0f0; text-align: center; }
          .items { margin-bottom: 10px; }
          .item { margin-bottom: 5px; padding-left: 5px; }
          .item-name { font-weight: bold; }
          .item-details { display: flex; justify-content: space-between; }
          .return-item { color: #c00; }
          .exchange-item { color: #080; }
          .totals { border-top: 1px dashed #000; padding-top: 10px; }
          .total-row { display: flex; justify-content: space-between; margin-bottom: 3px; }
          .total-row.grand { font-weight: bold; font-size: 14px; border-top: 1px solid #000; padding-top: 5px; margin-top: 5px; }
          .refund { background: #fff3e0; padding: 5px; margin-top: 5px; text-align: center; }
          .payment { background: #e8f5e9; padding: 5px; margin-top: 5px; text-align: center; }
          .footer { text-align: center; margin-top: 15px; padding-top: 10px; border-top: 1px dashed #000; font-size: 10px; color: #666; }
          @media print { body { padding: 0; } @page { margin: 5mm; } }
        </style>
      </head>
      <body>
        <div class="header">
          <h1>RETURN / EXCHANGE</h1>
          <h2>${M.transactionNumber}</h2>
          <p>Date: ${new Date().toLocaleString()}</p>
        </div>
        
        <div class="info">
          <div class="info-row">
            <span class="label">Customer:</span>
            <span>${M.customerName}</span>
          </div>
          <div class="info-row">
            <span class="label">Status:</span>
            <span>${M.status}</span>
          </div>
        </div>
        
        <div class="divider"></div>
        
        ${((Ce=M.returnItems)==null?void 0:Ce.length)>0?`
        <div class="section-title">RETURNED ITEMS</div>
        <div class="items">
          ${M.returnItems.map(_e=>`
            <div class="item return-item">
              <div class="item-name">${_e.productName}</div>
              <div class="item-details">
                <span>${_e.quantity} x ${_e.unitPrice.toFixed(3)}</span>
                <span>-${_e.lineTotal.toFixed(3)}</span>
              </div>
            </div>
          `).join("")}
        </div>
        `:""}
        
        ${((Qe=M.exchangeItems)==null?void 0:Qe.length)>0?`
        <div class="section-title">EXCHANGE ITEMS</div>
        <div class="items">
          ${M.exchangeItems.map(_e=>`
            <div class="item exchange-item">
              <div class="item-name">${_e.product.productName}</div>
              <div class="item-details">
                <span>${_e.quantity} x ${_e.unitPrice.toFixed(3)}</span>
                <span>+${(_e.quantity*_e.unitPrice-_e.discount).toFixed(3)}</span>
              </div>
            </div>
          `).join("")}
        </div>
        `:""}
        
        <div class="totals">
          <div class="total-row" style="color: #c00;">
            <span>Return Total:</span>
            <span>-${M.returnTotal.toFixed(3)}</span>
          </div>
          <div class="total-row" style="color: #080;">
            <span>Exchange Total:</span>
            <span>+${M.exchangeTotal.toFixed(3)}</span>
          </div>
          <div class="total-row grand">
            <span>NET AMOUNT:</span>
            <span>${M.netAmount===0?"0.000":M.netAmount<0?"-"+Math.abs(M.netAmount).toFixed(3):"+"+M.netAmount.toFixed(3)}</span>
          </div>
        </div>
        
        ${M.refundDue>0?`
        <div class="refund">
          <strong>REFUND DUE: ${M.refundDue.toFixed(3)}</strong>
        </div>
        `:""}
        
        ${M.paymentDue>0?`
        <div class="payment">
          <strong>PAYMENT COLLECTED: ${M.paymentDue.toFixed(3)}</strong>
        </div>
        `:""}
        
        <div class="footer">
          <p>${M.message}</p>
          <p>Thank you!</p>
        </div>
        
        <script>
          window.onload = function() { window.print(); }
        <\/script>
      </body>
      </html>
    `;je.document.write(fe),je.document.close()},Pe=async()=>{var M,je;if(de.trim()){Fe(!0);try{const fe=await _i.getByNumber(de.trim()),Ce=i.find(_e=>_e.id===fe.customerId);Ce&&Q(Ce);const Qe=[];for(const _e of fe.items){let Vt=t.find(Qt=>Qt.productId===_e.productId);Vt||(Vt={productId:_e.productId,productName:_e.productName,sku:_e.productSku,barcode:null,boxBarcode:null,warehouseId:R||0,warehouseName:"",quantity:999,variantId:null,variantName:null,baseUnit:"piece",secondUnit:null,unitsPerSecond:1,retailPrice:_e.unitPrice,wholesalePrice:_e.unitPrice,boxRetailPrice:_e.unitPrice,boxWholesalePrice:_e.unitPrice,costPrice:0,boxCostPrice:0,imageUrl:null,lowStockAlert:10,currency:"USD"}),Qe.push({product:Vt,variantId:null,variantName:null,quantity:_e.quantity,unitType:"piece",unitPrice:_e.unitPrice,discount:_e.discountAmount||0})}ne(Qe),$e(fe.id),B(`Quote: ${fe.quoteNumber}${fe.notes?` - ${fe.notes}`:""}`)}catch(fe){alert(((je=(M=fe.response)==null?void 0:M.data)==null?void 0:je.error)||"Failed to load quote")}finally{Fe(!1)}}},pe=(M,je)=>{var Qe;const fe=u.find(_e=>_e.productId===M.productId),Ce=((Qe=W==null?void 0:W.customerType)==null?void 0:Qe.toLowerCase())==="wholesale";return je==="box"?fe!=null&&fe.hasBoxSpecialPrice&&fe.boxSpecialPrice!=null?{price:fe.boxSpecialPrice,isSpecial:!0}:{price:Ce?M.boxWholesalePrice:M.boxRetailPrice,isSpecial:!1}:fe!=null&&fe.hasSpecialPrice&&fe.specialPrice!=null?{price:fe.specialPrice,isSpecial:!0}:{price:Ce?M.wholesalePrice:M.retailPrice,isSpecial:!1}},qe=M=>{var Ce;M.preventDefault();const je=v.trim();if(!je)return;const fe=t.find(Qe=>{var _e,Vt;return((_e=Qe.barcode)==null?void 0:_e.trim().toLowerCase())===je.toLowerCase()||((Vt=Qe.boxBarcode)==null?void 0:Vt.trim().toLowerCase())===je.toLowerCase()});if(fe){const Qe=((Ce=fe.boxBarcode)==null?void 0:Ce.trim().toLowerCase())===je.toLowerCase();lt(fe,Qe?"box":"piece")}else{const Qe=t.find(_e=>_e.sku.trim().toLowerCase()===je.toLowerCase());Qe&&lt(Qe,"piece")}j("")},lt=(M,je="piece",fe=null,Ce=null)=>{const{price:Qe}=pe(M,je);ne(_e=>_e.find(Qt=>Qt.product.productId===M.productId&&Qt.unitType===je&&Qt.variantId===fe)?_e.map(Qt=>Qt.product.productId===M.productId&&Qt.unitType===je&&Qt.variantId===fe?{...Qt,quantity:Qt.quantity+1}:Qt):[..._e,{product:M,variantId:fe,variantName:Ce,quantity:1,unitType:je,unitPrice:Qe,discount:0}])},ft=(M,je,fe,Ce)=>{ne(Qe=>Qe.map(_e=>{if(_e.product.productId===M&&_e.unitType===je&&_e.variantId===fe){const Vt=Math.max(0,_e.quantity+Ce);return{..._e,quantity:Vt}}return _e}).filter(_e=>_e.quantity>0))},Ze=(M,je,fe,Ce)=>{if(Ce<=0){dt(M,je,fe);return}ne(Qe=>Qe.map(_e=>_e.product.productId===M&&_e.unitType===je&&_e.variantId===fe?{..._e,quantity:Ce}:_e))},dt=(M,je,fe)=>{ne(Ce=>Ce.filter(Qe=>!(Qe.product.productId===M&&Qe.unitType===je&&Qe.variantId===fe)))},Ot=()=>{if(he===null)return;const M=parseFloat(z)||0;ne(je=>je.map((fe,Ce)=>Ce===he?{...fe,discount:M}:fe)),ye(null),A("")},Y=I.reduce((M,je)=>M+je.quantity*je.unitPrice,0),De=I.reduce((M,je)=>M+je.discount,0),at=Y-De,st=I.reduce((M,je)=>{const fe=je.product.currency||"USD";M[fe]||(M[fe]={subtotal:0,discount:0,total:0,items:0});const Ce=je.quantity*je.unitPrice-je.discount;return M[fe].subtotal+=je.quantity*je.unitPrice,M[fe].discount+=je.discount,M[fe].total+=Ce,M[fe].items+=1,M},{}),Mt=Object.keys(st).length>1,Lt=h.find(M=>M.isBase),pt=(Lt==null?void 0:Lt.code)||"USD",Ut=Object.entries(st).reduce((M,[je,fe])=>{const Ce=h.find(_e=>_e.code===je),Qe=(Ce==null?void 0:Ce.exchangeRate)||1;return M+fe.total/Qe},0),[qt,Ca]=m.useState(!1),nr=async()=>{var M,je;if(!(!W||I.length===0)){Ca(!0);try{const fe={customerId:W.id,validUntil:new Date(Date.now()+2592e6).toISOString(),discountAmount:De,taxAmount:0,notes:G||"Quote from Direct Sales",terms:"",items:I.map(Qe=>({productId:Qe.product.productId,quantity:Qe.quantity,unitPrice:Qe.unitPrice,discountPercent:0}))},Ce=await _i.create(fe);alert(`Quote created successfully! Quote #: ${Ce.quoteNumber}`),ne([]),Q(null),B("")}catch(fe){alert(((je=(M=fe.response)==null?void 0:M.data)==null?void 0:je.error)||"Failed to create quote")}finally{Ca(!1)}}},Ea=async()=>{var M,je;if(!(I.length===0||!R)){L(!0);try{const fe=Mt?Ut:at,Ce=Object.values(At).some(U=>U.selected&&parseFloat(U.amount)>0);let Qe,_e=[];H==="credit"?Qe=0:Ce?(Qe=Object.entries(At).filter(([,U])=>U.selected&&parseFloat(U.amount)>0).reduce((U,[Ke,rt])=>{const _t=h.find(Xt=>Xt.code===Ke),Fr=(_t==null?void 0:_t.exchangeRate)||1;return U+parseFloat(rt.amount)/Fr},0),_e=Object.entries(At).filter(([,U])=>U.selected&&parseFloat(U.amount)>0).map(([U,Ke])=>({currency:U,amount:parseFloat(Ke.amount)}))):H==="cash"?Qe=fe:Qe=parseFloat(q)||0;const Vt=await ie.post("/direct-sales",{customerId:(W==null?void 0:W.id)||null,warehouseId:R,notes:G||"Direct Sale",paymentType:H,paidAmount:Qe,discountAmount:De,taxAmount:0,paymentCurrenciesJson:_e.length>0?JSON.stringify(_e):JSON.stringify(Object.entries(st).map(([U,Ke])=>({currency:U,amount:Ke.total}))),exchangeRateSnapshotJson:JSON.stringify(h.reduce((U,Ke)=>(U[Ke.code]=Ke.exchangeRate,U),{})),items:I.map(U=>({productId:U.product.productId,variantId:U.variantId||null,unitType:U.unitType,quantity:U.quantity,unitPrice:U.unitPrice,discountAmount:U.discount,currency:U.product.currency||"USD"}))});if(ct&&((M=Vt.data)!=null&&M.orderId))try{await _i.convert(ct,Vt.data.orderId)}catch(U){console.error("Failed to mark quote as converted:",U)}const Qt=_e.length>0?_e:Object.entries(st).map(([U,Ke])=>({currency:U,amount:Ke.total}));F({...Vt.data,totalAmount:fe,paymentCurrencies:JSON.stringify(Qt),items:I.map(U=>({productName:U.product.productName+(U.variantName?` (${U.variantName})`:""),quantity:U.quantity,unitType:U.unitType==="box"?U.product.secondUnit:U.product.baseUnit,unitPrice:U.unitPrice,currency:U.product.currency||"USD",lineTotal:U.quantity*U.unitPrice-U.discount,discount:U.discount}))}),_(!0),ne([]),Q(null),B(""),ge(""),K("cash"),Er({}),D(""),$e(null),Or()}catch(fe){alert(((je=fe.response)==null?void 0:je.data)||"Failed to create order")}finally{L(!1)}}},Dr=()=>{var Rr,Yt,gt,tr;if(!Z)return;const M=Z.paymentCurrencies?typeof Z.paymentCurrencies=="string"?JSON.parse(Z.paymentCurrencies):Z.paymentCurrencies:null,je=M&&M.length>1;let fe="";(Z.items||[]).forEach(Wr=>{var kl,eu;const gn=Wr.discount>0?`<tr><td colspan="3" style="padding-left:10px;font-size:11pt">Disc: -${Wr.currency} ${Wr.discount.toFixed(3)}</td></tr>`:"";fe+=`
        <tr>
          <td style="padding:4px 0;font-weight:600">${Wr.productName}</td>
          <td style="padding:4px 0;text-align:center;width:40px">${Wr.quantity}</td>
          <td style="padding:4px 0;text-align:right;width:70px">${((kl=Wr.lineTotal)==null?void 0:kl.toFixed(3))||"0.000"}</td>
        </tr>
        ${Wr.unitType?`<tr><td colspan="3" style="padding-left:10px;font-size:11pt">${Wr.unitType} @ ${(eu=Wr.unitPrice)==null?void 0:eu.toFixed(3)}</td></tr>`:""}
        ${gn}`});let Ce="";je?M.forEach(Wr=>{Ce+=`<tr><td>Paid (${Wr.currency}):</td><td colspan="2" style="text-align:right">${Wr.currency} ${Number(Wr.amount).toFixed(3)}</td></tr>`}):Ce=`<tr><td>Paid:</td><td colspan="2" style="text-align:right">${((Rr=Z.paidAmount)==null?void 0:Rr.toFixed(3))||"0.000"}</td></tr>`;const Qe=Z.changeAmount>0?`<tr><td>Change:</td><td colspan="2" style="text-align:right">${Z.changeAmount.toFixed(3)}</td></tr>`:"",_e=or.showSecondaryPrice?`<tr style="color:#333"><td>Total (2nd):</td><td colspan="2" style="text-align:right">${(Z.totalAmount*or.exchangeRate).toFixed(0).replace(/\B(?=(\d{3})+(?!\d))/g,",")}</td></tr>`:"",Vt=new Date().toLocaleDateString(),Qt=new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),U=`<!DOCTYPE html><html><head><meta charset="utf-8"/>
<style>
  * { margin:0; padding:0; box-sizing:border-box; -webkit-print-color-adjust:exact; print-color-adjust:exact; }
  @page { size: 80mm auto; margin: 2mm; }
  @media print {
    html, body { width: 80mm; }
    body { -webkit-print-color-adjust: exact; }
  }
  html, body { width:80mm; margin:0; padding:0; }
  body { 
    font-family: 'Arial Black', 'Arial Bold', 'Helvetica Bold', sans-serif; 
    font-size: 11pt; 
    line-height: 1.4; 
    color: #000; 
    background: #fff; 
    padding: 3mm;
    font-weight: 900;
    -webkit-font-smoothing: none;
    text-rendering: geometricPrecision;
  }
  table { width: 100%; border-collapse: collapse; }
  td { vertical-align: top; font-weight: 700; }
  .divider { border: none; border-top: 2px dashed #000; margin: 6px 0; }
  .double { border-top: 3px solid #000; margin: 8px 0; }
  .header { text-align: center; margin-bottom: 8px; }
  .header h1 { font-size: 20pt; font-weight: 900; margin: 0; letter-spacing: 1px; text-transform: uppercase; }
  .header p { font-size: 11pt; margin: 3px 0; font-weight: 700; }
  .info-row td { font-size: 11pt; padding: 3px 0; font-weight: 700; }
  .items-table td { padding: 5px 0; font-size: 11pt; border-bottom: 1px solid #000; font-weight: 700; }
  .items-table th { padding: 5px 0; font-size: 11pt; font-weight: 900; border-bottom: 2px solid #000; text-align: left; }
  .totals td { padding: 4px 0; font-size: 12pt; font-weight: 700; }
  .grand-total td { padding: 8px 0; font-size: 18pt; font-weight: 900; }
  .footer { text-align: center; padding: 10px 0; font-size: 12pt; font-weight: 700; }
</style>
</head><body>

<div class="header">
  <h1>${or.name||"RECEIPT"}</h1>
  ${or.phone?`<p>Tel: ${or.phone}</p>`:""}
  ${or.address?`<p>${or.address}</p>`:""}
</div>

<hr class="divider"/>

<table>
  <tr class="info-row"><td style="width:40%">Order #:</td><td style="font-weight:700">${Z.orderNumber}</td></tr>
  <tr class="info-row"><td>Date:</td><td>${Vt} ${Qt}</td></tr>
  <tr class="info-row"><td>Payment:</td><td>${Z.paymentType?Z.paymentType.charAt(0).toUpperCase()+Z.paymentType.slice(1):"Cash"}</td></tr>
  ${Z.customerName?`<tr class="info-row"><td>Customer:</td><td>${Z.customerName}</td></tr>`:""}
</table>

<hr class="divider"/>

<table class="items-table">
  <tr><th style="width:auto">Item</th><th style="width:40px;text-align:center">Qty</th><th style="width:70px;text-align:right">Total</th></tr>
  ${fe||'<tr><td colspan="3" style="text-align:center;padding:10px">No items</td></tr>'}
</table>

<hr class="divider"/>

<table class="totals">
  <tr><td>Subtotal:</td><td colspan="2" style="text-align:right">${((Yt=Z.totalAmount)==null?void 0:Yt.toFixed(3))||"0.000"}</td></tr>
  ${Ce}
  ${Qe}
</table>

<hr class="double"/>

<table class="grand-total">
  <tr><td>TOTAL:</td><td style="text-align:right">${((gt=Z.totalAmount)==null?void 0:gt.toFixed(3))||"0.000"}</td></tr>
  ${_e}
</table>

<hr class="double"/>

<div class="footer">
  <div style="font-weight:700">Thank you!</div>
  <div style="font-size:10pt;margin-top:4px">${new Date().toLocaleString()}</div>
</div>

</body></html>`,Ke=document.getElementById("receipt-print-frame");Ke&&Ke.remove();const rt=document.createElement("iframe");rt.id="receipt-print-frame",rt.style.cssText="position:fixed;top:-10000px;left:-10000px;width:0;height:0;border:none;",document.body.appendChild(rt);const _t=rt.contentDocument||((tr=rt.contentWindow)==null?void 0:tr.document);if(!_t){alert("Could not create print frame");return}_t.open(),_t.write(U),_t.close();let Fr=!1;const Xt=()=>{var Wr;Fr||(Fr=!0,(Wr=rt.contentWindow)==null||Wr.print(),setTimeout(()=>rt.remove(),1e3))};rt.onload=()=>setTimeout(Xt,100),setTimeout(Xt,500)},Ds=s.filter(M=>{var fe,Ce;const je=M.productName.toLowerCase().includes(g.toLowerCase())||(M.sku||"").toLowerCase().includes(g.toLowerCase())||((fe=M.barcode)==null?void 0:fe.includes(g))||((Ce=M.variantName)==null?void 0:Ce.toLowerCase().includes(g.toLowerCase()));if(b){const Qe=M.quantity<=(M.lowStockAlert||10);return je&&Qe}return je}),Ue=i.filter(M=>{var je,fe;return M.name.toLowerCase().includes(O.toLowerCase())||((je=M.shopName)==null?void 0:je.toLowerCase().includes(O.toLowerCase()))||((fe=M.phone)==null?void 0:fe.includes(O))});return x?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):a.jsxs("div",{className:"h-[calc(100vh-4rem)] flex",children:[a.jsxs("div",{className:"flex-1 flex flex-col border-r",children:[a.jsxs("div",{className:"bg-white border-b px-4 py-3 flex items-center gap-4",children:[a.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Direct Sales"}),a.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[a.jsxs("button",{onClick:()=>{Bt("sale"),Be()},className:`px-4 py-1.5 rounded-md text-sm font-medium transition-colors ${We==="sale"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[a.jsx(ix,{size:16,className:"inline mr-1.5"}),"Sale"]}),a.jsxs("button",{onClick:()=>Bt("return"),className:`px-4 py-1.5 rounded-md text-sm font-medium transition-colors ${We==="return"?"bg-white text-orange-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[a.jsx(ao,{size:16,className:"inline mr-1.5"}),"Return / Exchange"]})]}),a.jsxs("select",{value:R||"",onChange:M=>C(Number(M.target.value)),className:"border rounded-lg px-3 py-2 text-sm",children:[a.jsx("option",{value:"",children:"Select Warehouse"}),o.map(M=>a.jsx("option",{value:M.id,children:M.name},M.id))]})]}),We==="return"&&a.jsxs("div",{className:"bg-orange-50 border-b px-4 py-2 flex items-center gap-3",children:[a.jsx(Yo,{size:18,className:"text-orange-600"}),a.jsx("span",{className:"text-sm font-medium text-orange-700",children:"Load Invoice:"}),a.jsx("input",{type:"text",value:we,onChange:M=>et(M.target.value),onKeyDown:M=>M.key==="Enter"&&Is(),placeholder:"Enter invoice number (e.g., DS-20241220-0001)",className:"flex-1 max-w-xs px-3 py-1.5 border rounded-lg text-sm"}),a.jsx("button",{onClick:Is,disabled:Ge||!we.trim(),className:"px-4 py-1.5 bg-orange-600 text-white text-sm rounded-lg hover:bg-orange-700 disabled:opacity-50",children:Ge?"Loading...":"Load"}),Rt&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("span",{className:"text-xs text-green-600 bg-green-100 px-2 py-1 rounded",children:["Invoice loaded: ",Rt.orderNumber]}),a.jsx("button",{onClick:Be,className:"text-xs text-gray-500 hover:text-gray-700",children:a.jsx(yt,{size:14})})]})]}),We==="return"&&Rt&&a.jsx("div",{className:"bg-gray-50 border-b px-4 py-3",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("span",{className:"font-semibold text-gray-900",children:Rt.orderNumber}),a.jsx("span",{className:"text-sm text-gray-500",children:new Date(Rt.orderDate).toLocaleDateString()}),a.jsx("span",{className:"text-xs bg-blue-100 text-blue-700 px-2 py-0.5 rounded",children:Rt.paymentStatus})]}),a.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:["Customer: ",a.jsx("span",{className:"font-medium",children:Rt.customerName}),Rt.cashierName&&a.jsxs("span",{className:"ml-3",children:["Cashier: ",Rt.cashierName]})]})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("div",{className:"text-lg font-bold text-gray-900",children:Rt.totalAmount.toFixed(3)}),a.jsxs("div",{className:"text-xs text-gray-500",children:["Paid: ",Rt.paidAmount.toFixed(3),Rt.discountAmount>0&&` | Discount: ${Rt.discountAmount.toFixed(3)}`]})]})]})}),We==="sale"&&a.jsxs("div",{className:"bg-blue-50 border-b px-4 py-2 flex items-center gap-3",children:[a.jsx(Br,{size:18,className:"text-blue-600"}),a.jsx("span",{className:"text-sm font-medium text-blue-700",children:"Load Quote:"}),a.jsx("input",{type:"text",value:de,onChange:M=>D(M.target.value),onKeyDown:M=>M.key==="Enter"&&Pe(),placeholder:"Enter quote number (e.g., QT-20241219-0001)",className:"flex-1 max-w-xs px-3 py-1.5 border rounded-lg text-sm"}),a.jsx("button",{onClick:Pe,disabled:ze||!de.trim(),className:"px-4 py-1.5 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700 disabled:opacity-50",children:ze?"Loading...":"Load"}),ct&&a.jsx("span",{className:"text-xs text-green-600 bg-green-100 px-2 py-1 rounded",children:"Quote loaded"})]}),We==="return"&&Rt&&a.jsxs("div",{className:"bg-white border-b px-4 py-2 flex gap-2",children:[a.jsxs("button",{onClick:()=>it("invoice"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${Ee==="invoice"?"bg-orange-100 text-orange-700":"text-gray-600 hover:bg-gray-100"}`,children:[a.jsx(s4,{size:16,className:"inline mr-1.5"}),"Invoice Items (",Rt.items.length,")"]}),a.jsxs("button",{onClick:()=>it("catalog"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${Ee==="catalog"?"bg-blue-100 text-blue-700":"text-gray-600 hover:bg-gray-100"}`,children:[a.jsx(Tr,{size:16,className:"inline mr-1.5"}),"All Products"]})]}),a.jsxs("div",{className:"bg-white border-b px-4 py-3 flex gap-4",children:[a.jsx("form",{onSubmit:qe,className:"w-48",children:a.jsxs("div",{className:"relative",children:[a.jsx(Oo,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),a.jsx("input",{ref:e,type:"text",value:v,onChange:M=>j(M.target.value),placeholder:"Scan barcode...",className:"w-full pl-10 pr-4 py-2 border rounded-lg text-sm"})]})}),a.jsxs("div",{className:"flex-1 relative",children:[a.jsx(Na,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),a.jsx("input",{type:"text",value:g,onChange:M=>y(M.target.value),placeholder:"Search products...",className:"w-full pl-10 pr-4 py-2 border rounded-lg text-sm"})]}),a.jsxs("button",{onClick:()=>w(!b),className:`flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition-colors whitespace-nowrap ${b?"bg-orange-100 text-orange-700 border border-orange-300":"bg-gray-100 text-gray-600 border border-gray-200 hover:bg-gray-200"}`,children:[a.jsx(c0,{size:16}),"Low Stock"]})]}),a.jsxs("div",{className:"flex-1 overflow-auto bg-gray-100 p-4",children:[We==="return"&&Rt&&Ee==="invoice"&&a.jsx("div",{className:"space-y-2",children:Rt.items.map(M=>{const je=Zt.find(Ce=>Ce.originalOrderItemId===M.id),fe=M.unitPrice-M.discountAmount/M.quantity;return a.jsxs("div",{className:`bg-white rounded-lg p-4 shadow-sm border-2 transition-colors ${je?"border-orange-300 bg-orange-50":"border-transparent hover:border-gray-200"}`,draggable:!0,onDragStart:Ce=>{Ce.dataTransfer.setData("invoiceItem",JSON.stringify(M)),ht(null)},children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(dW,{size:16,className:"text-gray-400 cursor-grab"}),a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-gray-900",children:M.productName}),a.jsxs("div",{className:"text-sm text-gray-500",children:[M.productSku,"  ",M.unitType]})]})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("div",{className:"font-medium",children:[fe.toFixed(3),"  ",M.quantity]}),a.jsxs("div",{className:"text-sm text-gray-500",children:["Total: ",M.lineTotal.toFixed(3)]})]})]}),a.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[a.jsxs("span",{className:"text-gray-600",children:["Sold: ",a.jsx("span",{className:"font-medium",children:M.quantity})]}),M.alreadyReturnedQty>0&&a.jsxs("span",{className:"text-orange-600",children:["Returned: ",a.jsx("span",{className:"font-medium",children:M.alreadyReturnedQty})]}),a.jsxs("span",{className:`${M.returnableQty>0?"text-green-600":"text-red-500"}`,children:["Returnable: ",a.jsx("span",{className:"font-medium",children:M.returnableQty})]})]}),M.returnableQty>0&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>Jr(M,1),className:"px-3 py-1 text-sm bg-orange-100 text-orange-700 rounded hover:bg-orange-200",children:"+ Return 1"}),M.returnableQty>1&&a.jsxs("button",{onClick:()=>Jr(M,M.returnableQty),className:"px-3 py-1 text-sm bg-orange-600 text-white rounded hover:bg-orange-700",children:["Return All (",M.returnableQty,")"]})]}),M.returnableQty===0&&a.jsx("span",{className:"text-xs text-red-500 bg-red-50 px-2 py-1 rounded",children:"Fully Returned"})]}),je&&a.jsxs("div",{className:"mt-2 text-sm text-orange-600 flex items-center gap-1",children:[a.jsx(Jt,{size:14}),je.quantity," in return basket"]})]},M.id)})}),(We==="sale"||We==="return"&&Ee==="catalog")&&a.jsx(a.Fragment,{children:R?Ds.length===0?a.jsxs("div",{className:"text-center py-12 text-gray-500",children:[a.jsx(Tr,{size:48,className:"mx-auto mb-4 opacity-50"}),a.jsx("p",{children:"No products found"})]}):a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-3",children:Ds.map(M=>{const je=pe(M,"piece"),fe=M.secondUnit?pe(M,"box"):null;return a.jsxs("div",{className:"bg-white rounded-xl shadow-sm hover:shadow-md transition-shadow overflow-hidden flex flex-col",draggable:We==="return",onDragStart:Ce=>{We==="return"&&Ce.dataTransfer.setData("catalogProduct",JSON.stringify(M))},children:[a.jsxs("div",{className:"relative h-28 bg-gradient-to-br from-gray-100 to-gray-200 flex items-center justify-center",children:[M.imageUrl?a.jsx("img",{src:M.imageUrl,alt:M.productName,className:"w-full h-full object-cover"}):a.jsx(Tr,{size:40,className:"text-gray-300"}),a.jsx("span",{className:`absolute top-2 right-2 px-2 py-0.5 rounded-full text-xs font-medium ${M.quantity<10?"bg-red-500 text-white":"bg-green-500 text-white"}`,children:M.quantity}),je.isSpecial&&a.jsx("span",{className:"absolute top-2 left-2 px-2 py-0.5 rounded-full text-xs font-medium bg-amber-500 text-white",children:"Special"})]}),a.jsxs("div",{className:"p-3 flex-1 flex flex-col",children:[a.jsx("h3",{className:"font-medium text-sm text-gray-900 line-clamp-2 mb-1",children:M.productName}),M.sku&&a.jsx("p",{className:"text-xs text-gray-500 mb-1",children:M.sku}),a.jsxs("div",{className:"flex flex-wrap gap-1 mb-1",children:[M.color&&a.jsx("span",{className:"px-1.5 py-0.5 bg-pink-50 text-pink-600 rounded text-[10px]",children:M.color}),M.size&&a.jsx("span",{className:"px-1.5 py-0.5 bg-blue-50 text-blue-600 rounded text-[10px]",children:M.size}),M.weight&&a.jsxs("span",{className:"px-1.5 py-0.5 bg-gray-100 text-gray-600 rounded text-[10px]",children:[M.weight,"kg"]}),(M.length||M.height)&&a.jsxs("span",{className:"px-1.5 py-0.5 bg-gray-100 text-gray-600 rounded text-[10px]",children:[M.length&&`${M.length}cm`,M.length&&M.height&&"  ",M.height&&`${M.height}cm`]})]}),a.jsxs("div",{className:"mt-auto",children:[a.jsxs("p",{className:`text-lg font-bold ${je.isSpecial?"text-green-600":"text-blue-600"}`,children:[M.currency," ",je.price.toFixed(3)]}),or.showSecondaryPrice&&a.jsx("p",{className:"text-xs text-orange-500 font-medium",children:(je.price*or.exchangeRate).toFixed(0).replace(/\B(?=(\d{3})+(?!\d))/g,",")}),a.jsxs("p",{className:"text-xs text-gray-400",children:["per ",M.baseUnit]}),fe&&a.jsxs("p",{className:`text-xs mt-1 ${fe.isSpecial?"text-green-600":"text-purple-600"}`,children:[M.currency," ",fe.price.toFixed(3)," / ",M.secondUnit,or.showSecondaryPrice&&a.jsxs("span",{className:"text-orange-500 ml-1",children:["(",(fe.price*or.exchangeRate).toFixed(0).replace(/\B(?=(\d{3})+(?!\d))/g,","),")"]})]})]})]}),a.jsx("div",{className:"p-2 bg-gray-50 border-t flex gap-1",children:We==="sale"?a.jsxs(a.Fragment,{children:[a.jsxs("button",{onClick:()=>lt(M,"piece",M.variantId,M.variantName),disabled:M.quantity===0,className:"flex-1 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:["+ ",M.baseUnit]}),M.secondUnit&&a.jsxs("button",{onClick:()=>lt(M,"box",M.variantId,M.variantName),disabled:M.quantity===0,className:"flex-1 py-2 bg-purple-600 text-white rounded-lg text-sm font-medium hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:`1 ${M.baseUnit} = ${M.unitsPerSecond} ${M.secondUnit}s`,children:["+ ",M.secondUnit]})]}):a.jsxs(a.Fragment,{children:[a.jsxs("button",{onClick:()=>V(M,"piece"),disabled:M.quantity===0,className:"flex-1 py-2 bg-green-600 text-white rounded-lg text-sm font-medium hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:["+ Add ",M.baseUnit]}),M.secondUnit&&a.jsxs("button",{onClick:()=>V(M,"box"),disabled:M.quantity===0,className:"flex-1 py-2 bg-teal-600 text-white rounded-lg text-sm font-medium hover:bg-teal-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:["+ Add ",M.secondUnit]})]})})]},`${M.productId}-${M.variantId??"main"}-${M.warehouseId}`)})}):a.jsxs("div",{className:"text-center py-12 text-gray-500",children:[a.jsx(gl,{size:48,className:"mx-auto mb-4 opacity-50"}),a.jsx("p",{children:"Please select a warehouse"})]})}),We==="return"&&!Rt&&a.jsxs("div",{className:"text-center py-12 text-gray-500",children:[a.jsx(Yo,{size:48,className:"mx-auto mb-4 opacity-50"}),a.jsx("p",{className:"text-lg font-medium",children:"Load an Invoice to Begin"}),a.jsx("p",{className:"text-sm mt-2",children:"Enter an invoice number above to start the return/exchange process"})]})]})]}),a.jsxs("div",{className:"w-96 flex flex-col bg-white",children:[a.jsx("div",{className:"p-4 border-b",children:a.jsxs("button",{onClick:()=>N(!0),disabled:We==="return"&&Rt!==null,className:`w-full flex items-center gap-2 px-4 py-3 rounded-lg border ${W?"bg-blue-50 border-blue-300 text-blue-700":"bg-gray-50 hover:bg-gray-100"} ${We==="return"&&Rt?"opacity-75 cursor-not-allowed":""}`,children:[a.jsx(Sy,{size:18}),a.jsx("span",{className:"flex-1 text-left",children:W?a.jsxs("div",{children:[a.jsx("div",{className:"font-medium",children:W.name}),W.debtBalance>0&&a.jsxs("div",{className:"text-xs text-red-600",children:["Owes: $",W.debtBalance.toFixed(3)]})]}):"Select Customer"})]})}),We==="sale"&&a.jsx(a.Fragment,{children:a.jsx("div",{className:"flex-1 overflow-auto p-4",children:I.length===0?a.jsxs("div",{className:"text-center py-8 text-gray-400",children:[a.jsx("p",{children:"Cart is empty"}),a.jsx("p",{className:"text-sm mt-1",children:"Add products from the left"})]}):a.jsx("div",{className:"space-y-3",children:I.map((M,je)=>a.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[a.jsxs("div",{className:"flex justify-between items-start mb-2",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"font-medium text-sm",children:[M.product.productName,M.variantName&&a.jsx("span",{className:"ml-1 px-1.5 py-0.5 bg-purple-100 text-purple-700 rounded text-[10px] font-medium",children:M.variantName})]}),a.jsxs("div",{className:"text-xs text-gray-500",children:[M.unitType==="box"?M.product.secondUnit:M.product.baseUnit,"  ",M.product.currency," ",M.unitPrice.toFixed(3),or.showSecondaryPrice&&a.jsxs("span",{className:"text-orange-500 ml-1",children:["(",(M.unitPrice*or.exchangeRate).toFixed(0).replace(/\B(?=(\d{3})+(?!\d))/g,","),")"]})]})]}),a.jsx("button",{onClick:()=>dt(M.product.productId,M.unitType,M.variantId),className:"p-1 text-gray-400 hover:text-red-600",children:a.jsx(xr,{size:16})})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>ft(M.product.productId,M.unitType,M.variantId,-1),className:"p-1 rounded bg-white border hover:bg-gray-100",children:a.jsx(Cb,{size:14})}),a.jsx("input",{type:"number",min:"1",value:M.quantity,onChange:fe=>Ze(M.product.productId,M.unitType,M.variantId,parseInt(fe.target.value)||0),className:"w-12 text-center font-medium border rounded px-1 py-0.5"}),a.jsx("button",{onClick:()=>ft(M.product.productId,M.unitType,M.variantId,1),className:"p-1 rounded bg-white border hover:bg-gray-100",children:a.jsx(hr,{size:14})})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("div",{className:"font-medium",children:[M.product.currency," ",(M.quantity*M.unitPrice-M.discount).toFixed(3)]}),or.showSecondaryPrice&&a.jsx("div",{className:"text-xs text-orange-500",children:((M.quantity*M.unitPrice-M.discount)*or.exchangeRate).toFixed(0).replace(/\B(?=(\d{3})+(?!\d))/g,",")}),M.discount>0&&a.jsxs("div",{className:"text-xs text-green-600",children:["-",M.product.currency," ",M.discount.toFixed(3)]})]})]}),a.jsx("button",{onClick:()=>{ye(je),A(M.discount.toString())},className:"mt-2 text-xs text-blue-600 hover:underline",children:M.discount>0?"Edit discount":"Add discount"})]},`${M.product.productId}-${M.unitType}-${M.variantId||0}`))})})}),We==="return"&&a.jsxs("div",{className:"flex-1 overflow-auto",children:[a.jsxs("div",{className:`border-b ${me==="return"?"bg-orange-50":""}`,onDragOver:M=>{M.preventDefault(),ht("return")},onDragLeave:()=>ht(null),onDrop:M=>{M.preventDefault(),ht(null);const je=M.dataTransfer.getData("invoiceItem");if(je){const fe=JSON.parse(je);fe.returnableQty>0&&Jr(fe,1)}},children:[a.jsxs("div",{className:"px-4 py-2 bg-orange-100 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(s4,{size:16,className:"text-orange-600"}),a.jsx("span",{className:"font-medium text-orange-800",children:"Return Basket"})]}),a.jsx("span",{className:"text-sm text-orange-600",children:te.toFixed(3)})]}),a.jsx("div",{className:"p-3 space-y-2 min-h-[100px]",children:Zt.length===0?a.jsx("div",{className:"text-center py-4 text-gray-400 text-sm",children:a.jsx("p",{children:"Drop items here to return"})}):Zt.map(M=>a.jsxs("div",{className:"bg-orange-50 rounded-lg p-3 border border-orange-200",children:[a.jsxs("div",{className:"flex justify-between items-start mb-2",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"font-medium text-sm",children:M.productName}),a.jsx("div",{className:"text-xs text-gray-500",children:M.productSku})]}),a.jsx("button",{onClick:()=>Os(M.originalOrderItemId),className:"p-1 text-gray-400 hover:text-red-600",children:a.jsx(xr,{size:14})})]}),a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>na(M.originalOrderItemId,M.quantity-1),className:"p-1 rounded bg-white border hover:bg-gray-100",children:a.jsx(Cb,{size:12})}),a.jsx("span",{className:"w-8 text-center font-medium",children:M.quantity}),a.jsx("button",{onClick:()=>na(M.originalOrderItemId,M.quantity+1),disabled:M.quantity>=M.maxReturnableQty,className:"p-1 rounded bg-white border hover:bg-gray-100 disabled:opacity-50",children:a.jsx(hr,{size:12})}),a.jsxs("span",{className:"text-xs text-gray-500",children:["/ ",M.maxReturnableQty]})]}),a.jsx("div",{className:"font-medium text-orange-700",children:M.lineTotal.toFixed(3)})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[a.jsx("select",{value:M.reason,onChange:je=>gr(M.originalOrderItemId,{reason:je.target.value}),className:"px-2 py-1 border rounded bg-white",children:bve.map(je=>a.jsx("option",{value:je.value,children:je.label},je.value))}),a.jsx("select",{value:M.condition,onChange:je=>gr(M.originalOrderItemId,{condition:je.target.value}),className:"px-2 py-1 border rounded bg-white",children:jve.map(je=>a.jsx("option",{value:je.value,children:je.label},je.value))})]}),a.jsx("select",{value:M.inventoryAction,onChange:je=>gr(M.originalOrderItemId,{inventoryAction:je.target.value}),className:"w-full mt-2 px-2 py-1 border rounded bg-white text-xs",children:wve.map(je=>a.jsx("option",{value:je.value,children:je.label},je.value))})]},M.originalOrderItemId))})]}),a.jsxs("div",{className:`${me==="exchange"?"bg-green-50":""}`,onDragOver:M=>{M.preventDefault(),ht("exchange")},onDragLeave:()=>ht(null),onDrop:M=>{M.preventDefault(),ht(null);const je=M.dataTransfer.getData("catalogProduct");if(je){const fe=JSON.parse(je);V(fe,"piece")}},children:[a.jsxs("div",{className:"px-4 py-2 bg-green-100 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(GU,{size:16,className:"text-green-600"}),a.jsx("span",{className:"font-medium text-green-800",children:"Exchange / Add Basket"})]}),a.jsxs("span",{className:"text-sm text-green-600",children:["$",re.toFixed(3)]})]}),a.jsx("div",{className:"p-3 space-y-2 min-h-[100px]",children:ue.length===0?a.jsx("div",{className:"text-center py-4 text-gray-400 text-sm",children:a.jsx("p",{children:"Drop products here to add/exchange"})}):ue.map(M=>a.jsxs("div",{className:"bg-green-50 rounded-lg p-3 border border-green-200",children:[a.jsxs("div",{className:"flex justify-between items-start mb-2",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"font-medium text-sm",children:M.product.productName}),a.jsxs("div",{className:"text-xs text-gray-500",children:[M.unitType==="box"?M.product.secondUnit:M.product.baseUnit,"  ",M.product.currency," ",M.unitPrice.toFixed(3)]})]}),a.jsx("button",{onClick:()=>X(M.product.productId,M.unitType),className:"p-1 text-gray-400 hover:text-red-600",children:a.jsx(xr,{size:14})})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>J(M.product.productId,M.unitType,-1),className:"p-1 rounded bg-white border hover:bg-gray-100",children:a.jsx(Cb,{size:12})}),a.jsx("span",{className:"w-8 text-center font-medium",children:M.quantity}),a.jsx("button",{onClick:()=>J(M.product.productId,M.unitType,1),className:"p-1 rounded bg-white border hover:bg-gray-100",children:a.jsx(hr,{size:12})})]}),a.jsxs("div",{className:"font-medium text-green-700",children:[M.product.currency," ",(M.quantity*M.unitPrice-M.discount).toFixed(3)]})]})]},`${M.product.productId}-${M.unitType}`))})]})]}),We==="sale"&&a.jsxs("div",{className:"border-t p-4 space-y-3",children:[a.jsx("input",{type:"text",value:G,onChange:M=>B(M.target.value),placeholder:"Order notes...",className:"w-full px-3 py-2 border rounded-lg text-sm"}),a.jsxs("div",{className:"space-y-1",children:[Mt?a.jsxs(a.Fragment,{children:[Object.entries(st).map(([M,je])=>a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsxs("span",{children:[M," Total (",je.items," items)"]}),a.jsxs("span",{className:"font-medium",children:[M," ",je.total.toFixed(3)]})]},M)),a.jsxs("div",{className:"border-t pt-1 mt-1",children:[a.jsxs("div",{className:"flex justify-between text-lg font-bold",children:[a.jsxs("span",{children:["Total (",pt,")"]}),a.jsxs("span",{children:[pt," ",Ut.toFixed(3)]})]}),a.jsx("div",{className:"text-xs text-gray-400 text-right",children:Object.keys(st).filter(M=>M!==pt).map(M=>{const je=h.find(fe=>fe.code===M);return`1 ${pt} = ${(je==null?void 0:je.exchangeRate)||1} ${M}`}).join(" | ")})]})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{children:"Subtotal"}),a.jsxs("span",{children:[Object.keys(st)[0]||""," ",Y.toFixed(3)]})]}),De>0&&a.jsxs("div",{className:"flex justify-between text-sm text-green-600",children:[a.jsx("span",{children:"Discount"}),a.jsxs("span",{children:["-",Object.keys(st)[0]||""," ",De.toFixed(3)]})]}),a.jsxs("div",{className:"flex justify-between text-lg font-bold",children:[a.jsx("span",{children:"Total"}),a.jsxs("span",{children:[Object.keys(st)[0]||""," ",at.toFixed(3)]})]})]}),or.showSecondaryPrice&&a.jsxs("div",{className:"flex justify-between text-sm text-orange-500 font-medium",children:[a.jsx("span",{children:"2nd Price"}),a.jsx("span",{children:(at*or.exchangeRate).toFixed(0).replace(/\B(?=(\d{3})+(?!\d))/g,",")})]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("button",{onClick:()=>K("cash"),className:`flex-1 py-2 rounded-lg flex items-center justify-center gap-1 text-sm ${H==="cash"?"bg-green-600 text-white":"bg-gray-100"}`,children:[a.jsx(da,{size:16}),"Cash"]}),a.jsxs("button",{onClick:()=>K("credit"),className:`flex-1 py-2 rounded-lg flex items-center justify-center gap-1 text-sm ${H==="credit"?"bg-orange-600 text-white":"bg-gray-100"}`,children:[a.jsx(Rh,{size:16}),"Credit"]}),a.jsx("button",{onClick:()=>K("split"),className:`flex-1 py-2 rounded-lg text-sm ${H==="split"?"bg-blue-600 text-white":"bg-gray-100"}`,children:"Split"})]}),H==="split"&&!Mt&&a.jsx("input",{type:"number",value:q,onChange:M=>ge(M.target.value),placeholder:"Cash amount...",className:"w-full px-3 py-2 border rounded-lg text-sm"}),H!=="credit"&&I.length>0&&a.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 space-y-2",children:[a.jsx("p",{className:"text-xs font-semibold text-gray-600 uppercase",children:"Pay using"}),(()=>{const M=Object.keys(st),je=[...new Set([...M,...h.filter(Qe=>Qe.isActive).map(Qe=>Qe.code)])],fe=Mt?Ut:at,Ce=(Qe,_e)=>{Er(Vt=>{const Qt={...Vt,[Qe]:{selected:_e,amount:""}};if(!_e)return Qt;const U=Object.entries(Qt).filter(([,Ke])=>Ke.selected).map(([Ke])=>Ke);if(U.length===1){const Ke=U[0],rt=h.find(Fr=>Fr.code===Ke),_t=(rt==null?void 0:rt.exchangeRate)||1;Qt[Ke]={selected:!0,amount:(fe*_t).toFixed(3)}}else{let Ke=0;U.forEach(Xt=>{if(Xt!==Qe&&st[Xt]){const Rr=h.find(gt=>gt.code===Xt),Yt=(Rr==null?void 0:Rr.exchangeRate)||1;Qt[Xt]={selected:!0,amount:st[Xt].total.toFixed(3)},Ke+=st[Xt].total/Yt}});const rt=Math.max(0,fe-Ke),_t=h.find(Xt=>Xt.code===Qe),Fr=(_t==null?void 0:_t.exchangeRate)||1;Qt[Qe]={selected:!0,amount:(rt*Fr).toFixed(3)}}return Qt})};return je.map(Qe=>{const _e=At[Qe],Vt=(_e==null?void 0:_e.selected)||!1,Qt=M.includes(Qe);return a.jsxs("div",{children:[a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:Vt,onChange:U=>Ce(Qe,U.target.checked),className:"rounded border-gray-300"}),a.jsxs("span",{className:`text-sm font-medium ${Qt?"text-gray-900":"text-gray-500"}`,children:[Qe,Qt&&a.jsxs("span",{className:"text-xs text-gray-400 ml-1",children:["(in cart: ",Qe," ",st[Qe].total.toFixed(3),")"]})]})]}),Vt&&a.jsx("div",{className:"ml-6 mt-1",children:a.jsx("input",{type:"number",step:"0.001",value:(_e==null?void 0:_e.amount)||"",onChange:U=>Er(Ke=>({...Ke,[Qe]:{...Ke[Qe],amount:U.target.value}})),placeholder:`Amount in ${Qe}...`,className:"w-full px-3 py-1.5 border rounded-lg text-sm"})})]},Qe)})})(),Object.values(At).some(M=>M.selected)&&(()=>{const M=Object.entries(At).filter(([,Qe])=>Qe.selected&&parseFloat(Qe.amount)>0),je=M.reduce((Qe,[_e,Vt])=>{const Qt=h.find(Ke=>Ke.code===_e),U=(Qt==null?void 0:Qt.exchangeRate)||1;return Qe+parseFloat(Vt.amount)/U},0),fe=Mt?Ut:at,Ce=je-fe;return a.jsxs("div",{className:"border-t pt-2 mt-2 space-y-1",children:[a.jsx("p",{className:"text-xs font-semibold text-gray-500",children:"Payment Summary"}),M.map(([Qe,_e])=>a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-gray-700",children:Qe}),a.jsxs("span",{className:"font-medium",children:[Qe," ",parseFloat(_e.amount).toFixed(3)]})]},Qe)),M.length>1&&a.jsxs("div",{className:"flex justify-between text-xs text-gray-500 border-t pt-1",children:[a.jsxs("span",{children:["= ",pt," equivalent"]}),a.jsxs("span",{className:"font-semibold",children:[pt," ",je.toFixed(3)]})]}),a.jsxs("div",{className:"flex justify-between text-xs text-gray-500",children:[a.jsxs("span",{children:["Required (",pt,")"]}),a.jsxs("span",{className:"font-semibold",children:[pt," ",fe.toFixed(3)]})]}),Math.abs(Ce)>.01&&a.jsxs("div",{className:`flex justify-between text-xs font-semibold ${Ce>0?"text-green-600":"text-red-600"}`,children:[a.jsx("span",{children:Ce>0?"Change:":"Short:"}),a.jsxs("span",{children:[pt," ",Math.abs(Ce).toFixed(3)]})]})]})})()]}),!W&&I.length>0&&a.jsxs("div",{className:"flex items-center gap-2 text-blue-600 bg-blue-50 p-2 rounded-lg text-sm",children:[a.jsx(kb,{size:16}),a.jsx("span",{children:"No customer selected  will use walk-in (----)"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:nr,disabled:!W||I.length===0||qt,className:"flex-1 py-3 bg-amber-500 text-white rounded-lg font-medium hover:bg-amber-600 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:qt?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),"Saving..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Br,{size:18}),"Save as Quote"]})}),a.jsx("button",{onClick:Ea,disabled:I.length===0||!R||se,className:"flex-1 py-3 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:se?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),"Processing..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Jt,{size:18}),"Complete Sale"]})})]})]}),We==="return"&&a.jsxs("div",{className:"border-t p-4 space-y-3",children:[a.jsx("input",{type:"text",value:le,onChange:M=>Me(M.target.value),placeholder:"Return notes / reason...",className:"w-full px-3 py-2 border rounded-lg text-sm"}),a.jsxs("div",{className:`p-4 rounded-lg ${ae===0?"bg-blue-50 border border-blue-200":ae<0?"bg-orange-50 border border-orange-200":"bg-green-50 border border-green-200"}`,children:[a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Net Result"}),a.jsx("div",{className:`text-2xl font-bold ${ae===0?"text-blue-600":ae<0?"text-orange-600":"text-green-600"}`,children:ae===0?"Even Exchange":ae<0?`Refund Due: $${Math.abs(ae).toFixed(3)}`:`Customer Pays: $${ae.toFixed(3)}`})]}),a.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200 grid grid-cols-2 gap-2 text-sm",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-gray-500",children:"Return Total"}),a.jsxs("div",{className:"font-medium text-orange-600",children:["-$",te.toFixed(3)]})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-gray-500",children:"Exchange Total"}),a.jsxs("div",{className:"font-medium text-green-600",children:["+$",re.toFixed(3)]})]})]})]}),ae<0&&a.jsxs("div",{className:"space-y-2",children:[a.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Refund Method"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("button",{onClick:()=>Xe("cash"),className:`flex-1 py-2 rounded-lg flex items-center justify-center gap-1 text-sm ${Je==="cash"?"bg-orange-600 text-white":"bg-gray-100"}`,children:[a.jsx(da,{size:16}),"Cash"]}),a.jsxs("button",{onClick:()=>Xe("store_credit"),className:`flex-1 py-2 rounded-lg flex items-center justify-center gap-1 text-sm ${Je==="store_credit"?"bg-purple-600 text-white":"bg-gray-100"}`,children:[a.jsx(Rh,{size:16}),"Store Credit"]})]})]}),ae>0&&a.jsxs("div",{className:"space-y-2",children:[a.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Payment Method"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("button",{onClick:()=>K("cash"),className:`flex-1 py-2 rounded-lg flex items-center justify-center gap-1 text-sm ${H==="cash"?"bg-green-600 text-white":"bg-gray-100"}`,children:[a.jsx(da,{size:16}),"Cash"]}),a.jsxs("button",{onClick:()=>K("credit"),className:`flex-1 py-2 rounded-lg flex items-center justify-center gap-1 text-sm ${H==="credit"?"bg-orange-600 text-white":"bg-gray-100"}`,children:[a.jsx(Rh,{size:16}),"Credit"]})]})]}),!Rt&&a.jsxs("div",{className:"flex items-center gap-2 text-amber-600 bg-amber-50 p-2 rounded-lg text-sm",children:[a.jsx(kb,{size:16}),a.jsx("span",{children:"Load an invoice first"})]}),Rt&&Zt.length===0&&ue.length===0&&a.jsxs("div",{className:"flex items-center gap-2 text-amber-600 bg-amber-50 p-2 rounded-lg text-sm",children:[a.jsx(kb,{size:16}),a.jsx("span",{children:"Add items to return or exchange"})]}),a.jsx("button",{onClick:Ne,disabled:!Rt||!R||Zt.length===0&&ue.length===0||ut,className:"w-full py-3 bg-orange-600 text-white rounded-lg font-medium hover:bg-orange-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:ut?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),"Processing..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Jt,{size:18}),"Complete Return / Exchange"]})})]})]}),k&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg w-full max-w-lg max-h-[80vh] flex flex-col",children:[a.jsxs("div",{className:"p-4 border-b flex justify-between items-center",children:[a.jsx("h2",{className:"text-lg font-bold",children:"Select Customer"}),a.jsx("button",{onClick:()=>N(!1),children:a.jsx(yt,{size:24})})]}),a.jsx("div",{className:"p-4 border-b",children:a.jsx("input",{type:"text",value:O,onChange:M=>E(M.target.value),placeholder:"Search customers...",className:"w-full px-4 py-2 border rounded-lg",autoFocus:!0})}),a.jsx("div",{className:"flex-1 overflow-auto",children:Ue.map(M=>a.jsxs("button",{onClick:()=>{Q(M),N(!1),E("")},className:"w-full px-4 py-3 text-left hover:bg-gray-50 border-b flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsx("div",{className:"font-medium",children:M.name}),M.shopName&&a.jsx("div",{className:"text-sm text-gray-500",children:M.shopName}),a.jsx("div",{className:"text-sm text-gray-500",children:M.phone})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("div",{className:"text-sm text-gray-500",children:M.customerType}),M.debtBalance>0&&a.jsxs("div",{className:"text-sm text-red-600",children:["Owes: $",M.debtBalance.toFixed(3)]})]})]},M.id))})]})}),he!==null&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-sm",children:[a.jsx("h3",{className:"text-lg font-bold mb-4",children:"Set Discount"}),a.jsx("input",{type:"number",value:z,onChange:M=>A(M.target.value),placeholder:"Discount amount...",className:"w-full px-4 py-2 border rounded-lg mb-4",autoFocus:!0}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>{ye(null),A("")},className:"flex-1 py-2 border rounded-lg",children:"Cancel"}),a.jsx("button",{onClick:Ot,className:"flex-1 py-2 bg-blue-600 text-white rounded-lg",children:"Apply"})]})]})}),S&&Z&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-sm text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(Jt,{size:32,className:"text-green-600"})}),a.jsx("h3",{className:"text-xl font-bold mb-2",children:"Sale Complete!"}),a.jsxs("p",{className:"text-gray-600 mb-4",children:["Order #",Z.orderNumber]}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-4 text-left space-y-2",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Customer"}),a.jsx("span",{className:"font-medium",children:Z.customerName})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs("span",{children:["Total (",pt,")"]}),a.jsxs("span",{className:"font-medium",children:[pt," ",Z.totalAmount.toFixed(3)]})]}),Z.paymentCurrencies&&(()=>{const M=typeof Z.paymentCurrencies=="string"?JSON.parse(Z.paymentCurrencies):Z.paymentCurrencies;return M&&M.length>0?a.jsxs("div",{className:"bg-blue-50 rounded p-2 space-y-1",children:[a.jsx("p",{className:"text-xs font-semibold text-blue-700",children:"Paid With"}),M.map((je,fe)=>a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{children:je.currency}),a.jsxs("span",{className:"font-medium",children:[je.currency," ",Number(je.amount).toFixed(3)]})]},fe))]}):null})(),!Z.paymentCurrencies&&a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Paid"}),a.jsx("span",{className:"font-medium",children:Z.paidAmount.toFixed(3)})]}),Z.changeAmount>0&&a.jsxs("div",{className:"flex justify-between text-green-600",children:[a.jsx("span",{children:"Change"}),a.jsx("span",{className:"font-medium",children:Z.changeAmount.toFixed(3)})]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>_(!1),className:"flex-1 py-2 border rounded-lg",children:"Close"}),a.jsxs("button",{onClick:Dr,className:"flex-1 py-2 bg-blue-600 text-white rounded-lg flex items-center justify-center gap-2",children:[a.jsx(ua,{size:18}),"Print"]})]})]})}),ve&&oe&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md text-center",children:[a.jsx("div",{className:`w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4 ${oe.netAmount===0?"bg-blue-100":oe.netAmount<0?"bg-orange-100":"bg-green-100"}`,children:a.jsx(Jt,{size:32,className:oe.netAmount===0?"text-blue-600":oe.netAmount<0?"text-orange-600":"text-green-600"})}),a.jsx("h3",{className:"text-xl font-bold mb-2",children:oe.netAmount===0?"Even Exchange Complete!":oe.netAmount<0?"Return Processed!":"Exchange Complete!"}),a.jsxs("p",{className:"text-gray-600 mb-4",children:["Transaction #",oe.transactionNumber]}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-4 text-left space-y-2",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Customer"}),a.jsx("span",{className:"font-medium",children:oe.customerName})]}),a.jsxs("div",{className:"flex justify-between text-orange-600",children:[a.jsx("span",{children:"Return Total"}),a.jsxs("span",{className:"font-medium",children:["-$",oe.returnTotal.toFixed(3)]})]}),a.jsxs("div",{className:"flex justify-between text-green-600",children:[a.jsx("span",{children:"Exchange Total"}),a.jsxs("span",{className:"font-medium",children:["+$",oe.exchangeTotal.toFixed(3)]})]}),a.jsxs("div",{className:"border-t pt-2 flex justify-between font-bold",children:[a.jsx("span",{children:"Net Amount"}),a.jsx("span",{className:oe.netAmount===0?"text-blue-600":oe.netAmount<0?"text-orange-600":"text-green-600",children:oe.netAmount===0?"$0.00":oe.netAmount<0?`-$${Math.abs(oe.netAmount).toFixed(3)}`:`+$${oe.netAmount.toFixed(3)}`})]}),oe.refundDue>0&&a.jsxs("div",{className:"bg-orange-50 p-2 rounded text-orange-700 text-sm",children:["Refund Due: $",oe.refundDue.toFixed(3)]}),oe.paymentDue>0&&a.jsxs("div",{className:"bg-green-50 p-2 rounded text-green-700 text-sm",children:["Payment Collected: $",oe.paymentDue.toFixed(3)]})]}),a.jsx("p",{className:"text-sm text-gray-500 mb-4",children:oe.message}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>xe(!1),className:"flex-1 py-2 border rounded-lg",children:"Close"}),a.jsxs("button",{onClick:()=>Se(oe),className:"flex-1 py-2 bg-orange-600 text-white rounded-lg flex items-center justify-center gap-2",children:[a.jsx(ua,{size:18}),"Print Invoice"]})]})]})})]})}function Sve(){const[e,t]=m.useState([]),[r,s]=m.useState([]),[n,i]=m.useState(!0),[l,o]=m.useState(""),[c,u]=m.useState(()=>{const G=new Date;return G.setDate(G.getDate()-30),G.toISOString().split("T")[0]}),[d,h]=m.useState(new Date().toISOString().split("T")[0]),[f,x]=m.useState(""),[p,g]=m.useState(""),[y,v]=m.useState(!1),[j,b]=m.useState(null),[w,k]=m.useState(!1),[N,S]=m.useState(!1),[_,O]=m.useState(null),[E,R]=m.useState(!1);m.useEffect(()=>{C()},[c,d,f]);const C=async()=>{try{i(!0);const[G,B]=await Promise.all([zp.getSales({startDate:c,endDate:d,customerId:f||void 0}),Ha.getAll()]);t(G),s(B.data||B)}catch(G){console.error("Failed to load data:",G)}finally{i(!1)}},I=async G=>{try{k(!0);const B=await zp.getOrderByNumber(G);b(B),v(!0)}catch(B){console.error("Failed to load order:",B),alert("Failed to load order details")}finally{k(!1)}},ne=G=>{O(G),S(!0)},W=async()=>{var G,B;if(_)try{R(!0),await ie.delete(`/orders/${_}`),t(e.filter(se=>se.id!==_)),S(!1),O(null)}catch(se){alert(((B=(G=se.response)==null?void 0:G.data)==null?void 0:B.error)||"Failed to delete order")}finally{R(!1)}},Q=G=>{const B=window.open("","_blank");B&&(B.document.write(`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Receipt - ${G.orderNumber}</title>
        <style>
          body { font-family: 'Courier New', monospace; font-size: 12px; padding: 10px; max-width: 300px; margin: 0 auto; }
          .header { text-align: center; margin-bottom: 10px; }
          .header h1 { font-size: 16px; margin: 0; }
          .divider { border-top: 1px dashed #000; margin: 10px 0; }
          .row { display: flex; justify-content: space-between; margin: 3px 0; }
          .item { margin: 5px 0; }
          .item-name { font-weight: bold; }
          .item-details { padding-left: 10px; color: #666; }
          .total { font-weight: bold; font-size: 14px; }
          .footer { text-align: center; margin-top: 15px; font-size: 10px; color: #666; }
        </style>
      </head>
      <body>
        <div class="header">
          <h1>SALES RECEIPT</h1>
          <p>${G.orderNumber}</p>
        </div>
        <div class="divider"></div>
        <div class="row"><span>Date:</span><span>${new Date(G.orderDate).toLocaleDateString()}</span></div>
        <div class="row"><span>Customer:</span><span>${G.customerName}</span></div>
        ${G.cashierName?`<div class="row"><span>Cashier:</span><span>${G.cashierName}</span></div>`:""}
        <div class="divider"></div>
        ${G.items.map(se=>`
          <div class="item">
            <div class="item-name">${se.productName}</div>
            <div class="item-details">
              ${se.quantity} x $${se.unitPrice.toFixed(3)} = $${se.lineTotal.toFixed(3)}
            </div>
          </div>
        `).join("")}
        <div class="divider"></div>
        <div class="row"><span>Subtotal:</span><span>$${G.subtotal.toFixed(3)}</span></div>
        ${G.discountAmount>0?`<div class="row"><span>Discount:</span><span>-$${G.discountAmount.toFixed(3)}</span></div>`:""}
        ${G.taxAmount>0?`<div class="row"><span>Tax:</span><span>$${G.taxAmount.toFixed(3)}</span></div>`:""}
        <div class="divider"></div>
        <div class="row total"><span>TOTAL:</span><span>$${G.totalAmount.toFixed(3)}</span></div>
        <div class="row"><span>Paid:</span><span>$${G.paidAmount.toFixed(3)}</span></div>
        ${G.totalAmount-G.paidAmount>0?`<div class="row"><span>Balance:</span><span>$${(G.totalAmount-G.paidAmount).toFixed(3)}</span></div>`:""}
        <div class="footer">
          <p>Thank you for your business!</p>
          <p>${new Date().toLocaleString()}</p>
        </div>
      </body>
      </html>
    `),B.document.close(),B.print())},H=e.filter(G=>{if(l){const B=l.toLowerCase();if(!G.orderNumber.toLowerCase().includes(B)&&!G.customerName.toLowerCase().includes(B))return!1}return!(p&&G.paymentStatus!==p)}),K=G=>{switch(G){case"paid":return"bg-green-100 text-green-700";case"partial":return"bg-yellow-100 text-yellow-700";case"unpaid":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}},q=H.reduce((G,B)=>G+B.totalAmount,0),ge=H.reduce((G,B)=>G+B.paidAmount,0);return a.jsxs("div",{className:"p-6",children:[a.jsx("div",{className:"flex justify-between items-center mb-6",children:a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-[#003366]",children:"Direct Sales"}),a.jsx("p",{className:"text-gray-500 text-sm",children:"Manage direct sales transactions"})]})}),a.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4",children:[a.jsx("div",{className:"text-sm text-gray-500",children:"Total Sales"}),a.jsx("div",{className:"text-2xl font-bold text-blue-600",children:H.length})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4",children:[a.jsx("div",{className:"text-sm text-gray-500",children:"Total Amount"}),a.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["$",q.toFixed(3)]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4",children:[a.jsx("div",{className:"text-sm text-gray-500",children:"Total Paid"}),a.jsxs("div",{className:"text-2xl font-bold text-emerald-600",children:["$",ge.toFixed(3)]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4",children:[a.jsx("div",{className:"text-sm text-gray-500",children:"Outstanding"}),a.jsxs("div",{className:"text-2xl font-bold text-red-600",children:["$",(q-ge).toFixed(3)]})]})]}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 mb-6",children:a.jsxs("div",{className:"flex flex-wrap gap-3",children:[a.jsxs("div",{className:"relative flex-1 min-w-[200px]",children:[a.jsx(Na,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),a.jsx("input",{type:"text",value:l,onChange:G=>o(G.target.value),placeholder:"Search by order # or customer...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg"})]}),a.jsx("input",{type:"date",value:c,onChange:G=>u(G.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg"}),a.jsx("input",{type:"date",value:d,onChange:G=>h(G.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg"}),a.jsxs("select",{value:f,onChange:G=>x(G.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg",children:[a.jsx("option",{value:"",children:"All Customers"}),r.map(G=>a.jsx("option",{value:G.id,children:G.name},G.id))]}),a.jsxs("select",{value:p,onChange:G=>g(G.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg",children:[a.jsx("option",{value:"",children:"All Status"}),a.jsx("option",{value:"paid",children:"Paid"}),a.jsx("option",{value:"partial",children:"Partial"}),a.jsx("option",{value:"unpaid",children:"Unpaid"})]})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden",children:n?a.jsx("div",{className:"flex items-center justify-center py-12",children:a.jsx(vt,{className:"animate-spin text-blue-500",size:32})}):a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Order #"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Date"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Customer"}),a.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-gray-600 uppercase",children:"Items"}),a.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-gray-600 uppercase",children:"Total"}),a.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-gray-600 uppercase",children:"Paid"}),a.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-gray-600 uppercase",children:"Status"}),a.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-gray-600 uppercase",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:H.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:8,className:"px-4 py-8 text-center text-gray-500",children:"No sales found"})}):H.map(G=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 font-medium text-blue-600",children:G.orderNumber}),a.jsx("td",{className:"px-4 py-3",children:new Date(G.orderDate).toLocaleDateString()}),a.jsx("td",{className:"px-4 py-3",children:G.customerName}),a.jsx("td",{className:"px-4 py-3 text-right",children:G.itemCount}),a.jsxs("td",{className:"px-4 py-3 text-right font-medium",children:["$",G.totalAmount.toFixed(3)]}),a.jsxs("td",{className:"px-4 py-3 text-right",children:["$",G.paidAmount.toFixed(3)]}),a.jsx("td",{className:"px-4 py-3 text-center",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${K(G.paymentStatus)}`,children:G.paymentStatus})}),a.jsx("td",{className:"px-4 py-3",children:a.jsxs("div",{className:"flex justify-center gap-1",children:[a.jsx("button",{onClick:()=>I(G.orderNumber),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",title:"View Details",disabled:w,children:a.jsx(gs,{size:16})}),a.jsx("button",{onClick:()=>ne(G.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Delete",children:a.jsx(xr,{size:16})})]})})]},G.id))})]})}),y&&j&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-3xl max-h-[90vh] overflow-hidden",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-[#003366] text-white",children:[a.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[a.jsx(da,{size:20})," Order Details"]}),a.jsx("button",{onClick:()=>{v(!1),b(null)},children:a.jsx(yt,{size:24})})]}),a.jsxs("div",{className:"p-6 space-y-4 overflow-y-auto max-h-[calc(90vh-140px)]",children:[a.jsxs("div",{className:"grid grid-cols-4 gap-4 bg-gray-50 rounded-lg p-4",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-xs text-gray-500",children:"Order #"}),a.jsx("div",{className:"font-semibold",children:j.orderNumber})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-xs text-gray-500",children:"Date"}),a.jsx("div",{className:"font-semibold",children:new Date(j.orderDate).toLocaleDateString()})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-xs text-gray-500",children:"Customer"}),a.jsx("div",{className:"font-semibold",children:j.customerName})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-xs text-gray-500",children:"Status"}),a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${K(j.paymentStatus)}`,children:j.paymentStatus})]})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold mb-2",children:"Items"}),a.jsx("div",{className:"border rounded-lg overflow-hidden",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-2 text-left",children:"Product"}),a.jsx("th",{className:"px-3 py-2 text-center",children:"Unit"}),a.jsx("th",{className:"px-3 py-2 text-right",children:"Qty"}),a.jsx("th",{className:"px-3 py-2 text-right",children:"Price"}),a.jsx("th",{className:"px-3 py-2 text-right",children:"Discount"}),a.jsx("th",{className:"px-3 py-2 text-right",children:"Total"})]})}),a.jsx("tbody",{className:"divide-y",children:j.items.map(G=>a.jsxs("tr",{children:[a.jsxs("td",{className:"px-3 py-2",children:[a.jsx("div",{className:"font-medium",children:G.productName}),a.jsx("div",{className:"text-xs text-gray-500",children:G.productSku})]}),a.jsx("td",{className:"px-3 py-2 text-center",children:G.unitType}),a.jsx("td",{className:"px-3 py-2 text-right",children:G.quantity}),a.jsxs("td",{className:"px-3 py-2 text-right",children:["$",G.unitPrice.toFixed(3)]}),a.jsx("td",{className:"px-3 py-2 text-right text-orange-600",children:G.discountAmount>0?`-$${G.discountAmount.toFixed(3)}`:"-"}),a.jsxs("td",{className:"px-3 py-2 text-right font-medium",children:["$",G.lineTotal.toFixed(3)]})]},G.id))})]})})]}),a.jsx("div",{className:"flex justify-end",children:a.jsxs("div",{className:"w-64 space-y-2",children:[a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-gray-500",children:"Subtotal:"}),a.jsxs("span",{children:["$",j.subtotal.toFixed(3)]})]}),j.discountAmount>0&&a.jsxs("div",{className:"flex justify-between text-sm text-orange-600",children:[a.jsx("span",{children:"Discount:"}),a.jsxs("span",{children:["-$",j.discountAmount.toFixed(3)]})]}),j.taxAmount>0&&a.jsxs("div",{className:"flex justify-between text-sm text-blue-600",children:[a.jsx("span",{children:"Tax:"}),a.jsxs("span",{children:["+$",j.taxAmount.toFixed(3)]})]}),a.jsxs("div",{className:"flex justify-between font-semibold text-lg border-t pt-2",children:[a.jsx("span",{children:"Total:"}),a.jsxs("span",{className:"text-green-600",children:["$",j.totalAmount.toFixed(3)]})]}),a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-gray-500",children:"Paid:"}),a.jsxs("span",{children:["$",j.paidAmount.toFixed(3)]})]}),j.totalAmount-j.paidAmount>0&&a.jsxs("div",{className:"flex justify-between text-sm font-medium",children:[a.jsx("span",{className:"text-gray-500",children:"Balance:"}),a.jsxs("span",{className:"text-red-600",children:["$",(j.totalAmount-j.paidAmount).toFixed(3)]})]})]})}),j.notes&&a.jsxs("div",{className:"border-t pt-4",children:[a.jsx("span",{className:"text-gray-500 text-sm",children:"Notes:"})," ",j.notes]})]}),a.jsxs("div",{className:"flex justify-between p-4 border-t",children:[a.jsxs("button",{onClick:()=>Q(j),className:"flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600",children:[a.jsx(ua,{size:16})," Print Receipt"]}),a.jsx("button",{onClick:()=>{v(!1),b(null)},className:"px-6 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Close"})]})]})}),N&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-md p-6",children:[a.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Confirm Delete"}),a.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to delete this sale? This action cannot be undone."}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:()=>{S(!1),O(null)},className:"flex-1 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",disabled:E,children:"Cancel"}),a.jsx("button",{onClick:W,disabled:E,className:"flex-1 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 disabled:opacity-50",children:E?"Deleting...":"Delete"})]})]})})]})}function kve(){const[e,t]=m.useState([]),[r,s]=m.useState([]),[n,i]=m.useState(!0),[l,o]=m.useState(""),[c,u]=m.useState(new Date().toISOString().split("T")[0]),[d,h]=m.useState(new Date().toISOString().split("T")[0]),[f,x]=m.useState(""),[p,g]=m.useState(""),[y,v]=m.useState(null),[j,b]=m.useState(!1),[w,k]=m.useState(1),N=20,[S,_]=m.useState(!1),[O,E]=m.useState({showSummary:!0,showTransactions:!0,showProducts:!0,showInventory:!0,showProfit:!0,showCost:!0}),[R,C]=m.useState([]),[I,ne]=m.useState(!1),[W,Q]=m.useState(0),[H,K]=m.useState({salary:0,advance:0,bonus:0,deduction:0,total:0}),[q,ge]=m.useState({name:"",phone:"",address:""});m.useEffect(()=>{L(),G()},[]);const G=async()=>{try{const ee=await Bp.get();ge({name:ee.data.companyName||"",phone:ee.data.phone||"",address:ee.data.address||""})}catch(ee){console.error("Failed to load company settings:",ee)}};m.useEffect(()=>{Z(),B(),se()},[c,d,f,p]);const B=async()=>{try{const ee={};c&&(ee.startDate=c),d&&(ee.endDate=d);const xe=(await Pi.getAll(ee)).data.reduce((oe,Ie)=>oe+Ie.amount,0);Q(xe)}catch(ee){console.error("Failed to load expenses:",ee)}},se=async()=>{try{const ee={};c&&(ee.startDate=c),d&&(ee.endDate=d);const ve=await Rc.getAll(ee),xe={salary:0,advance:0,bonus:0,deduction:0,total:0};ve.forEach(oe=>{const Ie=oe.amount||0;oe.paymentType==="salary"?(xe.salary+=Ie,xe.total+=Ie):oe.paymentType==="advance"?(xe.advance+=Ie,xe.total+=Ie):oe.paymentType==="bonus"?(xe.bonus+=Ie,xe.total+=Ie):oe.paymentType==="deduction"?xe.deduction+=Ie:(xe.salary+=Ie,xe.total+=Ie)}),K(xe)}catch(ee){console.error("Failed to load salaries:",ee)}},L=async()=>{try{const ee=await hs.getAll();s(ee.data.filter(ve=>ve.isDriver).map(ve=>({id:ve.id,name:ve.name})))}catch(ee){console.error("Failed to load drivers:",ee)}},Z=async()=>{i(!0);try{const ee=[];if(!f||f==="order"){const ve=new URLSearchParams;c&&ve.append("startDate",c),d&&ve.append("endDate",d),p&&ve.append("driverId",p),(await ie.get(`/orders?${ve.toString()}`)).data.forEach(oe=>{var At,Er,or;const Ie=((At=oe.items||oe.orderItems)==null?void 0:At.map(Gt=>{var zt,ma;return{id:Gt.id,productId:Gt.productId,productName:Gt.productName||((zt=Gt.product)==null?void 0:zt.name)||"Unknown",unitType:Gt.unitType||"piece",quantity:Gt.quantity,unitPrice:Gt.unitPrice,discountAmount:Gt.discountAmount||0,total:Gt.total,costPrice:Gt.costPrice||((ma=Gt.product)==null?void 0:ma.costPrice)||0,currency:Gt.currency||"USD"}}))||[];let me=null;if(oe.exchangeRateSnapshot)try{me=JSON.parse(oe.exchangeRateSnapshot)}catch{}let ht=oe.totalAmount;me&&Ie.length>0&&(ht=Ie.reduce((Gt,zt)=>{const ma=me[zt.currency]||1;return Gt+zt.total/ma},0)),ee.push({id:oe.id,type:"order",referenceNumber:oe.orderNumber,customerId:oe.customerId,customerName:((Er=oe.customer)==null?void 0:Er.name)||oe.customerName||"Walk-in",driverId:oe.driverId,driverName:((or=oe.driver)==null?void 0:or.name)||oe.driverName||"-",date:oe.orderDate,totalAmount:ht,paidAmount:oe.paidAmount,debtAmount:Math.max(0,ht-oe.paidAmount),paymentType:oe.paymentStatus==="paid"?"cash":oe.paymentStatus,status:oe.orderStatus,notes:oe.notes,items:Ie,paymentCurrencies:oe.paymentCurrencies?JSON.parse(oe.paymentCurrencies):null,exchangeRateSnapshot:me})})}if(!f||f==="task"){const ve=new URLSearchParams;c&&ve.append("startDate",c),d&&ve.append("endDate",d),p&&ve.append("driverId",p),ve.append("status","Completed"),(await ie.get(`/tasks?${ve.toString()}`)).data.forEach(oe=>{var Ie,me,ht;oe.total>0&&ee.push({id:oe.id,type:"task",referenceNumber:oe.taskNumber,customerId:oe.customerId,customerName:oe.customerName||((Ie=oe.customer)==null?void 0:Ie.name)||"-",driverId:oe.driverId,driverName:oe.driverName||((me=oe.driver)==null?void 0:me.name)||"-",date:oe.scheduledDate,totalAmount:oe.total,paidAmount:oe.paidAmount||oe.total,debtAmount:oe.debtAmount||0,paymentType:oe.paymentType||"cash",status:oe.status,notes:oe.notes,items:((ht=oe.items)==null?void 0:ht.map(At=>{var Er,or;return{id:At.id,productId:At.productId,productName:((Er=At.product)==null?void 0:Er.name)||At.productName||"Unknown",unitType:At.unitType||"piece",quantity:At.quantity,unitPrice:At.unitPrice,discountAmount:At.discountPercent||0,total:At.total,costPrice:At.costPrice||((or=At.product)==null?void 0:or.costPrice)||0,currency:At.currency||"USD"}}))||[]})})}if(!f||f==="collection"){const ve=new URLSearchParams;c&&ve.append("startDate",c),d&&ve.append("endDate",d),p&&ve.append("driverId",p),(await ie.get(`/collections?${ve.toString()}`)).data.forEach(oe=>{var Ie,me;ee.push({id:oe.id,type:"collection",referenceNumber:oe.collectionNumber,customerId:oe.customerId,customerName:((Ie=oe.customer)==null?void 0:Ie.name)||oe.customerName||"-",driverId:oe.driverId,driverName:((me=oe.driver)==null?void 0:me.name)||oe.driverName||"-",date:oe.collectionDate,totalAmount:oe.amount,paidAmount:oe.amount,debtAmount:0,paymentType:oe.paymentType||"cash",status:"collected",notes:oe.notes,items:[]})})}if(!f||f==="return_exchange"){const ve=new URLSearchParams;c&&ve.append("startDate",c),d&&ve.append("endDate",d);try{(await ie.get(`/direct-sales/return-exchanges?${ve.toString()}`)).data.forEach(oe=>{var Ie,me;ee.push({id:oe.id,type:"return_exchange",referenceNumber:oe.transactionNumber,customerId:oe.customerId,customerName:oe.customerName||"-",driverId:null,driverName:"-",date:oe.transactionDate,totalAmount:oe.netAmount,paidAmount:oe.netAmount>=0?oe.paymentAmount:0,debtAmount:oe.netAmount<0?Math.abs(oe.netAmount):0,paymentType:oe.netAmount<0?"refund":oe.netAmount>0?"payment":"even",status:oe.status,notes:`Return: ${((Ie=oe.returnTotal)==null?void 0:Ie.toFixed(3))||"0.000"} | Exchange: ${((me=oe.exchangeTotal)==null?void 0:me.toFixed(3))||"0.000"}`,items:[],returnTotal:oe.returnTotal||0,exchangeTotal:oe.exchangeTotal||0})})}catch{console.log("Return exchanges not available")}}ee.sort((ve,xe)=>new Date(xe.date).getTime()-new Date(ve.date).getTime()),t(ee)}catch(ee){console.error("Failed to load transactions:",ee)}finally{i(!1)}},F=async ee=>{var ve;if(ee.type==="order"&&ee.items.length===0){b(!0);try{const Ie=((ve=(await ie.get(`/orders/${ee.id}`)).data.orderItems)==null?void 0:ve.map(me=>{var ht,At;return{id:me.id,productId:me.productId,productName:me.productName||((ht=me.product)==null?void 0:ht.name)||"Unknown",unitType:me.unitType||"piece",quantity:me.quantity,unitPrice:me.unitPrice,discountAmount:me.discountAmount||0,total:me.total,costPrice:me.costPrice||((At=me.product)==null?void 0:At.costPrice)||0,currency:me.currency||"USD"}}))||[];v({...ee,items:Ie})}catch(xe){console.error("Failed to load order details:",xe),v(ee)}finally{b(!1)}}else v(ee)},he=async ee=>{var xe,oe;if(confirm(`Are you sure you want to delete this ${{order:"order",task:"task",collection:"collection",return_exchange:"return/exchange"}[ee.type]||"transaction"}?

Reference: ${ee.referenceNumber}
Amount: ${ee.totalAmount.toFixed(3)}

This action cannot be undone.`))try{let Ie="";switch(ee.type){case"order":Ie=`/orders/${ee.id}`;break;case"task":Ie=`/tasks/${ee.id}`;break;case"collection":Ie=`/collections/${ee.id}`;break;case"return_exchange":Ie=`/direct-sales/return-exchanges/${ee.id}`;break;default:alert("Cannot delete this transaction type");return}await ie.delete(Ie),alert("Transaction deleted successfully"),Z()}catch(Ie){console.error("Failed to delete transaction:",Ie),alert(((oe=(xe=Ie.response)==null?void 0:xe.data)==null?void 0:oe.message)||"Failed to delete transaction")}},ye=ee=>{const ve=window.open("","_blank","width=400,height=600");if(!ve){alert("Please allow popups to print invoice");return}const xe=`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Invoice - ${ee.referenceNumber}</title>
        <style>
          * { margin: 0; padding: 0; box-sizing: border-box; }
          body { font-family: 'Courier New', monospace; font-size: 12px; padding: 10px; max-width: 300px; margin: 0 auto; }
          .header { text-align: center; border-bottom: 1px dashed #000; padding-bottom: 10px; margin-bottom: 10px; }
          .header h1 { font-size: 16px; margin-bottom: 5px; }
          .header p { font-size: 10px; color: #666; }
          .info { margin-bottom: 10px; }
          .info-row { display: flex; justify-content: space-between; margin-bottom: 3px; }
          .info-row .label { color: #666; }
          .divider { border-top: 1px dashed #000; margin: 10px 0; }
          .items { margin-bottom: 10px; }
          .item { margin-bottom: 5px; }
          .item-name { font-weight: bold; }
          .item-details { display: flex; justify-content: space-between; padding-left: 10px; }
          .totals { border-top: 1px dashed #000; padding-top: 10px; }
          .total-row { display: flex; justify-content: space-between; margin-bottom: 3px; }
          .total-row.grand { font-weight: bold; font-size: 14px; border-top: 1px solid #000; padding-top: 5px; margin-top: 5px; }
          .footer { text-align: center; margin-top: 15px; padding-top: 10px; border-top: 1px dashed #000; font-size: 10px; color: #666; }
          @media print { 
            body { padding: 0; } 
            @page { margin: 5mm; }
          }
        </style>
      </head>
      <body>
        <div class="header">
          ${q.name?`<h1>${q.name}</h1>`:"<h1>INVOICE</h1>"}
          ${q.phone?`<p> ${q.phone}</p>`:""}
          ${q.address?`<p>${q.address}</p>`:""}
          <p style="margin-top: 5px; font-weight: bold;">${ee.referenceNumber}</p>
        </div>
        
        <div class="info">
          <div class="info-row">
            <span class="label">Date:</span>
            <span>${new Date(ee.date).toLocaleDateString()}</span>
          </div>
          <div class="info-row">
            <span class="label">Customer:</span>
            <span>${ee.customerName||"Walk-in"}</span>
          </div>
          ${ee.driverName&&ee.driverName!=="-"?`
          <div class="info-row">
            <span class="label">Driver:</span>
            <span>${ee.driverName}</span>
          </div>
          `:""}
          <div class="info-row">
            <span class="label">Payment:</span>
            <span>${ee.paymentType}</span>
          </div>
        </div>
        
        <div class="divider"></div>
        
        <div class="items">
          ${ee.items.length>0?ee.items.map(oe=>`
            <div class="item">
              <div class="item-name">${oe.productName}</div>
              <div class="item-details">
                <span>${oe.quantity} x ${oe.currency||""} ${oe.unitPrice.toFixed(3)}</span>
                <span>${oe.currency||""} ${oe.total.toFixed(3)}</span>
              </div>
            </div>
          `).join(""):`
            <div class="item">
              <div class="item-name">${ee.type==="collection"?"Debt Collection":"Sale"}</div>
              <div class="item-details">
                <span></span>
                <span>${ee.totalAmount.toFixed(3)}</span>
              </div>
            </div>
          `}
        </div>
        
        <div class="totals">
          <div class="total-row">
            <span>Subtotal:</span>
            <span>${ee.totalAmount.toFixed(3)}</span>
          </div>
          <div class="total-row">
            <span>Paid:</span>
            <span>${ee.paidAmount.toFixed(3)}</span>
          </div>
          ${ee.debtAmount>0?`
          <div class="total-row">
            <span>Balance Due:</span>
            <span>${ee.debtAmount.toFixed(3)}</span>
          </div>
          `:""}
          <div class="total-row grand">
            <span>TOTAL:</span>
            <span>${ee.totalAmount.toFixed(3)}</span>
          </div>
        </div>
        
        <div class="footer">
          <p>Thank you for your business!</p>
          <p>Printed: ${new Date().toLocaleString()}</p>
        </div>
        
        <script>
          window.onload = function() { window.print(); }
        <\/script>
      </body>
      </html>
    `;ve.document.write(xe),ve.document.close()},z=e.filter(ee=>{var xe,oe;return ee.referenceNumber.toLowerCase().includes(l.toLowerCase())||((xe=ee.customerName)==null?void 0:xe.toLowerCase().includes(l.toLowerCase()))||((oe=ee.driverName)==null?void 0:oe.toLowerCase().includes(l.toLowerCase()))}),A=Math.ceil(z.length/N),de=z.slice((w-1)*N,w*N),D=ee=>{switch(ee){case"order":return a.jsx(ix,{size:16,className:"text-blue-600"});case"task":return a.jsx(On,{size:16,className:"text-green-600"});case"collection":return a.jsx(n4,{size:16,className:"text-purple-600"});case"return_exchange":return a.jsx(ao,{size:16,className:"text-orange-600"});default:return a.jsx(Yo,{size:16,className:"text-gray-600"})}},ze=ee=>{switch(ee){case"order":return"POS Sale";case"task":return"Task Delivery";case"collection":return"Collection";case"return_exchange":return"Return/Exchange";default:return ee}},Fe=ee=>{switch(ee){case"order":return"bg-blue-100 text-blue-800";case"task":return"bg-green-100 text-green-800";case"collection":return"bg-purple-100 text-purple-800";case"return_exchange":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}},ct=ee=>{switch(ee){case"cash":return"bg-green-100 text-green-800";case"credit":return"bg-orange-100 text-orange-800";case"split":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}},$e=ee=>(ee||0).toFixed(3),We=ee=>new Date(ee).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),Bt=z.filter(ee=>ee.type!=="collection"&&ee.type!=="return_exchange"),Ee=Bt.reduce((ee,ve)=>ee+ve.totalAmount,0),it=Bt.reduce((ee,ve)=>ee+ve.paidAmount,0),we=z.filter(ee=>ee.type==="collection").reduce((ee,ve)=>ee+ve.paidAmount,0),et=Bt.reduce((ee,ve)=>ee+ve.debtAmount,0),Ge=Bt.length,Nt={};Bt.forEach(ee=>{ee.items.forEach(ve=>{const xe=ve.currency||"USD";Nt[xe]=(Nt[xe]||0)+ve.total})});const Rt=z.filter(ee=>ee.type==="return_exchange"),pr=Rt.reduce((ee,ve)=>ee+(ve.returnTotal||0),0),Zt=Rt.reduce((ee,ve)=>ee+(ve.exchangeTotal||0),0),er=(ee,ve)=>{const xe=ve.exchangeRateSnapshot;if(!xe||!ee.currency)return ee.total;const oe=xe[ee.currency]||1;return ee.total/oe},ue=(ee,ve)=>{const xe=ve.exchangeRateSnapshot,oe=ee.costPrice*ee.quantity;if(!xe||!ee.currency)return oe;const Ie=xe[ee.currency]||1;return oe/Ie},Le=Bt.reduce((ee,ve)=>ee+ve.items.reduce((xe,oe)=>xe+ue(oe,ve),0),0),Je=Ee-Le,Xe=()=>{const ee=new Map;return Bt.forEach(ve=>{ve.items.forEach(xe=>{const oe=ee.get(xe.productId),Ie=er(xe,ve),me=ue(xe,ve),ht=Ie-me;oe?(oe.totalQuantity+=xe.quantity,oe.totalSales+=Ie,oe.totalCost+=me,oe.profit+=ht):ee.set(xe.productId,{productId:xe.productId,productName:xe.productName,totalQuantity:xe.quantity,totalSales:Ie,totalCost:me,profit:ht})})}),Array.from(ee.values()).sort((ve,xe)=>xe.totalSales-ve.totalSales)},le=async()=>{ne(!0);try{const[ee,ve,xe]=await Promise.all([ie.get("/warehouses"),ie.get("/vans"),ie.get("/products")]),oe=xe.data.map(Ie=>({productId:Ie.id,productName:Ie.name,warehouses:ee.data.map(me=>{var At;const ht=(At=Ie.warehouseStock)==null?void 0:At.find(Er=>Er.warehouseId===me.id);return{id:me.id,name:me.name,quantity:(ht==null?void 0:ht.quantity)||0}}),vans:ve.data.map(me=>{var At;const ht=(At=Ie.vanStock)==null?void 0:At.find(Er=>Er.vanId===me.id);return{id:me.id,name:me.name,quantity:(ht==null?void 0:ht.quantity)||0}})}));C(oe)}catch(ee){console.error("Failed to load inventory:",ee)}finally{ne(!1)}},Me=()=>{le(),_(!0)},ut=()=>{var oe,Ie;const ee=Xe(),ve=window.open("","_blank","width=1000,height=800");if(!ve){alert("Please allow popups to print report");return}const xe=`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Sales Report</title>
        <style>
          * { margin: 0; padding: 0; box-sizing: border-box; }
          body { font-family: Arial, sans-serif; font-size: 12px; padding: 20px; }
          .header { text-align: center; margin-bottom: 20px; border-bottom: 2px solid #333; padding-bottom: 10px; }
          .header h1 { font-size: 24px; margin-bottom: 5px; }
          .header p { color: #666; }
          .summary-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-bottom: 20px; }
          .summary-card { border: 1px solid #ddd; padding: 10px; border-radius: 5px; text-align: center; }
          .summary-card .label { font-size: 10px; color: #666; text-transform: uppercase; }
          .summary-card .value { font-size: 18px; font-weight: bold; margin-top: 5px; }
          .summary-card .value.green { color: #22c55e; }
          .summary-card .value.red { color: #ef4444; }
          .summary-card .value.blue { color: #3b82f6; }
          .section { margin-bottom: 20px; }
          .section h2 { font-size: 16px; margin-bottom: 10px; border-bottom: 1px solid #ddd; padding-bottom: 5px; }
          table { width: 100%; border-collapse: collapse; margin-bottom: 15px; }
          th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
          th { background: #f5f5f5; font-weight: bold; }
          .text-right { text-align: right; }
          .text-center { text-align: center; }
          .profit-positive { color: #22c55e; }
          .profit-negative { color: #ef4444; }
          .footer { text-align: center; margin-top: 20px; padding-top: 10px; border-top: 1px solid #ddd; color: #666; font-size: 10px; }
          @media print { body { padding: 0; } }
        </style>
      </head>
      <body>
        <div class="header">
          <h1>Sales Report</h1>
          <p>Period: ${c||"All time"} ${c&&d?" to ":""} ${d||""}</p>
          <p>Generated: ${new Date().toLocaleString()}</p>
        </div>
        
        ${O.showSummary?`
        <div class="summary-grid">
          <div class="summary-card">
            <div class="label">Total Orders</div>
            <div class="value">${Ge}</div>
          </div>
          <div class="summary-card">
            <div class="label">Total Sales</div>
            <div class="value blue">${$e(Ee)}</div>
          </div>
          <div class="summary-card">
            <div class="label">Collected</div>
            <div class="value green">${$e(it)}</div>
          </div>
          <div class="summary-card">
            <div class="label">Debt Collections</div>
            <div class="value">${$e(we)}</div>
          </div>
          <div class="summary-card">
            <div class="label">Outstanding</div>
            <div class="value red">${$e(et)}</div>
          </div>
          <div class="summary-card">
            <div class="label">Returns</div>
            <div class="value red">${$e(pr)}</div>
          </div>
          <div class="summary-card">
            <div class="label">Exchanges</div>
            <div class="value blue">${$e(Zt)}</div>
          </div>
          ${O.showCost?`
          <div class="summary-card">
            <div class="label">Goods Cost</div>
            <div class="value">${$e(Le)}</div>
          </div>
          `:""}
          ${O.showProfit?`
          <div class="summary-card">
            <div class="label">Profit</div>
            <div class="value ${Je>=0?"green":"red"}">${$e(Je)}</div>
          </div>
          `:""}
        </div>
        `:""}
        
        ${O.showProducts?`
        <div class="section">
          <h2>Product Summary</h2>
          <table>
            <thead>
              <tr>
                <th>Product</th>
                <th class="text-center">Qty Sold</th>
                ${O.showCost?'<th class="text-right">Cost</th>':""}
                <th class="text-right">Total Sales</th>
                ${O.showProfit?'<th class="text-right">Profit</th>':""}
              </tr>
            </thead>
            <tbody>
              ${ee.map(me=>`
                <tr>
                  <td>${me.productName}</td>
                  <td class="text-center">${me.totalQuantity}</td>
                  ${O.showCost?`<td class="text-right">${$e(me.totalCost)}</td>`:""}
                  <td class="text-right">${$e(me.totalSales)}</td>
                  ${O.showProfit?`<td class="text-right ${me.profit>=0?"profit-positive":"profit-negative"}">${$e(me.profit)}</td>`:""}
                </tr>
              `).join("")}
            </tbody>
          </table>
        </div>
        `:""}
        
        ${O.showInventory&&R.length>0?`
        <div class="section">
          <h2>Current Inventory</h2>
          <table>
            <thead>
              <tr>
                <th>Product</th>
                ${((oe=R[0])==null?void 0:oe.warehouses.map(me=>`<th class="text-center">${me.name}</th>`).join(""))||""}
                ${((Ie=R[0])==null?void 0:Ie.vans.map(me=>`<th class="text-center">${me.name}</th>`).join(""))||""}
              </tr>
            </thead>
            <tbody>
              ${R.filter(me=>ee.some(ht=>ht.productId===me.productId)).map(me=>`
                <tr>
                  <td>${me.productName}</td>
                  ${me.warehouses.map(ht=>`<td class="text-center">${ht.quantity}</td>`).join("")}
                  ${me.vans.map(ht=>`<td class="text-center">${ht.quantity}</td>`).join("")}
                </tr>
              `).join("")}
            </tbody>
          </table>
        </div>
        `:""}
        
        ${O.showTransactions?`
        <div class="section">
          <h2>Transactions</h2>
          <table>
            <thead>
              <tr>
                <th>Type</th>
                <th>Reference</th>
                <th>Customer</th>
                <th>Driver</th>
                <th>Date</th>
                <th class="text-right">Total</th>
                <th class="text-right">Paid</th>
                <th class="text-right">Debt</th>
              </tr>
            </thead>
            <tbody>
              ${z.slice(0,100).map(me=>`
                <tr>
                  <td>${ze(me.type)}</td>
                  <td>${me.referenceNumber}</td>
                  <td>${me.customerName||"-"}</td>
                  <td>${me.driverName||"-"}</td>
                  <td>${We(me.date)}</td>
                  <td class="text-right">${$e(me.totalAmount)}</td>
                  <td class="text-right">${$e(me.paidAmount)}</td>
                  <td class="text-right">${me.debtAmount>0?$e(me.debtAmount):"-"}</td>
                </tr>
              `).join("")}
            </tbody>
          </table>
          ${z.length>100?`<p style="text-align: center; color: #666;">Showing first 100 of ${z.length} transactions</p>`:""}
        </div>
        `:""}
        
        <div class="footer">
          <p>Catalyst Sales Report - Confidential</p>
        </div>
      </body>
      </html>
    `;ve.document.write(xe),ve.document.close(),ve.onload=()=>{ve.focus(),ve.print()}};return a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Deep Report"}),a.jsx("p",{className:"text-sm text-gray-500",children:"All transactions with returns & exchanges"})]}),a.jsxs("button",{onClick:Me,className:"flex items-center gap-2 px-3 py-1.5 text-sm bg-emerald-600 text-white rounded-lg hover:bg-emerald-700",children:[a.jsx(ua,{size:16}),"Print"]})]}),a.jsxs("div",{className:"grid grid-cols-3 md:grid-cols-5 lg:grid-cols-10 gap-2",children:[a.jsx("div",{className:"bg-white p-3 rounded-lg shadow-sm border",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"p-1.5 bg-blue-100 rounded",children:a.jsx(Yo,{size:16,className:"text-blue-600"})}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-xs text-gray-500 truncate",children:"Orders"}),a.jsx("p",{className:"text-lg font-bold",children:Ge})]})]})}),a.jsx("div",{className:"bg-white p-3 rounded-lg shadow-sm border col-span-2",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"p-1.5 bg-green-100 rounded",children:a.jsx(da,{size:16,className:"text-green-600"})}),a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsx("p",{className:"text-xs text-gray-500 truncate",children:"Sales"}),Object.keys(Nt).length>1?a.jsxs("div",{children:[Object.entries(Nt).map(([ee,ve])=>a.jsxs("p",{className:"text-sm font-bold text-green-600",children:[ee," ",$e(ve)]},ee)),a.jsxs("p",{className:"text-xs text-gray-400 mt-0.5",children:["Base: ",$e(Ee)]})]}):a.jsxs("p",{className:"text-lg font-bold text-green-600",children:[Object.keys(Nt)[0]||""," ",$e(Ee)]})]})]})}),a.jsx("div",{className:"bg-white p-3 rounded-lg shadow-sm border",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"p-1.5 bg-emerald-100 rounded",children:a.jsx(Rh,{size:16,className:"text-emerald-600"})}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-xs text-gray-500 truncate",children:"Collected"}),a.jsx("p",{className:"text-lg font-bold text-emerald-600",children:$e(it)})]})]})}),a.jsx("div",{className:"bg-white p-3 rounded-lg shadow-sm border",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"p-1.5 bg-purple-100 rounded",children:a.jsx(n4,{size:16,className:"text-purple-600"})}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-xs text-gray-500 truncate",children:"Debt Coll."}),a.jsx("p",{className:"text-lg font-bold text-purple-600",children:$e(we)})]})]})}),a.jsx("div",{className:"bg-white p-3 rounded-lg shadow-sm border",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"p-1.5 bg-red-100 rounded",children:a.jsx(Up,{size:16,className:"text-red-600"})}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-xs text-gray-500 truncate",children:"Outstanding"}),a.jsx("p",{className:"text-lg font-bold text-red-600",children:$e(et)})]})]})}),a.jsx("div",{className:"bg-white p-3 rounded-lg shadow-sm border",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"p-1.5 bg-orange-100 rounded",children:a.jsx(ao,{size:16,className:"text-orange-600"})}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-xs text-gray-500 truncate",children:"Returns"}),a.jsx("p",{className:"text-lg font-bold text-orange-600",children:$e(pr)})]})]})}),a.jsx("div",{className:"bg-white p-3 rounded-lg shadow-sm border",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"p-1.5 bg-cyan-100 rounded",children:a.jsx(Tr,{size:16,className:"text-cyan-600"})}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-xs text-gray-500 truncate",children:"Exchanges"}),a.jsx("p",{className:"text-lg font-bold text-cyan-600",children:$e(Zt)})]})]})}),a.jsx("div",{className:"bg-white p-3 rounded-lg shadow-sm border",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"p-1.5 bg-gray-100 rounded",children:a.jsx(tW,{size:16,className:"text-gray-600"})}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-xs text-gray-500 truncate",children:"Cost"}),a.jsx("p",{className:"text-lg font-bold text-gray-600",children:$e(Le)})]})]})}),a.jsx("div",{className:"bg-white p-3 rounded-lg shadow-sm border",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"p-1.5 bg-teal-100 rounded",children:a.jsx(hn,{size:16,className:"text-teal-600"})}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-xs text-gray-500 truncate",children:"Profit"}),a.jsx("p",{className:`text-lg font-bold ${Je>=0?"text-teal-600":"text-red-600"}`,children:$e(Je)})]})]})}),a.jsx("div",{className:"bg-white p-3 rounded-lg shadow-sm border",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"p-1.5 bg-rose-100 rounded",children:a.jsx(Yo,{size:16,className:"text-rose-600"})}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-xs text-gray-500 truncate",children:"Expenses"}),a.jsx("p",{className:"text-lg font-bold text-rose-600",children:$e(W)})]})]})}),a.jsx("div",{className:"bg-white p-3 rounded-lg shadow-sm border",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"p-1.5 bg-indigo-100 rounded",children:a.jsx(so,{size:16,className:"text-indigo-600"})}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-xs text-gray-500 truncate",children:"Salaries Paid"}),a.jsx("p",{className:"text-lg font-bold text-indigo-600",children:$e(H.total)}),a.jsxs("div",{className:"text-xs text-gray-500 mt-1 space-y-0.5",children:[H.salary>0&&a.jsxs("div",{children:["Salary: ",$e(H.salary)]}),H.advance>0&&a.jsxs("div",{children:["Advance: ",$e(H.advance)]}),H.bonus>0&&a.jsxs("div",{children:["Bonus: ",$e(H.bonus)]})]})]})]})}),a.jsx("div",{className:"bg-white p-3 rounded-lg shadow-sm border col-span-2",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"p-1.5 bg-emerald-100 rounded",children:a.jsx(hn,{size:16,className:"text-emerald-600"})}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-xs text-gray-500 truncate",children:"Final Profit"}),a.jsx("p",{className:`text-xl font-bold ${Je-H.total-W>=0?"text-emerald-600":"text-red-600"}`,children:$e(Je-H.total-W)}),a.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Profit - Salaries - Expenses"})]})]})})]}),a.jsx("div",{className:"bg-white p-3 rounded-lg shadow-sm border",children:a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsxs("div",{className:"relative flex-1 min-w-[180px]",children:[a.jsx(Na,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 text-gray-400",size:16}),a.jsx("input",{type:"text",placeholder:"Search ref #, customer, driver...",value:l,onChange:ee=>o(ee.target.value),className:"w-full pl-8 pr-3 py-1.5 text-sm border rounded-lg focus:ring-1 focus:ring-blue-500"})]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(ro,{size:14,className:"text-gray-400"}),a.jsx("input",{type:"date",value:c,onChange:ee=>u(ee.target.value),className:"px-2 py-1.5 text-sm border rounded-lg focus:ring-1 focus:ring-blue-500"}),a.jsx("span",{className:"text-gray-400 text-sm",children:"-"}),a.jsx("input",{type:"date",value:d,onChange:ee=>h(ee.target.value),className:"px-2 py-1.5 text-sm border rounded-lg focus:ring-1 focus:ring-blue-500"})]}),a.jsxs("select",{value:f,onChange:ee=>x(ee.target.value),className:"px-2 py-1.5 text-sm border rounded-lg focus:ring-1 focus:ring-blue-500",children:[a.jsx("option",{value:"",children:"All Types"}),a.jsx("option",{value:"order",children:"POS Sales"}),a.jsx("option",{value:"task",children:"Deliveries"}),a.jsx("option",{value:"collection",children:"Collections"}),a.jsx("option",{value:"return_exchange",children:"Returns/Exch"})]}),a.jsxs("select",{value:p,onChange:ee=>g(ee.target.value),className:"px-2 py-1.5 text-sm border rounded-lg focus:ring-1 focus:ring-blue-500",children:[a.jsx("option",{value:"",children:"All Drivers"}),r.map(ee=>a.jsx("option",{value:ee.id,children:ee.name},ee.id))]})]})}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border overflow-hidden",children:[n?a.jsx("div",{className:"flex items-center justify-center py-12",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):de.length===0?a.jsxs("div",{className:"text-center py-12 text-gray-500",children:[a.jsx(Yo,{size:48,className:"mx-auto mb-4 opacity-50"}),a.jsx("p",{children:"No sales found"})]}):a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50 border-b",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-gray-600",children:"Type"}),a.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-gray-600",children:"Reference #"}),a.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-gray-600",children:"Customer"}),a.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-gray-600",children:"Driver"}),a.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-gray-600",children:"Date"}),a.jsx("th",{className:"text-right px-4 py-3 text-sm font-medium text-gray-600",children:"Total"}),a.jsx("th",{className:"text-right px-4 py-3 text-sm font-medium text-gray-600",children:"Paid"}),a.jsx("th",{className:"text-right px-4 py-3 text-sm font-medium text-gray-600",children:"Debt"}),a.jsx("th",{className:"text-center px-4 py-3 text-sm font-medium text-gray-600",children:"Payment"}),a.jsx("th",{className:"text-center px-4 py-3 text-sm font-medium text-gray-600",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y",children:de.map(ee=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3",children:a.jsxs("div",{className:"flex items-center gap-2",children:[D(ee.type),a.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${Fe(ee.type)}`,children:ze(ee.type)})]})}),a.jsx("td",{className:"px-4 py-3",children:a.jsx("span",{className:"font-medium text-blue-600",children:ee.referenceNumber})}),a.jsx("td",{className:"px-4 py-3",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Sy,{size:16,className:"text-gray-400"}),a.jsx("span",{children:ee.customerName||"-"})]})}),a.jsx("td",{className:"px-4 py-3",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(On,{size:16,className:"text-gray-400"}),a.jsx("span",{children:ee.driverName||"-"})]})}),a.jsx("td",{className:"px-4 py-3 text-gray-600",children:We(ee.date)}),a.jsx("td",{className:"px-4 py-3 text-right font-medium",children:$e(ee.totalAmount)}),a.jsx("td",{className:"px-4 py-3 text-right text-green-600",children:$e(ee.paidAmount)}),a.jsx("td",{className:"px-4 py-3 text-right text-orange-600",children:ee.debtAmount>0?$e(ee.debtAmount):"-"}),a.jsxs("td",{className:"px-4 py-3 text-center",children:[a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${ct(ee.paymentType)}`,children:ee.paymentType}),ee.paymentCurrencies&&ee.paymentCurrencies.length>0&&a.jsx("div",{className:"mt-1 text-xs text-gray-500",children:ee.paymentCurrencies.map(ve=>`${ve.currency} ${ve.amount.toFixed(0)}`).join(" + ")})]}),a.jsx("td",{className:"px-4 py-3 text-center",children:a.jsxs("div",{className:"flex items-center justify-center gap-1",children:[a.jsx("button",{onClick:()=>F(ee),className:"p-2 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg",title:"View",children:a.jsx(gs,{size:18})}),a.jsx("button",{onClick:()=>he(ee),className:"p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg",title:"Delete",children:a.jsx(xr,{size:18})})]})})]},`${ee.type}-${ee.id}`))})]}),A>1&&a.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-t bg-gray-50",children:[a.jsxs("p",{className:"text-sm text-gray-600",children:["Showing ",(w-1)*N+1," to ",Math.min(w*N,z.length)," of ",z.length]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>k(ee=>Math.max(1,ee-1)),disabled:w===1,className:"p-2 rounded-lg hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed",children:a.jsx(iW,{size:18})}),a.jsxs("span",{className:"px-3 py-1 bg-white border rounded-lg",children:[w," / ",A]}),a.jsx("button",{onClick:()=>k(ee=>Math.min(A,ee+1)),disabled:w===A,className:"p-2 rounded-lg hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed",children:a.jsx(K6,{size:18})})]})]})]}),y&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-auto",children:[a.jsx("div",{className:"p-6 border-b",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[D(y.type),a.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${Fe(y.type)}`,children:ze(y.type)})]}),a.jsx("h2",{className:"text-xl font-bold",children:y.referenceNumber})]}),a.jsx("button",{onClick:()=>v(null),className:"p-2 hover:bg-gray-100 rounded-lg",children:""})]})}),a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Customer"}),a.jsx("p",{className:"font-medium",children:y.customerName||"-"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Driver"}),a.jsx("p",{className:"font-medium",children:y.driverName||"-"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Date"}),a.jsx("p",{className:"font-medium",children:We(y.date)})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Payment Type"}),a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${ct(y.paymentType)}`,children:y.paymentType})]})]}),(y.items.length>0||j)&&a.jsxs("div",{children:[a.jsxs("h3",{className:"font-medium mb-3 flex items-center gap-2",children:[a.jsx(Tr,{size:18}),"Items"]}),j?a.jsx("div",{className:"flex items-center justify-center py-4",children:a.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"})}):a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-left px-3 py-2",children:"Product"}),a.jsx("th",{className:"text-center px-3 py-2",children:"Qty"}),a.jsx("th",{className:"text-right px-3 py-2",children:"Price"}),a.jsx("th",{className:"text-right px-3 py-2",children:"Total"})]})}),a.jsx("tbody",{className:"divide-y",children:y.items.map(ee=>a.jsxs("tr",{children:[a.jsx("td",{className:"px-3 py-2",children:ee.productName}),a.jsxs("td",{className:"px-3 py-2 text-center",children:[ee.quantity," ",ee.unitType]}),a.jsxs("td",{className:"px-3 py-2 text-right",children:[ee.currency||""," ",$e(ee.unitPrice)]}),a.jsxs("td",{className:"px-3 py-2 text-right font-medium",children:[ee.currency||""," ",$e(ee.total)]})]},ee.id))})]})]}),a.jsxs("div",{className:"border-t pt-4",children:[a.jsxs("div",{className:"flex justify-between py-1",children:[a.jsx("span",{className:"text-gray-600",children:"Total Amount"}),a.jsx("span",{className:"font-bold text-lg",children:$e(y.totalAmount)})]}),a.jsxs("div",{className:"flex justify-between py-1",children:[a.jsx("span",{className:"text-gray-600",children:"Paid (Cash)"}),a.jsx("span",{className:"text-green-600 font-medium",children:$e(y.paidAmount)})]}),y.debtAmount>0&&a.jsxs("div",{className:"flex justify-between py-1",children:[a.jsx("span",{className:"text-gray-600",children:"On Credit"}),a.jsx("span",{className:"text-orange-600 font-medium",children:$e(y.debtAmount)})]})]}),y.paymentCurrencies&&y.paymentCurrencies.length>0&&a.jsxs("div",{className:"bg-blue-50 rounded-lg p-3 border border-blue-200",children:[a.jsx("p",{className:"text-xs font-semibold text-blue-700 uppercase mb-2",children:"Paid With"}),a.jsx("div",{className:"space-y-1",children:y.paymentCurrencies.map((ee,ve)=>a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-gray-700",children:ee.currency}),a.jsxs("span",{className:"font-medium",children:[ee.currency," ",ee.amount.toFixed(3)]})]},ve))}),y.exchangeRateSnapshot&&a.jsx("div",{className:"mt-2 pt-2 border-t border-blue-200 text-xs text-blue-600",children:Object.entries(y.exchangeRateSnapshot).map(([ee,ve])=>a.jsxs("span",{className:"mr-3",children:["1 base = ",ve," ",ee]},ee))})]}),y.notes&&a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Notes"}),a.jsx("p",{className:"text-gray-700",children:y.notes})]}),a.jsx("div",{className:"pt-4 border-t",children:a.jsxs("button",{onClick:()=>ye(y),className:"w-full px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center justify-center gap-2 font-medium",children:[a.jsx(ua,{size:18}),"Print Invoice"]})})]})]})}),S&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-lg w-full mx-4 max-h-[90vh] overflow-auto",children:[a.jsx("div",{className:"p-6 border-b",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Br,{size:24,className:"text-emerald-600"}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-bold",children:"Print Sales Report"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Select what to include in the report"})]})]}),a.jsx("button",{onClick:()=>_(!1),className:"p-2 hover:bg-gray-100 rounded-lg",children:a.jsx(yt,{size:20})})]})}),a.jsxs("div",{className:"p-6 space-y-4",children:[a.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[a.jsxs("p",{className:"text-sm text-gray-600",children:[a.jsx("strong",{children:"Period:"})," ",c||"All time"," ",c&&d?" to ":""," ",d||""]}),a.jsxs("p",{className:"text-sm text-gray-600",children:[a.jsx("strong",{children:"Transactions:"})," ",z.length]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("h3",{className:"font-medium text-gray-700",children:"Include in Report:"}),a.jsxs("label",{className:"flex items-center gap-3 p-3 bg-white border rounded-lg cursor-pointer hover:bg-gray-50",children:[a.jsx("input",{type:"checkbox",checked:O.showSummary,onChange:ee=>E({...O,showSummary:ee.target.checked}),className:"w-5 h-5 text-emerald-600 rounded"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-medium",children:"Summary Cards"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Total transactions, sales, collected, outstanding"})]}),O.showSummary&&a.jsx(Jt,{size:18,className:"text-emerald-600"})]}),a.jsxs("label",{className:"flex items-center gap-3 p-3 bg-white border rounded-lg cursor-pointer hover:bg-gray-50",children:[a.jsx("input",{type:"checkbox",checked:O.showProducts,onChange:ee=>E({...O,showProducts:ee.target.checked}),className:"w-5 h-5 text-emerald-600 rounded"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-medium",children:"Product Summary"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Items sold with quantities and totals"})]}),O.showProducts&&a.jsx(Jt,{size:18,className:"text-emerald-600"})]}),a.jsxs("label",{className:"flex items-center gap-3 p-3 bg-white border rounded-lg cursor-pointer hover:bg-gray-50",children:[a.jsx("input",{type:"checkbox",checked:O.showCost,onChange:ee=>E({...O,showCost:ee.target.checked}),className:"w-5 h-5 text-emerald-600 rounded"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-medium",children:"Goods Cost"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Cost price for each product"})]}),O.showCost&&a.jsx(Jt,{size:18,className:"text-emerald-600"})]}),a.jsxs("label",{className:"flex items-center gap-3 p-3 bg-white border rounded-lg cursor-pointer hover:bg-gray-50",children:[a.jsx("input",{type:"checkbox",checked:O.showProfit,onChange:ee=>E({...O,showProfit:ee.target.checked}),className:"w-5 h-5 text-emerald-600 rounded"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-medium",children:"Profit"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Profit margins for each product"})]}),O.showProfit&&a.jsx(Jt,{size:18,className:"text-emerald-600"})]}),a.jsxs("label",{className:"flex items-center gap-3 p-3 bg-white border rounded-lg cursor-pointer hover:bg-gray-50",children:[a.jsx("input",{type:"checkbox",checked:O.showInventory,onChange:ee=>E({...O,showInventory:ee.target.checked}),className:"w-5 h-5 text-emerald-600 rounded"}),a.jsxs("div",{className:"flex-1 flex items-center gap-2",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:"Current Inventory"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Stock levels in warehouses and vans"})]}),I&&a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-emerald-600"})]}),O.showInventory&&a.jsx(Jt,{size:18,className:"text-emerald-600"})]}),a.jsxs("label",{className:"flex items-center gap-3 p-3 bg-white border rounded-lg cursor-pointer hover:bg-gray-50",children:[a.jsx("input",{type:"checkbox",checked:O.showTransactions,onChange:ee=>E({...O,showTransactions:ee.target.checked}),className:"w-5 h-5 text-emerald-600 rounded"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-medium",children:"Transaction List"}),a.jsx("p",{className:"text-sm text-gray-500",children:"All individual transactions (max 100)"})]}),O.showTransactions&&a.jsx(Jt,{size:18,className:"text-emerald-600"})]})]})]}),a.jsxs("div",{className:"p-6 border-t bg-gray-50 flex gap-3",children:[a.jsx("button",{onClick:()=>_(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-100",children:"Cancel"}),a.jsxs("button",{onClick:()=>{ut(),_(!1)},className:"flex-1 px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 flex items-center justify-center gap-2",children:[a.jsx(ua,{size:18}),"Print Report"]})]})]})})]})}const Cve={present:"bg-green-100 text-green-800",absent:"bg-red-100 text-red-800",late:"bg-yellow-100 text-yellow-800",half_day:"bg-orange-100 text-orange-800",leave:"bg-blue-100 text-blue-800"},Bm={present:"Present",absent:"Absent",late:"Late",half_day:"Half Day",leave:"Leave"};function Eve(){const[e,t]=m.useState("daily"),[r,s]=m.useState([]),[n,i]=m.useState([]),[l,o]=m.useState([]),[c,u]=m.useState(!0),[d,h]=m.useState(!1),[f,x]=m.useState(new Date().toISOString().split("T")[0]),[p,g]=m.useState(new Date(new Date().setDate(1)).toISOString().split("T")[0]),[y,v]=m.useState(new Date().toISOString().split("T")[0]),[j,b]=m.useState(""),[w,k]=m.useState(""),[N,S]=m.useState(!1),[_,O]=m.useState(!1),[E,R]=m.useState(null),[C,I]=m.useState({employeeId:0,date:new Date().toISOString().split("T")[0],checkIn:"",checkOut:"",status:"present",notes:"",overtimeHours:0}),[ne,W]=m.useState(new Date().toISOString().split("T")[0]),[Q,H]=m.useState([]);m.useEffect(()=>{K()},[]),m.useEffect(()=>{e==="daily"?q():ge()},[e,f,p,y,j,w]);const K=async()=>{try{const A=await Oc.getEmployees();s(A.data)}catch(A){console.error("Failed to load employees:",A)}},q=async()=>{try{u(!0);const A={};f&&(A.startDate=f,A.endDate=f),j&&(A.employeeId=j),w&&(A.status=w);const de=await Oc.getAll(A);i(de.data)}catch(A){console.error("Failed to load attendances:",A)}finally{u(!1)}},ge=async()=>{try{u(!0);const A=await Oc.getSummary({startDate:p,endDate:y});o(A.data)}catch(A){console.error("Failed to load summary:",A)}finally{u(!1)}},G=()=>{I({employeeId:0,date:f,checkIn:"",checkOut:"",status:"present",notes:"",overtimeHours:0}),R(null)},B=()=>{G(),I(A=>({...A,date:f})),S(!0)},se=A=>{var de,D;R(A),I({employeeId:A.employeeId,date:A.date.split("T")[0],checkIn:A.checkIn&&((de=A.checkIn.split("T")[1])==null?void 0:de.substring(0,5))||"",checkOut:A.checkOut&&((D=A.checkOut.split("T")[1])==null?void 0:D.substring(0,5))||"",status:A.status,notes:A.notes||"",overtimeHours:A.overtimeHours}),S(!0)},L=async A=>{var de,D;if(A.preventDefault(),!C.employeeId){alert("Please select an employee");return}h(!0);try{const ze={employeeId:C.employeeId,date:C.date,checkIn:C.checkIn?`${C.date}T${C.checkIn}:00`:null,checkOut:C.checkOut?`${C.date}T${C.checkOut}:00`:null,status:C.status,notes:C.notes||null,overtimeHours:C.overtimeHours};E?await Oc.update(E.id,ze):await Oc.create(ze),S(!1),q()}catch(ze){alert(((D=(de=ze.response)==null?void 0:de.data)==null?void 0:D.message)||"Failed to save attendance")}finally{h(!1)}},Z=async A=>{if(confirm("Are you sure you want to delete this attendance record?"))try{await Oc.delete(A),q()}catch{alert("Failed to delete attendance record")}},F=()=>{W(f),H(r.map(A=>({employeeId:A.id,status:"present",checkIn:"09:00",checkOut:"17:00",notes:""}))),O(!0)},he=async()=>{var A,de;h(!0);try{const D=Q.map(ze=>({employeeId:ze.employeeId,date:ne,checkIn:ze.checkIn?`${ne}T${ze.checkIn}:00`:null,checkOut:ze.checkOut?`${ne}T${ze.checkOut}:00`:null,status:ze.status,notes:ze.notes||null,overtimeHours:0}));await Oc.createBulk(D),O(!1),q()}catch(D){alert(((de=(A=D.response)==null?void 0:A.data)==null?void 0:de.message)||"Failed to save bulk attendance")}finally{h(!1)}},ye=(A,de,D)=>{H(ze=>ze.map(Fe=>Fe.employeeId===A?{...Fe,[de]:D}:Fe))},z=A=>A?new Date(A).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0}):"-";return a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Attendance Management"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("button",{onClick:F,className:"flex items-center gap-2 px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600",children:[a.jsx(ro,{size:20}),"Mark Bulk Attendance"]}),a.jsxs("button",{onClick:B,className:"flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600",children:[a.jsx(hr,{size:20}),"Add Record"]})]})]}),a.jsxs("div",{className:"flex gap-4 mb-6 border-b",children:[a.jsx("button",{onClick:()=>t("daily"),className:`pb-2 px-4 font-medium ${e==="daily"?"text-blue-600 border-b-2 border-blue-600":"text-gray-500"}`,children:"Daily Attendance"}),a.jsx("button",{onClick:()=>t("summary"),className:`pb-2 px-4 font-medium ${e==="summary"?"text-blue-600 border-b-2 border-blue-600":"text-gray-500"}`,children:"Summary Report"})]}),a.jsx("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:a.jsx("div",{className:"flex flex-wrap gap-4 items-end",children:e==="daily"?a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),a.jsx("input",{type:"date",value:f,onChange:A=>x(A.target.value),className:"px-3 py-2 border rounded-lg"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Employee"}),a.jsxs("select",{value:j,onChange:A=>b(A.target.value?parseInt(A.target.value):""),className:"px-3 py-2 border rounded-lg min-w-[150px]",children:[a.jsx("option",{value:"",children:"All Employees"}),r.map(A=>a.jsx("option",{value:A.id,children:A.name},A.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),a.jsxs("select",{value:w,onChange:A=>k(A.target.value),className:"px-3 py-2 border rounded-lg min-w-[120px]",children:[a.jsx("option",{value:"",children:"All Status"}),Object.entries(Bm).map(([A,de])=>a.jsx("option",{value:A,children:de},A))]})]})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date"}),a.jsx("input",{type:"date",value:p,onChange:A=>g(A.target.value),className:"px-3 py-2 border rounded-lg"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date"}),a.jsx("input",{type:"date",value:y,onChange:A=>v(A.target.value),className:"px-3 py-2 border rounded-lg"})]})]})})}),c?a.jsx("div",{className:"flex justify-center py-12",children:a.jsx(vt,{className:"animate-spin text-blue-500",size:40})}):e==="daily"?a.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Employee"}),a.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Role"}),a.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Status"}),a.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Check In"}),a.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Check Out"}),a.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Hours"}),a.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Overtime"}),a.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Notes"}),a.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:n.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:9,className:"px-4 py-8 text-center text-gray-500",children:"No attendance records found for this date"})}):n.map(A=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 font-medium",children:A.employeeName}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:A.employeeRole||"-"}),a.jsx("td",{className:"px-4 py-3",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${Cve[A.status]||"bg-gray-100 text-gray-800"}`,children:Bm[A.status]||A.status})}),a.jsx("td",{className:"px-4 py-3 text-sm",children:z(A.checkIn)}),a.jsx("td",{className:"px-4 py-3 text-sm",children:z(A.checkOut)}),a.jsx("td",{className:"px-4 py-3 text-sm",children:A.workedHours>0?`${A.workedHours}h`:"-"}),a.jsx("td",{className:"px-4 py-3 text-sm",children:A.overtimeHours>0?`${A.overtimeHours}h`:"-"}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-600 max-w-[150px] truncate",children:A.notes||"-"}),a.jsx("td",{className:"px-4 py-3",children:a.jsxs("div",{className:"flex justify-center gap-2",children:[a.jsx("button",{onClick:()=>se(A),className:"p-1 text-amber-600 hover:bg-amber-50 rounded",children:a.jsx(js,{size:16})}),a.jsx("button",{onClick:()=>Z(A.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",children:a.jsx(xr,{size:16})})]})})]},A.id))})]})}):a.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Employee"}),a.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Role"}),a.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"Total Days"}),a.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"Present"}),a.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"Absent"}),a.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"Late"}),a.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"Half Day"}),a.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"Leave"}),a.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"Hours Worked"}),a.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"Overtime"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:l.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:10,className:"px-4 py-8 text-center text-gray-500",children:"No attendance records found for this period"})}):l.map(A=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 font-medium",children:A.employeeName}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:A.employeeRole||"-"}),a.jsx("td",{className:"px-4 py-3 text-center",children:A.totalDays}),a.jsx("td",{className:"px-4 py-3 text-center text-green-600 font-medium",children:A.presentDays}),a.jsx("td",{className:"px-4 py-3 text-center text-red-600 font-medium",children:A.absentDays}),a.jsx("td",{className:"px-4 py-3 text-center text-yellow-600 font-medium",children:A.lateDays}),a.jsx("td",{className:"px-4 py-3 text-center text-orange-600 font-medium",children:A.halfDays}),a.jsx("td",{className:"px-4 py-3 text-center text-blue-600 font-medium",children:A.leaveDays}),a.jsxs("td",{className:"px-4 py-3 text-center",children:[A.totalWorkedHours.toFixed(1),"h"]}),a.jsxs("td",{className:"px-4 py-3 text-center",children:[A.totalOvertimeHours.toFixed(1),"h"]})]},A.employeeId))})]})}),N&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-4",children:[a.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[a.jsx("h2",{className:"text-lg font-semibold",children:E?"Edit Attendance":"Add Attendance Record"}),a.jsx("button",{onClick:()=>S(!1),className:"text-gray-500 hover:text-gray-700",children:a.jsx(yt,{size:20})})]}),a.jsxs("form",{onSubmit:L,className:"p-4 space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Employee *"}),a.jsxs("select",{value:C.employeeId,onChange:A=>I({...C,employeeId:parseInt(A.target.value)}),className:"w-full px-3 py-2 border rounded-lg",required:!0,disabled:!!E,children:[a.jsx("option",{value:0,children:"Select Employee"}),r.map(A=>a.jsx("option",{value:A.id,children:A.name},A.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date *"}),a.jsx("input",{type:"date",value:C.date,onChange:A=>I({...C,date:A.target.value}),className:"w-full px-3 py-2 border rounded-lg",required:!0,disabled:!!E})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status *"}),a.jsx("select",{value:C.status,onChange:A=>I({...C,status:A.target.value}),className:"w-full px-3 py-2 border rounded-lg",required:!0,children:Object.entries(Bm).map(([A,de])=>a.jsx("option",{value:A,children:de},A))})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Check In"}),a.jsx("input",{type:"time",value:C.checkIn,onChange:A=>I({...C,checkIn:A.target.value}),className:"w-full px-3 py-2 border rounded-lg"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Check Out"}),a.jsx("input",{type:"time",value:C.checkOut,onChange:A=>I({...C,checkOut:A.target.value}),className:"w-full px-3 py-2 border rounded-lg"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Overtime Hours"}),a.jsx("input",{type:"number",step:"0.5",min:"0",value:C.overtimeHours,onChange:A=>I({...C,overtimeHours:parseFloat(A.target.value)||0}),className:"w-full px-3 py-2 border rounded-lg"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),a.jsx("textarea",{value:C.notes,onChange:A=>I({...C,notes:A.target.value}),className:"w-full px-3 py-2 border rounded-lg",rows:2})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>S(!1),className:"flex-1 px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:d,className:"flex-1 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50",children:d?a.jsx(vt,{className:"animate-spin mx-auto",size:20}):"Save"})]})]})]})}),_&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl mx-4 max-h-[90vh] overflow-hidden flex flex-col",children:[a.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[a.jsx("h2",{className:"text-lg font-semibold",children:"Mark Bulk Attendance"}),a.jsx("button",{onClick:()=>O(!1),className:"text-gray-500 hover:text-gray-700",children:a.jsx(yt,{size:20})})]}),a.jsxs("div",{className:"p-4 border-b",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),a.jsx("input",{type:"date",value:ne,onChange:A=>W(A.target.value),className:"px-3 py-2 border rounded-lg"})]}),a.jsx("div",{className:"flex-1 overflow-auto p-4",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50 sticky top-0",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-2 text-left text-sm font-semibold",children:"Employee"}),a.jsx("th",{className:"px-3 py-2 text-left text-sm font-semibold",children:"Status"}),a.jsx("th",{className:"px-3 py-2 text-left text-sm font-semibold",children:"Check In"}),a.jsx("th",{className:"px-3 py-2 text-left text-sm font-semibold",children:"Check Out"}),a.jsx("th",{className:"px-3 py-2 text-left text-sm font-semibold",children:"Notes"})]})}),a.jsx("tbody",{className:"divide-y",children:Q.map(A=>{const de=r.find(D=>D.id===A.employeeId);return a.jsxs("tr",{children:[a.jsx("td",{className:"px-3 py-2 font-medium",children:de==null?void 0:de.name}),a.jsx("td",{className:"px-3 py-2",children:a.jsx("select",{value:A.status,onChange:D=>ye(A.employeeId,"status",D.target.value),className:"px-2 py-1 border rounded text-sm w-full",children:Object.entries(Bm).map(([D,ze])=>a.jsx("option",{value:D,children:ze},D))})}),a.jsx("td",{className:"px-3 py-2",children:a.jsx("input",{type:"time",value:A.checkIn,onChange:D=>ye(A.employeeId,"checkIn",D.target.value),className:"px-2 py-1 border rounded text-sm w-full",disabled:A.status==="absent"||A.status==="leave"})}),a.jsx("td",{className:"px-3 py-2",children:a.jsx("input",{type:"time",value:A.checkOut,onChange:D=>ye(A.employeeId,"checkOut",D.target.value),className:"px-2 py-1 border rounded text-sm w-full",disabled:A.status==="absent"||A.status==="leave"})}),a.jsx("td",{className:"px-3 py-2",children:a.jsx("input",{type:"text",value:A.notes,onChange:D=>ye(A.employeeId,"notes",D.target.value),className:"px-2 py-1 border rounded text-sm w-full",placeholder:"Notes..."})})]},A.employeeId)})})]})}),a.jsxs("div",{className:"flex gap-3 p-4 border-t",children:[a.jsx("button",{onClick:()=>O(!1),className:"flex-1 px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{onClick:he,disabled:d,className:"flex-1 px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 disabled:opacity-50",children:d?a.jsx(vt,{className:"animate-spin mx-auto",size:20}):"Save All Attendance"})]})]})})]})}function Pve(){const[e,t]=m.useState([]),[r,s]=m.useState([]),[n,i]=m.useState(!0),[l,o]=m.useState(!1),[c,u]=m.useState(""),[d,h]=m.useState(!1),[f,x]=m.useState(null),[p,g]=m.useState(!1),[y,v]=m.useState(null),[j,b]=m.useState([]),[w,k]=m.useState(!1),[N,S]=m.useState({code:"",name:"",description:"",unit:"Unit",costPrice:0,lowStockAlert:10}),[_,O]=m.useState({warehouseId:"",quantity:0,adjustmentType:"set"});m.useEffect(()=>{E()},[]);const E=async()=>{try{i(!0);const[K,q]=await Promise.all([Tl.getAll(),Ks.getAll()]);t(K),s(q.data)}catch(K){console.error("Failed to load data:",K)}finally{i(!1)}},R=e.filter(K=>{var ge;if(!c)return!0;const q=c.toLowerCase();return K.name.toLowerCase().includes(q)||((ge=K.code)==null?void 0:ge.toLowerCase().includes(q))}),C=()=>{S({code:"",name:"",description:"",unit:"Unit",costPrice:0,lowStockAlert:10})},I=K=>{x(K),S({code:K.code||"",name:K.name,description:K.description||"",unit:K.unit,costPrice:K.costPrice,lowStockAlert:K.lowStockAlert}),h(!0)},ne=async K=>{var q,ge;if(K.preventDefault(),!!N.name.trim()){o(!0);try{f?await Tl.update(f.id,N):await Tl.create(N),await E(),h(!1),C(),x(null)}catch(G){alert(((ge=(q=G.response)==null?void 0:q.data)==null?void 0:ge.message)||"Failed to save")}finally{o(!1)}}},W=async K=>{var q;if(confirm("Delete this raw material?"))try{await Tl.delete(K),t(e.filter(ge=>ge.id!==K))}catch(ge){alert(((q=ge.response)==null?void 0:q.data)||"Failed to delete")}},Q=async K=>{v(K),g(!0),k(!0),O({warehouseId:"",quantity:0,adjustmentType:"set"});try{const q=await Tl.getInventory(K.id);b(q)}catch(q){console.error("Failed to load inventory:",q)}finally{k(!1)}},H=async()=>{var K;if(!(!y||!_.warehouseId))try{await Tl.adjustInventory(y.id,{warehouseId:parseInt(_.warehouseId),quantity:_.quantity,adjustmentType:_.adjustmentType});const q=await Tl.getInventory(y.id);b(q),await E(),O({warehouseId:"",quantity:0,adjustmentType:"set"})}catch(q){alert(((K=q.response)==null?void 0:K.data)||"Failed to adjust inventory")}};return n?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx(vt,{className:"animate-spin",size:32})}):a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[a.jsx(Tr,{className:"text-orange-600"})," Raw Materials"]}),a.jsxs("button",{onClick:()=>{C(),x(null),h(!0)},className:"flex items-center gap-2 px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600",children:[a.jsx(hr,{size:20})," Add Raw Material"]})]}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 mb-6",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("div",{className:"flex-1 relative",children:[a.jsx(Na,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:20}),a.jsx("input",{type:"text",placeholder:"Search by name or code...",value:c,onChange:K=>u(K.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg"})]}),a.jsxs("div",{className:"text-sm text-gray-600",children:["Showing ",a.jsx("strong",{children:R.length})," of ",e.length," materials"]})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50 border-b",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-gray-700",children:"Code"}),a.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-gray-700",children:"Name"}),a.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-gray-700",children:"Unit"}),a.jsx("th",{className:"text-right px-4 py-3 text-sm font-medium text-gray-700",children:"Cost Price"}),a.jsx("th",{className:"text-right px-4 py-3 text-sm font-medium text-gray-700",children:"Stock"}),a.jsx("th",{className:"text-center px-4 py-3 text-sm font-medium text-gray-700",children:"Status"}),a.jsx("th",{className:"text-center px-4 py-3 text-sm font-medium text-gray-700",children:"Actions"})]})}),a.jsxs("tbody",{className:"divide-y",children:[R.map(K=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 text-sm font-mono text-gray-600",children:K.code||"-"}),a.jsxs("td",{className:"px-4 py-3",children:[a.jsx("div",{className:"font-medium text-gray-900",children:K.name}),K.description&&a.jsx("div",{className:"text-xs text-gray-500",children:K.description})]}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:K.unit}),a.jsxs("td",{className:"px-4 py-3 text-sm text-right font-medium",children:["$",K.costPrice.toFixed(3)]}),a.jsx("td",{className:"px-4 py-3 text-right",children:a.jsxs("button",{onClick:()=>Q(K),className:"inline-flex items-center gap-1 text-sm font-medium hover:text-orange-600",children:[K.totalStock<=K.lowStockAlert&&a.jsx(c0,{size:14,className:"text-red-500"}),a.jsx("span",{className:K.totalStock<=K.lowStockAlert?"text-red-600":"text-gray-900",children:K.totalStock}),a.jsx(gl,{size:14,className:"text-gray-400"})]})}),a.jsx("td",{className:"px-4 py-3 text-center",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${K.isActive?"bg-green-100 text-green-700":"bg-gray-100 text-gray-600"}`,children:K.isActive?"Active":"Inactive"})}),a.jsx("td",{className:"px-4 py-3",children:a.jsxs("div",{className:"flex items-center justify-center gap-2",children:[a.jsx("button",{onClick:()=>I(K),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",children:a.jsx(js,{size:18})}),a.jsx("button",{onClick:()=>W(K.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",children:a.jsx(xr,{size:18})})]})})]},K.id)),R.length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"px-4 py-8 text-center text-gray-500",children:"No raw materials found"})})]})]})}),d&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-lg overflow-hidden",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-orange-500 text-white",children:[a.jsx("h2",{className:"text-lg font-semibold",children:f?"Edit Raw Material":"Add Raw Material"}),a.jsx("button",{onClick:()=>h(!1),children:a.jsx(yt,{size:24})})]}),a.jsxs("form",{onSubmit:ne,className:"p-6 space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Code"}),a.jsx("input",{type:"text",value:N.code,onChange:K=>S({...N,code:K.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"Auto-generated"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Unit"}),a.jsx("input",{type:"text",value:N.unit,onChange:K=>S({...N,unit:K.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name *"}),a.jsx("input",{type:"text",value:N.name,onChange:K=>S({...N,name:K.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),a.jsx("textarea",{value:N.description,onChange:K=>S({...N,description:K.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",rows:2})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cost Price"}),a.jsx("input",{type:"number",step:"0.001",value:N.costPrice,onChange:K=>S({...N,costPrice:parseFloat(K.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Low Stock Alert"}),a.jsx("input",{type:"number",value:N.lowStockAlert,onChange:K=>S({...N,lowStockAlert:parseFloat(K.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>h(!1),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:l,className:"flex-1 px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 disabled:opacity-50",children:l?a.jsx(vt,{className:"animate-spin mx-auto",size:20}):f?"Update":"Create"})]})]})]})}),p&&y&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-2xl overflow-hidden",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-blue-600 text-white",children:[a.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[a.jsx(gl,{size:24})," Inventory: ",y.name]}),a.jsx("button",{onClick:()=>g(!1),children:a.jsx(yt,{size:24})})]}),a.jsx("div",{className:"p-6",children:w?a.jsx("div",{className:"flex justify-center py-8",children:a.jsx(vt,{className:"animate-spin",size:32})}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:"Stock by Warehouse"}),j.length===0?a.jsx("p",{className:"text-gray-500 text-sm",children:"No inventory records"}):a.jsx("div",{className:"space-y-2",children:j.map(K=>a.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[a.jsx("span",{className:"font-medium",children:K.warehouseName}),a.jsxs("span",{className:"text-lg font-bold text-gray-900",children:[K.quantity," ",y.unit]})]},K.id))})]}),a.jsxs("div",{className:"border-t pt-4",children:[a.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:"Adjust Inventory"}),a.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[a.jsxs("select",{value:_.warehouseId,onChange:K=>O({..._,warehouseId:K.target.value}),className:"px-3 py-2 border border-gray-300 rounded-lg",children:[a.jsx("option",{value:"",children:"Select Warehouse"}),r.map(K=>a.jsx("option",{value:K.id,children:K.name},K.id))]}),a.jsxs("select",{value:_.adjustmentType,onChange:K=>O({..._,adjustmentType:K.target.value}),className:"px-3 py-2 border border-gray-300 rounded-lg",children:[a.jsx("option",{value:"set",children:"Set to"}),a.jsx("option",{value:"add",children:"Add"}),a.jsx("option",{value:"subtract",children:"Subtract"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("input",{type:"number",step:"0.01",value:_.quantity,onChange:K=>O({..._,quantity:parseFloat(K.target.value)||0}),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg",placeholder:"Qty"}),a.jsx("button",{onClick:H,disabled:!_.warehouseId,className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50",children:"Apply"})]})]})]})]})})]})})]})}function Ave(){const[e,t]=m.useState([]),[r,s]=m.useState([]),[n,i]=m.useState([]),[l,o]=m.useState([]),[c,u]=m.useState(!0),[d,h]=m.useState(!1),[f,x]=m.useState(""),[p,g]=m.useState(""),[y,v]=m.useState(!1),[j,b]=m.useState(!1),[w,k]=m.useState(null),[N,S]=m.useState(!1),[_,O]=m.useState({supplierId:"",supplierName:"",supplierContact:"",purchaseDate:new Date().toISOString().split("T")[0],dueDate:"",taxAmount:0,discountAmount:0,shippingCost:0,paidAmount:0,notes:"",reference:""}),[E,R]=m.useState([]),[C,I]=m.useState({rawMaterialId:"",warehouseId:"",quantity:1,unitPrice:0,taxAmount:0,discountAmount:0});m.useEffect(()=>{ne()},[]);const ne=async()=>{try{u(!0);const[F,he,ye,z]=await Promise.all([dl.getAll(),Tl.getAll({isActive:!0}),Ks.getAll(),Vr.getAll({isActive:!0})]);t(F),s(he),i(ye.data),o(z.data||z)}catch(F){console.error("Failed to load data:",F)}finally{u(!1)}},W=e.filter(F=>{var he;if(p&&F.paymentStatus!==p)return!1;if(f){const ye=f.toLowerCase();return F.purchaseNumber.toLowerCase().includes(ye)||((he=F.supplierName)==null?void 0:he.toLowerCase().includes(ye))}return!0}),Q=()=>{O({supplierId:"",supplierName:"",supplierContact:"",purchaseDate:new Date().toISOString().split("T")[0],dueDate:"",taxAmount:0,discountAmount:0,shippingCost:0,paidAmount:0,notes:"",reference:""}),R([]),I({rawMaterialId:"",warehouseId:"",quantity:1,unitPrice:0,taxAmount:0,discountAmount:0})},H=()=>{if(!C.rawMaterialId||!C.warehouseId)return;const F=r.find(z=>z.id===parseInt(C.rawMaterialId)),he=n.find(z=>z.id===parseInt(C.warehouseId));if(!F||!he)return;const ye=C.quantity*C.unitPrice+C.taxAmount-C.discountAmount;R([...E,{rawMaterialId:F.id,rawMaterialName:F.name,rawMaterialCode:F.code||void 0,unit:F.unit,warehouseId:he.id,warehouseName:he.name,quantity:C.quantity,unitPrice:C.unitPrice,taxAmount:C.taxAmount,discountAmount:C.discountAmount,lineTotal:ye}]),I({rawMaterialId:"",warehouseId:"",quantity:1,unitPrice:0,taxAmount:0,discountAmount:0})},K=F=>{R(E.filter((he,ye)=>ye!==F))},q=()=>{const F=E.reduce((A,de)=>A+de.quantity*de.unitPrice,0),he=E.reduce((A,de)=>A+de.taxAmount,0),ye=E.reduce((A,de)=>A+de.discountAmount,0),z=F+_.taxAmount+he+_.shippingCost-_.discountAmount-ye;return{subtotal:F,total:z}},ge=async F=>{var he,ye,z,A,de,D;if(F.preventDefault(),E.length===0){alert("Please add at least one item");return}h(!0);try{await dl.create({supplierId:_.supplierId?Number(_.supplierId):null,supplierName:_.supplierName||null,supplierContact:_.supplierContact||null,purchaseDate:_.purchaseDate||null,dueDate:_.dueDate||null,taxAmount:_.taxAmount,discountAmount:_.discountAmount,shippingCost:_.shippingCost,paidAmount:_.paidAmount,notes:_.notes||null,reference:_.reference||null,items:E.map(ze=>({rawMaterialId:ze.rawMaterialId,warehouseId:ze.warehouseId,quantity:ze.quantity,unitPrice:ze.unitPrice,taxAmount:ze.taxAmount,discountAmount:ze.discountAmount}))}),await ne(),v(!1),Q()}catch(ze){const Fe=((ye=(he=ze.response)==null?void 0:he.data)==null?void 0:ye.message)||((z=ze.response)==null?void 0:z.data)||"Failed to create purchase",ct=(de=(A=ze.response)==null?void 0:A.data)!=null&&de.errors?`
`+ze.response.data.errors.join(`
`):"";console.error("Purchase error:",(D=ze.response)==null?void 0:D.data),alert(Fe+ct)}finally{h(!1)}},G=async F=>{k(F),b(!0),S(!0);try{const he=await dl.getById(F.id);k(he)}catch(he){console.error("Failed to load detail:",he)}finally{S(!1)}},B=async F=>{var he;if(w)try{await dl.recordPayment(w.id,{amount:F}),await ne();const ye=await dl.getById(w.id);k(ye)}catch(ye){alert(((he=ye.response)==null?void 0:he.data)||"Failed to record payment")}},se=async F=>{var he;if(confirm("Delete this purchase? This will reverse inventory additions."))try{await dl.delete(F),t(e.filter(ye=>ye.id!==F))}catch(ye){alert(((he=ye.response)==null?void 0:he.data)||"Failed to delete")}},{subtotal:L,total:Z}=q();return c?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx(vt,{className:"animate-spin",size:32})}):a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[a.jsx(Br,{className:"text-purple-600"})," Raw Material Purchases"]}),a.jsxs("button",{onClick:()=>{Q(),v(!0)},className:"flex items-center gap-2 px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600",children:[a.jsx(hr,{size:20})," New Purchase"]})]}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 mb-6",children:a.jsxs("div",{className:"flex flex-wrap gap-3 items-center",children:[a.jsxs("div",{className:"flex-1 relative min-w-[200px]",children:[a.jsx(Na,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:20}),a.jsx("input",{type:"text",placeholder:"Search by number or supplier...",value:f,onChange:F=>x(F.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg"})]}),a.jsxs("select",{value:p,onChange:F=>g(F.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg",children:[a.jsx("option",{value:"",children:"All Status"}),a.jsx("option",{value:"unpaid",children:"Unpaid"}),a.jsx("option",{value:"partial",children:"Partial"}),a.jsx("option",{value:"paid",children:"Paid"})]})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50 border-b",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-gray-700",children:"Purchase #"}),a.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-gray-700",children:"Supplier"}),a.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-gray-700",children:"Date"}),a.jsx("th",{className:"text-right px-4 py-3 text-sm font-medium text-gray-700",children:"Total"}),a.jsx("th",{className:"text-right px-4 py-3 text-sm font-medium text-gray-700",children:"Paid"}),a.jsx("th",{className:"text-center px-4 py-3 text-sm font-medium text-gray-700",children:"Status"}),a.jsx("th",{className:"text-center px-4 py-3 text-sm font-medium text-gray-700",children:"Actions"})]})}),a.jsxs("tbody",{className:"divide-y",children:[W.map(F=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 font-mono text-sm text-purple-600",children:F.purchaseNumber}),a.jsxs("td",{className:"px-4 py-3",children:[a.jsx("div",{className:"font-medium text-gray-900",children:F.supplierName||"-"}),F.supplierContact&&a.jsx("div",{className:"text-xs text-gray-500",children:F.supplierContact})]}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:new Date(F.purchaseDate).toLocaleDateString()}),a.jsxs("td",{className:"px-4 py-3 text-sm text-right font-medium",children:["$",F.totalAmount.toFixed(3)]}),a.jsxs("td",{className:"px-4 py-3 text-sm text-right font-medium text-green-600",children:["$",F.paidAmount.toFixed(3)]}),a.jsx("td",{className:"px-4 py-3 text-center",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${F.paymentStatus==="paid"?"bg-green-100 text-green-700":F.paymentStatus==="partial"?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:F.paymentStatus})}),a.jsx("td",{className:"px-4 py-3",children:a.jsxs("div",{className:"flex items-center justify-center gap-2",children:[a.jsx("button",{onClick:()=>G(F),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",children:a.jsx(gs,{size:18})}),a.jsx("button",{onClick:()=>se(F.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",children:a.jsx(xr,{size:18})})]})})]},F.id)),W.length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"px-4 py-8 text-center text-gray-500",children:"No purchases found"})})]})]})}),y&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-4xl max-h-[90vh] overflow-hidden",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-purple-600 text-white",children:[a.jsx("h2",{className:"text-lg font-semibold",children:"New Raw Material Purchase"}),a.jsx("button",{onClick:()=>v(!1),children:a.jsx(yt,{size:24})})]}),a.jsxs("form",{onSubmit:ge,className:"p-6 space-y-4 overflow-y-auto max-h-[calc(90vh-120px)]",children:[a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Supplier"}),a.jsxs("select",{value:_.supplierId,onChange:F=>{const he=F.target.value,ye=l.find(z=>z.id===parseInt(he));O({..._,supplierId:he,supplierName:(ye==null?void 0:ye.name)||"",supplierContact:(ye==null?void 0:ye.phone)||""})},className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[a.jsx("option",{value:"",children:"-- Manual Entry --"}),l.filter(F=>F.isManufacturer).map(F=>a.jsx("option",{value:F.id,children:F.name},F.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Supplier Name"}),a.jsx("input",{type:"text",value:_.supplierName,onChange:F=>O({..._,supplierName:F.target.value}),disabled:!!_.supplierId,className:"w-full px-3 py-2 border border-gray-300 rounded-lg disabled:bg-gray-100"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Supplier Contact"}),a.jsx("input",{type:"text",value:_.supplierContact,onChange:F=>O({..._,supplierContact:F.target.value}),disabled:!!_.supplierId,className:"w-full px-3 py-2 border border-gray-300 rounded-lg disabled:bg-gray-100"})]})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Purchase Date"}),a.jsx("input",{type:"date",value:_.purchaseDate,onChange:F=>O({..._,purchaseDate:F.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Due Date"}),a.jsx("input",{type:"date",value:_.dueDate,onChange:F=>O({..._,dueDate:F.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reference"}),a.jsx("input",{type:"text",value:_.reference,onChange:F=>O({..._,reference:F.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]})]}),a.jsxs("div",{className:"border rounded-lg p-4",children:[a.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:"Items"}),a.jsxs("div",{className:"grid grid-cols-6 gap-2 mb-3",children:[a.jsxs("select",{value:C.rawMaterialId,onChange:F=>{const he=r.find(ye=>ye.id===parseInt(F.target.value));I({...C,rawMaterialId:F.target.value,unitPrice:(he==null?void 0:he.costPrice)||0})},className:"col-span-2 px-2 py-2 border border-gray-300 rounded-lg text-sm",children:[a.jsx("option",{value:"",children:"Select Material"}),r.map(F=>a.jsx("option",{value:F.id,children:F.name},F.id))]}),a.jsxs("select",{value:C.warehouseId,onChange:F=>I({...C,warehouseId:F.target.value}),className:"px-2 py-2 border border-gray-300 rounded-lg text-sm",children:[a.jsx("option",{value:"",children:"Warehouse"}),n.map(F=>a.jsx("option",{value:F.id,children:F.name},F.id))]}),a.jsx("input",{type:"number",step:"0.01",value:C.quantity,onChange:F=>I({...C,quantity:parseFloat(F.target.value)||0}),className:"px-2 py-2 border border-gray-300 rounded-lg text-sm",placeholder:"Qty"}),a.jsx("input",{type:"number",step:"0.001",value:C.unitPrice,onChange:F=>I({...C,unitPrice:parseFloat(F.target.value)||0}),className:"px-2 py-2 border border-gray-300 rounded-lg text-sm",placeholder:"Unit Price"}),a.jsx("button",{type:"button",onClick:H,className:"px-3 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 text-sm",children:"Add"})]}),E.length>0&&a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-left px-2 py-2",children:"Material"}),a.jsx("th",{className:"text-left px-2 py-2",children:"Warehouse"}),a.jsx("th",{className:"text-right px-2 py-2",children:"Qty"}),a.jsx("th",{className:"text-right px-2 py-2",children:"Price"}),a.jsx("th",{className:"text-right px-2 py-2",children:"Total"}),a.jsx("th",{className:"px-2 py-2"})]})}),a.jsx("tbody",{className:"divide-y",children:E.map((F,he)=>a.jsxs("tr",{children:[a.jsx("td",{className:"px-2 py-2",children:F.rawMaterialName}),a.jsx("td",{className:"px-2 py-2",children:F.warehouseName}),a.jsxs("td",{className:"px-2 py-2 text-right",children:[F.quantity," ",F.unit]}),a.jsxs("td",{className:"px-2 py-2 text-right",children:["$",F.unitPrice.toFixed(3)]}),a.jsxs("td",{className:"px-2 py-2 text-right font-medium",children:["$",F.lineTotal.toFixed(3)]}),a.jsx("td",{className:"px-2 py-2 text-center",children:a.jsx("button",{type:"button",onClick:()=>K(he),className:"text-red-500 hover:text-red-700",children:a.jsx(xr,{size:16})})})]},he))})]})]}),a.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tax"}),a.jsx("input",{type:"number",step:"0.001",value:_.taxAmount,onChange:F=>O({..._,taxAmount:parseFloat(F.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Discount"}),a.jsx("input",{type:"number",step:"0.001",value:_.discountAmount,onChange:F=>O({..._,discountAmount:parseFloat(F.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Shipping"}),a.jsx("input",{type:"number",step:"0.001",value:_.shippingCost,onChange:F=>O({..._,shippingCost:parseFloat(F.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Paid Amount"}),a.jsx("input",{type:"number",step:"0.001",value:_.paidAmount,onChange:F=>O({..._,paidAmount:parseFloat(F.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]})]}),a.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Subtotal:"}),a.jsxs("span",{className:"ml-2 font-medium",children:["$",L.toFixed(3)]})]}),a.jsxs("div",{className:"text-xl font-bold text-purple-600",children:["Total: $",Z.toFixed(3)]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),a.jsx("textarea",{value:_.notes,onChange:F=>O({..._,notes:F.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",rows:2})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>v(!1),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:d||E.length===0,className:"flex-1 px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 disabled:opacity-50",children:d?a.jsx(vt,{className:"animate-spin mx-auto",size:20}):"Create Purchase"})]})]})]})}),j&&w&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-3xl max-h-[90vh] overflow-hidden",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-purple-600 text-white",children:[a.jsxs("h2",{className:"text-lg font-semibold",children:["Purchase: ",w.purchaseNumber]}),a.jsx("button",{onClick:()=>b(!1),children:a.jsx(yt,{size:24})})]}),a.jsx("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-80px)]",children:N?a.jsx("div",{className:"flex justify-center py-8",children:a.jsx(vt,{className:"animate-spin",size:32})}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Supplier"}),a.jsx("p",{className:"font-medium",children:w.supplierName||"-"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Date"}),a.jsx("p",{className:"font-medium",children:new Date(w.purchaseDate).toLocaleDateString()})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Status"}),a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${w.paymentStatus==="paid"?"bg-green-100 text-green-700":w.paymentStatus==="partial"?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:w.paymentStatus})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Reference"}),a.jsx("p",{className:"font-medium",children:w.reference||"-"})]})]}),w.items&&w.items.length>0&&a.jsxs("div",{className:"mb-6",children:[a.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:"Items"}),a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-left px-3 py-2",children:"Material"}),a.jsx("th",{className:"text-left px-3 py-2",children:"Warehouse"}),a.jsx("th",{className:"text-right px-3 py-2",children:"Qty"}),a.jsx("th",{className:"text-right px-3 py-2",children:"Price"}),a.jsx("th",{className:"text-right px-3 py-2",children:"Total"})]})}),a.jsx("tbody",{className:"divide-y",children:w.items.map(F=>a.jsxs("tr",{children:[a.jsx("td",{className:"px-3 py-2",children:F.rawMaterialName}),a.jsx("td",{className:"px-3 py-2",children:F.warehouseName}),a.jsxs("td",{className:"px-3 py-2 text-right",children:[F.quantity," ",F.unit]}),a.jsxs("td",{className:"px-3 py-2 text-right",children:["$",F.unitPrice.toFixed(3)]}),a.jsxs("td",{className:"px-3 py-2 text-right font-medium",children:["$",F.lineTotal.toFixed(3)]})]},F.id))})]})]}),a.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg mb-6",children:[a.jsxs("div",{className:"flex justify-between mb-2",children:[a.jsx("span",{children:"Subtotal"}),a.jsxs("span",{children:["$",w.subtotal.toFixed(3)]})]}),a.jsxs("div",{className:"flex justify-between mb-2",children:[a.jsx("span",{children:"Tax"}),a.jsxs("span",{children:["$",w.taxAmount.toFixed(3)]})]}),a.jsxs("div",{className:"flex justify-between mb-2",children:[a.jsx("span",{children:"Discount"}),a.jsxs("span",{children:["-$",w.discountAmount.toFixed(3)]})]}),a.jsxs("div",{className:"flex justify-between mb-2",children:[a.jsx("span",{children:"Shipping"}),a.jsxs("span",{children:["$",w.shippingCost.toFixed(3)]})]}),a.jsxs("div",{className:"flex justify-between text-lg font-bold border-t pt-2",children:[a.jsx("span",{children:"Total"}),a.jsxs("span",{children:["$",w.totalAmount.toFixed(3)]})]}),a.jsxs("div",{className:"flex justify-between text-green-600 mt-2",children:[a.jsx("span",{children:"Paid"}),a.jsxs("span",{children:["$",w.paidAmount.toFixed(3)]})]}),w.totalAmount>w.paidAmount&&a.jsxs("div",{className:"flex justify-between text-red-600 font-medium",children:[a.jsx("span",{children:"Balance Due"}),a.jsxs("span",{children:["$",(w.totalAmount-w.paidAmount).toFixed(3)]})]})]}),w.paymentStatus!=="paid"&&a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("button",{onClick:()=>{const F=prompt("Enter payment amount:");F&&B(parseFloat(F))},className:"flex items-center gap-2 px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600",children:[a.jsx(da,{size:18})," Record Payment"]}),a.jsxs("button",{onClick:()=>B(w.totalAmount-w.paidAmount),className:"flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600",children:[a.jsx(Jt,{size:18})," Pay Full"]})]})]})})]})})]})}function _ve(){const[e,t]=m.useState([]),[r,s]=m.useState([]),[n,i]=m.useState([]),[l,o]=m.useState([]),[c,u]=m.useState(!0),[d,h]=m.useState(!1),[f,x]=m.useState(""),[p,g]=m.useState(""),[y,v]=m.useState(!1),[j,b]=m.useState(!1),[w,k]=m.useState(null),[N,S]=m.useState(!1),[_,O]=m.useState({productionDate:new Date().toISOString().split("T")[0],productId:"",outputQuantity:1,outputWarehouseId:"",notes:""}),[E,R]=m.useState([]),[C,I]=m.useState({rawMaterialId:"",warehouseId:"",quantity:1}),[ne,W]=m.useState({description:"",amount:0,paymentMethod:"cash"});m.useEffect(()=>{Q()},[]);const Q=async()=>{try{u(!0);const[A,de,D,ze]=await Promise.all([el.getAll(),Tl.getAll({isActive:!0}),br.getAll({isActive:!0}),Ks.getAll()]);t(A),s(de),i(D.data),o(ze.data)}catch(A){console.error("Failed to load data:",A)}finally{u(!1)}},H=e.filter(A=>{if(p&&A.status!==p)return!1;if(f){const de=f.toLowerCase();return A.productionNumber.toLowerCase().includes(de)||A.productName.toLowerCase().includes(de)}return!0}),K=()=>{O({productionDate:new Date().toISOString().split("T")[0],productId:"",outputQuantity:1,outputWarehouseId:"",notes:""}),R([]),I({rawMaterialId:"",warehouseId:"",quantity:1})},q=()=>{if(!C.rawMaterialId||!C.warehouseId)return;const A=r.find(ze=>ze.id===parseInt(C.rawMaterialId)),de=l.find(ze=>ze.id===parseInt(C.warehouseId));if(!A||!de)return;const D=C.quantity*A.costPrice;R([...E,{rawMaterialId:A.id,rawMaterialName:A.name,rawMaterialCode:A.code||void 0,unit:A.unit,warehouseId:de.id,warehouseName:de.name,quantity:C.quantity,unitCost:A.costPrice,totalCost:D}]),I({rawMaterialId:"",warehouseId:"",quantity:1})},ge=A=>{R(E.filter((de,D)=>D!==A))},G=()=>{const A=E.reduce((D,ze)=>D+ze.totalCost,0),de=_.outputQuantity>0?A/_.outputQuantity:0;return{rawMaterialCost:A,unitCost:de}},B=async A=>{var de,D;if(A.preventDefault(),!_.productId||!_.outputWarehouseId){alert("Please select product and output warehouse");return}if(E.length===0){alert("Please add at least one raw material");return}h(!0);try{await el.create({..._,productId:parseInt(_.productId),outputWarehouseId:parseInt(_.outputWarehouseId),materials:E.map(ze=>({rawMaterialId:ze.rawMaterialId,warehouseId:ze.warehouseId,quantity:ze.quantity,unitCost:ze.unitCost}))}),await Q(),v(!1),K()}catch(ze){alert(((D=(de=ze.response)==null?void 0:de.data)==null?void 0:D.message)||"Failed to create production order")}finally{h(!1)}},se=async A=>{k(A),b(!0),S(!0);try{const de=await el.getById(A.id);k(de)}catch(de){console.error("Failed to load detail:",de)}finally{S(!1)}},L=async()=>{var A;if(!(!w||!ne.description||ne.amount<=0))try{await el.addCost(w.id,ne);const de=await el.getById(w.id);k(de),await Q(),W({description:"",amount:0,paymentMethod:"cash"})}catch(de){alert(((A=de.response)==null?void 0:A.data)||"Failed to add cost")}},Z=async A=>{var de;if(!(!w||!confirm("Remove this cost? The associated expense will also be deleted.")))try{await el.removeCost(w.id,A);const D=await el.getById(w.id);k(D),await Q()}catch(D){alert(((de=D.response)==null?void 0:de.data)||"Failed to remove cost")}},F=async()=>{var A,de,D;if(w&&confirm(`Complete this production order? This will:
- Deduct raw materials from inventory
- Add finished products to inventory
- Update product cost price

This action cannot be undone.`))try{const ze=await el.complete(w.id);alert(`Production completed!
${ze.productQuantityAdded} units added to inventory.
New product cost: $${ze.newProductCost.toFixed(3)}`);const Fe=await el.getById(w.id);k(Fe),await Q()}catch(ze){alert(((de=(A=ze.response)==null?void 0:A.data)==null?void 0:de.message)||((D=ze.response)==null?void 0:D.data)||"Failed to complete production")}},he=async A=>{var de;if(confirm("Delete this production order?"))try{await el.delete(A),t(e.filter(D=>D.id!==A))}catch(D){alert(((de=D.response)==null?void 0:de.data)||"Failed to delete")}},{rawMaterialCost:ye,unitCost:z}=G();return c?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx(vt,{className:"animate-spin",size:32})}):a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[a.jsx(Wp,{className:"text-indigo-600"})," Production Orders"]}),a.jsxs("button",{onClick:()=>{K(),v(!0)},className:"flex items-center gap-2 px-4 py-2 bg-indigo-500 text-white rounded-lg hover:bg-indigo-600",children:[a.jsx(hr,{size:20})," New Production"]})]}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 mb-6",children:a.jsxs("div",{className:"flex flex-wrap gap-3 items-center",children:[a.jsxs("div",{className:"flex-1 relative min-w-[200px]",children:[a.jsx(Na,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:20}),a.jsx("input",{type:"text",placeholder:"Search by number or product...",value:f,onChange:A=>x(A.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg"})]}),a.jsxs("select",{value:p,onChange:A=>g(A.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg",children:[a.jsx("option",{value:"",children:"All Status"}),a.jsx("option",{value:"draft",children:"Draft"}),a.jsx("option",{value:"completed",children:"Completed"})]})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50 border-b",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-gray-700",children:"Order #"}),a.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-gray-700",children:"Product"}),a.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-gray-700",children:"Date"}),a.jsx("th",{className:"text-right px-4 py-3 text-sm font-medium text-gray-700",children:"Output Qty"}),a.jsx("th",{className:"text-right px-4 py-3 text-sm font-medium text-gray-700",children:"Total Cost"}),a.jsx("th",{className:"text-right px-4 py-3 text-sm font-medium text-gray-700",children:"Unit Cost"}),a.jsx("th",{className:"text-center px-4 py-3 text-sm font-medium text-gray-700",children:"Status"}),a.jsx("th",{className:"text-center px-4 py-3 text-sm font-medium text-gray-700",children:"Actions"})]})}),a.jsxs("tbody",{className:"divide-y",children:[H.map(A=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 font-mono text-sm text-indigo-600",children:A.productionNumber}),a.jsxs("td",{className:"px-4 py-3",children:[a.jsx("div",{className:"font-medium text-gray-900",children:A.productName}),a.jsx("div",{className:"text-xs text-gray-500",children:A.productSku})]}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:new Date(A.productionDate).toLocaleDateString()}),a.jsx("td",{className:"px-4 py-3 text-sm text-right font-medium",children:A.outputQuantity}),a.jsxs("td",{className:"px-4 py-3 text-sm text-right",children:["$",A.totalCost.toFixed(3)]}),a.jsxs("td",{className:"px-4 py-3 text-sm text-right font-medium text-indigo-600",children:["$",A.unitCost.toFixed(3)]}),a.jsx("td",{className:"px-4 py-3 text-center",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${A.status==="completed"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:A.status})}),a.jsx("td",{className:"px-4 py-3",children:a.jsxs("div",{className:"flex items-center justify-center gap-2",children:[a.jsx("button",{onClick:()=>se(A),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",children:a.jsx(gs,{size:18})}),A.status!=="completed"&&a.jsx("button",{onClick:()=>he(A.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",children:a.jsx(xr,{size:18})})]})})]},A.id)),H.length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:8,className:"px-4 py-8 text-center text-gray-500",children:"No production orders found"})})]})]})}),y&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-4xl max-h-[90vh] overflow-hidden",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-indigo-600 text-white",children:[a.jsx("h2",{className:"text-lg font-semibold",children:"New Production Order"}),a.jsx("button",{onClick:()=>v(!1),children:a.jsx(yt,{size:24})})]}),a.jsxs("form",{onSubmit:B,className:"p-6 space-y-4 overflow-y-auto max-h-[calc(90vh-120px)]",children:[a.jsxs("div",{className:"bg-indigo-50 border border-indigo-200 rounded-lg p-4",children:[a.jsxs("h3",{className:"font-medium text-indigo-800 mb-3 flex items-center gap-2",children:[a.jsx(Tr,{size:18})," Output Product"]}),a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsxs("div",{className:"col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Product *"}),a.jsxs("select",{value:_.productId,onChange:A=>O({..._,productId:A.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0,children:[a.jsx("option",{value:"",children:"Select Product"}),n.map(A=>a.jsxs("option",{value:A.id,children:[A.name," (",A.sku,")"]},A.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Output Qty *"}),a.jsx("input",{type:"number",step:"0.01",value:_.outputQuantity,onChange:A=>O({..._,outputQuantity:parseFloat(A.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0,min:"0.01"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Output Warehouse *"}),a.jsxs("select",{value:_.outputWarehouseId,onChange:A=>O({..._,outputWarehouseId:A.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0,children:[a.jsx("option",{value:"",children:"Select Warehouse"}),l.map(A=>a.jsx("option",{value:A.id,children:A.name},A.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Production Date"}),a.jsx("input",{type:"date",value:_.productionDate,onChange:A=>O({..._,productionDate:A.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]})]})]}),a.jsxs("div",{className:"border rounded-lg p-4",children:[a.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:"Raw Materials"}),a.jsxs("div",{className:"grid grid-cols-4 gap-2 mb-3",children:[a.jsxs("select",{value:C.rawMaterialId,onChange:A=>I({...C,rawMaterialId:A.target.value}),className:"col-span-2 px-2 py-2 border border-gray-300 rounded-lg text-sm",children:[a.jsx("option",{value:"",children:"Select Raw Material"}),r.map(A=>a.jsxs("option",{value:A.id,children:[A.name," (Stock: ",A.totalStock," ",A.unit,")"]},A.id))]}),a.jsxs("select",{value:C.warehouseId,onChange:A=>I({...C,warehouseId:A.target.value}),className:"px-2 py-2 border border-gray-300 rounded-lg text-sm",children:[a.jsx("option",{value:"",children:"Warehouse"}),l.map(A=>a.jsx("option",{value:A.id,children:A.name},A.id))]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("input",{type:"number",step:"0.01",value:C.quantity,onChange:A=>I({...C,quantity:parseFloat(A.target.value)||0}),className:"flex-1 px-2 py-2 border border-gray-300 rounded-lg text-sm",placeholder:"Qty"}),a.jsx("button",{type:"button",onClick:q,className:"px-3 py-2 bg-indigo-500 text-white rounded-lg hover:bg-indigo-600 text-sm",children:"Add"})]})]}),E.length>0&&a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-left px-2 py-2",children:"Material"}),a.jsx("th",{className:"text-left px-2 py-2",children:"Warehouse"}),a.jsx("th",{className:"text-right px-2 py-2",children:"Qty"}),a.jsx("th",{className:"text-right px-2 py-2",children:"Unit Cost"}),a.jsx("th",{className:"text-right px-2 py-2",children:"Total"}),a.jsx("th",{className:"px-2 py-2"})]})}),a.jsx("tbody",{className:"divide-y",children:E.map((A,de)=>a.jsxs("tr",{children:[a.jsx("td",{className:"px-2 py-2",children:A.rawMaterialName}),a.jsx("td",{className:"px-2 py-2",children:A.warehouseName}),a.jsxs("td",{className:"px-2 py-2 text-right",children:[A.quantity," ",A.unit]}),a.jsxs("td",{className:"px-2 py-2 text-right",children:["$",A.unitCost.toFixed(3)]}),a.jsxs("td",{className:"px-2 py-2 text-right font-medium",children:["$",A.totalCost.toFixed(3)]}),a.jsx("td",{className:"px-2 py-2 text-center",children:a.jsx("button",{type:"button",onClick:()=>ge(de),className:"text-red-500 hover:text-red-700",children:a.jsx(xr,{size:16})})})]},de))})]})]}),a.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[a.jsxs("div",{className:"flex justify-between mb-2",children:[a.jsx("span",{className:"text-gray-600",children:"Raw Material Cost:"}),a.jsxs("span",{className:"font-medium",children:["$",ye.toFixed(3)]})]}),a.jsxs("div",{className:"flex justify-between text-lg font-bold text-indigo-600",children:[a.jsx("span",{children:"Unit Cost:"}),a.jsxs("span",{children:["$",z.toFixed(3)," / unit"]})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"* Extra costs can be added after creating the order"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),a.jsx("textarea",{value:_.notes,onChange:A=>O({..._,notes:A.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",rows:2})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>v(!1),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:d||E.length===0,className:"flex-1 px-4 py-2 bg-indigo-500 text-white rounded-lg hover:bg-indigo-600 disabled:opacity-50",children:d?a.jsx(vt,{className:"animate-spin mx-auto",size:20}):"Create Production Order"})]})]})]})}),j&&w&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-4xl max-h-[90vh] overflow-hidden",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-indigo-600 text-white",children:[a.jsxs("h2",{className:"text-lg font-semibold",children:["Production: ",w.productionNumber]}),a.jsx("button",{onClick:()=>b(!1),children:a.jsx(yt,{size:24})})]}),a.jsx("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-80px)]",children:N?a.jsx("div",{className:"flex justify-center py-8",children:a.jsx(vt,{className:"animate-spin",size:32})}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Product"}),a.jsx("p",{className:"font-medium",children:w.productName}),a.jsx("p",{className:"text-xs text-gray-500",children:w.productSku})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Output Quantity"}),a.jsx("p",{className:"font-medium text-lg",children:w.outputQuantity})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Status"}),a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${w.status==="completed"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:w.status})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Output Warehouse"}),a.jsx("p",{className:"font-medium",children:w.outputWarehouseName})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Production Date"}),a.jsx("p",{className:"font-medium",children:new Date(w.productionDate).toLocaleDateString()})]}),w.completedAt&&a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Completed At"}),a.jsx("p",{className:"font-medium",children:new Date(w.completedAt).toLocaleString()})]})]}),w.materials&&w.materials.length>0&&a.jsxs("div",{className:"mb-6",children:[a.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:"Raw Materials Used"}),a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-left px-3 py-2",children:"Material"}),a.jsx("th",{className:"text-left px-3 py-2",children:"Warehouse"}),a.jsx("th",{className:"text-right px-3 py-2",children:"Qty"}),a.jsx("th",{className:"text-right px-3 py-2",children:"Unit Cost"}),a.jsx("th",{className:"text-right px-3 py-2",children:"Total"})]})}),a.jsx("tbody",{className:"divide-y",children:w.materials.map(A=>a.jsxs("tr",{children:[a.jsx("td",{className:"px-3 py-2",children:A.rawMaterialName}),a.jsx("td",{className:"px-3 py-2",children:A.warehouseName}),a.jsxs("td",{className:"px-3 py-2 text-right",children:[A.quantity," ",A.unit]}),a.jsxs("td",{className:"px-3 py-2 text-right",children:["$",A.unitCost.toFixed(3)]}),a.jsxs("td",{className:"px-3 py-2 text-right font-medium",children:["$",A.totalCost.toFixed(3)]})]},A.id))})]})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:"Extra Costs (goes to Expenses)"}),w.costs&&w.costs.length>0&&a.jsxs("table",{className:"w-full text-sm mb-3",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-left px-3 py-2",children:"Description"}),a.jsx("th",{className:"text-left px-3 py-2",children:"Expense #"}),a.jsx("th",{className:"text-right px-3 py-2",children:"Amount"}),w.status!=="completed"&&a.jsx("th",{className:"px-3 py-2"})]})}),a.jsx("tbody",{className:"divide-y",children:w.costs.map(A=>a.jsxs("tr",{children:[a.jsx("td",{className:"px-3 py-2",children:A.description}),a.jsx("td",{className:"px-3 py-2 text-purple-600",children:A.expenseNumber||"-"}),a.jsxs("td",{className:"px-3 py-2 text-right font-medium",children:["$",A.amount.toFixed(3)]}),w.status!=="completed"&&a.jsx("td",{className:"px-3 py-2 text-center",children:a.jsx("button",{onClick:()=>Z(A.id),className:"text-red-500 hover:text-red-700",children:a.jsx(xr,{size:16})})})]},A.id))})]}),w.status!=="completed"&&a.jsxs("div",{className:"flex gap-2 items-end",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Description"}),a.jsx("input",{type:"text",value:ne.description,onChange:A=>W({...ne,description:A.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",placeholder:"e.g., Labor, Packaging, Electricity"})]}),a.jsxs("div",{className:"w-32",children:[a.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Amount"}),a.jsx("input",{type:"number",step:"0.001",value:ne.amount,onChange:A=>W({...ne,amount:parseFloat(A.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"})]}),a.jsxs("button",{onClick:L,disabled:!ne.description||ne.amount<=0,className:"px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 disabled:opacity-50 text-sm flex items-center gap-1",children:[a.jsx(da,{size:16})," Add Cost"]})]})]}),a.jsxs("div",{className:"bg-indigo-50 p-4 rounded-lg mb-6",children:[a.jsxs("div",{className:"flex justify-between mb-2",children:[a.jsx("span",{children:"Raw Material Cost"}),a.jsxs("span",{children:["$",w.rawMaterialCost.toFixed(3)]})]}),a.jsxs("div",{className:"flex justify-between mb-2",children:[a.jsx("span",{children:"Extra Costs"}),a.jsxs("span",{children:["$",w.extraCost.toFixed(3)]})]}),a.jsxs("div",{className:"flex justify-between text-lg font-bold border-t border-indigo-200 pt-2",children:[a.jsx("span",{children:"Total Cost"}),a.jsxs("span",{children:["$",w.totalCost.toFixed(3)]})]}),a.jsxs("div",{className:"flex justify-between text-indigo-700 font-medium mt-2",children:[a.jsxs("span",{children:["Unit Cost (",w.outputQuantity," units)"]}),a.jsxs("span",{children:["$",w.unitCost.toFixed(3)," / unit"]})]})]}),w.status!=="completed"&&a.jsxs("button",{onClick:F,className:"w-full flex items-center justify-center gap-2 px-4 py-3 bg-green-500 text-white rounded-lg hover:bg-green-600 font-medium",children:[a.jsx(Jt,{size:20})," Complete Production"]})]})})]})})]})}function Tve(){const{id:e}=a6(),t=Hd(),[r,s]=m.useState(!0),[n,i]=m.useState(null),[l,o]=m.useState([]),[c,u]=m.useState([]),[d,h]=m.useState(null),[f,x]=m.useState(!1),[p,g]=m.useState(""),[y,v]=m.useState(""),[j,b]=m.useState(""),[w,k]=m.useState("");m.useEffect(()=>{e&&_()},[e]),m.useEffect(()=>{let H=[...l];p&&(H=H.filter(K=>K.purchaseNumber.toLowerCase().includes(p.toLowerCase()))),y&&(H=H.filter(K=>new Date(K.purchaseDate)>=new Date(y))),j&&(H=H.filter(K=>new Date(K.purchaseDate)<=new Date(j+"T23:59:59"))),w&&(H=H.filter(K=>K.paymentStatus===w)),u(H)},[l,p,y,j,w]);const N=()=>{g(""),v(""),b(""),k("")},S=p||y||j||w,_=async()=>{try{s(!0);const[H,K]=await Promise.all([Vr.getById(parseInt(e)),dl.getAll()]);i(H.data||H);const q=K.filter(ge=>ge.supplierId===parseInt(e));o(q)}catch(H){console.error("Failed to load data:",H)}finally{s(!1)}},O=async H=>{try{x(!0);const K=await dl.getById(H);h(K)}catch(K){console.error("Failed to load purchase detail:",K)}finally{x(!1)}},E=H=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(H),R=H=>new Date(H).toLocaleDateString(),C=c.reduce((H,K)=>H+K.totalAmount,0),I=c.reduce((H,K)=>H+K.paidAmount,0),ne=C-I,W=c.length,Q=()=>{const H=`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Manufacturer Report - ${n==null?void 0:n.name}</title>
        <style>
          * { margin: 0; padding: 0; box-sizing: border-box; }
          body { font-family: Arial, sans-serif; font-size: 12px; padding: 20px; }
          .header { text-align: center; margin-bottom: 20px; border-bottom: 2px solid #7c3aed; padding-bottom: 10px; }
          .header h1 { font-size: 24px; color: #7c3aed; margin-bottom: 5px; }
          .info-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 20px; background: #f5f3ff; padding: 15px; border-radius: 8px; }
          .info-item .label { font-size: 10px; color: #666; text-transform: uppercase; }
          .info-item .value { font-weight: bold; }
          .summary-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-bottom: 20px; }
          .summary-card { border: 1px solid #ddd; padding: 12px; border-radius: 5px; text-align: center; }
          .summary-card .label { font-size: 10px; color: #666; text-transform: uppercase; }
          .summary-card .value { font-size: 18px; font-weight: bold; margin-top: 5px; }
          .summary-card .value.purple { color: #7c3aed; }
          .summary-card .value.green { color: #22c55e; }
          .summary-card .value.red { color: #ef4444; }
          .section { margin-bottom: 20px; }
          .section h2 { font-size: 16px; margin-bottom: 10px; border-bottom: 1px solid #7c3aed; padding-bottom: 5px; color: #7c3aed; }
          table { width: 100%; border-collapse: collapse; margin-bottom: 15px; }
          th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
          th { background: #f5f3ff; font-weight: bold; }
          .text-right { text-align: right; }
          .text-center { text-align: center; }
          .status-paid { color: #22c55e; font-weight: bold; }
          .status-unpaid { color: #ef4444; font-weight: bold; }
          .status-partial { color: #f59e0b; font-weight: bold; }
          .footer { text-align: center; margin-top: 20px; padding-top: 10px; border-top: 1px solid #ddd; color: #666; font-size: 10px; }
          @media print { body { padding: 0; } }
        </style>
      </head>
      <body>
        <div class="header">
          <h1>Manufacturer Report</h1>
          <p>Raw Material Supplier Statement</p>
          <p style="margin-top: 5px; color: #666;">Generated: ${new Date().toLocaleString()}</p>
          ${S?`<p style="margin-top: 5px; color: #7c3aed; font-size: 11px;">
            Filters Applied: ${[y?`From: ${y}`:"",j?`To: ${j}`:"",w?`Status: ${w}`:"",p?`Search: "${p}"`:""].filter(Boolean).join(" | ")}
          </p>`:""}
        </div>
        
        <div class="info-grid">
          <div class="info-item">
            <div class="label">Manufacturer Name</div>
            <div class="value">${n==null?void 0:n.name}</div>
          </div>
          <div class="info-item">
            <div class="label">Company</div>
            <div class="value">${(n==null?void 0:n.companyName)||"-"}</div>
          </div>
          <div class="info-item">
            <div class="label">Phone</div>
            <div class="value">${(n==null?void 0:n.phone)||"-"}</div>
          </div>
          <div class="info-item">
            <div class="label">Email</div>
            <div class="value">${(n==null?void 0:n.email)||"-"}</div>
          </div>
          <div class="info-item">
            <div class="label">City</div>
            <div class="value">${(n==null?void 0:n.city)||"-"}</div>
          </div>
          <div class="info-item">
            <div class="label">Payment Terms</div>
            <div class="value">${(n==null?void 0:n.paymentTerms)||"-"}</div>
          </div>
        </div>
        
        <div class="summary-grid">
          <div class="summary-card">
            <div class="label">Total Purchases</div>
            <div class="value purple">${E(C)}</div>
          </div>
          <div class="summary-card">
            <div class="label">Total Paid</div>
            <div class="value green">${E(I)}</div>
          </div>
          <div class="summary-card">
            <div class="label">Outstanding</div>
            <div class="value red">${E(ne)}</div>
          </div>
          <div class="summary-card">
            <div class="label">Purchase Count</div>
            <div class="value">${W}</div>
          </div>
        </div>
        
        <div class="section">
          <h2>Raw Material Purchases</h2>
          <table>
            <thead>
              <tr>
                <th>Purchase #</th>
                <th>Date</th>
                <th class="text-right">Total</th>
                <th class="text-right">Paid</th>
                <th class="text-right">Balance</th>
                <th class="text-center">Status</th>
                <th>Notes</th>
              </tr>
            </thead>
            <tbody>
              ${c.map(q=>`
                <tr>
                  <td>${q.purchaseNumber}</td>
                  <td>${R(q.purchaseDate)}</td>
                  <td class="text-right">${E(q.totalAmount)}</td>
                  <td class="text-right">${E(q.paidAmount)}</td>
                  <td class="text-right">${E(q.totalAmount-q.paidAmount)}</td>
                  <td class="text-center status-${q.paymentStatus}">${q.paymentStatus.toUpperCase()}</td>
                  <td>${q.notes||"-"}</td>
                </tr>
              `).join("")}
            </tbody>
            <tfoot>
              <tr>
                <th colspan="2">Total</th>
                <th class="text-right">${E(C)}</th>
                <th class="text-right">${E(I)}</th>
                <th class="text-right">${E(ne)}</th>
                <th colspan="2"></th>
              </tr>
            </tfoot>
          </table>
        </div>
        
        <div class="footer">
          <p>Catalyst Manufacturer Report - Raw Material Purchases Statement</p>
        </div>
      </body>
      </html>
    `,K=window.open("","_blank");K&&(K.document.write(H),K.document.close(),K.print())};return r?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx(vt,{className:"animate-spin text-purple-600",size:32})}):n?a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("button",{onClick:()=>t(-1),className:"p-2 hover:bg-gray-100 rounded-lg",children:a.jsx(ff,{size:24})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Manufacturer Report"}),a.jsx("p",{className:"text-gray-500",children:"Raw Material Supplier Statement"})]})]}),a.jsxs("button",{onClick:Q,className:"flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",children:[a.jsx(ua,{size:18}),"Print Report"]})]}),a.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-purple-100 rounded-xl p-6",children:[a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-bold text-purple-900",children:n.name}),n.companyName&&a.jsx("p",{className:"text-purple-700",children:n.companyName})]}),a.jsx("span",{className:"px-3 py-1 bg-purple-600 text-white text-sm rounded-full",children:"Manufacturer"})]}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-4",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-purple-600 uppercase",children:"Phone"}),a.jsx("p",{className:"font-medium",children:n.phone||"-"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-purple-600 uppercase",children:"Email"}),a.jsx("p",{className:"font-medium",children:n.email||"-"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-purple-600 uppercase",children:"City"}),a.jsx("p",{className:"font-medium",children:n.city||"-"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-purple-600 uppercase",children:"Payment Terms"}),a.jsx("p",{className:"font-medium",children:n.paymentTerms||"-"})]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[a.jsx("div",{className:"bg-white rounded-xl p-4 shadow-sm border",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:a.jsx(Tr,{className:"text-purple-600",size:20})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:"Total Purchases"}),a.jsx("p",{className:"text-xl font-bold text-purple-600",children:E(C)})]})]})}),a.jsx("div",{className:"bg-white rounded-xl p-4 shadow-sm border",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:a.jsx(da,{className:"text-green-600",size:20})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:"Total Paid"}),a.jsx("p",{className:"text-xl font-bold text-green-600",children:E(I)})]})]})}),a.jsx("div",{className:"bg-white rounded-xl p-4 shadow-sm border",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:a.jsx(hn,{className:"text-red-600",size:20})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:"Outstanding"}),a.jsx("p",{className:"text-xl font-bold text-red-600",children:E(ne)})]})]})}),a.jsx("div",{className:"bg-white rounded-xl p-4 shadow-sm border",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:a.jsx(ro,{className:"text-blue-600",size:20})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:"Purchase Count"}),a.jsx("p",{className:"text-xl font-bold text-blue-600",children:W})]})]})})]}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm border p-4 mb-4",children:a.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(l2,{size:18,className:"text-gray-500"}),a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Filters:"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(Na,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Search purchase #...",value:p,onChange:H=>g(H.target.value),className:"pl-9 pr-3 py-2 border border-gray-300 rounded-lg text-sm w-48 focus:ring-2 focus:ring-purple-500 focus:border-purple-500"})]}),a.jsx("input",{type:"date",value:y,onChange:H=>v(H.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-purple-500 focus:border-purple-500",title:"Start Date"}),a.jsx("input",{type:"date",value:j,onChange:H=>b(H.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-purple-500 focus:border-purple-500",title:"End Date"}),a.jsxs("select",{value:w,onChange:H=>k(H.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-purple-500 focus:border-purple-500",children:[a.jsx("option",{value:"",children:"All Status"}),a.jsx("option",{value:"unpaid",children:"Unpaid"}),a.jsx("option",{value:"partial",children:"Partial"}),a.jsx("option",{value:"paid",children:"Paid"})]}),S&&a.jsxs("button",{onClick:N,className:"flex items-center gap-1 px-3 py-2 text-sm text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:[a.jsx(yt,{size:16}),"Clear"]}),a.jsxs("div",{className:"ml-auto text-sm text-gray-500",children:["Showing ",c.length," of ",l.length," purchases"]})]})}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border overflow-hidden",children:[a.jsx("div",{className:"p-4 border-b bg-purple-50",children:a.jsxs("h3",{className:"font-semibold text-purple-900 flex items-center gap-2",children:[a.jsx(Br,{size:18}),"Raw Material Purchases"]})}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Purchase #"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),a.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Total"}),a.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Paid"}),a.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Balance"}),a.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Status"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Notes"}),a.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:c.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:8,className:"px-4 py-8 text-center text-gray-500",children:l.length===0?"No purchases found for this manufacturer":"No purchases match the filters"})}):c.map(H=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 font-medium text-purple-600",children:H.purchaseNumber}),a.jsx("td",{className:"px-4 py-3 text-gray-600",children:R(H.purchaseDate)}),a.jsx("td",{className:"px-4 py-3 text-right font-medium",children:E(H.totalAmount)}),a.jsx("td",{className:"px-4 py-3 text-right text-green-600",children:E(H.paidAmount)}),a.jsx("td",{className:"px-4 py-3 text-right text-red-600",children:E(H.totalAmount-H.paidAmount)}),a.jsx("td",{className:"px-4 py-3 text-center",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${H.paymentStatus==="paid"?"bg-green-100 text-green-700":H.paymentStatus==="partial"?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:H.paymentStatus.toUpperCase()})}),a.jsx("td",{className:"px-4 py-3 text-gray-500 text-sm",children:H.notes||"-"}),a.jsx("td",{className:"px-4 py-3 text-center",children:a.jsx("button",{onClick:()=>O(H.id),className:"text-purple-600 hover:text-purple-800 text-sm font-medium",children:"View Details"})})]},H.id))}),l.length>0&&a.jsx("tfoot",{className:"bg-gray-50 font-semibold",children:a.jsxs("tr",{children:[a.jsx("td",{colSpan:2,className:"px-4 py-3",children:"Total"}),a.jsx("td",{className:"px-4 py-3 text-right",children:E(C)}),a.jsx("td",{className:"px-4 py-3 text-right text-green-600",children:E(I)}),a.jsx("td",{className:"px-4 py-3 text-right text-red-600",children:E(ne)}),a.jsx("td",{colSpan:3})]})})]})})]}),d&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-3xl max-h-[90vh] overflow-hidden",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-purple-600 text-white",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-lg font-semibold",children:"Purchase Details"}),a.jsx("p",{className:"text-purple-200 text-sm",children:d.purchaseNumber})]}),a.jsx("button",{onClick:()=>h(null),className:"p-1 hover:bg-purple-700 rounded",children:a.jsx(ff,{size:20})})]}),f?a.jsx("div",{className:"p-8 flex justify-center",children:a.jsx(vt,{className:"animate-spin text-purple-600",size:32})}):a.jsxs("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-80px)]",children:[a.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:"Date"}),a.jsx("p",{className:"font-medium",children:R(d.purchaseDate)})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:"Total"}),a.jsx("p",{className:"font-medium",children:E(d.totalAmount)})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:"Status"}),a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${d.paymentStatus==="paid"?"bg-green-100 text-green-700":d.paymentStatus==="partial"?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:d.paymentStatus.toUpperCase()})]})]}),a.jsx("h3",{className:"font-semibold mb-3",children:"Items"}),a.jsxs("table",{className:"w-full border",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500",children:"Material"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500",children:"Warehouse"}),a.jsx("th",{className:"px-3 py-2 text-right text-xs font-medium text-gray-500",children:"Qty"}),a.jsx("th",{className:"px-3 py-2 text-right text-xs font-medium text-gray-500",children:"Unit Price"}),a.jsx("th",{className:"px-3 py-2 text-right text-xs font-medium text-gray-500",children:"Total"})]})}),a.jsx("tbody",{className:"divide-y",children:d.items.map(H=>a.jsxs("tr",{children:[a.jsxs("td",{className:"px-3 py-2",children:[a.jsx("p",{className:"font-medium",children:H.rawMaterialName}),a.jsx("p",{className:"text-xs text-gray-500",children:H.rawMaterialCode})]}),a.jsx("td",{className:"px-3 py-2 text-gray-600",children:H.warehouseName}),a.jsxs("td",{className:"px-3 py-2 text-right",children:[H.quantity," ",H.unit]}),a.jsx("td",{className:"px-3 py-2 text-right",children:E(H.unitPrice)}),a.jsx("td",{className:"px-3 py-2 text-right font-medium",children:E(H.lineTotal)})]},H.id))})]}),a.jsxs("div",{className:"mt-4 border-t pt-4 space-y-2",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Subtotal"}),a.jsx("span",{children:E(d.subtotal)})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Tax"}),a.jsx("span",{children:E(d.taxAmount)})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Shipping"}),a.jsx("span",{children:E(d.shippingCost)})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Discount"}),a.jsxs("span",{children:["-",E(d.discountAmount)]})]}),a.jsxs("div",{className:"flex justify-between font-bold text-lg border-t pt-2",children:[a.jsx("span",{children:"Total"}),a.jsx("span",{children:E(d.totalAmount)})]}),a.jsxs("div",{className:"flex justify-between text-green-600",children:[a.jsx("span",{children:"Paid"}),a.jsx("span",{children:E(d.paidAmount)})]}),a.jsxs("div",{className:"flex justify-between text-red-600 font-medium",children:[a.jsx("span",{children:"Balance Due"}),a.jsx("span",{children:E(d.totalAmount-d.paidAmount)})]})]}),d.notes&&a.jsxs("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg",children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase mb-1",children:"Notes"}),a.jsx("p",{className:"text-gray-700",children:d.notes})]})]})]})})]}):a.jsxs("div",{className:"p-6",children:[a.jsx("p",{className:"text-red-500",children:"Manufacturer not found"}),a.jsx("button",{onClick:()=>t(-1),className:"mt-4 text-purple-600 hover:underline",children:"Go Back"})]})}function Ive(){const{id:e}=a6(),t=Hd(),[r,s]=m.useState(!0),[n,i]=m.useState(null),[l,o]=m.useState([]),[c,u]=m.useState([]),[d,h]=m.useState(null),[f,x]=m.useState(!1),[p,g]=m.useState("transactions");m.useEffect(()=>{e&&y()},[e]);const y=async()=>{try{s(!0);const E=parseInt(e),R=await Ha.getById(E);i(R.data||R);const I=((await ie.get(`/orders?customerId=${E}`)).data||[]).map(K=>{var q;return{id:K.id,type:"order",transactionNumber:K.orderNumber,date:K.orderDate,itemCount:((q=K.items)==null?void 0:q.length)||0,totalAmount:K.totalAmount,paidAmount:K.paidAmount,paymentStatus:K.paymentStatus}}),W=((await ie.get(`/tasks?customerId=${E}`)).data||[]).filter(K=>K.status==="completed").map(K=>{var q;return{id:K.id,type:"task",transactionNumber:K.taskNumber,date:K.scheduledDate,itemCount:((q=K.items)==null?void 0:q.length)||0,totalAmount:K.total||0,paidAmount:K.paidAmount||0,paymentStatus:K.debtAmount>0?K.paidAmount>0?"partial":"unpaid":"paid"}}),Q=[...I,...W].sort((K,q)=>new Date(q.date).getTime()-new Date(K.date).getTime());o(Q);const H=await ie.get(`/collections?customerId=${E}`);u(H.data||[])}catch(E){console.error("Failed to load data:",E)}finally{s(!1)}},v=async E=>{try{if(x(!0),E.type==="order"){const C=(await ie.get(`/orders/${E.id}`)).data;h({id:C.id,type:"order",transactionNumber:C.orderNumber,date:C.orderDate,totalAmount:C.totalAmount,paidAmount:C.paidAmount,paymentStatus:C.paymentStatus,paymentType:C.paymentType,notes:C.notes,items:(C.items||[]).map(I=>({id:I.id,productName:I.productName||"Unknown",quantity:I.quantity,unitPrice:I.unitPrice,total:I.total}))})}else{const C=(await ie.get(`/tasks/${E.id}`)).data;h({id:C.id,type:"task",transactionNumber:C.taskNumber,date:C.scheduledDate,totalAmount:C.total||0,paidAmount:C.paidAmount||0,paymentStatus:C.debtAmount>0?C.paidAmount>0?"partial":"unpaid":"paid",paymentType:C.paymentType,notes:C.notes,items:(C.items||[]).map(I=>({id:I.id,productName:I.productName||"Unknown",quantity:I.quantity,unitPrice:I.unitPrice,total:I.total}))})}}catch(R){console.error("Failed to load transaction detail:",R)}finally{x(!1)}},j=E=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(E),b=E=>new Date(E).toLocaleDateString(),w=l.reduce((E,R)=>E+R.totalAmount,0),k=l.reduce((E,R)=>E+R.paidAmount,0),N=c.reduce((E,R)=>E+R.amount,0),S=(n==null?void 0:n.debtBalance)||0,_=l.length,O=()=>{const E=`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Customer Report - ${n==null?void 0:n.name}</title>
        <style>
          * { margin: 0; padding: 0; box-sizing: border-box; }
          body { font-family: Arial, sans-serif; font-size: 12px; padding: 20px; }
          .header { text-align: center; margin-bottom: 20px; border-bottom: 2px solid #ec4899; padding-bottom: 10px; }
          .header h1 { font-size: 24px; color: #ec4899; margin-bottom: 5px; }
          .info-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 20px; background: #fdf2f8; padding: 15px; border-radius: 8px; }
          .info-item .label { font-size: 10px; color: #666; text-transform: uppercase; }
          .info-item .value { font-weight: bold; }
          .summary-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-bottom: 20px; }
          .summary-card { border: 1px solid #ddd; padding: 12px; border-radius: 5px; text-align: center; }
          .summary-card .label { font-size: 10px; color: #666; text-transform: uppercase; }
          .summary-card .value { font-size: 18px; font-weight: bold; margin-top: 5px; }
          .summary-card .value.pink { color: #ec4899; }
          .summary-card .value.green { color: #22c55e; }
          .summary-card .value.red { color: #ef4444; }
          .section { margin-bottom: 20px; }
          .section h2 { font-size: 16px; margin-bottom: 10px; border-bottom: 1px solid #ec4899; padding-bottom: 5px; color: #ec4899; }
          table { width: 100%; border-collapse: collapse; margin-bottom: 15px; }
          th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
          th { background: #fdf2f8; font-weight: bold; }
          .text-right { text-align: right; }
          .text-center { text-align: center; }
          .status-paid { color: #22c55e; font-weight: bold; }
          .status-unpaid { color: #ef4444; font-weight: bold; }
          .status-partial { color: #f59e0b; font-weight: bold; }
          .footer { text-align: center; margin-top: 20px; padding-top: 10px; border-top: 1px solid #ddd; color: #666; font-size: 10px; }
          @media print { body { padding: 0; } }
        </style>
      </head>
      <body>
        <div class="header">
          <h1>Customer Report</h1>
          <p>Customer Statement</p>
          <p style="margin-top: 5px; color: #666;">Generated: ${new Date().toLocaleString()}</p>
        </div>
        
        <div class="info-grid">
          <div class="info-item">
            <div class="label">Customer Name</div>
            <div class="value">${n==null?void 0:n.name}</div>
          </div>
          <div class="info-item">
            <div class="label">Shop Name</div>
            <div class="value">${(n==null?void 0:n.shopName)||"-"}</div>
          </div>
          <div class="info-item">
            <div class="label">Phone</div>
            <div class="value">${(n==null?void 0:n.phone)||"-"}</div>
          </div>
          <div class="info-item">
            <div class="label">Email</div>
            <div class="value">${(n==null?void 0:n.email)||"-"}</div>
          </div>
          <div class="info-item">
            <div class="label">Type</div>
            <div class="value">${(n==null?void 0:n.customerType)||"-"}</div>
          </div>
          <div class="info-item">
            <div class="label">Credit Limit</div>
            <div class="value">${j((n==null?void 0:n.creditLimit)||0)}</div>
          </div>
        </div>
        
        <div class="summary-grid">
          <div class="summary-card">
            <div class="label">Total Purchases</div>
            <div class="value pink">${j(w)}</div>
          </div>
          <div class="summary-card">
            <div class="label">Total Paid</div>
            <div class="value green">${j(k+N)}</div>
          </div>
          <div class="summary-card">
            <div class="label">Outstanding</div>
            <div class="value red">${j(S)}</div>
          </div>
          <div class="summary-card">
            <div class="label">Transactions</div>
            <div class="value">${_}</div>
          </div>
        </div>
        
        <div class="section">
          <h2>Sales Transactions</h2>
          <table>
            <thead>
              <tr>
                <th>Transaction #</th>
                <th>Type</th>
                <th>Date</th>
                <th>Items</th>
                <th class="text-right">Total</th>
                <th class="text-right">Paid</th>
                <th class="text-right">Balance</th>
                <th class="text-center">Status</th>
              </tr>
            </thead>
            <tbody>
              ${l.map(C=>`
                <tr>
                  <td>${C.transactionNumber}</td>
                  <td>${C.type==="order"?"POS Order":"Delivery"}</td>
                  <td>${b(C.date)}</td>
                  <td class="text-center">${C.itemCount}</td>
                  <td class="text-right">${j(C.totalAmount)}</td>
                  <td class="text-right">${j(C.paidAmount)}</td>
                  <td class="text-right">${j(C.totalAmount-C.paidAmount)}</td>
                  <td class="text-center status-${C.paymentStatus}">${C.paymentStatus.toUpperCase()}</td>
                </tr>
              `).join("")}
            </tbody>
            <tfoot>
              <tr>
                <th colspan="4">Total</th>
                <th class="text-right">${j(w)}</th>
                <th class="text-right">${j(k)}</th>
                <th class="text-right">${j(w-k)}</th>
                <th></th>
              </tr>
            </tfoot>
          </table>
        </div>
        
        ${c.length>0?`
        <div class="section">
          <h2>Debt Collections</h2>
          <table>
            <thead>
              <tr>
                <th>Collection #</th>
                <th>Date</th>
                <th class="text-right">Amount</th>
                <th class="text-center">Payment Type</th>
                <th>Notes</th>
              </tr>
            </thead>
            <tbody>
              ${c.map(C=>`
                <tr>
                  <td>${C.collectionNumber}</td>
                  <td>${b(C.collectionDate)}</td>
                  <td class="text-right">${j(C.amount)}</td>
                  <td class="text-center">${C.paymentType}</td>
                  <td>${C.notes||"-"}</td>
                </tr>
              `).join("")}
            </tbody>
            <tfoot>
              <tr>
                <th colspan="2">Total Collected</th>
                <th class="text-right">${j(N)}</th>
                <th colspan="2"></th>
              </tr>
            </tfoot>
          </table>
        </div>
        `:""}
        
        <div class="footer">
          <p>Catalyst Customer Report - Customer Statement</p>
        </div>
      </body>
      </html>
    `,R=window.open("","_blank");R&&(R.document.write(E),R.document.close(),R.print())};return r?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx(vt,{className:"animate-spin text-pink-600",size:32})}):n?a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("button",{onClick:()=>t(-1),className:"p-2 hover:bg-gray-100 rounded-lg",children:a.jsx(ff,{size:24})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Customer Report"}),a.jsx("p",{className:"text-gray-500",children:"Customer Statement"})]})]}),a.jsxs("button",{onClick:O,className:"flex items-center gap-2 px-4 py-2 bg-pink-600 text-white rounded-lg hover:bg-pink-700",children:[a.jsx(ua,{size:18}),"Print Report"]})]}),a.jsxs("div",{className:"bg-gradient-to-r from-pink-50 to-pink-100 rounded-xl p-6",children:[a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-bold text-pink-900",children:n.name}),n.shopName&&a.jsx("p",{className:"text-pink-700",children:n.shopName})]}),a.jsx("span",{className:"px-3 py-1 bg-pink-600 text-white text-sm rounded-full",children:n.customerType})]}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-4",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-pink-600 uppercase",children:"Phone"}),a.jsx("p",{className:"font-medium",children:n.phone||"-"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-pink-600 uppercase",children:"Email"}),a.jsx("p",{className:"font-medium",children:n.email||"-"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-pink-600 uppercase",children:"Credit Limit"}),a.jsx("p",{className:"font-medium",children:j(n.creditLimit)})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-pink-600 uppercase",children:"Status"}),a.jsx("p",{className:"font-medium",children:n.status})]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[a.jsx("div",{className:"bg-white rounded-xl p-4 shadow-sm border",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-2 bg-pink-100 rounded-lg",children:a.jsx(ix,{className:"text-pink-600",size:20})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:"Total Purchases"}),a.jsx("p",{className:"text-xl font-bold text-pink-600",children:j(w)})]})]})}),a.jsx("div",{className:"bg-white rounded-xl p-4 shadow-sm border",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:a.jsx(da,{className:"text-green-600",size:20})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:"Total Paid"}),a.jsx("p",{className:"text-xl font-bold text-green-600",children:j(k+N)})]})]})}),a.jsx("div",{className:"bg-white rounded-xl p-4 shadow-sm border",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:a.jsx(hn,{className:"text-red-600",size:20})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:"Outstanding"}),a.jsx("p",{className:"text-xl font-bold text-red-600",children:j(S)})]})]})}),a.jsx("div",{className:"bg-white rounded-xl p-4 shadow-sm border",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:a.jsx(ro,{className:"text-blue-600",size:20})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:"Transactions"}),a.jsx("p",{className:"text-xl font-bold text-blue-600",children:_})]})]})})]}),a.jsxs("div",{className:"flex gap-2 border-b",children:[a.jsx("button",{onClick:()=>g("transactions"),className:`px-4 py-2 font-medium border-b-2 transition-colors ${p==="transactions"?"border-pink-600 text-pink-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Tr,{size:18}),"Sales (",l.length,")"]})}),a.jsx("button",{onClick:()=>g("collections"),className:`px-4 py-2 font-medium border-b-2 transition-colors ${p==="collections"?"border-pink-600 text-pink-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(e4,{size:18}),"Collections (",c.length,")"]})})]}),p==="transactions"&&a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border overflow-hidden",children:[a.jsx("div",{className:"p-4 border-b bg-pink-50",children:a.jsxs("h3",{className:"font-semibold text-pink-900 flex items-center gap-2",children:[a.jsx(Br,{size:18}),"Sales Transactions"]})}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Transaction #"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Type"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),a.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Items"}),a.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Total"}),a.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Paid"}),a.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Balance"}),a.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Status"}),a.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:l.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:9,className:"px-4 py-8 text-center text-gray-500",children:"No transactions found for this customer"})}):l.map(E=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 font-medium text-pink-600",children:E.transactionNumber}),a.jsx("td",{className:"px-4 py-3",children:a.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${E.type==="order"?"bg-blue-100 text-blue-700":"bg-purple-100 text-purple-700"}`,children:E.type==="order"?"POS Order":"Delivery"})}),a.jsx("td",{className:"px-4 py-3 text-gray-600",children:b(E.date)}),a.jsx("td",{className:"px-4 py-3 text-center",children:E.itemCount}),a.jsx("td",{className:"px-4 py-3 text-right font-medium",children:j(E.totalAmount)}),a.jsx("td",{className:"px-4 py-3 text-right text-green-600",children:j(E.paidAmount)}),a.jsx("td",{className:"px-4 py-3 text-right text-red-600",children:j(E.totalAmount-E.paidAmount)}),a.jsx("td",{className:"px-4 py-3 text-center",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${E.paymentStatus==="paid"?"bg-green-100 text-green-700":E.paymentStatus==="partial"?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:E.paymentStatus.toUpperCase()})}),a.jsx("td",{className:"px-4 py-3 text-center",children:a.jsx("button",{onClick:()=>v(E),className:"text-pink-600 hover:text-pink-800 text-sm font-medium",children:"View Details"})})]},`${E.type}-${E.id}`))}),l.length>0&&a.jsx("tfoot",{className:"bg-gray-50 font-semibold",children:a.jsxs("tr",{children:[a.jsx("td",{colSpan:4,className:"px-4 py-3",children:"Total"}),a.jsx("td",{className:"px-4 py-3 text-right",children:j(w)}),a.jsx("td",{className:"px-4 py-3 text-right text-green-600",children:j(k)}),a.jsx("td",{className:"px-4 py-3 text-right text-red-600",children:j(w-k)}),a.jsx("td",{colSpan:2})]})})]})})]}),p==="collections"&&a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border overflow-hidden",children:[a.jsx("div",{className:"p-4 border-b bg-green-50",children:a.jsxs("h3",{className:"font-semibold text-green-900 flex items-center gap-2",children:[a.jsx(e4,{size:18}),"Debt Collections"]})}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Collection #"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),a.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Amount"}),a.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Payment Type"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Notes"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:c.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:5,className:"px-4 py-8 text-center text-gray-500",children:"No collections found for this customer"})}):c.map(E=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 font-medium text-green-600",children:E.collectionNumber}),a.jsx("td",{className:"px-4 py-3 text-gray-600",children:b(E.collectionDate)}),a.jsx("td",{className:"px-4 py-3 text-right font-medium text-green-600",children:j(E.amount)}),a.jsx("td",{className:"px-4 py-3 text-center",children:a.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-700",children:E.paymentType.toUpperCase()})}),a.jsx("td",{className:"px-4 py-3 text-gray-600",children:E.notes||"-"})]},E.id))}),c.length>0&&a.jsx("tfoot",{className:"bg-gray-50 font-semibold",children:a.jsxs("tr",{children:[a.jsx("td",{colSpan:2,className:"px-4 py-3",children:"Total Collected"}),a.jsx("td",{className:"px-4 py-3 text-right text-green-600",children:j(N)}),a.jsx("td",{colSpan:2})]})})]})})]}),d&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-3xl max-h-[90vh] overflow-hidden",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-pink-600 text-white",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-lg font-semibold",children:d.type==="order"?"Order Details":"Delivery Details"}),a.jsx("p",{className:"text-pink-200 text-sm",children:d.transactionNumber})]}),a.jsx("button",{onClick:()=>h(null),className:"p-1 hover:bg-pink-700 rounded",children:a.jsx(ff,{size:20})})]}),f?a.jsx("div",{className:"p-8 flex justify-center",children:a.jsx(vt,{className:"animate-spin text-pink-600",size:32})}):a.jsxs("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-80px)]",children:[a.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:"Date"}),a.jsx("p",{className:"font-medium",children:b(d.date)})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:"Total"}),a.jsx("p",{className:"font-medium",children:j(d.totalAmount)})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase",children:"Status"}),a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${d.paymentStatus==="paid"?"bg-green-100 text-green-700":d.paymentStatus==="partial"?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:d.paymentStatus.toUpperCase()})]})]}),a.jsx("h3",{className:"font-semibold mb-3",children:"Items"}),a.jsxs("table",{className:"w-full border",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500",children:"Product"}),a.jsx("th",{className:"px-3 py-2 text-right text-xs font-medium text-gray-500",children:"Qty"}),a.jsx("th",{className:"px-3 py-2 text-right text-xs font-medium text-gray-500",children:"Unit Price"}),a.jsx("th",{className:"px-3 py-2 text-right text-xs font-medium text-gray-500",children:"Total"})]})}),a.jsx("tbody",{className:"divide-y",children:d.items.map(E=>a.jsxs("tr",{children:[a.jsx("td",{className:"px-3 py-2 font-medium",children:E.productName}),a.jsx("td",{className:"px-3 py-2 text-right",children:E.quantity}),a.jsx("td",{className:"px-3 py-2 text-right",children:j(E.unitPrice)}),a.jsx("td",{className:"px-3 py-2 text-right font-medium",children:j(E.total)})]},E.id))})]}),a.jsxs("div",{className:"mt-4 border-t pt-4 space-y-2",children:[a.jsxs("div",{className:"flex justify-between font-bold text-lg",children:[a.jsx("span",{children:"Total"}),a.jsx("span",{children:j(d.totalAmount)})]}),a.jsxs("div",{className:"flex justify-between text-green-600",children:[a.jsx("span",{children:"Paid"}),a.jsx("span",{children:j(d.paidAmount)})]}),a.jsxs("div",{className:"flex justify-between text-red-600 font-medium",children:[a.jsx("span",{children:"Balance Due"}),a.jsx("span",{children:j(d.totalAmount-d.paidAmount)})]})]}),d.notes&&a.jsxs("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg",children:[a.jsx("p",{className:"text-xs text-gray-500 uppercase mb-1",children:"Notes"}),a.jsx("p",{className:"text-gray-700",children:d.notes})]})]})]})})]}):a.jsxs("div",{className:"p-6",children:[a.jsx("p",{className:"text-red-500",children:"Customer not found"}),a.jsx("button",{onClick:()=>t(-1),className:"mt-4 text-pink-600 hover:underline",children:"Go Back"})]})}function Ove(){const e=py(),[t,r]=m.useState({isOnlineStoreEnabled:!1,storeDescription:"",storeBannerUrl:"",storeThemeColor:"#003366",deliveryEnabled:!1,deliveryFee:0,minOrderAmount:0,storeLat:"",storeLng:"",whatsappNumber:"",storeCategoryId:null,storeCategoryIds:[]}),{data:s,isLoading:n}=Dh({queryKey:["online-store-settings"],queryFn:()=>Sb.get()}),{data:i=[]}=Dh({queryKey:["available-store-categories"],queryFn:()=>Sb.getAvailableCategories()});m.useEffect(()=>{var u,d,h;s&&r({isOnlineStoreEnabled:s.isOnlineStoreEnabled,storeDescription:s.storeDescription||"",storeBannerUrl:s.storeBannerUrl||"",storeThemeColor:s.storeThemeColor||"#003366",deliveryEnabled:s.deliveryEnabled,deliveryFee:s.deliveryFee,minOrderAmount:s.minOrderAmount,storeLat:((u=s.storeLat)==null?void 0:u.toString())||"",storeLng:((d=s.storeLng)==null?void 0:d.toString())||"",whatsappNumber:s.whatsappNumber||"",storeCategoryId:s.storeCategoryId,storeCategoryIds:((h=s.storeCategories)==null?void 0:h.map(f=>f.storeCategoryId))||[]})},[s]);const l=ep({mutationFn:u=>Sb.update(u),onSuccess:()=>{e.invalidateQueries({queryKey:["online-store-settings"]})}}),o=u=>{u.preventDefault(),l.mutate({...t,storeLat:t.storeLat?parseFloat(t.storeLat):null,storeLng:t.storeLng?parseFloat(t.storeLng):null})},c=u=>{r(d=>({...d,storeCategoryIds:d.storeCategoryIds.includes(u)?d.storeCategoryIds.filter(h=>h!==u):[...d.storeCategoryIds,u]}))};return n?a.jsx("div",{className:"flex justify-center py-20",children:a.jsx(vt,{className:"animate-spin text-emerald-500",size:32})}):a.jsxs("div",{className:"max-w-3xl",children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Online Store Settings"}),a.jsx("p",{className:"text-gray-500 mt-1",children:"Configure your online store for the marketplace"})]}),(s==null?void 0:s.isPremium)&&a.jsxs("div",{className:"mb-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg flex items-center gap-3",children:[a.jsx("span",{className:"text-yellow-600 font-medium",children:"Premium Store"}),a.jsxs("span",{className:"text-yellow-700 text-sm capitalize",children:["Tier: ",s.premiumTier]})]}),a.jsxs("form",{onSubmit:o,className:"space-y-8",children:[a.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Z6,{className:"text-emerald-600",size:24}),a.jsxs("div",{children:[a.jsx("h2",{className:"font-semibold text-gray-900",children:"Online Store"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Enable to list your store in the marketplace"})]})]}),a.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:t.isOnlineStoreEnabled,onChange:u=>r({...t,isOnlineStoreEnabled:u.target.checked}),className:"sr-only peer"}),a.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-emerald-600"})]})]})}),a.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 space-y-4",children:[a.jsxs("h2",{className:"font-semibold text-gray-900 flex items-center gap-2",children:[a.jsx(mW,{size:20,className:"text-emerald-600"}),"Store Appearance"]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Store Description"}),a.jsx("textarea",{value:t.storeDescription,onChange:u=>r({...t,storeDescription:u.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500",rows:3,placeholder:"Describe your store..."})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Banner Image URL"}),a.jsx("input",{type:"text",value:t.storeBannerUrl,onChange:u=>r({...t,storeBannerUrl:u.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500",placeholder:"https://..."})]}),a.jsx("div",{className:"flex items-center gap-4",children:a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Theme Color"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"color",value:t.storeThemeColor,onChange:u=>r({...t,storeThemeColor:u.target.value}),className:"w-10 h-10 rounded cursor-pointer border border-gray-300"}),a.jsx("input",{type:"text",value:t.storeThemeColor,onChange:u=>r({...t,storeThemeColor:u.target.value}),className:"w-28 px-3 py-2 border border-gray-300 rounded-lg text-sm"})]})]})})]}),a.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 space-y-4",children:[a.jsx("h2",{className:"font-semibold text-gray-900",children:"Store Categories"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Select the categories that describe your store"}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.map(u=>a.jsx("button",{type:"button",onClick:()=>c(u.id),className:`px-4 py-2 rounded-full text-sm font-medium transition-colors ${t.storeCategoryIds.includes(u.id)?"bg-emerald-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:u.name},u.id)),i.length===0&&a.jsx("p",{className:"text-gray-400 text-sm",children:"No categories available. Admin needs to create them first."})]})]}),a.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("h2",{className:"font-semibold text-gray-900 flex items-center gap-2",children:[a.jsx(On,{size:20,className:"text-emerald-600"}),"Delivery Settings"]}),a.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:t.deliveryEnabled,onChange:u=>r({...t,deliveryEnabled:u.target.checked}),className:"sr-only peer"}),a.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-emerald-600"})]})]}),t.deliveryEnabled&&a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Delivery Fee"}),a.jsx("input",{type:"number",step:"0.01",value:t.deliveryFee,onChange:u=>r({...t,deliveryFee:parseFloat(u.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Min Order Amount"}),a.jsx("input",{type:"number",step:"0.01",value:t.minOrderAmount,onChange:u=>r({...t,minOrderAmount:parseFloat(u.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"})]})]})]}),a.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 space-y-4",children:[a.jsxs("h2",{className:"font-semibold text-gray-900 flex items-center gap-2",children:[a.jsx(dc,{size:20,className:"text-emerald-600"}),"Store Location"]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Latitude"}),a.jsx("input",{type:"text",value:t.storeLat,onChange:u=>r({...t,storeLat:u.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500",placeholder:"e.g. 33.8938"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Longitude"}),a.jsx("input",{type:"text",value:t.storeLng,onChange:u=>r({...t,storeLng:u.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500",placeholder:"e.g. 35.5018"})]})]})]}),a.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 space-y-4",children:[a.jsxs("h2",{className:"font-semibold text-gray-900 flex items-center gap-2",children:[a.jsx(xW,{size:20,className:"text-emerald-600"}),"WhatsApp"]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"WhatsApp Number"}),a.jsx("input",{type:"text",value:t.whatsappNumber,onChange:u=>r({...t,whatsappNumber:u.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500",placeholder:"+961..."}),a.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Include country code for WhatsApp checkout"})]})]}),a.jsx("div",{className:"flex justify-end",children:a.jsxs("button",{type:"submit",disabled:l.isPending,className:"px-6 py-2.5 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors flex items-center gap-2 font-medium disabled:opacity-50",children:[l.isPending?a.jsx(vt,{className:"animate-spin",size:18}):a.jsx(bW,{size:18}),"Save Settings"]})}),l.isSuccess&&a.jsx("p",{className:"text-green-600 text-sm text-right",children:"Settings saved successfully!"}),l.isError&&a.jsx("p",{className:"text-red-600 text-sm text-right",children:"Failed to save settings. Please try again."})]})]})}const Dve=[{key:"",label:"All",icon:Tr},{key:"pending",label:"Pending",icon:Up},{key:"confirmed",label:"Confirmed",icon:o0},{key:"preparing",label:"Preparing",icon:Tr},{key:"delivering",label:"Delivering",icon:On},{key:"delivered",label:"Delivered",icon:o0},{key:"cancelled",label:"Cancelled",icon:Dj}],Fve={pending:"bg-yellow-100 text-yellow-800",confirmed:"bg-blue-100 text-blue-800",preparing:"bg-purple-100 text-purple-800",delivering:"bg-orange-100 text-orange-800",delivered:"bg-green-100 text-green-800",cancelled:"bg-red-100 text-red-800"},m1={pending:"confirmed",confirmed:"preparing",preparing:"delivering",delivering:"delivered"};function Rve(){const[e,t]=m.useState(""),[r,s]=m.useState(null),[n,i]=m.useState(""),[l,o]=m.useState(null),[c,u]=m.useState(null),d=py(),{data:h=[],isLoading:f}=Dh({queryKey:["online-orders",e],queryFn:()=>sh.getAll({status:e||void 0}),refetchInterval:15e3}),{data:x}=Dh({queryKey:["online-order-stats"],queryFn:()=>sh.getStats(),refetchInterval:15e3}),{data:p}=Dh({queryKey:["employees-all"],queryFn:()=>hs.getAll()}),g=(p==null?void 0:p.data)||[],y=ep({mutationFn:({id:S,status:_,cancelReason:O})=>sh.updateStatus(S,{status:_,cancelReason:O}),onSuccess:()=>{d.invalidateQueries({queryKey:["online-orders"]}),d.invalidateQueries({queryKey:["online-order-stats"]})}}),v=ep({mutationFn:({id:S,driverId:_})=>sh.assignDriver(S,{driverId:_}),onSuccess:()=>{d.invalidateQueries({queryKey:["online-orders"]}),u(null)}}),j=ep({mutationFn:S=>sh.requestDriver(S),onSuccess:()=>{d.invalidateQueries({queryKey:["online-orders"]}),d.invalidateQueries({queryKey:["online-order-stats"]})}}),b=S=>S.deliveryType==="delivery"&&!["delivered","cancelled"].includes(S.status)&&!S.assignedCompanyDriverId&&!S.assignedFreelanceDriverId,w=S=>{const _=m1[S.status];_&&y.mutate({id:S.id,status:_})},k=S=>{y.mutate({id:S,status:"cancelled",cancelReason:n}),o(null),i("")},N=S=>S.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2});return a.jsxs("div",{children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Online Orders"}),a.jsx("p",{className:"text-gray-500 mt-1",children:"Manage incoming online orders"})]}),x&&a.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[a.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Today's Orders"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:x.todayOrders})]}),a.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Today's Revenue"}),a.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["$",N(x.todayRevenue)]})]}),a.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[a.jsx("p",{className:"text-sm text-yellow-600",children:"Pending"}),a.jsx("p",{className:"text-2xl font-bold text-yellow-700",children:x.pending})]}),a.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[a.jsx("p",{className:"text-sm text-green-600",children:"Delivered"}),a.jsx("p",{className:"text-2xl font-bold text-green-700",children:x.delivered})]})]}),a.jsx("div",{className:"flex gap-1 mb-6 bg-gray-100 rounded-lg p-1 overflow-x-auto",children:Dve.map(S=>{const _=x?x[S.key]:void 0;return a.jsxs("button",{onClick:()=>t(S.key),className:`px-3 py-2 rounded-md text-sm font-medium transition-colors whitespace-nowrap flex items-center gap-1.5 ${e===S.key?"bg-white text-emerald-700 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:[S.label,_!==void 0&&S.key&&a.jsx("span",{className:"text-xs bg-gray-200 text-gray-600 px-1.5 py-0.5 rounded-full",children:_})]},S.key)})}),f?a.jsx("div",{className:"flex justify-center py-20",children:a.jsx(vt,{className:"animate-spin text-emerald-500",size:32})}):h.length===0?a.jsxs("div",{className:"text-center py-20 text-gray-400",children:["No orders found",e?` with status "${e}"`:"","."]}):a.jsx("div",{className:"space-y-3",children:h.map(S=>a.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[a.jsxs("div",{className:"p-4 flex items-center justify-between cursor-pointer hover:bg-gray-50",onClick:()=>s(r===S.id?null:S.id),children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("div",{children:[a.jsxs("span",{className:"font-semibold text-gray-900",children:["#",S.orderNumber||S.id]}),a.jsx("p",{className:"text-sm text-gray-500",children:new Date(S.createdAt).toLocaleString()})]}),a.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[a.jsx(Vp,{size:14}),a.jsx("span",{children:S.customerName}),a.jsx("span",{className:"text-gray-400",children:S.customerPhone})]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("span",{className:"font-bold text-gray-900",children:["$",N(S.total)]}),a.jsx("span",{className:`px-2.5 py-1 rounded-full text-xs font-medium capitalize ${Fve[S.status]||"bg-gray-100 text-gray-600"}`,children:S.status}),S.assignedCompanyDriverId&&a.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs bg-blue-50 text-blue-700",children:"Company Driver"}),S.assignedDriverType==="freelance"&&!S.assignedFreelanceDriverId&&a.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs bg-orange-50 text-orange-700",children:"Awaiting Freelancer"}),S.assignedFreelanceDriverId&&a.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs bg-purple-50 text-purple-700",children:"Freelance Driver"}),b(S)&&a.jsxs("div",{className:"flex items-center gap-1",onClick:_=>_.stopPropagation(),children:[a.jsxs("button",{onClick:()=>u(S.id),className:"px-2.5 py-1 text-xs font-medium bg-blue-50 text-blue-700 rounded-md hover:bg-blue-100 flex items-center gap-1",title:"Assign company driver",children:[a.jsx(Ed,{size:12})," Assign Driver"]}),a.jsxs("button",{onClick:()=>j.mutate(S.id),disabled:j.isPending,className:"px-2.5 py-1 text-xs font-medium bg-purple-50 text-purple-700 rounded-md hover:bg-purple-100 flex items-center gap-1 disabled:opacity-50",title:"Send to external freelance delivery",children:[a.jsx(cW,{size:12})," External Delivery"]})]}),a.jsxs("span",{className:"text-gray-400 text-sm",children:[S.itemCount," items"]}),r===S.id?a.jsx(G6,{size:18}):a.jsx(i2,{size:18})]})]}),r===S.id&&a.jsx("div",{className:"border-t border-gray-100 p-4 bg-gray-50",children:a.jsxs("div",{className:"grid grid-cols-3 gap-6",children:[a.jsxs("div",{className:"col-span-2",children:[a.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:"Order Items"}),a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"text-gray-500 border-b border-gray-200",children:[a.jsx("th",{className:"text-left pb-2",children:"Product"}),a.jsx("th",{className:"text-right pb-2",children:"Qty"}),a.jsx("th",{className:"text-right pb-2",children:"Price"}),a.jsx("th",{className:"text-right pb-2",children:"Total"})]})}),a.jsx("tbody",{children:S.items.map(_=>a.jsxs("tr",{className:"border-b border-gray-100",children:[a.jsx("td",{className:"py-2 text-gray-800",children:_.productName}),a.jsxs("td",{className:"py-2 text-right text-gray-600",children:[_.quantity," ",_.unitType]}),a.jsxs("td",{className:"py-2 text-right text-gray-600",children:["$",N(_.unitPrice)]}),a.jsxs("td",{className:"py-2 text-right font-medium text-gray-800",children:["$",N(_.total)]})]},_.id))}),a.jsxs("tfoot",{children:[a.jsxs("tr",{className:"text-gray-500",children:[a.jsx("td",{colSpan:3,className:"pt-2 text-right",children:"Subtotal:"}),a.jsxs("td",{className:"pt-2 text-right",children:["$",N(S.subtotal)]})]}),S.deliveryFee>0&&a.jsxs("tr",{className:"text-gray-500",children:[a.jsx("td",{colSpan:3,className:"text-right",children:"Delivery:"}),a.jsxs("td",{className:"text-right",children:["$",N(S.deliveryFee)]})]}),S.discount>0&&a.jsxs("tr",{className:"text-green-600",children:[a.jsx("td",{colSpan:3,className:"text-right",children:"Discount:"}),a.jsxs("td",{className:"text-right",children:["-$",N(S.discount)]})]}),a.jsxs("tr",{className:"font-bold text-gray-900",children:[a.jsx("td",{colSpan:3,className:"text-right pt-1",children:"Total:"}),a.jsxs("td",{className:"text-right pt-1",children:["$",N(S.total)]})]})]})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:"Customer"}),a.jsx("p",{className:"text-sm text-gray-800",children:S.customerName}),a.jsxs("p",{className:"text-sm text-gray-500 flex items-center gap-1",children:[a.jsx(Vp,{size:12})," ",S.customerPhone]}),S.deliveryAddress&&a.jsxs("p",{className:"text-sm text-gray-500 flex items-center gap-1 mt-1",children:[a.jsx(dc,{size:12})," ",S.deliveryAddress]}),S.notes&&a.jsxs("p",{className:"text-sm text-gray-500 flex items-center gap-1 mt-1",children:[a.jsx(Br,{size:12})," ",S.notes]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:"Info"}),a.jsxs("div",{className:"text-sm space-y-1",children:[a.jsxs("p",{className:"text-gray-500",children:["Payment: ",a.jsx("span",{className:"text-gray-700",children:S.paymentMethod||"N/A"})]}),a.jsxs("p",{className:"text-gray-500",children:["Delivery: ",a.jsx("span",{className:"text-gray-700 capitalize",children:S.deliveryType})]})]})]}),a.jsxs("div",{className:"space-y-2 pt-2",children:[m1[S.status]&&a.jsxs("button",{onClick:()=>w(S),disabled:y.isPending,className:"w-full px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 text-sm font-medium disabled:opacity-50 flex items-center justify-center gap-2",children:[y.isPending&&a.jsx(vt,{className:"animate-spin",size:14}),'Move to "',m1[S.status],'"']}),S.status==="pending"&&a.jsx("button",{onClick:()=>o(S.id),className:"w-full px-4 py-2 bg-red-50 text-red-600 rounded-lg hover:bg-red-100 text-sm font-medium",children:"Cancel Order"})]})]})]})})]},S.id))}),l&&a.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-sm",children:[a.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Cancel Order"}),a.jsx("textarea",{value:n,onChange:S=>i(S.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm mb-4",rows:3,placeholder:"Reason for cancellation (optional)..."}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:()=>{o(null),i("")},className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg text-sm",children:"Keep Order"}),a.jsx("button",{onClick:()=>k(l),className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg text-sm hover:bg-red-700",children:"Cancel Order"})]})]})}),c&&a.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md",children:[a.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:"Assign Company Driver"}),a.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Select a driver from your team to deliver this order"}),g.length===0?a.jsx("div",{className:"text-center py-6 text-gray-400 text-sm",children:'No drivers found. Add employees with a "driver" role first.'}):a.jsx("div",{className:"max-h-64 overflow-y-auto space-y-2 mb-4",children:g.map(S=>{var _,O;return a.jsxs("button",{onClick:()=>v.mutate({id:c,driverId:S.id}),disabled:v.isPending,className:"w-full flex items-center gap-3 p-3 rounded-lg border border-gray-200 hover:border-blue-300 hover:bg-blue-50 transition-colors text-left disabled:opacity-50",children:[a.jsx("div",{className:"w-9 h-9 rounded-full bg-blue-100 text-blue-700 flex items-center justify-center font-semibold text-sm",children:((O=(_=S.name)==null?void 0:_.charAt(0))==null?void 0:O.toUpperCase())||"?"}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:S.name}),a.jsx("p",{className:"text-xs text-gray-500",children:S.phone||S.role||"Driver"})]}),a.jsx(Ed,{size:14,className:"text-gray-400"})]},S.id)})}),a.jsx("button",{onClick:()=>u(null),className:"w-full px-4 py-2 border border-gray-300 rounded-lg text-sm text-gray-700 hover:bg-gray-50",children:"Cancel"})]})})]})}function Mve(){const[e,t]=m.useState(!0),[r,s]=m.useState([]),[n,i]=m.useState(0),[l,o]=m.useState([]),[c,u]=m.useState([]),[d,h]=m.useState(!1),[f,x]=m.useState(!1),[p,g]=m.useState(""),[y,v]=m.useState(""),[j,b]=m.useState(null),[w,k]=m.useState(""),[N,S]=m.useState(!1),[_,O]=m.useState(""),[E,R]=m.useState("set"),[C,I]=m.useState(""),[ne,W]=m.useState(""),[Q,H]=m.useState(""),[K,q]=m.useState(null);m.useEffect(()=>{const he=new URLSearchParams(window.location.search).get("productId");he&&q(parseInt(he))},[]);const ge=async()=>{t(!0);try{const[F,he,ye]=await Promise.all([br.getAll(),Ks.getAll(),br.getStockAdjustments({productId:p||void 0,warehouseId:y||void 0})]);if(o(F.data),u(he.data),s(ye.data.items),i(ye.data.total),K){const z=F.data.find(A=>A.id===K);z&&(b(z),k(z.name),h(!0)),q(null)}}catch(F){console.error("Failed to load data:",F)}finally{t(!1)}};m.useEffect(()=>{ge()},[p,y]);const G=async F=>{var he,ye;if(F.preventDefault(),!(!j||!_)){x(!0);try{await br.adjustStock({productId:j.id,warehouseId:_,adjustmentType:E,baseUnitQuantity:parseFloat(C)||0,secondUnitQuantity:ne?parseFloat(ne):null,reason:Q||null}),h(!1),B(),ge()}catch(z){alert(((ye=(he=z.response)==null?void 0:he.data)==null?void 0:ye.message)||"Failed to adjust stock")}finally{x(!1)}}},B=()=>{b(null),k(""),O(""),R("set"),I(""),W(""),H("")},se=F=>{B(),h(!0)},L=l.filter(F=>F.name.toLowerCase().includes(w.toLowerCase())||F.sku.toLowerCase().includes(w.toLowerCase())),Z=F=>{const he=new Date(F);return he.toLocaleDateString()+" "+he.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})};return e&&r.length===0?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx(vt,{className:"animate-spin text-emerald-500",size:32})}):a.jsxs("div",{className:"p-4 md:p-6 max-w-7xl mx-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{children:[a.jsxs("h1",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[a.jsx(Fh,{size:24}),"Stock Adjustment"]}),a.jsxs("p",{className:"text-gray-500 text-sm mt-1",children:[n," adjustment",n!==1?"s":""," recorded"]})]}),a.jsx(qr,{permission:Ve.ADJUST_STOCK_LEVELS,children:a.jsxs("button",{onClick:()=>se(),className:"flex items-center gap-2 px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600",children:[a.jsx(hr,{size:18}),"New Adjustment"]})})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-4 mb-4 flex flex-wrap gap-3",children:[a.jsxs("select",{value:p,onChange:F=>g(F.target.value?parseInt(F.target.value):""),className:"px-3 py-2 border rounded-lg text-sm",children:[a.jsx("option",{value:"",children:"All Products"}),l.map(F=>a.jsxs("option",{value:F.id,children:[F.name," (",F.sku,")"]},F.id))]}),a.jsxs("select",{value:y,onChange:F=>v(F.target.value?parseInt(F.target.value):""),className:"px-3 py-2 border rounded-lg text-sm",children:[a.jsx("option",{value:"",children:"All Warehouses"}),c.map(F=>a.jsx("option",{value:F.id,children:F.name},F.id))]})]}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm border overflow-hidden",children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50 text-gray-600",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left",children:"Date"}),a.jsx("th",{className:"px-4 py-3 text-left",children:"Product"}),a.jsx("th",{className:"px-4 py-3 text-left",children:"Warehouse"}),a.jsx("th",{className:"px-4 py-3 text-right",children:"Change"}),a.jsx("th",{className:"px-4 py-3 text-left",children:"Notes"})]})}),a.jsx("tbody",{className:"divide-y",children:r.length===0?a.jsx("tr",{children:a.jsxs("td",{colSpan:5,className:"px-4 py-12 text-center text-gray-400",children:[a.jsx(Fh,{size:32,className:"mx-auto mb-2 opacity-50"}),"No stock adjustments recorded yet"]})}):r.map(F=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 text-gray-500 whitespace-nowrap",children:Z(F.createdAt)}),a.jsxs("td",{className:"px-4 py-3",children:[a.jsx("div",{className:"font-medium",children:F.productName}),a.jsx("div",{className:"text-xs text-gray-400",children:F.productSku})]}),a.jsx("td",{className:"px-4 py-3 text-gray-600",children:F.warehouseName}),a.jsxs("td",{className:"px-4 py-3 text-right",children:[a.jsxs("span",{className:`font-semibold ${F.quantity>0?"text-green-600":F.quantity<0?"text-red-600":"text-gray-500"}`,children:[F.quantity>0?"+":"",F.quantity," ",F.baseUnit]}),F.secondUnit&&F.unitsPerSecond>0&&a.jsxs("div",{className:"text-xs text-gray-400",children:["(",F.quantity>0?"+":"",(F.quantity/F.unitsPerSecond).toFixed(1)," ",F.secondUnit,")"]})]}),a.jsx("td",{className:"px-4 py-3 text-gray-500 text-xs max-w-[250px] truncate",children:F.notes})]},F.id))})]})})}),d&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-lg",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[a.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[a.jsx(Fh,{size:20}),"Stock Adjustment"]}),a.jsx("button",{onClick:()=>{h(!1),B()},children:a.jsx(yt,{size:20})})]}),a.jsxs("form",{onSubmit:G,className:"p-4 space-y-4",children:[a.jsxs("div",{className:"relative",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Product *"}),a.jsxs("div",{className:"relative",children:[a.jsx(Na,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),a.jsx("input",{type:"text",value:w,onChange:F=>{k(F.target.value),S(!0),F.target.value||b(null)},onFocus:()=>S(!0),placeholder:"Search by name or SKU...",className:"w-full pl-9 pr-3 py-2 border rounded-lg text-sm",required:!0})]}),N&&w&&!j&&a.jsxs("div",{className:"absolute z-10 w-full mt-1 bg-white border rounded-lg shadow-lg max-h-48 overflow-y-auto",children:[L.slice(0,20).map(F=>a.jsxs("button",{type:"button",onClick:()=>{b(F),k(F.name),S(!1)},className:"w-full px-3 py-2 text-left hover:bg-gray-50 text-sm flex justify-between",children:[a.jsx("span",{className:"font-medium",children:F.name}),a.jsx("span",{className:"text-gray-400",children:F.sku})]},F.id)),L.length===0&&a.jsx("div",{className:"px-3 py-2 text-gray-400 text-sm",children:"No products found"})]}),j&&a.jsxs("div",{className:"mt-1 text-xs text-gray-500",children:["Unit: ",a.jsx("strong",{children:j.baseUnit}),j.secondUnit&&a.jsxs(a.Fragment,{children:[" | ",j.secondUnit," (",j.unitsPerSecond," ",j.baseUnit," per ",j.secondUnit,")"]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Warehouse *"}),a.jsxs("select",{value:_,onChange:F=>O(F.target.value?parseInt(F.target.value):""),className:"w-full px-3 py-2 border rounded-lg text-sm",required:!0,children:[a.jsx("option",{value:"",children:"Select warehouse..."}),c.map(F=>a.jsx("option",{value:F.id,children:F.name},F.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Adjustment Type"}),a.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[a.jsxs("button",{type:"button",onClick:()=>R("set"),className:`py-2 px-3 rounded-lg border text-sm font-medium flex items-center justify-center gap-1 ${E==="set"?"bg-blue-50 border-blue-500 text-blue-700":"hover:bg-gray-50"}`,children:[a.jsx(lW,{size:16})," Set To"]}),a.jsxs("button",{type:"button",onClick:()=>R("add"),className:`py-2 px-3 rounded-lg border text-sm font-medium flex items-center justify-center gap-1 ${E==="add"?"bg-green-50 border-green-500 text-green-700":"hover:bg-gray-50"}`,children:[a.jsx(YU,{size:16})," Add"]}),a.jsxs("button",{type:"button",onClick:()=>R("subtract"),className:`py-2 px-3 rounded-lg border text-sm font-medium flex items-center justify-center gap-1 ${E==="subtract"?"bg-red-50 border-red-500 text-red-700":"hover:bg-gray-50"}`,children:[a.jsx(KU,{size:16})," Subtract"]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(j==null?void 0:j.baseUnit)||"Base Unit"," Qty *"]}),a.jsx("input",{type:"number",value:C,onChange:F=>I(F.target.value),min:"0",step:"any",className:"w-full px-3 py-2 border rounded-lg text-sm",placeholder:"0",required:!0})]}),(j==null?void 0:j.secondUnit)&&j.unitsPerSecond>0&&a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[j.secondUnit," Qty"]}),a.jsx("input",{type:"number",value:ne,onChange:F=>W(F.target.value),min:"0",step:"any",className:"w-full px-3 py-2 border rounded-lg text-sm",placeholder:"0"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reason"}),a.jsxs("select",{value:Q,onChange:F=>H(F.target.value),className:"w-full px-3 py-2 border rounded-lg text-sm",children:[a.jsx("option",{value:"",children:"Select reason..."}),a.jsx("option",{value:"Physical Count",children:"Physical Count"}),a.jsx("option",{value:"Damaged",children:"Damaged"}),a.jsx("option",{value:"Expired",children:"Expired"}),a.jsx("option",{value:"Lost",children:"Lost"}),a.jsx("option",{value:"Returned to Supplier",children:"Returned to Supplier"}),a.jsx("option",{value:"Received from Supplier",children:"Received from Supplier"}),a.jsx("option",{value:"Transfer",children:"Transfer"}),a.jsx("option",{value:"Correction",children:"Correction"}),a.jsx("option",{value:"Other",children:"Other"})]})]}),a.jsxs("div",{className:"flex gap-3 pt-2",children:[a.jsx("button",{type:"button",onClick:()=>{h(!1),B()},className:"flex-1 py-2 border rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsxs("button",{type:"submit",disabled:f||!j||!_,className:"flex-1 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 disabled:opacity-50 flex items-center justify-center gap-2",children:[f?a.jsx(vt,{size:16,className:"animate-spin"}):a.jsx(Jt,{size:16}),f?"Saving...":"Apply Adjustment"]})]})]})]})})]})}const p1=[{value:"asset",label:"Asset",color:"bg-blue-100 text-blue-800"},{value:"liability",label:"Liability",color:"bg-orange-100 text-orange-800"},{value:"equity",label:"Equity",color:"bg-purple-100 text-purple-800"},{value:"revenue",label:"Revenue",color:"bg-green-100 text-green-800"},{value:"expense",label:"Expense",color:"bg-red-100 text-red-800"}],Lve={asset:["Current Asset","Fixed Asset","Other Asset"],liability:["Current Liability","Long-term Liability"],equity:["Equity"],revenue:["Income","Other Income"],expense:["COGS","Operating Expense","Other Expense"]};function $ve(){const[e,t]=m.useState([]),[r,s]=m.useState(!0),[n,i]=m.useState(""),[l,o]=m.useState(""),[c,u]=m.useState(!1),[d,h]=m.useState(null),[f,x]=m.useState(!1),[p,g]=m.useState({asset:!0,liability:!0,equity:!0,revenue:!0,expense:!0}),[y,v]=m.useState({code:"",name:"",accountType:"asset",category:"",parentId:null,description:"",isActive:!0}),[j,b]=m.useState(!1),[w,k]=m.useState(!1);m.useEffect(()=>{N()},[]);const N=async()=>{try{s(!0);const Q=await Sn.getAccounts();t(Q)}catch(Q){console.error("Failed to load accounts:",Q)}finally{s(!1)}},S=()=>{h(null),v({code:"",name:"",accountType:"asset",category:"",parentId:null,description:"",isActive:!0}),u(!0)},_=Q=>{h(Q),v({code:Q.code,name:Q.name,accountType:Q.accountType,category:Q.category||"",parentId:Q.parentId,description:Q.description||"",isActive:Q.isActive}),u(!0)},O=async()=>{var Q,H;if(!(!y.code||!y.name||!y.accountType)){x(!0);try{d?await Sn.updateAccount(d.id,y):await Sn.createAccount(y),u(!1),N()}catch(K){alert(((H=(Q=K.response)==null?void 0:Q.data)==null?void 0:H.message)||"Failed to save account")}finally{x(!1)}}},E=async Q=>{var H,K;if(Q.isSystem)return alert("Cannot delete system account");if(confirm(`Delete account "${Q.code} - ${Q.name}"?`))try{await Sn.deleteAccount(Q.id),N()}catch(q){alert(((K=(H=q.response)==null?void 0:H.data)==null?void 0:K.message)||"Failed to delete account")}},R=Q=>{g(H=>({...H,[Q]:!H[Q]}))},C=async()=>{try{k(!0),await Sn.resetAccounting(),b(!1),await N()}catch(Q){console.error("Failed to reset accounting:",Q),alert("Failed to reset accounting data")}finally{k(!1)}},I=e.filter(Q=>{if(l&&Q.accountType!==l)return!1;if(n){const H=n.toLowerCase();return Q.code.toLowerCase().includes(H)||Q.name.toLowerCase().includes(H)||(Q.category||"").toLowerCase().includes(H)}return!0}),ne=p1.map(Q=>({...Q,accounts:I.filter(H=>H.accountType===Q.value)})).filter(Q=>Q.accounts.length>0),W=Q=>Q.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2});return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Chart of Accounts"}),a.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[e.length," accounts"]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("button",{onClick:()=>b(!0),className:"flex items-center gap-2 px-4 py-2 border border-red-300 text-red-600 rounded-lg hover:bg-red-50",children:[a.jsx(ao,{size:18})," Reset Balances"]}),a.jsxs("button",{onClick:S,className:"flex items-center gap-2 px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700",children:[a.jsx(hr,{size:18})," Add Account"]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"bg-white rounded-lg p-4 border",children:[a.jsx("p",{className:"text-xs text-gray-500",children:"Total Assets"}),a.jsxs("p",{className:"text-lg font-bold text-blue-600",children:["$",W(e.filter(Q=>Q.accountType==="asset").reduce((Q,H)=>Q+H.balance,0))]})]}),a.jsxs("div",{className:"bg-white rounded-lg p-4 border",children:[a.jsx("p",{className:"text-xs text-gray-500",children:"Total Liabilities"}),a.jsxs("p",{className:"text-lg font-bold text-orange-600",children:["$",W(e.filter(Q=>Q.accountType==="liability").reduce((Q,H)=>Q+H.balance,0))]})]}),a.jsxs("div",{className:"bg-white rounded-lg p-4 border",children:[a.jsx("p",{className:"text-xs text-gray-500",children:"Total Revenue"}),a.jsxs("p",{className:"text-lg font-bold text-green-600",children:["$",W(e.filter(Q=>Q.accountType==="revenue").reduce((Q,H)=>Q+H.balance,0))]})]}),a.jsxs("div",{className:"bg-white rounded-lg p-4 border",children:[a.jsx("p",{className:"text-xs text-gray-500",children:"Total Expenses"}),a.jsxs("p",{className:"text-lg font-bold text-red-600",children:["$",W(e.filter(Q=>Q.accountType==="expense").reduce((Q,H)=>Q+H.balance,0))]})]})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(Na,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Search accounts...",value:n,onChange:Q=>i(Q.target.value),className:"w-full pl-9 pr-4 py-2 border rounded-lg text-sm"})]}),a.jsxs("select",{value:l,onChange:Q=>o(Q.target.value),className:"border rounded-lg px-3 py-2 text-sm",children:[a.jsx("option",{value:"",children:"All Types"}),p1.map(Q=>a.jsx("option",{value:Q.value,children:Q.label},Q.value))]})]}),r?a.jsx("div",{className:"flex justify-center py-12",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-emerald-500"})}):a.jsx("div",{className:"space-y-4",children:ne.map(Q=>a.jsxs("div",{className:"bg-white rounded-lg border overflow-hidden",children:[a.jsxs("button",{onClick:()=>R(Q.value),className:"w-full flex items-center justify-between px-4 py-3 bg-gray-50 hover:bg-gray-100 transition-colors",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[p[Q.value]?a.jsx(i2,{size:18}):a.jsx(K6,{size:18}),a.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${Q.color}`,children:Q.label}),a.jsxs("span",{className:"text-sm text-gray-500",children:["(",Q.accounts.length," accounts)"]})]}),a.jsxs("span",{className:"text-sm font-semibold",children:["$",W(Q.accounts.reduce((H,K)=>H+K.balance,0))]})]}),p[Q.value]&&a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-t bg-gray-50 text-gray-500 text-xs uppercase",children:[a.jsx("th",{className:"text-left px-4 py-2",children:"Code"}),a.jsx("th",{className:"text-left px-4 py-2",children:"Account Name"}),a.jsx("th",{className:"text-left px-4 py-2",children:"Category"}),a.jsx("th",{className:"text-right px-4 py-2",children:"Balance"}),a.jsx("th",{className:"text-center px-4 py-2",children:"Status"}),a.jsx("th",{className:"text-right px-4 py-2",children:"Actions"})]})}),a.jsx("tbody",{children:Q.accounts.map(H=>a.jsxs("tr",{className:"border-t hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-2.5 font-mono text-xs font-semibold",children:H.code}),a.jsxs("td",{className:"px-4 py-2.5",children:[H.name,H.isSystem&&a.jsx("span",{className:"ml-2 text-xs text-gray-400 bg-gray-100 px-1.5 py-0.5 rounded",children:"System"})]}),a.jsx("td",{className:"px-4 py-2.5 text-gray-500",children:H.category||"-"}),a.jsxs("td",{className:"px-4 py-2.5 text-right font-mono",children:["$",W(H.balance)]}),a.jsx("td",{className:"px-4 py-2.5 text-center",children:a.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${H.isActive?"bg-green-100 text-green-700":"bg-gray-100 text-gray-500"}`,children:H.isActive?"Active":"Inactive"})}),a.jsx("td",{className:"px-4 py-2.5 text-right",children:a.jsxs("div",{className:"flex items-center justify-end gap-1",children:[a.jsx("button",{onClick:()=>_(H),className:"p-1 text-gray-400 hover:text-blue-600",children:a.jsx(yW,{size:14})}),!H.isSystem&&a.jsx("button",{onClick:()=>E(H),className:"p-1 text-gray-400 hover:text-red-600",children:a.jsx(xr,{size:14})})]})})]},H.id))})]})]},Q.value))}),c&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-lg",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h2",{className:"text-lg font-bold",children:d?"Edit Account":"New Account"}),a.jsx("button",{onClick:()=>u(!1),className:"text-gray-400 hover:text-gray-600",children:a.jsx(yt,{size:20})})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Account Code *"}),a.jsx("input",{value:y.code,onChange:Q=>v({...y,code:Q.target.value}),className:"w-full border rounded-lg px-3 py-2 text-sm",placeholder:"e.g. 1050"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Account Type *"}),a.jsx("select",{value:y.accountType,onChange:Q=>v({...y,accountType:Q.target.value,category:""}),className:"w-full border rounded-lg px-3 py-2 text-sm",children:p1.map(Q=>a.jsx("option",{value:Q.value,children:Q.label},Q.value))})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Account Name *"}),a.jsx("input",{value:y.name,onChange:Q=>v({...y,name:Q.target.value}),className:"w-full border rounded-lg px-3 py-2 text-sm",placeholder:"e.g. Petty Cash"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),a.jsxs("select",{value:y.category,onChange:Q=>v({...y,category:Q.target.value}),className:"w-full border rounded-lg px-3 py-2 text-sm",children:[a.jsx("option",{value:"",children:"Select..."}),(Lve[y.accountType]||[]).map(Q=>a.jsx("option",{value:Q,children:Q},Q))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Parent Account"}),a.jsxs("select",{value:y.parentId??"",onChange:Q=>v({...y,parentId:Q.target.value?Number(Q.target.value):null}),className:"w-full border rounded-lg px-3 py-2 text-sm",children:[a.jsx("option",{value:"",children:"None (Top Level)"}),e.filter(Q=>Q.accountType===y.accountType&&Q.id!==(d==null?void 0:d.id)).map(Q=>a.jsxs("option",{value:Q.id,children:[Q.code," - ",Q.name]},Q.id))]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),a.jsx("input",{value:y.description,onChange:Q=>v({...y,description:Q.target.value}),className:"w-full border rounded-lg px-3 py-2 text-sm",placeholder:"Optional description"})]}),d&&a.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[a.jsx("input",{type:"checkbox",checked:y.isActive,onChange:Q=>v({...y,isActive:Q.target.checked}),className:"rounded"}),"Active"]})]}),a.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[a.jsx("button",{onClick:()=>u(!1),className:"px-4 py-2 text-sm text-gray-600 border rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{onClick:O,disabled:f||!y.code||!y.name,className:"px-4 py-2 text-sm bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 disabled:opacity-50",children:f?"Saving...":d?"Update":"Create"})]})]})}),j&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md p-6",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"p-3 bg-red-100 rounded-full",children:a.jsx(ao,{size:24,className:"text-red-600"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Reset Accounting Data"}),a.jsx("p",{className:"text-sm text-gray-500",children:"This action cannot be undone"})]})]}),a.jsxs("p",{className:"text-sm text-gray-600 mb-6",children:["This will delete ",a.jsx("strong",{children:"all journal entries"})," and reset ",a.jsx("strong",{children:"all account balances to zero"}),". The chart of accounts structure will be preserved."]}),a.jsxs("div",{className:"flex justify-end gap-3",children:[a.jsx("button",{onClick:()=>b(!1),className:"px-4 py-2 text-sm text-gray-600 border rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{onClick:C,disabled:w,className:"px-4 py-2 text-sm bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50",children:w?"Resetting...":"Reset All Balances"})]})]})})]})}const g1={order:"Sales Order",direct_sale:"Direct Sale",collection:"Collection",expense:"Expense",supplier_invoice:"Supplier Invoice",supplier_payment:"Supplier Payment",salary:"Salary",production:"Production",return:"Return",deposit:"Deposit",rm_purchase:"RM Purchase",manual:"Manual",reversal:"Reversal"};function Bve(){const[e,t]=m.useState([]),[r,s]=m.useState([]),[n,i]=m.useState(!0),[l,o]=m.useState(""),[c,u]=m.useState(""),[d,h]=m.useState(""),[f,x]=m.useState(""),[p,g]=m.useState(null),[y,v]=m.useState(!1),[j,b]=m.useState(!1),[w,k]=m.useState({entryDate:new Date().toISOString().split("T")[0],description:"",lines:[{accountCode:"",debit:0,credit:0,description:""},{accountCode:"",debit:0,credit:0,description:""}]});m.useEffect(()=>{N()},[]);const N=async()=>{try{i(!0);const H={};d&&(H.startDate=d),f&&(H.endDate=f),c&&(H.referenceType=c);const[K,q]=await Promise.all([Sn.getJournalEntries(H),Sn.getAccounts({activeOnly:!0})]);t(K),s(q)}catch(H){console.error("Failed to load:",H)}finally{i(!1)}};m.useEffect(()=>{const H=setTimeout(()=>N(),300);return()=>clearTimeout(H)},[d,f,c]);const S=()=>{k(H=>({...H,lines:[...H.lines,{accountCode:"",debit:0,credit:0,description:""}]}))},_=H=>{w.lines.length<=2||k(K=>({...K,lines:K.lines.filter((q,ge)=>ge!==H)}))},O=(H,K,q)=>{k(ge=>({...ge,lines:ge.lines.map((G,B)=>B===H?{...G,[K]:q}:G)}))},E=async()=>{var q,ge;const H=w.lines.reduce((G,B)=>G+Number(B.debit),0),K=w.lines.reduce((G,B)=>G+Number(B.credit),0);if(Math.abs(H-K)>.001){alert(`Debits ($${H.toFixed(2)}) must equal Credits ($${K.toFixed(2)})`);return}if(w.lines.some(G=>!G.accountCode)){alert("All lines must have an account selected");return}b(!0);try{await Sn.createJournalEntry({entryDate:w.entryDate,description:w.description,lines:w.lines.filter(G=>G.debit>0||G.credit>0).map(G=>({accountCode:G.accountCode,debit:Number(G.debit),credit:Number(G.credit),description:G.description||null}))}),v(!1),k({entryDate:new Date().toISOString().split("T")[0],description:"",lines:[{accountCode:"",debit:0,credit:0,description:""},{accountCode:"",debit:0,credit:0,description:""}]}),N()}catch(G){alert(((ge=(q=G.response)==null?void 0:q.data)==null?void 0:ge.message)||"Failed to create entry")}finally{b(!1)}},R=async H=>{var K,q;if(confirm(`Reverse entry ${H.entryNumber}? This will create a mirror entry.`))try{await Sn.reverseJournalEntry(H.id),N(),g(null)}catch(ge){alert(((q=(K=ge.response)==null?void 0:K.data)==null?void 0:q.message)||"Failed to reverse entry")}},C=e.filter(H=>{if(!l)return!0;const K=l.toLowerCase();return H.entryNumber.toLowerCase().includes(K)||(H.description||"").toLowerCase().includes(K)}),I=H=>H.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}),ne=w.lines.reduce((H,K)=>H+Number(K.debit),0),W=w.lines.reduce((H,K)=>H+Number(K.credit),0),Q=Math.abs(ne-W)<.001;return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Journal Entries"}),a.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[e.length," entries"]})]}),a.jsxs("button",{onClick:()=>v(!0),className:"flex items-center gap-2 px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700",children:[a.jsx(hr,{size:18})," Manual Entry"]})]}),a.jsxs("div",{className:"flex gap-3 flex-wrap",children:[a.jsxs("div",{className:"relative flex-1 min-w-[200px]",children:[a.jsx(Na,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Search entries...",value:l,onChange:H=>o(H.target.value),className:"w-full pl-9 pr-4 py-2 border rounded-lg text-sm"})]}),a.jsx("input",{type:"date",value:d,onChange:H=>h(H.target.value),className:"border rounded-lg px-3 py-2 text-sm"}),a.jsx("input",{type:"date",value:f,onChange:H=>x(H.target.value),className:"border rounded-lg px-3 py-2 text-sm"}),a.jsxs("select",{value:c,onChange:H=>u(H.target.value),className:"border rounded-lg px-3 py-2 text-sm",children:[a.jsx("option",{value:"",children:"All Types"}),Object.entries(g1).map(([H,K])=>a.jsx("option",{value:H,children:K},H))]})]}),n?a.jsx("div",{className:"flex justify-center py-12",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-emerald-500"})}):a.jsx("div",{className:"bg-white rounded-lg border overflow-hidden",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gray-50 text-gray-500 text-xs uppercase",children:[a.jsx("th",{className:"text-left px-4 py-3",children:"Entry #"}),a.jsx("th",{className:"text-left px-4 py-3",children:"Date"}),a.jsx("th",{className:"text-left px-4 py-3",children:"Description"}),a.jsx("th",{className:"text-left px-4 py-3",children:"Type"}),a.jsx("th",{className:"text-right px-4 py-3",children:"Debit"}),a.jsx("th",{className:"text-right px-4 py-3",children:"Credit"}),a.jsx("th",{className:"text-center px-4 py-3",children:"Status"}),a.jsx("th",{className:"text-right px-4 py-3",children:"Actions"})]})}),a.jsx("tbody",{children:C.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:8,className:"text-center py-8 text-gray-400",children:"No journal entries found"})}):C.map(H=>a.jsxs("tr",{className:"border-t hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-2.5 font-mono text-xs font-semibold",children:H.entryNumber}),a.jsx("td",{className:"px-4 py-2.5",children:new Date(H.entryDate).toLocaleDateString()}),a.jsx("td",{className:"px-4 py-2.5 max-w-[250px] truncate",children:H.description||"-"}),a.jsx("td",{className:"px-4 py-2.5",children:a.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-gray-100 text-gray-700",children:g1[H.referenceType||""]||H.referenceType||"-"})}),a.jsxs("td",{className:"px-4 py-2.5 text-right font-mono",children:["$",I(H.totalDebit)]}),a.jsxs("td",{className:"px-4 py-2.5 text-right font-mono",children:["$",I(H.totalCredit)]}),a.jsx("td",{className:"px-4 py-2.5 text-center",children:H.isReversed?a.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-red-100 text-red-700",children:"Reversed"}):H.isPosted?a.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-green-100 text-green-700",children:"Posted"}):a.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-yellow-100 text-yellow-700",children:"Draft"})}),a.jsx("td",{className:"px-4 py-2.5 text-right",children:a.jsx("button",{onClick:()=>g(H),className:"p-1 text-gray-400 hover:text-blue-600",children:a.jsx(gs,{size:14})})})]},H.id))})]})}),p&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-2xl max-h-[80vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-lg font-bold",children:p.entryNumber}),a.jsxs("p",{className:"text-sm text-gray-500",children:[new Date(p.entryDate).toLocaleDateString()," - ",g1[p.referenceType||""]||"Manual"]})]}),a.jsx("button",{onClick:()=>g(null),className:"text-gray-400 hover:text-gray-600",children:a.jsx(yt,{size:20})})]}),p.description&&a.jsx("p",{className:"text-sm text-gray-600 mb-4",children:p.description}),a.jsxs("table",{className:"w-full text-sm border rounded-lg overflow-hidden",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gray-50 text-xs text-gray-500 uppercase",children:[a.jsx("th",{className:"text-left px-4 py-2",children:"Account"}),a.jsx("th",{className:"text-left px-4 py-2",children:"Description"}),a.jsx("th",{className:"text-right px-4 py-2",children:"Debit"}),a.jsx("th",{className:"text-right px-4 py-2",children:"Credit"})]})}),a.jsxs("tbody",{children:[p.lines.map(H=>a.jsxs("tr",{className:"border-t",children:[a.jsxs("td",{className:"px-4 py-2",children:[a.jsx("span",{className:"font-mono text-xs",children:H.accountCode})," ",H.accountName]}),a.jsx("td",{className:"px-4 py-2 text-gray-500",children:H.description||"-"}),a.jsx("td",{className:"px-4 py-2 text-right font-mono",children:H.debit>0?`$${I(H.debit)}`:""}),a.jsx("td",{className:"px-4 py-2 text-right font-mono",children:H.credit>0?`$${I(H.credit)}`:""})]},H.id)),a.jsxs("tr",{className:"border-t bg-gray-50 font-bold",children:[a.jsx("td",{className:"px-4 py-2",colSpan:2,children:"Total"}),a.jsxs("td",{className:"px-4 py-2 text-right font-mono",children:["$",I(p.totalDebit)]}),a.jsxs("td",{className:"px-4 py-2 text-right font-mono",children:["$",I(p.totalCredit)]})]})]})]}),a.jsxs("div",{className:"flex justify-between mt-4",children:[a.jsx("div",{className:"flex gap-2",children:p.isReversed&&a.jsx("span",{className:"text-xs text-red-600 bg-red-50 px-2 py-1 rounded",children:"This entry has been reversed"})}),a.jsxs("div",{className:"flex gap-2",children:[!p.isReversed&&p.isPosted&&a.jsxs("button",{onClick:()=>R(p),className:"flex items-center gap-1 px-3 py-1.5 text-sm text-red-600 border border-red-200 rounded-lg hover:bg-red-50",children:[a.jsx(ao,{size:14})," Reverse"]}),a.jsx("button",{onClick:()=>g(null),className:"px-4 py-1.5 text-sm text-gray-600 border rounded-lg hover:bg-gray-50",children:"Close"})]})]})]})}),y&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:a.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-3xl max-h-[85vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h2",{className:"text-lg font-bold",children:"Create Manual Journal Entry"}),a.jsx("button",{onClick:()=>v(!1),className:"text-gray-400 hover:text-gray-600",children:a.jsx(yt,{size:20})})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date *"}),a.jsx("input",{type:"date",value:w.entryDate,onChange:H=>k({...w,entryDate:H.target.value}),className:"w-full border rounded-lg px-3 py-2 text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),a.jsx("input",{value:w.description,onChange:H=>k({...w,description:H.target.value}),className:"w-full border rounded-lg px-3 py-2 text-sm",placeholder:"Entry description"})]})]}),a.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[a.jsx("h3",{className:"text-sm font-semibold text-gray-700",children:"Lines"}),a.jsxs("button",{onClick:S,className:"text-xs text-emerald-600 hover:text-emerald-700 flex items-center gap-1",children:[a.jsx(hr,{size:14})," Add Line"]})]}),a.jsxs("table",{className:"w-full text-sm border rounded-lg overflow-hidden mb-4",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gray-50 text-xs text-gray-500 uppercase",children:[a.jsx("th",{className:"text-left px-3 py-2",children:"Account"}),a.jsx("th",{className:"text-left px-3 py-2",children:"Description"}),a.jsx("th",{className:"text-right px-3 py-2 w-28",children:"Debit"}),a.jsx("th",{className:"text-right px-3 py-2 w-28",children:"Credit"}),a.jsx("th",{className:"w-8"})]})}),a.jsxs("tbody",{children:[w.lines.map((H,K)=>a.jsxs("tr",{className:"border-t",children:[a.jsx("td",{className:"px-3 py-1.5",children:a.jsxs("select",{value:H.accountCode,onChange:q=>O(K,"accountCode",q.target.value),className:"w-full border rounded px-2 py-1.5 text-sm",children:[a.jsx("option",{value:"",children:"Select account..."}),r.map(q=>a.jsxs("option",{value:q.code,children:[q.code," - ",q.name]},q.id))]})}),a.jsx("td",{className:"px-3 py-1.5",children:a.jsx("input",{value:H.description,onChange:q=>O(K,"description",q.target.value),className:"w-full border rounded px-2 py-1.5 text-sm",placeholder:"Line note"})}),a.jsx("td",{className:"px-3 py-1.5",children:a.jsx("input",{type:"number",min:"0",step:"0.01",value:H.debit||"",onChange:q=>O(K,"debit",q.target.value),className:"w-full border rounded px-2 py-1.5 text-sm text-right",placeholder:"0.00"})}),a.jsx("td",{className:"px-3 py-1.5",children:a.jsx("input",{type:"number",min:"0",step:"0.01",value:H.credit||"",onChange:q=>O(K,"credit",q.target.value),className:"w-full border rounded px-2 py-1.5 text-sm text-right",placeholder:"0.00"})}),a.jsx("td",{className:"px-1",children:w.lines.length>2&&a.jsx("button",{onClick:()=>_(K),className:"p-1 text-gray-400 hover:text-red-500",children:a.jsx(yt,{size:14})})})]},K)),a.jsxs("tr",{className:"border-t bg-gray-50 font-semibold",children:[a.jsx("td",{className:"px-3 py-2",colSpan:2,children:"Total"}),a.jsxs("td",{className:"px-3 py-2 text-right font-mono",children:["$",I(ne)]}),a.jsxs("td",{className:"px-3 py-2 text-right font-mono",children:["$",I(W)]}),a.jsx("td",{})]})]})]}),!Q&&ne>0&&a.jsxs("p",{className:"text-sm text-red-600 mb-4",children:["Difference: $",I(Math.abs(ne-W)),"  Debits must equal Credits"]}),a.jsxs("div",{className:"flex justify-end gap-3",children:[a.jsx("button",{onClick:()=>v(!1),className:"px-4 py-2 text-sm text-gray-600 border rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{onClick:E,disabled:j||!Q||ne===0,className:"px-4 py-2 text-sm bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 disabled:opacity-50",children:j?"Posting...":"Post Entry"})]})]})})]})}function zve(){const[e,t]=m.useState("income"),[r,s]=m.useState(!1),[n,i]=m.useState(()=>{const b=new Date;return b.setDate(1),b.toISOString().split("T")[0]}),[l,o]=m.useState(()=>new Date().toISOString().split("T")[0]),[c,u]=m.useState(()=>new Date().toISOString().split("T")[0]),[d,h]=m.useState(null),[f,x]=m.useState(null),[p,g]=m.useState([]),y=async()=>{s(!0);try{if(e==="income"){const b=await Sn.getIncomeStatement(n,l);h(b)}else if(e==="balance"){const b=await Sn.getBalanceSheet({asOfDate:c});x(b)}else{const b=await Sn.getTrialBalance({asOfDate:c});g(b)}}catch(b){console.error("Failed to load report:",b)}finally{s(!1)}},v=b=>b.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}),j=()=>window.print();return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Financial Reports"}),a.jsxs("button",{onClick:j,className:"flex items-center gap-2 px-4 py-2 text-gray-600 border rounded-lg hover:bg-gray-50 print:hidden",children:[a.jsx(ua,{size:16})," Print"]})]}),a.jsx("div",{className:"grid grid-cols-3 gap-4 print:hidden",children:[{type:"income",label:"Income Statement",desc:"Revenue, expenses & profit",icon:hn,color:"emerald"},{type:"balance",label:"Balance Sheet",desc:"Assets, liabilities & equity",icon:qi,color:"blue"},{type:"trial",label:"Trial Balance",desc:"All accounts debit/credit",icon:Br,color:"purple"}].map(b=>a.jsxs("button",{onClick:()=>t(b.type),className:`p-4 rounded-lg border-2 text-left transition-colors ${e===b.type?`border-${b.color}-500 bg-${b.color}-50`:"border-gray-200 hover:border-gray-300"}`,children:[a.jsx(b.icon,{size:24,className:e===b.type?`text-${b.color}-600`:"text-gray-400"}),a.jsx("h3",{className:"font-semibold mt-2",children:b.label}),a.jsx("p",{className:"text-xs text-gray-500",children:b.desc})]},b.type))}),a.jsxs("div",{className:"flex gap-3 items-end print:hidden",children:[e==="income"?a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Start Date"}),a.jsx("input",{type:"date",value:n,onChange:b=>i(b.target.value),className:"border rounded-lg px-3 py-2 text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"End Date"}),a.jsx("input",{type:"date",value:l,onChange:b=>o(b.target.value),className:"border rounded-lg px-3 py-2 text-sm"})]})]}):a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"As of Date"}),a.jsx("input",{type:"date",value:c,onChange:b=>u(b.target.value),className:"border rounded-lg px-3 py-2 text-sm"})]}),a.jsx("button",{onClick:y,disabled:r,className:"px-6 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 disabled:opacity-50 text-sm",children:r?"Loading...":"Generate Report"})]}),e==="income"&&d&&a.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("h2",{className:"text-xl font-bold",children:"Income Statement"}),a.jsxs("p",{className:"text-sm text-gray-500",children:[new Date(d.startDate).toLocaleDateString(),"  ",new Date(d.endDate).toLocaleDateString()]})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("h3",{className:"text-sm font-bold text-gray-700 uppercase tracking-wider mb-2 border-b pb-1",children:"Revenue"}),d.revenue.map((b,w)=>a.jsxs("div",{className:"flex justify-between py-1 text-sm",children:[a.jsx("span",{className:"text-gray-600 pl-4",children:b.accountName}),a.jsxs("span",{className:"font-mono",children:["$",v(b.amount)]})]},w)),a.jsxs("div",{className:"flex justify-between py-2 font-semibold border-t mt-1",children:[a.jsx("span",{children:"Total Revenue"}),a.jsxs("span",{className:"font-mono text-green-700",children:["$",v(d.totalRevenue)]})]})]}),d.costOfGoodsSold.length>0&&a.jsxs("div",{className:"mb-6",children:[a.jsx("h3",{className:"text-sm font-bold text-gray-700 uppercase tracking-wider mb-2 border-b pb-1",children:"Cost of Goods Sold"}),d.costOfGoodsSold.map((b,w)=>a.jsxs("div",{className:"flex justify-between py-1 text-sm",children:[a.jsx("span",{className:"text-gray-600 pl-4",children:b.accountName}),a.jsxs("span",{className:"font-mono",children:["$",v(b.amount)]})]},w)),a.jsxs("div",{className:"flex justify-between py-2 font-semibold border-t mt-1",children:[a.jsx("span",{children:"Total COGS"}),a.jsxs("span",{className:"font-mono",children:["$",v(d.totalCOGS)]})]})]}),a.jsxs("div",{className:"flex justify-between py-3 font-bold text-lg border-y bg-gray-50 px-4 rounded mb-6",children:[a.jsx("span",{children:"Gross Profit"}),a.jsxs("span",{className:`font-mono ${d.grossProfit>=0?"text-green-700":"text-red-700"}`,children:["$",v(d.grossProfit)]})]}),d.operatingExpenses.length>0&&a.jsxs("div",{className:"mb-6",children:[a.jsx("h3",{className:"text-sm font-bold text-gray-700 uppercase tracking-wider mb-2 border-b pb-1",children:"Operating Expenses"}),d.operatingExpenses.map((b,w)=>a.jsxs("div",{className:"flex justify-between py-1 text-sm",children:[a.jsx("span",{className:"text-gray-600 pl-4",children:b.accountName}),a.jsxs("span",{className:"font-mono",children:["$",v(b.amount)]})]},w)),a.jsxs("div",{className:"flex justify-between py-2 font-semibold border-t mt-1",children:[a.jsx("span",{children:"Total Operating Expenses"}),a.jsxs("span",{className:"font-mono",children:["$",v(d.totalOperatingExpenses)]})]})]}),a.jsxs("div",{className:`flex justify-between py-4 font-bold text-xl border-y-2 px-4 rounded ${d.netProfit>=0?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:[a.jsx("span",{children:"Net Profit"}),a.jsxs("span",{className:`font-mono ${d.netProfit>=0?"text-green-700":"text-red-700"}`,children:["$",v(d.netProfit)]})]})]}),e==="balance"&&f&&a.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("h2",{className:"text-xl font-bold",children:"Balance Sheet"}),a.jsxs("p",{className:"text-sm text-gray-500",children:["As of ",new Date(f.asOfDate).toLocaleDateString()]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-bold text-blue-700 uppercase tracking-wider mb-3 border-b border-blue-200 pb-1",children:"Assets"}),f.assets.map((b,w)=>a.jsxs("div",{className:"flex justify-between py-1 text-sm",children:[a.jsx("span",{className:"text-gray-600",children:b.accountName}),a.jsxs("span",{className:"font-mono",children:["$",v(b.amount)]})]},w)),a.jsxs("div",{className:"flex justify-between py-3 font-bold border-t-2 border-blue-200 mt-2",children:[a.jsx("span",{className:"text-blue-700",children:"Total Assets"}),a.jsxs("span",{className:"font-mono text-blue-700",children:["$",v(f.totalAssets)]})]})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-bold text-orange-700 uppercase tracking-wider mb-3 border-b border-orange-200 pb-1",children:"Liabilities"}),f.liabilities.map((b,w)=>a.jsxs("div",{className:"flex justify-between py-1 text-sm",children:[a.jsx("span",{className:"text-gray-600",children:b.accountName}),a.jsxs("span",{className:"font-mono",children:["$",v(b.amount)]})]},w)),a.jsxs("div",{className:"flex justify-between py-2 font-semibold border-t mt-1 mb-4",children:[a.jsx("span",{children:"Total Liabilities"}),a.jsxs("span",{className:"font-mono",children:["$",v(f.totalLiabilities)]})]}),a.jsx("h3",{className:"text-sm font-bold text-purple-700 uppercase tracking-wider mb-3 border-b border-purple-200 pb-1",children:"Equity"}),f.equity.map((b,w)=>a.jsxs("div",{className:"flex justify-between py-1 text-sm",children:[a.jsx("span",{className:"text-gray-600",children:b.accountName}),a.jsxs("span",{className:"font-mono",children:["$",v(b.amount)]})]},w)),a.jsxs("div",{className:"flex justify-between py-2 font-semibold border-t mt-1 mb-4",children:[a.jsx("span",{children:"Total Equity"}),a.jsxs("span",{className:"font-mono",children:["$",v(f.totalEquity)]})]}),a.jsxs("div",{className:"flex justify-between py-3 font-bold border-t-2 border-purple-200",children:[a.jsx("span",{className:"text-purple-700",children:"Total L + E"}),a.jsxs("span",{className:"font-mono text-purple-700",children:["$",v(f.totalLiabilitiesAndEquity)]})]})]})]}),a.jsx("div",{className:`mt-6 text-center py-3 rounded-lg ${Math.abs(f.totalAssets-f.totalLiabilitiesAndEquity)<.01?"bg-green-50 text-green-700":"bg-red-50 text-red-700"}`,children:Math.abs(f.totalAssets-f.totalLiabilitiesAndEquity)<.01?a.jsx("span",{className:"font-semibold",children:" Balance Sheet is balanced"}):a.jsxs("span",{className:"font-semibold",children:[" Out of balance by $",v(Math.abs(f.totalAssets-f.totalLiabilitiesAndEquity))]})})]}),e==="trial"&&p.length>0&&a.jsxs("div",{className:"bg-white rounded-lg border overflow-hidden",children:[a.jsxs("div",{className:"text-center py-4 border-b",children:[a.jsx("h2",{className:"text-xl font-bold",children:"Trial Balance"}),a.jsxs("p",{className:"text-sm text-gray-500",children:["As of ",new Date(c).toLocaleDateString()]})]}),a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gray-50 text-xs text-gray-500 uppercase",children:[a.jsx("th",{className:"text-left px-4 py-3",children:"Code"}),a.jsx("th",{className:"text-left px-4 py-3",children:"Account"}),a.jsx("th",{className:"text-left px-4 py-3",children:"Type"}),a.jsx("th",{className:"text-right px-4 py-3",children:"Debit"}),a.jsx("th",{className:"text-right px-4 py-3",children:"Credit"})]})}),a.jsxs("tbody",{children:[p.map(b=>a.jsxs("tr",{className:"border-t hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-2 font-mono text-xs",children:b.accountCode}),a.jsx("td",{className:"px-4 py-2",children:b.accountName}),a.jsx("td",{className:"px-4 py-2 text-gray-500 capitalize",children:b.accountType}),a.jsx("td",{className:"px-4 py-2 text-right font-mono",children:b.debit>0?`$${v(b.debit)}`:""}),a.jsx("td",{className:"px-4 py-2 text-right font-mono",children:b.credit>0?`$${v(b.credit)}`:""})]},b.accountId)),a.jsxs("tr",{className:"border-t-2 bg-gray-50 font-bold",children:[a.jsx("td",{className:"px-4 py-3",colSpan:3,children:"Total"}),a.jsxs("td",{className:"px-4 py-3 text-right font-mono",children:["$",v(p.reduce((b,w)=>b+w.debit,0))]}),a.jsxs("td",{className:"px-4 py-3 text-right font-mono",children:["$",v(p.reduce((b,w)=>b+w.credit,0))]})]})]})]})]}),!r&&(e==="income"&&!d||e==="balance"&&!f||e==="trial"&&p.length===0)&&a.jsxs("div",{className:"text-center py-12 text-gray-400",children:[a.jsx(Br,{size:48,className:"mx-auto mb-3 opacity-50"}),a.jsx("p",{children:'Click "Generate Report" to view the report'})]})]})}const Uve={order:"Sales Order",direct_sale:"Direct Sale",collection:"Collection",expense:"Expense",supplier_invoice:"Supplier Invoice",supplier_payment:"Supplier Payment",salary:"Salary",production:"Production",return:"Return",deposit:"Deposit",rm_purchase:"RM Purchase",manual:"Manual",reversal:"Reversal"};function Wve(){const[e,t]=m.useState([]),[r,s]=m.useState(null),[n,i]=m.useState(null),[l,o]=m.useState(!0),[c,u]=m.useState(!1),[d,h]=m.useState(""),[f,x]=m.useState(""),[p,g]=m.useState("");m.useEffect(()=>{y()},[]);const y=async()=>{try{o(!0);const k=await Sn.getAccounts({activeOnly:!0});t(k)}catch(k){console.error("Failed to load accounts:",k)}finally{o(!1)}},v=async k=>{s(k),u(!0);try{const N={};f&&(N.startDate=f),p&&(N.endDate=p);const S=await Sn.getLedger(k,N);i(S)}catch(N){console.error("Failed to load ledger:",N)}finally{u(!1)}};m.useEffect(()=>{r&&v(r)},[f,p]);const j=e.filter(k=>{if(!d)return!0;const N=d.toLowerCase();return k.code.toLowerCase().includes(N)||k.name.toLowerCase().includes(N)}),b=k=>k.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}),w=k=>{switch(k){case"asset":return"bg-blue-100 text-blue-800";case"liability":return"bg-orange-100 text-orange-800";case"equity":return"bg-purple-100 text-purple-800";case"revenue":return"bg-green-100 text-green-800";case"expense":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return n?a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("button",{onClick:()=>{i(null),s(null)},className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg print:hidden",children:a.jsx(ff,{size:20})}),a.jsxs("div",{children:[a.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:[a.jsx("span",{className:"font-mono text-gray-500 text-lg",children:n.accountCode})," ",n.accountName]}),a.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[a.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium capitalize ${w(n.accountType)}`,children:n.accountType}),a.jsxs("span",{className:"text-sm text-gray-500",children:["Current Balance: ",a.jsxs("span",{className:"font-semibold font-mono",children:["$",b(n.currentBalance)]})]})]})]})]}),a.jsxs("button",{onClick:()=>window.print(),className:"flex items-center gap-2 px-4 py-2 text-gray-600 border rounded-lg hover:bg-gray-50 print:hidden",children:[a.jsx(ua,{size:16})," Print"]})]}),a.jsxs("div",{className:"flex gap-3 print:hidden",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Start Date"}),a.jsx("input",{type:"date",value:f,onChange:k=>x(k.target.value),className:"border rounded-lg px-3 py-2 text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"End Date"}),a.jsx("input",{type:"date",value:p,onChange:k=>g(k.target.value),className:"border rounded-lg px-3 py-2 text-sm"})]})]}),c?a.jsx("div",{className:"flex justify-center py-12",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-emerald-500"})}):a.jsxs("div",{className:"bg-white rounded-lg border overflow-hidden",children:[a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gray-50 text-xs text-gray-500 uppercase",children:[a.jsx("th",{className:"text-left px-4 py-3",children:"Date"}),a.jsx("th",{className:"text-left px-4 py-3",children:"Entry #"}),a.jsx("th",{className:"text-left px-4 py-3",children:"Description"}),a.jsx("th",{className:"text-left px-4 py-3",children:"Type"}),a.jsx("th",{className:"text-right px-4 py-3",children:"Debit"}),a.jsx("th",{className:"text-right px-4 py-3",children:"Credit"}),a.jsx("th",{className:"text-right px-4 py-3",children:"Balance"})]})}),a.jsx("tbody",{children:n.lines.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"text-center py-8 text-gray-400",children:"No transactions found for this account"})}):n.lines.map(k=>a.jsxs("tr",{className:"border-t hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-2",children:new Date(k.entryDate).toLocaleDateString()}),a.jsx("td",{className:"px-4 py-2 font-mono text-xs",children:k.entryNumber}),a.jsx("td",{className:"px-4 py-2 max-w-[250px] truncate text-gray-600",children:k.description||"-"}),a.jsx("td",{className:"px-4 py-2",children:a.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-gray-100 text-gray-700",children:Uve[k.referenceType||""]||k.referenceType||"-"})}),a.jsx("td",{className:"px-4 py-2 text-right font-mono",children:k.debit>0?`$${b(k.debit)}`:""}),a.jsx("td",{className:"px-4 py-2 text-right font-mono",children:k.credit>0?`$${b(k.credit)}`:""}),a.jsxs("td",{className:"px-4 py-2 text-right font-mono font-semibold",children:["$",b(k.runningBalance)]})]},k.id))})]}),n.lines.length>0&&a.jsxs("div",{className:"border-t bg-gray-50 px-4 py-3 flex justify-between text-sm",children:[a.jsxs("span",{className:"text-gray-500",children:[n.lines.length," transactions"]}),a.jsxs("div",{className:"flex gap-6",children:[a.jsxs("span",{children:["Total Debit: ",a.jsxs("span",{className:"font-semibold font-mono",children:["$",b(n.lines.reduce((k,N)=>k+N.debit,0))]})]}),a.jsxs("span",{children:["Total Credit: ",a.jsxs("span",{className:"font-semibold font-mono",children:["$",b(n.lines.reduce((k,N)=>k+N.credit,0))]})]})]})]})]})]}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Account Ledger"}),a.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Select an account to view its transaction history"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(Na,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Search accounts...",value:d,onChange:k=>h(k.target.value),className:"w-full pl-9 pr-4 py-2 border rounded-lg text-sm"})]}),l?a.jsx("div",{className:"flex justify-center py-12",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-emerald-500"})}):a.jsx("div",{className:"bg-white rounded-lg border overflow-hidden",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gray-50 text-xs text-gray-500 uppercase",children:[a.jsx("th",{className:"text-left px-4 py-3",children:"Code"}),a.jsx("th",{className:"text-left px-4 py-3",children:"Account Name"}),a.jsx("th",{className:"text-left px-4 py-3",children:"Type"}),a.jsx("th",{className:"text-right px-4 py-3",children:"Balance"})]})}),a.jsx("tbody",{children:j.map(k=>a.jsxs("tr",{onClick:()=>v(k.id),className:"border-t hover:bg-emerald-50 cursor-pointer transition-colors",children:[a.jsx("td",{className:"px-4 py-2.5 font-mono text-xs font-semibold",children:k.code}),a.jsx("td",{className:"px-4 py-2.5 font-medium",children:k.name}),a.jsx("td",{className:"px-4 py-2.5",children:a.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium capitalize ${w(k.accountType)}`,children:k.accountType})}),a.jsxs("td",{className:"px-4 py-2.5 text-right font-mono",children:["$",b(k.balance)]})]},k.id))})]})})]})}function Vve(){const{isAuthenticated:e,isLoading:t}=wy();return t?a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-500"})}):a.jsx(WU,{children:a.jsxs(fz,{children:[a.jsx(rr,{path:"/login",element:e?a.jsx(Fp,{to:"/"}):a.jsx(DW,{})}),a.jsxs(rr,{path:"/",element:e?a.jsx(TW,{}):a.jsx(Fp,{to:"/login"}),children:[a.jsx(rr,{index:!0,element:a.jsx(dr,{permission:Ve.VIEW_DASHBOARD,children:a.jsx(FW,{})})}),a.jsx(rr,{path:"no-access",element:a.jsx(eI,{})}),a.jsx(rr,{path:"employees",element:a.jsx(dr,{permission:Ve.VIEW_EMPLOYEES,children:a.jsx(tve,{})})}),a.jsx(rr,{path:"vans",element:a.jsx(dr,{permission:Ve.VIEW_VANS,children:a.jsx(rve,{})})}),a.jsx(rr,{path:"salesmen",element:a.jsx(dr,{permission:Ve.VIEW_EMPLOYEES,children:a.jsx(ave,{})})}),a.jsx(rr,{path:"warehouses",element:a.jsx(dr,{permission:Ve.VIEW_WAREHOUSES,children:a.jsx(sve,{})})}),a.jsx(rr,{path:"products",element:a.jsx(dr,{permission:Ve.VIEW_PRODUCTS,children:a.jsx(Zye,{})})}),a.jsx(rr,{path:"customers",element:a.jsx(dr,{permission:Ve.VIEW_CUSTOMERS,children:a.jsx(eve,{})})}),a.jsx(rr,{path:"tasks",element:a.jsx(dr,{permission:Ve.VIEW_ORDERS,children:a.jsx(nve,{})})}),a.jsx(rr,{path:"leads",element:a.jsx(dr,{permission:Ve.VIEW_LEADS,children:a.jsx(pve,{})})}),a.jsx(rr,{path:"returns",element:a.jsx(dr,{permission:Ve.VIEW_RETURNS,children:a.jsx(yve,{})})}),a.jsx(rr,{path:"quotes",element:a.jsx(dr,{permission:Ve.VIEW_QUOTES,children:a.jsx(vve,{})})}),a.jsx(rr,{path:"direct-sales",element:a.jsx(dr,{permission:Ve.VIEW_DIRECT_SALES,children:a.jsx(Nve,{})})}),a.jsx(rr,{path:"sales-history",element:a.jsx(dr,{permission:Ve.VIEW_DIRECT_SALES,children:a.jsx(Sve,{})})}),a.jsx(rr,{path:"deep-report",element:a.jsx(dr,{permission:Ve.VIEW_DEEP_REPORT,children:a.jsx(kve,{})})}),a.jsx(rr,{path:"cash",element:a.jsx(dr,{permission:Ve.VIEW_COLLECTIONS,children:a.jsx(ive,{})})}),a.jsx(rr,{path:"suppliers",element:a.jsx(dr,{permission:Ve.VIEW_SUPPLIERS,children:a.jsx(lve,{})})}),a.jsx(rr,{path:"expenses",element:a.jsx(dr,{permission:Ve.VIEW_EXPENSES,children:a.jsx(ove,{})})}),a.jsx(rr,{path:"reports",element:a.jsx(dr,{permission:Ve.VIEW_SALES_REPORT,children:a.jsx(cve,{})})}),a.jsx(rr,{path:"valuation",element:a.jsx(dr,{permission:Ve.VIEW_INVENTORY_VALUATION,children:a.jsx(dve,{})})}),a.jsx(rr,{path:"inventory-settings",element:a.jsx(dr,{permission:Ve.EDIT_INVENTORY_SETTINGS,children:a.jsx(uve,{})})}),a.jsx(rr,{path:"currencies",element:a.jsx(dr,{permission:Ve.VIEW_CURRENCIES,children:a.jsx(hve,{})})}),a.jsx(rr,{path:"categories",element:a.jsx(dr,{permission:Ve.VIEW_CATEGORIES,children:a.jsx(fve,{})})}),a.jsx(rr,{path:"units",element:a.jsx(dr,{permission:Ve.VIEW_UNITS,children:a.jsx(gve,{})})}),a.jsx(rr,{path:"settings",element:a.jsx(dr,{permission:Ve.VIEW_SETTINGS,children:a.jsx(xve,{})})}),a.jsx(rr,{path:"roles",element:a.jsx(dr,{permission:Ve.VIEW_ROLES,children:a.jsx(mve,{})})}),a.jsx(rr,{path:"attendance",element:a.jsx(dr,{permission:Ve.VIEW_ATTENDANCE,children:a.jsx(Eve,{})})}),a.jsx(rr,{path:"raw-materials",element:a.jsx(dr,{permission:Ve.VIEW_PRODUCTS,children:a.jsx(Pve,{})})}),a.jsx(rr,{path:"raw-material-purchases",element:a.jsx(dr,{permission:Ve.VIEW_SUPPLIERS,children:a.jsx(Ave,{})})}),a.jsx(rr,{path:"production-orders",element:a.jsx(dr,{permission:Ve.VIEW_PRODUCTS,children:a.jsx(_ve,{})})}),a.jsx(rr,{path:"manufacturer-report/:id",element:a.jsx(dr,{permission:Ve.VIEW_PRODUCTS,children:a.jsx(Tve,{})})}),a.jsx(rr,{path:"customer-report/:id",element:a.jsx(dr,{permission:Ve.VIEW_CUSTOMERS,children:a.jsx(Ive,{})})}),a.jsx(rr,{path:"online-store-settings",element:a.jsx(dr,{permission:Ve.VIEW_ONLINE_STORE,children:a.jsx(Ove,{})})}),a.jsx(rr,{path:"online-orders",element:a.jsx(dr,{permission:Ve.VIEW_ONLINE_ORDERS,children:a.jsx(Rve,{})})}),a.jsx(rr,{path:"stock-adjustment",element:a.jsx(dr,{permission:Ve.ADJUST_STOCK_LEVELS,children:a.jsx(Mve,{})})}),a.jsx(rr,{path:"chart-of-accounts",element:a.jsx(dr,{permission:Ve.VIEW_ACCOUNTING,children:a.jsx($ve,{})})}),a.jsx(rr,{path:"journal-entries",element:a.jsx(dr,{permission:Ve.VIEW_ACCOUNTING,children:a.jsx(Bve,{})})}),a.jsx(rr,{path:"financial-reports",element:a.jsx(dr,{permission:Ve.VIEW_FINANCIAL_REPORTS,children:a.jsx(zve,{})})}),a.jsx(rr,{path:"account-ledger",element:a.jsx(dr,{permission:Ve.VIEW_ACCOUNTING,children:a.jsx(Wve,{})})})]})]})})}const Hve=new Zz({defaultOptions:{queries:{staleTime:1e3*60*5,retry:1}}});y1.createRoot(document.getElementById("root")).render(a.jsx(K_.StrictMode,{children:a.jsx(e9,{client:Hve,children:a.jsx(wz,{basename:"/",children:a.jsx(Vve,{})})})}));
